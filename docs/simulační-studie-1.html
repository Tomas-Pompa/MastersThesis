<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.5 Simulační studie | Diplomová práce</title>
  <meta name="description" content="3.5 Simulační studie | Diplomová práce" />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="3.5 Simulační studie | Diplomová práce" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.5 Simulační studie | Diplomová práce" />
  
  
  

<meta name="author" content="Tomáš Pompa" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tabulka-výsledků-1.html"/>
<link rel="next" href="aplikace-na-reálných-datech-1.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/codefolding-lua-1.1/codefolding-lua.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="sci-lg-eng-rgb.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Metoda podpůrných vektorů pro funkcionální data</a></li>
<li class="chapter" data-level="2" data-path="simulace-1.html"><a href="simulace-1.html"><i class="fa fa-check"></i><b>2</b> Simulace 1</a>
<ul>
<li class="chapter" data-level="2.1" data-path="simulace-funkcionálních-dat.html"><a href="simulace-funkcionálních-dat.html"><i class="fa fa-check"></i><b>2.1</b> Simulace funkcionálních dat</a></li>
<li class="chapter" data-level="2.2" data-path="vyhlazení-pozorovaných-křivek.html"><a href="vyhlazení-pozorovaných-křivek.html"><i class="fa fa-check"></i><b>2.2</b> Vyhlazení pozorovaných křivek</a></li>
<li class="chapter" data-level="2.3" data-path="klasifikace-křivek.html"><a href="klasifikace-křivek.html"><i class="fa fa-check"></i><b>2.3</b> Klasifikace křivek</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="klasifikace-křivek.html"><a href="klasifikace-křivek.html#k-nejbližších-sousedů"><i class="fa fa-check"></i><b>2.3.1</b> 1) <span class="math inline">\(K\)</span> nejbližších sousedů</a></li>
<li class="chapter" data-level="2.3.2" data-path="klasifikace-křivek.html"><a href="klasifikace-křivek.html#lineární-diskriminační-analýza"><i class="fa fa-check"></i><b>2.3.2</b> 2) Lineární diskriminační analýza</a></li>
<li class="chapter" data-level="2.3.3" data-path="klasifikace-křivek.html"><a href="klasifikace-křivek.html#kvadratická-diskriminační-analýza"><i class="fa fa-check"></i><b>2.3.3</b> 3) Kvadratická diskriminační analýza</a></li>
<li class="chapter" data-level="2.3.4" data-path="klasifikace-křivek.html"><a href="klasifikace-křivek.html#logistická-regrese"><i class="fa fa-check"></i><b>2.3.4</b> 4) Logistická regrese</a></li>
<li class="chapter" data-level="2.3.5" data-path="klasifikace-křivek.html"><a href="klasifikace-křivek.html#rozhodovací-stromy"><i class="fa fa-check"></i><b>2.3.5</b> 5) Rozhodovací stromy</a></li>
<li class="chapter" data-level="2.3.6" data-path="klasifikace-křivek.html"><a href="klasifikace-křivek.html#náhodné-lesy"><i class="fa fa-check"></i><b>2.3.6</b> 6) Náhodné lesy</a></li>
<li class="chapter" data-level="2.3.7" data-path="klasifikace-křivek.html"><a href="klasifikace-křivek.html#support-vector-machines"><i class="fa fa-check"></i><b>2.3.7</b> 7) Support Vector Machines</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="tabulka-výsledků.html"><a href="tabulka-výsledků.html"><i class="fa fa-check"></i><b>2.4</b> Tabulka výsledků</a></li>
<li class="chapter" data-level="2.5" data-path="simulační-studie.html"><a href="simulační-studie.html"><i class="fa fa-check"></i><b>2.5</b> Simulační studie</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="simulační-studie.html"><a href="simulační-studie.html#výsledky"><i class="fa fa-check"></i><b>2.5.1</b> Výsledky</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="simulace-2.html"><a href="simulace-2.html"><i class="fa fa-check"></i><b>3</b> Simulace 2</a>
<ul>
<li class="chapter" data-level="3.1" data-path="simulace-funkcionálních-dat-1.html"><a href="simulace-funkcionálních-dat-1.html"><i class="fa fa-check"></i><b>3.1</b> Simulace funkcionálních dat</a></li>
<li class="chapter" data-level="3.2" data-path="vyhlazení-pozorovaných-křivek-1.html"><a href="vyhlazení-pozorovaných-křivek-1.html"><i class="fa fa-check"></i><b>3.2</b> Vyhlazení pozorovaných křivek</a></li>
<li class="chapter" data-level="3.3" data-path="klasifikace-křivek-1.html"><a href="klasifikace-křivek-1.html"><i class="fa fa-check"></i><b>3.3</b> Klasifikace křivek</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="klasifikace-křivek-1.html"><a href="klasifikace-křivek-1.html#k-nejbližších-sousedů-1"><i class="fa fa-check"></i><b>3.3.1</b> 1) <span class="math inline">\(K\)</span> nejbližších sousedů</a></li>
<li class="chapter" data-level="3.3.2" data-path="klasifikace-křivek-1.html"><a href="klasifikace-křivek-1.html#lineární-diskriminační-analýza-1"><i class="fa fa-check"></i><b>3.3.2</b> 2) Lineární diskriminační analýza</a></li>
<li class="chapter" data-level="3.3.3" data-path="klasifikace-křivek-1.html"><a href="klasifikace-křivek-1.html#kvadratická-diskriminační-analýza-1"><i class="fa fa-check"></i><b>3.3.3</b> 3) Kvadratická diskriminační analýza</a></li>
<li class="chapter" data-level="3.3.4" data-path="klasifikace-křivek-1.html"><a href="klasifikace-křivek-1.html#logistická-regrese-1"><i class="fa fa-check"></i><b>3.3.4</b> 4) Logistická regrese</a></li>
<li class="chapter" data-level="3.3.5" data-path="klasifikace-křivek-1.html"><a href="klasifikace-křivek-1.html#rozhodovací-stromy-1"><i class="fa fa-check"></i><b>3.3.5</b> 5) Rozhodovací stromy</a></li>
<li class="chapter" data-level="3.3.6" data-path="klasifikace-křivek-1.html"><a href="klasifikace-křivek-1.html#náhodné-lesy-1"><i class="fa fa-check"></i><b>3.3.6</b> 6) Náhodné lesy</a></li>
<li class="chapter" data-level="3.3.7" data-path="klasifikace-křivek-1.html"><a href="klasifikace-křivek-1.html#support-vector-machines-1"><i class="fa fa-check"></i><b>3.3.7</b> 7) Support Vector Machines</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="tabulka-výsledků-1.html"><a href="tabulka-výsledků-1.html"><i class="fa fa-check"></i><b>3.4</b> Tabulka výsledků</a></li>
<li class="chapter" data-level="3.5" data-path="simulační-studie-1.html"><a href="simulační-studie-1.html"><i class="fa fa-check"></i><b>3.5</b> Simulační studie</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="simulační-studie-1.html"><a href="simulační-studie-1.html#výsledky-1"><i class="fa fa-check"></i><b>3.5.1</b> Výsledky</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="aplikace-na-reálných-datech-1.html"><a href="aplikace-na-reálných-datech-1.html"><i class="fa fa-check"></i><b>4</b> Aplikace na reálných datech 1</a></li>
<li class="chapter" data-level="5" data-path="aplikace-na-reálných-datech-2.html"><a href="aplikace-na-reálných-datech-2.html"><i class="fa fa-check"></i><b>5</b> Aplikace na reálných datech 2</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Diplomová práce</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulační-studie-1" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Simulační studie<a href="simulační-studie-1.html#simulační-studie-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>V celé předchozí části jsme se zabývali pouze jedním náhodně vygenerovaným souborem funkcí ze dvou klasifikačních tříd, který jsme následně opět náhodně rozdělili na testovací a trénovací část.
Poté jsme jednotlivé klasifikátory získané pomocí uvažovaných metod ohodnotili na základě testovací a trénovací chybovosti.</p>
<p>Jelikož se vygenerovaná data (a jejich rozdělení na dvě části) mohou při každém zopakování výrazně lišit, budou se i chybovosti jednotlivých klasifikačních algoritmů výrazně lišit.
Proto dělat jakékoli závěry o metodách a porovnávat je mezi sebou může být na základě jednoho vygenerovaného datového souboru velmi zavádějící.</p>
<p>Z tohoto důvodu se v této části zaměříme na opakování celého předchozího postupu pro různé vygenerované soubory.
Výsledky si budeme ukládat do tabulky a nakonec spočítáme průměrné charakteristiky modelů přes jednotlivá opakování.
Aby byly naše závěry dostatečně obecné, zvolíme počet opakování <span class="math inline">\(n_{sim} = 50\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="simulační-studie-1.html#cb246-1" tabindex="-1"></a><span class="co"># pocet simulaci</span></span>
<span id="cb246-2"><a href="simulační-studie-1.html#cb246-2" tabindex="-1"></a>n.sim <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb246-3"><a href="simulační-studie-1.html#cb246-3" tabindex="-1"></a></span>
<span id="cb246-4"><a href="simulační-studie-1.html#cb246-4" tabindex="-1"></a><span class="do">## list, do ktereho budeme ukladat hodnoty chybovosti</span></span>
<span id="cb246-5"><a href="simulační-studie-1.html#cb246-5" tabindex="-1"></a><span class="co"># ve sloupcich budou metody</span></span>
<span id="cb246-6"><a href="simulační-studie-1.html#cb246-6" tabindex="-1"></a><span class="co"># v radcich budou jednotliva opakovani</span></span>
<span id="cb246-7"><a href="simulační-studie-1.html#cb246-7" tabindex="-1"></a><span class="co"># list ma dve polozky ... train a test</span></span>
<span id="cb246-8"><a href="simulační-studie-1.html#cb246-8" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;KNN&#39;</span>, <span class="st">&#39;LDA&#39;</span>, <span class="st">&#39;QDA&#39;</span>, <span class="st">&#39;LR_functional&#39;</span>, <span class="st">&#39;LR_score&#39;</span>, <span class="st">&#39;Tree_discr&#39;</span>,</span>
<span id="cb246-9"><a href="simulační-studie-1.html#cb246-9" tabindex="-1"></a>             <span class="st">&#39;Tree_score&#39;</span>, <span class="st">&#39;Tree_Bbasis&#39;</span>, <span class="st">&#39;RF_discr&#39;</span>, <span class="st">&#39;RF_score&#39;</span>, <span class="st">&#39;RF_Bbasis&#39;</span>, </span>
<span id="cb246-10"><a href="simulační-studie-1.html#cb246-10" tabindex="-1"></a>             <span class="st">&#39;SVM linear - diskr&#39;</span>, <span class="st">&#39;SVM poly - diskr&#39;</span>, <span class="st">&#39;SVM rbf - diskr&#39;</span>, </span>
<span id="cb246-11"><a href="simulační-studie-1.html#cb246-11" tabindex="-1"></a>             <span class="st">&#39;SVM linear - PCA&#39;</span>, <span class="st">&#39;SVM poly - PCA&#39;</span>, <span class="st">&#39;SVM rbf - PCA&#39;</span>, </span>
<span id="cb246-12"><a href="simulační-studie-1.html#cb246-12" tabindex="-1"></a>             <span class="st">&#39;SVM linear - Bbasis&#39;</span>, <span class="st">&#39;SVM poly - Bbasis&#39;</span>, <span class="st">&#39;SVM rbf - Bbasis&#39;</span>,</span>
<span id="cb246-13"><a href="simulační-studie-1.html#cb246-13" tabindex="-1"></a>             <span class="st">&#39;SVM linear - projection&#39;</span>, <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb246-14"><a href="simulační-studie-1.html#cb246-14" tabindex="-1"></a>             <span class="st">&#39;SVM rbf - projection&#39;</span>, <span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>, <span class="st">&#39;SVM linear - RKHS - poly&#39;</span>, <span class="st">&#39;SVM poly - RKHS - poly&#39;</span>, <span class="st">&#39;SVM rbf - RKHS - poly&#39;</span>, <span class="st">&#39;SVM linear - RKHS - linear&#39;</span>, <span class="st">&#39;SVM poly - RKHS - linear&#39;</span>, <span class="st">&#39;SVM rbf - RKHS - linear&#39;</span>)</span>
<span id="cb246-15"><a href="simulační-studie-1.html#cb246-15" tabindex="-1"></a></span>
<span id="cb246-16"><a href="simulační-studie-1.html#cb246-16" tabindex="-1"></a>SIMULACE <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">train =</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(methods), </span>
<span id="cb246-17"><a href="simulační-studie-1.html#cb246-17" tabindex="-1"></a>                                             <span class="at">nrow =</span> n.sim,</span>
<span id="cb246-18"><a href="simulační-studie-1.html#cb246-18" tabindex="-1"></a>                                             <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n.sim, methods))), </span>
<span id="cb246-19"><a href="simulační-studie-1.html#cb246-19" tabindex="-1"></a>                 <span class="at">test =</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(methods), </span>
<span id="cb246-20"><a href="simulační-studie-1.html#cb246-20" tabindex="-1"></a>                                             <span class="at">nrow =</span> n.sim,</span>
<span id="cb246-21"><a href="simulační-studie-1.html#cb246-21" tabindex="-1"></a>                                             <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n.sim, methods))))</span>
<span id="cb246-22"><a href="simulační-studie-1.html#cb246-22" tabindex="-1"></a></span>
<span id="cb246-23"><a href="simulační-studie-1.html#cb246-23" tabindex="-1"></a><span class="co"># objekt na ulozeni optimalnich hodnot hyperparametru, ktere se urcuji pomoci CV</span></span>
<span id="cb246-24"><a href="simulační-studie-1.html#cb246-24" tabindex="-1"></a>CV_RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">KNN_K =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n.sim),</span>
<span id="cb246-25"><a href="simulační-studie-1.html#cb246-25" tabindex="-1"></a>                         <span class="at">SVM_d_Linear =</span> <span class="cn">NA</span>,</span>
<span id="cb246-26"><a href="simulační-studie-1.html#cb246-26" tabindex="-1"></a>                         <span class="at">SVM_d_Poly =</span> <span class="cn">NA</span>,</span>
<span id="cb246-27"><a href="simulační-studie-1.html#cb246-27" tabindex="-1"></a>                         <span class="at">SVM_d_Radial =</span> <span class="cn">NA</span>)</span></code></pre></div>
</details>
<p>Nyní zopakujeme celou předchozí část <code>n.sim</code>-krát a hodnoty chybovostí si budeme ukládat to listu <code>SIMULACE</code>.
Do datové tabulky <code>CV_RESULTS</code> si potom budeme ukládat hodnoty optimálních hyperparametrů – pro metodu <span class="math inline">\(K\)</span> nejbližších sousedů a pro SVM hodnotu dimenze <span class="math inline">\(d\)</span> v případě projekce na B-splinovou bázi.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="simulační-studie-1.html#cb247-1" tabindex="-1"></a><span class="do">## SIMULACE</span></span>
<span id="cb247-2"><a href="simulační-studie-1.html#cb247-2" tabindex="-1"></a></span>
<span id="cb247-3"><a href="simulační-studie-1.html#cb247-3" tabindex="-1"></a><span class="cf">for</span>(sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.sim) {</span>
<span id="cb247-4"><a href="simulační-studie-1.html#cb247-4" tabindex="-1"></a>  <span class="co"># pocet vygenerovanych pozorovani pro kazdou tridu</span></span>
<span id="cb247-5"><a href="simulační-studie-1.html#cb247-5" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb247-6"><a href="simulační-studie-1.html#cb247-6" tabindex="-1"></a>  <span class="co"># vektor casu ekvidistantni na intervalu [0, 1]</span></span>
<span id="cb247-7"><a href="simulační-studie-1.html#cb247-7" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">51</span>)</span>
<span id="cb247-8"><a href="simulační-studie-1.html#cb247-8" tabindex="-1"></a>  </span>
<span id="cb247-9"><a href="simulační-studie-1.html#cb247-9" tabindex="-1"></a>  <span class="co"># pro Y = 0</span></span>
<span id="cb247-10"><a href="simulační-studie-1.html#cb247-10" tabindex="-1"></a>  X0 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_0, n, <span class="dv">1</span>)</span>
<span id="cb247-11"><a href="simulační-studie-1.html#cb247-11" tabindex="-1"></a>  <span class="co"># pro Y = 1</span></span>
<span id="cb247-12"><a href="simulační-studie-1.html#cb247-12" tabindex="-1"></a>  X1 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_1, n, <span class="dv">1</span>)</span>
<span id="cb247-13"><a href="simulační-studie-1.html#cb247-13" tabindex="-1"></a>  </span>
<span id="cb247-14"><a href="simulační-studie-1.html#cb247-14" tabindex="-1"></a>  rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb247-15"><a href="simulační-studie-1.html#cb247-15" tabindex="-1"></a>  breaks <span class="ot">&lt;-</span> t</span>
<span id="cb247-16"><a href="simulační-studie-1.html#cb247-16" tabindex="-1"></a>  norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb247-17"><a href="simulační-studie-1.html#cb247-17" tabindex="-1"></a>  </span>
<span id="cb247-18"><a href="simulační-studie-1.html#cb247-18" tabindex="-1"></a>  bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb247-19"><a href="simulační-studie-1.html#cb247-19" tabindex="-1"></a>                                 <span class="at">norder =</span> norder, </span>
<span id="cb247-20"><a href="simulační-studie-1.html#cb247-20" tabindex="-1"></a>                                 <span class="at">breaks =</span> breaks)</span>
<span id="cb247-21"><a href="simulační-studie-1.html#cb247-21" tabindex="-1"></a>  </span>
<span id="cb247-22"><a href="simulační-studie-1.html#cb247-22" tabindex="-1"></a>  curv.Lfd <span class="ot">&lt;-</span> <span class="fu">int2Lfd</span>(<span class="dv">2</span>) </span>
<span id="cb247-23"><a href="simulační-studie-1.html#cb247-23" tabindex="-1"></a>  <span class="co"># spojeni pozorovani do jedne matice</span></span>
<span id="cb247-24"><a href="simulační-studie-1.html#cb247-24" tabindex="-1"></a>  XX <span class="ot">&lt;-</span> <span class="fu">cbind</span>(X0, X1)</span>
<span id="cb247-25"><a href="simulační-studie-1.html#cb247-25" tabindex="-1"></a>  </span>
<span id="cb247-26"><a href="simulační-studie-1.html#cb247-26" tabindex="-1"></a>  lambda.vect <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">length.out =</span> <span class="dv">25</span>) <span class="co"># vektor lambd</span></span>
<span id="cb247-27"><a href="simulační-studie-1.html#cb247-27" tabindex="-1"></a>  gcv <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="at">length =</span> <span class="fu">length</span>(lambda.vect)) <span class="co"># prazdny vektor pro ulozebi GCV</span></span>
<span id="cb247-28"><a href="simulační-studie-1.html#cb247-28" tabindex="-1"></a>  </span>
<span id="cb247-29"><a href="simulační-studie-1.html#cb247-29" tabindex="-1"></a>  <span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambda.vect)) {</span>
<span id="cb247-30"><a href="simulační-studie-1.html#cb247-30" tabindex="-1"></a>    curv.Fdpar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.vect[index])</span>
<span id="cb247-31"><a href="simulační-studie-1.html#cb247-31" tabindex="-1"></a>    BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.Fdpar) <span class="co"># vyhlazeni</span></span>
<span id="cb247-32"><a href="simulační-studie-1.html#cb247-32" tabindex="-1"></a>    gcv[index] <span class="ot">&lt;-</span> <span class="fu">mean</span>(BSmooth<span class="sc">$</span>gcv) <span class="co"># prumer pres vsechny pozorovane krivky</span></span>
<span id="cb247-33"><a href="simulační-studie-1.html#cb247-33" tabindex="-1"></a>  }</span>
<span id="cb247-34"><a href="simulační-studie-1.html#cb247-34" tabindex="-1"></a>  </span>
<span id="cb247-35"><a href="simulační-studie-1.html#cb247-35" tabindex="-1"></a>  GCV <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb247-36"><a href="simulační-studie-1.html#cb247-36" tabindex="-1"></a>    <span class="at">lambda =</span> <span class="fu">round</span>(<span class="fu">log10</span>(lambda.vect), <span class="dv">3</span>),</span>
<span id="cb247-37"><a href="simulační-studie-1.html#cb247-37" tabindex="-1"></a>    <span class="at">GCV =</span> gcv</span>
<span id="cb247-38"><a href="simulační-studie-1.html#cb247-38" tabindex="-1"></a>  )</span>
<span id="cb247-39"><a href="simulační-studie-1.html#cb247-39" tabindex="-1"></a>  </span>
<span id="cb247-40"><a href="simulační-studie-1.html#cb247-40" tabindex="-1"></a>  <span class="co"># najdeme hodnotu minima</span></span>
<span id="cb247-41"><a href="simulační-studie-1.html#cb247-41" tabindex="-1"></a>  lambda.opt <span class="ot">&lt;-</span> lambda.vect[<span class="fu">which.min</span>(gcv)]</span>
<span id="cb247-42"><a href="simulační-studie-1.html#cb247-42" tabindex="-1"></a>  </span>
<span id="cb247-43"><a href="simulační-studie-1.html#cb247-43" tabindex="-1"></a>  curv.fdPar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.opt)</span>
<span id="cb247-44"><a href="simulační-studie-1.html#cb247-44" tabindex="-1"></a>  BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.fdPar)</span>
<span id="cb247-45"><a href="simulační-studie-1.html#cb247-45" tabindex="-1"></a>  XXfd <span class="ot">&lt;-</span> BSmooth<span class="sc">$</span>fd</span>
<span id="cb247-46"><a href="simulační-studie-1.html#cb247-46" tabindex="-1"></a>  </span>
<span id="cb247-47"><a href="simulační-studie-1.html#cb247-47" tabindex="-1"></a>  fdobjSmootheval <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> XXfd, <span class="at">evalarg =</span> t)</span>
<span id="cb247-48"><a href="simulační-studie-1.html#cb247-48" tabindex="-1"></a>  </span>
<span id="cb247-49"><a href="simulační-studie-1.html#cb247-49" tabindex="-1"></a>  <span class="co"># rozdeleni na testovaci a trenovaci cast</span></span>
<span id="cb247-50"><a href="simulační-studie-1.html#cb247-50" tabindex="-1"></a>  split <span class="ot">&lt;-</span> <span class="fu">sample.split</span>(XXfd<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb247-51"><a href="simulační-studie-1.html#cb247-51" tabindex="-1"></a>  </span>
<span id="cb247-52"><a href="simulační-studie-1.html#cb247-52" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n)</span>
<span id="cb247-53"><a href="simulační-studie-1.html#cb247-53" tabindex="-1"></a>  </span>
<span id="cb247-54"><a href="simulační-studie-1.html#cb247-54" tabindex="-1"></a>  X.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb247-55"><a href="simulační-studie-1.html#cb247-55" tabindex="-1"></a>  X.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb247-56"><a href="simulační-studie-1.html#cb247-56" tabindex="-1"></a>  </span>
<span id="cb247-57"><a href="simulační-studie-1.html#cb247-57" tabindex="-1"></a>  Y.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb247-58"><a href="simulační-studie-1.html#cb247-58" tabindex="-1"></a>  Y.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb247-59"><a href="simulační-studie-1.html#cb247-59" tabindex="-1"></a>  </span>
<span id="cb247-60"><a href="simulační-studie-1.html#cb247-60" tabindex="-1"></a>  x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb247-61"><a href="simulační-studie-1.html#cb247-61" tabindex="-1"></a>  y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.train))</span>
<span id="cb247-62"><a href="simulační-studie-1.html#cb247-62" tabindex="-1"></a>  </span>
<span id="cb247-63"><a href="simulační-studie-1.html#cb247-63" tabindex="-1"></a>  <span class="do">## 1) K nejbližších sousedů</span></span>
<span id="cb247-64"><a href="simulační-studie-1.html#cb247-64" tabindex="-1"></a>  </span>
<span id="cb247-65"><a href="simulační-studie-1.html#cb247-65" tabindex="-1"></a>  k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb247-66"><a href="simulační-studie-1.html#cb247-66" tabindex="-1"></a>  neighbours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">ceiling</span>(<span class="fu">sqrt</span>(<span class="fu">length</span>(y.train))))) <span class="co"># pocet sousedu </span></span>
<span id="cb247-67"><a href="simulační-studie-1.html#cb247-67" tabindex="-1"></a>  </span>
<span id="cb247-68"><a href="simulační-studie-1.html#cb247-68" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb247-69"><a href="simulační-studie-1.html#cb247-69" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb247-70"><a href="simulační-studie-1.html#cb247-70" tabindex="-1"></a>  </span>
<span id="cb247-71"><a href="simulační-studie-1.html#cb247-71" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(neighbours), <span class="at">ncol =</span> k_cv)</span>
<span id="cb247-72"><a href="simulační-studie-1.html#cb247-72" tabindex="-1"></a>  </span>
<span id="cb247-73"><a href="simulační-studie-1.html#cb247-73" tabindex="-1"></a>  <span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb247-74"><a href="simulační-studie-1.html#cb247-74" tabindex="-1"></a>    <span class="co"># definujeme danou indexovou mnozinu</span></span>
<span id="cb247-75"><a href="simulační-studie-1.html#cb247-75" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb247-76"><a href="simulační-studie-1.html#cb247-76" tabindex="-1"></a>      </span>
<span id="cb247-77"><a href="simulační-studie-1.html#cb247-77" tabindex="-1"></a>    x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb247-78"><a href="simulační-studie-1.html#cb247-78" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb247-79"><a href="simulační-studie-1.html#cb247-79" tabindex="-1"></a>    y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb247-80"><a href="simulační-studie-1.html#cb247-80" tabindex="-1"></a>      <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb247-81"><a href="simulační-studie-1.html#cb247-81" tabindex="-1"></a>    </span>
<span id="cb247-82"><a href="simulační-studie-1.html#cb247-82" tabindex="-1"></a>    x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb247-83"><a href="simulační-studie-1.html#cb247-83" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb247-84"><a href="simulační-studie-1.html#cb247-84" tabindex="-1"></a>    y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb247-85"><a href="simulační-studie-1.html#cb247-85" tabindex="-1"></a>      <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb247-86"><a href="simulační-studie-1.html#cb247-86" tabindex="-1"></a>    </span>
<span id="cb247-87"><a href="simulační-studie-1.html#cb247-87" tabindex="-1"></a>    <span class="co"># projdeme kazdou cast ... k-krat zopakujeme</span></span>
<span id="cb247-88"><a href="simulační-studie-1.html#cb247-88" tabindex="-1"></a>    <span class="cf">for</span>(neighbour <span class="cf">in</span> neighbours) {</span>
<span id="cb247-89"><a href="simulační-studie-1.html#cb247-89" tabindex="-1"></a>      <span class="co"># model pro konkretni volbu K</span></span>
<span id="cb247-90"><a href="simulační-studie-1.html#cb247-90" tabindex="-1"></a>      neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train.cv, </span>
<span id="cb247-91"><a href="simulační-studie-1.html#cb247-91" tabindex="-1"></a>                                <span class="at">fdataobj =</span> x.train.cv, </span>
<span id="cb247-92"><a href="simulační-studie-1.html#cb247-92" tabindex="-1"></a>                                <span class="at">knn =</span> neighbour) </span>
<span id="cb247-93"><a href="simulační-studie-1.html#cb247-93" tabindex="-1"></a>      <span class="co"># predikce na validacni casti</span></span>
<span id="cb247-94"><a href="simulační-studie-1.html#cb247-94" tabindex="-1"></a>      model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb247-95"><a href="simulační-studie-1.html#cb247-95" tabindex="-1"></a>                                      <span class="at">new.fdataobj =</span> x.test.cv)</span>
<span id="cb247-96"><a href="simulační-studie-1.html#cb247-96" tabindex="-1"></a>      <span class="co"># presnost na validacni casti</span></span>
<span id="cb247-97"><a href="simulační-studie-1.html#cb247-97" tabindex="-1"></a>      presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, model.neighb.predict) <span class="sc">|&gt;</span> </span>
<span id="cb247-98"><a href="simulační-studie-1.html#cb247-98" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-99"><a href="simulační-studie-1.html#cb247-99" tabindex="-1"></a>      </span>
<span id="cb247-100"><a href="simulační-studie-1.html#cb247-100" tabindex="-1"></a>      <span class="co"># presnost vlozime na pozici pro dane K a fold</span></span>
<span id="cb247-101"><a href="simulační-studie-1.html#cb247-101" tabindex="-1"></a>      CV.results[neighbour, index] <span class="ot">&lt;-</span> presnost</span>
<span id="cb247-102"><a href="simulační-studie-1.html#cb247-102" tabindex="-1"></a>    }</span>
<span id="cb247-103"><a href="simulační-studie-1.html#cb247-103" tabindex="-1"></a>  }</span>
<span id="cb247-104"><a href="simulační-studie-1.html#cb247-104" tabindex="-1"></a>  </span>
<span id="cb247-105"><a href="simulační-studie-1.html#cb247-105" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva K pres folds</span></span>
<span id="cb247-106"><a href="simulační-studie-1.html#cb247-106" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb247-107"><a href="simulační-studie-1.html#cb247-107" tabindex="-1"></a>  K.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(CV.results)</span>
<span id="cb247-108"><a href="simulační-studie-1.html#cb247-108" tabindex="-1"></a>  CV_RESULTS<span class="sc">$</span>KNN_K[sim] <span class="ot">&lt;-</span> K.opt</span>
<span id="cb247-109"><a href="simulační-studie-1.html#cb247-109" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb247-110"><a href="simulační-studie-1.html#cb247-110" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">K =</span> neighbours, <span class="at">CV =</span> CV.results)</span>
<span id="cb247-111"><a href="simulační-studie-1.html#cb247-111" tabindex="-1"></a>  </span>
<span id="cb247-112"><a href="simulační-studie-1.html#cb247-112" tabindex="-1"></a>  neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, <span class="at">fdataobj =</span> x.train, <span class="at">knn =</span> K.opt)</span>
<span id="cb247-113"><a href="simulační-studie-1.html#cb247-113" tabindex="-1"></a>  </span>
<span id="cb247-114"><a href="simulační-studie-1.html#cb247-114" tabindex="-1"></a>  <span class="co"># predikce</span></span>
<span id="cb247-115"><a href="simulační-studie-1.html#cb247-115" tabindex="-1"></a>  model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb247-116"><a href="simulační-studie-1.html#cb247-116" tabindex="-1"></a>                                  <span class="at">new.fdataobj =</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb247-117"><a href="simulační-studie-1.html#cb247-117" tabindex="-1"></a>  </span>
<span id="cb247-118"><a href="simulační-studie-1.html#cb247-118" tabindex="-1"></a>  presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.test)), model.neighb.predict) <span class="sc">|&gt;</span></span>
<span id="cb247-119"><a href="simulační-studie-1.html#cb247-119" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span></span>
<span id="cb247-120"><a href="simulační-studie-1.html#cb247-120" tabindex="-1"></a>    <span class="fu">diag</span>() <span class="sc">|&gt;</span></span>
<span id="cb247-121"><a href="simulační-studie-1.html#cb247-121" tabindex="-1"></a>    <span class="fu">sum</span>()</span>
<span id="cb247-122"><a href="simulační-studie-1.html#cb247-122" tabindex="-1"></a>  </span>
<span id="cb247-123"><a href="simulační-studie-1.html#cb247-123" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;KNN&#39;</span>, </span>
<span id="cb247-124"><a href="simulační-studie-1.html#cb247-124" tabindex="-1"></a>                        <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> neighb.model<span class="sc">$</span>max.prob,</span>
<span id="cb247-125"><a href="simulační-studie-1.html#cb247-125" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost)</span>
<span id="cb247-126"><a href="simulační-studie-1.html#cb247-126" tabindex="-1"></a>  </span>
<span id="cb247-127"><a href="simulační-studie-1.html#cb247-127" tabindex="-1"></a>  <span class="do">## 2) Lineární diskriminační analýza</span></span>
<span id="cb247-128"><a href="simulační-studie-1.html#cb247-128" tabindex="-1"></a>  </span>
<span id="cb247-129"><a href="simulační-studie-1.html#cb247-129" tabindex="-1"></a>  <span class="co"># analyza hlavnich komponent</span></span>
<span id="cb247-130"><a href="simulační-studie-1.html#cb247-130" tabindex="-1"></a>  data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> <span class="dv">10</span>) <span class="co"># nharm - maximalni pocet HK</span></span>
<span id="cb247-131"><a href="simulační-studie-1.html#cb247-131" tabindex="-1"></a>  nharm <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">cumsum</span>(data.PCA<span class="sc">$</span>varprop) <span class="sc">&gt;=</span> <span class="fl">0.9</span>)[<span class="dv">1</span>] <span class="co"># urceni p</span></span>
<span id="cb247-132"><a href="simulační-studie-1.html#cb247-132" tabindex="-1"></a>  </span>
<span id="cb247-133"><a href="simulační-studie-1.html#cb247-133" tabindex="-1"></a>  data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> nharm) </span>
<span id="cb247-134"><a href="simulační-studie-1.html#cb247-134" tabindex="-1"></a>  data.PCA.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA<span class="sc">$</span>scores) <span class="co"># skore prvnich p HK</span></span>
<span id="cb247-135"><a href="simulační-studie-1.html#cb247-135" tabindex="-1"></a>  data.PCA.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train) <span class="co"># prislusnost do trid</span></span>
<span id="cb247-136"><a href="simulační-studie-1.html#cb247-136" tabindex="-1"></a>  </span>
<span id="cb247-137"><a href="simulační-studie-1.html#cb247-137" tabindex="-1"></a>  <span class="co"># vypocet skoru testovacich funkci</span></span>
<span id="cb247-138"><a href="simulační-studie-1.html#cb247-138" tabindex="-1"></a>  scores <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> nharm, <span class="at">nrow =</span> <span class="fu">length</span>(Y.test)) <span class="co"># prazdna matice </span></span>
<span id="cb247-139"><a href="simulační-studie-1.html#cb247-139" tabindex="-1"></a>  </span>
<span id="cb247-140"><a href="simulační-studie-1.html#cb247-140" tabindex="-1"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(scores)[<span class="dv">1</span>]) {</span>
<span id="cb247-141"><a href="simulační-studie-1.html#cb247-141" tabindex="-1"></a>    xfd <span class="ot">=</span> X.test[k] <span class="sc">-</span> data.PCA<span class="sc">$</span>meanfd[<span class="dv">1</span>] <span class="co"># k-te pozorovani - prumerna funkce</span></span>
<span id="cb247-142"><a href="simulační-studie-1.html#cb247-142" tabindex="-1"></a>    scores[k, ] <span class="ot">=</span> <span class="fu">inprod</span>(xfd, data.PCA<span class="sc">$</span>harmonics) </span>
<span id="cb247-143"><a href="simulační-studie-1.html#cb247-143" tabindex="-1"></a>    <span class="co"># skalarni soucin rezidua a vlastnich funkci rho (funkcionalni hlavni komponenty)</span></span>
<span id="cb247-144"><a href="simulační-studie-1.html#cb247-144" tabindex="-1"></a>  }</span>
<span id="cb247-145"><a href="simulační-studie-1.html#cb247-145" tabindex="-1"></a>  </span>
<span id="cb247-146"><a href="simulační-studie-1.html#cb247-146" tabindex="-1"></a>  data.PCA.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(scores)</span>
<span id="cb247-147"><a href="simulační-studie-1.html#cb247-147" tabindex="-1"></a>  data.PCA.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb247-148"><a href="simulační-studie-1.html#cb247-148" tabindex="-1"></a>  <span class="fu">colnames</span>(data.PCA.test) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data.PCA.train) </span>
<span id="cb247-149"><a href="simulační-studie-1.html#cb247-149" tabindex="-1"></a>  </span>
<span id="cb247-150"><a href="simulační-studie-1.html#cb247-150" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb247-151"><a href="simulační-studie-1.html#cb247-151" tabindex="-1"></a>  clf.LDA <span class="ot">&lt;-</span> <span class="fu">lda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb247-152"><a href="simulační-studie-1.html#cb247-152" tabindex="-1"></a>  </span>
<span id="cb247-153"><a href="simulační-studie-1.html#cb247-153" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb247-154"><a href="simulační-studie-1.html#cb247-154" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb247-155"><a href="simulační-studie-1.html#cb247-155" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb247-156"><a href="simulační-studie-1.html#cb247-156" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-157"><a href="simulační-studie-1.html#cb247-157" tabindex="-1"></a>    </span>
<span id="cb247-158"><a href="simulační-studie-1.html#cb247-158" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb247-159"><a href="simulační-studie-1.html#cb247-159" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb247-160"><a href="simulační-studie-1.html#cb247-160" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb247-161"><a href="simulační-studie-1.html#cb247-161" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-162"><a href="simulační-studie-1.html#cb247-162" tabindex="-1"></a>  </span>
<span id="cb247-163"><a href="simulační-studie-1.html#cb247-163" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LDA&#39;</span>, </span>
<span id="cb247-164"><a href="simulační-studie-1.html#cb247-164" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb247-165"><a href="simulační-studie-1.html#cb247-165" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb247-166"><a href="simulační-studie-1.html#cb247-166" tabindex="-1"></a>  </span>
<span id="cb247-167"><a href="simulační-studie-1.html#cb247-167" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb247-168"><a href="simulační-studie-1.html#cb247-168" tabindex="-1"></a>  </span>
<span id="cb247-169"><a href="simulační-studie-1.html#cb247-169" tabindex="-1"></a>  <span class="do">## 3) Kvadratická diskriminační analýza</span></span>
<span id="cb247-170"><a href="simulační-studie-1.html#cb247-170" tabindex="-1"></a>  </span>
<span id="cb247-171"><a href="simulační-studie-1.html#cb247-171" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb247-172"><a href="simulační-studie-1.html#cb247-172" tabindex="-1"></a>  clf.QDA <span class="ot">&lt;-</span> <span class="fu">qda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb247-173"><a href="simulační-studie-1.html#cb247-173" tabindex="-1"></a>  </span>
<span id="cb247-174"><a href="simulační-studie-1.html#cb247-174" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb247-175"><a href="simulační-studie-1.html#cb247-175" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb247-176"><a href="simulační-studie-1.html#cb247-176" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb247-177"><a href="simulační-studie-1.html#cb247-177" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-178"><a href="simulační-studie-1.html#cb247-178" tabindex="-1"></a>    </span>
<span id="cb247-179"><a href="simulační-studie-1.html#cb247-179" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb247-180"><a href="simulační-studie-1.html#cb247-180" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb247-181"><a href="simulační-studie-1.html#cb247-181" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb247-182"><a href="simulační-studie-1.html#cb247-182" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-183"><a href="simulační-studie-1.html#cb247-183" tabindex="-1"></a>  </span>
<span id="cb247-184"><a href="simulační-studie-1.html#cb247-184" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;QDA&#39;</span>, </span>
<span id="cb247-185"><a href="simulační-studie-1.html#cb247-185" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb247-186"><a href="simulační-studie-1.html#cb247-186" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb247-187"><a href="simulační-studie-1.html#cb247-187" tabindex="-1"></a>  </span>
<span id="cb247-188"><a href="simulační-studie-1.html#cb247-188" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb247-189"><a href="simulační-studie-1.html#cb247-189" tabindex="-1"></a>  </span>
<span id="cb247-190"><a href="simulační-studie-1.html#cb247-190" tabindex="-1"></a>  <span class="do">## 4) Logistická regrese</span></span>
<span id="cb247-191"><a href="simulační-studie-1.html#cb247-191" tabindex="-1"></a>  <span class="do">### 4.1) Funkcionální logistická regrese</span></span>
<span id="cb247-192"><a href="simulační-studie-1.html#cb247-192" tabindex="-1"></a>  </span>
<span id="cb247-193"><a href="simulační-studie-1.html#cb247-193" tabindex="-1"></a>  <span class="co"># vytvorime vhodne objekty</span></span>
<span id="cb247-194"><a href="simulační-studie-1.html#cb247-194" tabindex="-1"></a>  x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb247-195"><a href="simulační-studie-1.html#cb247-195" tabindex="-1"></a>  y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Y.train)</span>
<span id="cb247-196"><a href="simulační-studie-1.html#cb247-196" tabindex="-1"></a>  </span>
<span id="cb247-197"><a href="simulační-studie-1.html#cb247-197" tabindex="-1"></a>  <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb247-198"><a href="simulační-studie-1.html#cb247-198" tabindex="-1"></a>  tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb247-199"><a href="simulační-studie-1.html#cb247-199" tabindex="-1"></a>  </span>
<span id="cb247-200"><a href="simulační-studie-1.html#cb247-200" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb247-201"><a href="simulační-studie-1.html#cb247-201" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb247-202"><a href="simulační-studie-1.html#cb247-202" tabindex="-1"></a>  <span class="co"># B-spline baze </span></span>
<span id="cb247-203"><a href="simulační-studie-1.html#cb247-203" tabindex="-1"></a>  basis1 <span class="ot">&lt;-</span> X.train<span class="sc">$</span>basis</span>
<span id="cb247-204"><a href="simulační-studie-1.html#cb247-204" tabindex="-1"></a>  </span>
<span id="cb247-205"><a href="simulační-studie-1.html#cb247-205" tabindex="-1"></a>  <span class="do">### 10-fold cross-validation</span></span>
<span id="cb247-206"><a href="simulační-studie-1.html#cb247-206" tabindex="-1"></a>  n.basis.max <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb247-207"><a href="simulační-studie-1.html#cb247-207" tabindex="-1"></a>  n.basis <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span>n.basis.max</span>
<span id="cb247-208"><a href="simulační-studie-1.html#cb247-208" tabindex="-1"></a>  k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb247-209"><a href="simulační-studie-1.html#cb247-209" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb247-210"><a href="simulační-studie-1.html#cb247-210" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb247-211"><a href="simulační-studie-1.html#cb247-211" tabindex="-1"></a>  <span class="do">## prvky, ktere se behem cyklu nemeni</span></span>
<span id="cb247-212"><a href="simulační-studie-1.html#cb247-212" tabindex="-1"></a>  <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb247-213"><a href="simulační-studie-1.html#cb247-213" tabindex="-1"></a>  tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb247-214"><a href="simulační-studie-1.html#cb247-214" tabindex="-1"></a>  rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(tt)</span>
<span id="cb247-215"><a href="simulační-studie-1.html#cb247-215" tabindex="-1"></a>  <span class="co"># B-spline baze </span></span>
<span id="cb247-216"><a href="simulační-studie-1.html#cb247-216" tabindex="-1"></a>  basis1 <span class="ot">&lt;-</span> X.train<span class="sc">$</span>basis</span>
<span id="cb247-217"><a href="simulační-studie-1.html#cb247-217" tabindex="-1"></a>  <span class="co"># vztah</span></span>
<span id="cb247-218"><a href="simulační-studie-1.html#cb247-218" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb247-219"><a href="simulační-studie-1.html#cb247-219" tabindex="-1"></a>  <span class="co"># baze pro x</span></span>
<span id="cb247-220"><a href="simulační-studie-1.html#cb247-220" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1)</span>
<span id="cb247-221"><a href="simulační-studie-1.html#cb247-221" tabindex="-1"></a>  </span>
<span id="cb247-222"><a href="simulační-studie-1.html#cb247-222" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(n.basis), <span class="at">ncol =</span> k_cv, </span>
<span id="cb247-223"><a href="simulační-studie-1.html#cb247-223" tabindex="-1"></a>                       <span class="at">dimnames =</span> <span class="fu">list</span>(n.basis, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb247-224"><a href="simulační-studie-1.html#cb247-224" tabindex="-1"></a>  </span>
<span id="cb247-225"><a href="simulační-studie-1.html#cb247-225" tabindex="-1"></a>  <span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb247-226"><a href="simulační-studie-1.html#cb247-226" tabindex="-1"></a>    <span class="co"># definujeme danou indexovou mnozinu</span></span>
<span id="cb247-227"><a href="simulační-studie-1.html#cb247-227" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb247-228"><a href="simulační-studie-1.html#cb247-228" tabindex="-1"></a>      </span>
<span id="cb247-229"><a href="simulační-studie-1.html#cb247-229" tabindex="-1"></a>    x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb247-230"><a href="simulační-studie-1.html#cb247-230" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb247-231"><a href="simulační-studie-1.html#cb247-231" tabindex="-1"></a>    y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb247-232"><a href="simulační-studie-1.html#cb247-232" tabindex="-1"></a>      <span class="fu">as.numeric</span>()</span>
<span id="cb247-233"><a href="simulační-studie-1.html#cb247-233" tabindex="-1"></a>    </span>
<span id="cb247-234"><a href="simulační-studie-1.html#cb247-234" tabindex="-1"></a>    x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb247-235"><a href="simulační-studie-1.html#cb247-235" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb247-236"><a href="simulační-studie-1.html#cb247-236" tabindex="-1"></a>    y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb247-237"><a href="simulační-studie-1.html#cb247-237" tabindex="-1"></a>      <span class="fu">as.numeric</span>()</span>
<span id="cb247-238"><a href="simulační-studie-1.html#cb247-238" tabindex="-1"></a>    </span>
<span id="cb247-239"><a href="simulační-studie-1.html#cb247-239" tabindex="-1"></a>    dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train.cv) </span>
<span id="cb247-240"><a href="simulační-studie-1.html#cb247-240" tabindex="-1"></a>    <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb247-241"><a href="simulační-studie-1.html#cb247-241" tabindex="-1"></a>    </span>
<span id="cb247-242"><a href="simulační-studie-1.html#cb247-242" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> n.basis) {</span>
<span id="cb247-243"><a href="simulační-studie-1.html#cb247-243" tabindex="-1"></a>      <span class="co"># baze pro bety</span></span>
<span id="cb247-244"><a href="simulační-studie-1.html#cb247-244" tabindex="-1"></a>      basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, <span class="at">nbasis =</span> i)</span>
<span id="cb247-245"><a href="simulační-studie-1.html#cb247-245" tabindex="-1"></a>      </span>
<span id="cb247-246"><a href="simulační-studie-1.html#cb247-246" tabindex="-1"></a>      basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb247-247"><a href="simulační-studie-1.html#cb247-247" tabindex="-1"></a>      <span class="co"># vstupni data do modelu</span></span>
<span id="cb247-248"><a href="simulační-studie-1.html#cb247-248" tabindex="-1"></a>      ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train.cv)</span>
<span id="cb247-249"><a href="simulační-studie-1.html#cb247-249" tabindex="-1"></a>      <span class="co"># binomicky model ... model logisticke regrese</span></span>
<span id="cb247-250"><a href="simulační-studie-1.html#cb247-250" tabindex="-1"></a>      model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb247-251"><a href="simulační-studie-1.html#cb247-251" tabindex="-1"></a>                              <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb247-252"><a href="simulační-studie-1.html#cb247-252" tabindex="-1"></a>      </span>
<span id="cb247-253"><a href="simulační-studie-1.html#cb247-253" tabindex="-1"></a>      <span class="co"># presnost na validacni casti </span></span>
<span id="cb247-254"><a href="simulační-studie-1.html#cb247-254" tabindex="-1"></a>      newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(y.test.cv), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb247-255"><a href="simulační-studie-1.html#cb247-255" tabindex="-1"></a>      predictions.valid <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb247-256"><a href="simulační-studie-1.html#cb247-256" tabindex="-1"></a>      predictions.valid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.valid <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb247-257"><a href="simulační-studie-1.html#cb247-257" tabindex="-1"></a>      presnost.valid <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, predictions.valid<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb247-258"><a href="simulační-studie-1.html#cb247-258" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-259"><a href="simulační-studie-1.html#cb247-259" tabindex="-1"></a>      </span>
<span id="cb247-260"><a href="simulační-studie-1.html#cb247-260" tabindex="-1"></a>      <span class="co"># vlozime do matice</span></span>
<span id="cb247-261"><a href="simulační-studie-1.html#cb247-261" tabindex="-1"></a>      CV.results[<span class="fu">as.character</span>(i), <span class="fu">as.character</span>(index)] <span class="ot">&lt;-</span> presnost.valid</span>
<span id="cb247-262"><a href="simulační-studie-1.html#cb247-262" tabindex="-1"></a>    } </span>
<span id="cb247-263"><a href="simulační-studie-1.html#cb247-263" tabindex="-1"></a>  }</span>
<span id="cb247-264"><a href="simulační-studie-1.html#cb247-264" tabindex="-1"></a>  </span>
<span id="cb247-265"><a href="simulační-studie-1.html#cb247-265" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva n pres folds</span></span>
<span id="cb247-266"><a href="simulační-studie-1.html#cb247-266" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb247-267"><a href="simulační-studie-1.html#cb247-267" tabindex="-1"></a>  n.basis.opt <span class="ot">&lt;-</span> n.basis[<span class="fu">which.max</span>(CV.results)]</span>
<span id="cb247-268"><a href="simulační-studie-1.html#cb247-268" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb247-269"><a href="simulační-studie-1.html#cb247-269" tabindex="-1"></a>  </span>
<span id="cb247-270"><a href="simulační-studie-1.html#cb247-270" tabindex="-1"></a>  <span class="co"># optimalni model</span></span>
<span id="cb247-271"><a href="simulační-studie-1.html#cb247-271" tabindex="-1"></a>  basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> n.basis.opt)</span>
<span id="cb247-272"><a href="simulační-studie-1.html#cb247-272" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb247-273"><a href="simulační-studie-1.html#cb247-273" tabindex="-1"></a>  <span class="co"># baze pro x a bety</span></span>
<span id="cb247-274"><a href="simulační-studie-1.html#cb247-274" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb247-275"><a href="simulační-studie-1.html#cb247-275" tabindex="-1"></a>  basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb247-276"><a href="simulační-studie-1.html#cb247-276" tabindex="-1"></a>  <span class="co"># vstupni data do modelu</span></span>
<span id="cb247-277"><a href="simulační-studie-1.html#cb247-277" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb247-278"><a href="simulační-studie-1.html#cb247-278" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb247-279"><a href="simulační-studie-1.html#cb247-279" tabindex="-1"></a>  ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb247-280"><a href="simulační-studie-1.html#cb247-280" tabindex="-1"></a>  <span class="co"># binomicky model ... model logisticke regrese</span></span>
<span id="cb247-281"><a href="simulační-studie-1.html#cb247-281" tabindex="-1"></a>  model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb247-282"><a href="simulační-studie-1.html#cb247-282" tabindex="-1"></a>                          <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb247-283"><a href="simulační-studie-1.html#cb247-283" tabindex="-1"></a>  </span>
<span id="cb247-284"><a href="simulační-studie-1.html#cb247-284" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb247-285"><a href="simulační-studie-1.html#cb247-285" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> ldata)</span>
<span id="cb247-286"><a href="simulační-studie-1.html#cb247-286" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb247-287"><a href="simulační-studie-1.html#cb247-287" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb247-288"><a href="simulační-studie-1.html#cb247-288" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-289"><a href="simulační-studie-1.html#cb247-289" tabindex="-1"></a>    </span>
<span id="cb247-290"><a href="simulační-studie-1.html#cb247-290" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb247-291"><a href="simulační-studie-1.html#cb247-291" tabindex="-1"></a>  newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(Y.test), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb247-292"><a href="simulační-studie-1.html#cb247-292" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb247-293"><a href="simulační-studie-1.html#cb247-293" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb247-294"><a href="simulační-studie-1.html#cb247-294" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb247-295"><a href="simulační-studie-1.html#cb247-295" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-296"><a href="simulační-studie-1.html#cb247-296" tabindex="-1"></a>  </span>
<span id="cb247-297"><a href="simulační-studie-1.html#cb247-297" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR_functional&#39;</span>, </span>
<span id="cb247-298"><a href="simulační-studie-1.html#cb247-298" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb247-299"><a href="simulační-studie-1.html#cb247-299" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb247-300"><a href="simulační-studie-1.html#cb247-300" tabindex="-1"></a>  </span>
<span id="cb247-301"><a href="simulační-studie-1.html#cb247-301" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb247-302"><a href="simulační-studie-1.html#cb247-302" tabindex="-1"></a>  </span>
<span id="cb247-303"><a href="simulační-studie-1.html#cb247-303" tabindex="-1"></a>  <span class="do">### 4.2) Logistická regrese s analýzou hlavních komponent</span></span>
<span id="cb247-304"><a href="simulační-studie-1.html#cb247-304" tabindex="-1"></a>  </span>
<span id="cb247-305"><a href="simulační-studie-1.html#cb247-305" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb247-306"><a href="simulační-studie-1.html#cb247-306" tabindex="-1"></a>  clf.LR <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span>  ., <span class="at">data =</span> data.PCA.train, <span class="at">family =</span> binomial)</span>
<span id="cb247-307"><a href="simulační-studie-1.html#cb247-307" tabindex="-1"></a>  </span>
<span id="cb247-308"><a href="simulační-studie-1.html#cb247-308" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb247-309"><a href="simulační-studie-1.html#cb247-309" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.train, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb247-310"><a href="simulační-studie-1.html#cb247-310" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb247-311"><a href="simulační-studie-1.html#cb247-311" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb247-312"><a href="simulační-studie-1.html#cb247-312" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-313"><a href="simulační-studie-1.html#cb247-313" tabindex="-1"></a>    </span>
<span id="cb247-314"><a href="simulační-studie-1.html#cb247-314" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb247-315"><a href="simulační-studie-1.html#cb247-315" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.test, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb247-316"><a href="simulační-studie-1.html#cb247-316" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb247-317"><a href="simulační-studie-1.html#cb247-317" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb247-318"><a href="simulační-studie-1.html#cb247-318" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-319"><a href="simulační-studie-1.html#cb247-319" tabindex="-1"></a>  </span>
<span id="cb247-320"><a href="simulační-studie-1.html#cb247-320" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR_score&#39;</span>, </span>
<span id="cb247-321"><a href="simulační-studie-1.html#cb247-321" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb247-322"><a href="simulační-studie-1.html#cb247-322" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb247-323"><a href="simulační-studie-1.html#cb247-323" tabindex="-1"></a>  </span>
<span id="cb247-324"><a href="simulační-studie-1.html#cb247-324" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb247-325"><a href="simulační-studie-1.html#cb247-325" tabindex="-1"></a>  </span>
<span id="cb247-326"><a href="simulační-studie-1.html#cb247-326" tabindex="-1"></a>  <span class="do">## 5) Rozhodovací stromy</span></span>
<span id="cb247-327"><a href="simulační-studie-1.html#cb247-327" tabindex="-1"></a>  <span class="do">### 5.1) Diskretizace intervalu</span></span>
<span id="cb247-328"><a href="simulační-studie-1.html#cb247-328" tabindex="-1"></a>  </span>
<span id="cb247-329"><a href="simulační-studie-1.html#cb247-329" tabindex="-1"></a>  <span class="co"># posloupnost bodu, ve kterych funkce vyhodnotime</span></span>
<span id="cb247-330"><a href="simulační-studie-1.html#cb247-330" tabindex="-1"></a>  t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">101</span>)</span>
<span id="cb247-331"><a href="simulační-studie-1.html#cb247-331" tabindex="-1"></a>     </span>
<span id="cb247-332"><a href="simulační-studie-1.html#cb247-332" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb247-333"><a href="simulační-studie-1.html#cb247-333" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) <span class="co"># transpozice kvuli funkcim v radku</span></span>
<span id="cb247-334"><a href="simulační-studie-1.html#cb247-334" tabindex="-1"></a>  grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb247-335"><a href="simulační-studie-1.html#cb247-335" tabindex="-1"></a>  </span>
<span id="cb247-336"><a href="simulační-studie-1.html#cb247-336" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb247-337"><a href="simulační-studie-1.html#cb247-337" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb247-338"><a href="simulační-studie-1.html#cb247-338" tabindex="-1"></a>  grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb247-339"><a href="simulační-studie-1.html#cb247-339" tabindex="-1"></a>  </span>
<span id="cb247-340"><a href="simulační-studie-1.html#cb247-340" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb247-341"><a href="simulační-studie-1.html#cb247-341" tabindex="-1"></a>  clf.tree <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb247-342"><a href="simulační-studie-1.html#cb247-342" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb247-343"><a href="simulační-studie-1.html#cb247-343" tabindex="-1"></a>                   <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb247-344"><a href="simulační-studie-1.html#cb247-344" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb247-345"><a href="simulační-studie-1.html#cb247-345" tabindex="-1"></a>  </span>
<span id="cb247-346"><a href="simulační-studie-1.html#cb247-346" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb247-347"><a href="simulační-studie-1.html#cb247-347" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data)</span>
<span id="cb247-348"><a href="simulační-studie-1.html#cb247-348" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb247-349"><a href="simulační-studie-1.html#cb247-349" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-350"><a href="simulační-studie-1.html#cb247-350" tabindex="-1"></a>    </span>
<span id="cb247-351"><a href="simulační-studie-1.html#cb247-351" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb247-352"><a href="simulační-studie-1.html#cb247-352" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb247-353"><a href="simulační-studie-1.html#cb247-353" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb247-354"><a href="simulační-studie-1.html#cb247-354" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-355"><a href="simulační-studie-1.html#cb247-355" tabindex="-1"></a>  </span>
<span id="cb247-356"><a href="simulační-studie-1.html#cb247-356" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree_discr&#39;</span>, </span>
<span id="cb247-357"><a href="simulační-studie-1.html#cb247-357" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb247-358"><a href="simulační-studie-1.html#cb247-358" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb247-359"><a href="simulační-studie-1.html#cb247-359" tabindex="-1"></a>  </span>
<span id="cb247-360"><a href="simulační-studie-1.html#cb247-360" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb247-361"><a href="simulační-studie-1.html#cb247-361" tabindex="-1"></a>  </span>
<span id="cb247-362"><a href="simulační-studie-1.html#cb247-362" tabindex="-1"></a>  <span class="do">### 5.2) Skóre hlavních komponent</span></span>
<span id="cb247-363"><a href="simulační-studie-1.html#cb247-363" tabindex="-1"></a>  </span>
<span id="cb247-364"><a href="simulační-studie-1.html#cb247-364" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb247-365"><a href="simulační-studie-1.html#cb247-365" tabindex="-1"></a>  clf.tree.PCA <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb247-366"><a href="simulační-studie-1.html#cb247-366" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb247-367"><a href="simulační-studie-1.html#cb247-367" tabindex="-1"></a>                   <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb247-368"><a href="simulační-studie-1.html#cb247-368" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb247-369"><a href="simulační-studie-1.html#cb247-369" tabindex="-1"></a>  </span>
<span id="cb247-370"><a href="simulační-studie-1.html#cb247-370" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb247-371"><a href="simulační-studie-1.html#cb247-371" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb247-372"><a href="simulační-studie-1.html#cb247-372" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb247-373"><a href="simulační-studie-1.html#cb247-373" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-374"><a href="simulační-studie-1.html#cb247-374" tabindex="-1"></a>    </span>
<span id="cb247-375"><a href="simulační-studie-1.html#cb247-375" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb247-376"><a href="simulační-studie-1.html#cb247-376" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb247-377"><a href="simulační-studie-1.html#cb247-377" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb247-378"><a href="simulační-studie-1.html#cb247-378" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-379"><a href="simulační-studie-1.html#cb247-379" tabindex="-1"></a>  </span>
<span id="cb247-380"><a href="simulační-studie-1.html#cb247-380" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree_score&#39;</span>, </span>
<span id="cb247-381"><a href="simulační-studie-1.html#cb247-381" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb247-382"><a href="simulační-studie-1.html#cb247-382" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb247-383"><a href="simulační-studie-1.html#cb247-383" tabindex="-1"></a>  </span>
<span id="cb247-384"><a href="simulační-studie-1.html#cb247-384" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb247-385"><a href="simulační-studie-1.html#cb247-385" tabindex="-1"></a>  </span>
<span id="cb247-386"><a href="simulační-studie-1.html#cb247-386" tabindex="-1"></a>  <span class="do">### 5.3) Bázové koeficienty</span></span>
<span id="cb247-387"><a href="simulační-studie-1.html#cb247-387" tabindex="-1"></a>  </span>
<span id="cb247-388"><a href="simulační-studie-1.html#cb247-388" tabindex="-1"></a>  <span class="co"># trenovaci dataset</span></span>
<span id="cb247-389"><a href="simulační-studie-1.html#cb247-389" tabindex="-1"></a>  data.Bbasis.train <span class="ot">&lt;-</span> <span class="fu">t</span>(X.train<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb247-390"><a href="simulační-studie-1.html#cb247-390" tabindex="-1"></a>  data.Bbasis.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb247-391"><a href="simulační-studie-1.html#cb247-391" tabindex="-1"></a>  </span>
<span id="cb247-392"><a href="simulační-studie-1.html#cb247-392" tabindex="-1"></a>  <span class="co"># testovaci dataset</span></span>
<span id="cb247-393"><a href="simulační-studie-1.html#cb247-393" tabindex="-1"></a>  data.Bbasis.test <span class="ot">&lt;-</span> <span class="fu">t</span>(X.test<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb247-394"><a href="simulační-studie-1.html#cb247-394" tabindex="-1"></a>  data.Bbasis.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb247-395"><a href="simulační-studie-1.html#cb247-395" tabindex="-1"></a>  </span>
<span id="cb247-396"><a href="simulační-studie-1.html#cb247-396" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb247-397"><a href="simulační-studie-1.html#cb247-397" tabindex="-1"></a>  clf.tree.Bbasis <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb247-398"><a href="simulační-studie-1.html#cb247-398" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb247-399"><a href="simulační-studie-1.html#cb247-399" tabindex="-1"></a>                   <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb247-400"><a href="simulační-studie-1.html#cb247-400" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb247-401"><a href="simulační-studie-1.html#cb247-401" tabindex="-1"></a>  </span>
<span id="cb247-402"><a href="simulační-studie-1.html#cb247-402" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb247-403"><a href="simulační-studie-1.html#cb247-403" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb247-404"><a href="simulační-studie-1.html#cb247-404" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb247-405"><a href="simulační-studie-1.html#cb247-405" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-406"><a href="simulační-studie-1.html#cb247-406" tabindex="-1"></a>    </span>
<span id="cb247-407"><a href="simulační-studie-1.html#cb247-407" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb247-408"><a href="simulační-studie-1.html#cb247-408" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb247-409"><a href="simulační-studie-1.html#cb247-409" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb247-410"><a href="simulační-studie-1.html#cb247-410" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-411"><a href="simulační-studie-1.html#cb247-411" tabindex="-1"></a>  </span>
<span id="cb247-412"><a href="simulační-studie-1.html#cb247-412" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree_Bbasis&#39;</span>, </span>
<span id="cb247-413"><a href="simulační-studie-1.html#cb247-413" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb247-414"><a href="simulační-studie-1.html#cb247-414" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb247-415"><a href="simulační-studie-1.html#cb247-415" tabindex="-1"></a>  </span>
<span id="cb247-416"><a href="simulační-studie-1.html#cb247-416" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb247-417"><a href="simulační-studie-1.html#cb247-417" tabindex="-1"></a>  </span>
<span id="cb247-418"><a href="simulační-studie-1.html#cb247-418" tabindex="-1"></a>  <span class="do">## 6) Náhodné lesy</span></span>
<span id="cb247-419"><a href="simulační-studie-1.html#cb247-419" tabindex="-1"></a>  </span>
<span id="cb247-420"><a href="simulační-studie-1.html#cb247-420" tabindex="-1"></a>  <span class="do">### 6.1) Diskretizace intervalu</span></span>
<span id="cb247-421"><a href="simulační-studie-1.html#cb247-421" tabindex="-1"></a>  </span>
<span id="cb247-422"><a href="simulační-studie-1.html#cb247-422" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb247-423"><a href="simulační-studie-1.html#cb247-423" tabindex="-1"></a>  clf.RF <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb247-424"><a href="simulační-studie-1.html#cb247-424" tabindex="-1"></a>                         <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb247-425"><a href="simulační-studie-1.html#cb247-425" tabindex="-1"></a>                         <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb247-426"><a href="simulační-studie-1.html#cb247-426" tabindex="-1"></a>                         <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb247-427"><a href="simulační-studie-1.html#cb247-427" tabindex="-1"></a>  </span>
<span id="cb247-428"><a href="simulační-studie-1.html#cb247-428" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb247-429"><a href="simulační-studie-1.html#cb247-429" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data)</span>
<span id="cb247-430"><a href="simulační-studie-1.html#cb247-430" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb247-431"><a href="simulační-studie-1.html#cb247-431" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-432"><a href="simulační-studie-1.html#cb247-432" tabindex="-1"></a>    </span>
<span id="cb247-433"><a href="simulační-studie-1.html#cb247-433" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb247-434"><a href="simulační-studie-1.html#cb247-434" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb247-435"><a href="simulační-studie-1.html#cb247-435" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb247-436"><a href="simulační-studie-1.html#cb247-436" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-437"><a href="simulační-studie-1.html#cb247-437" tabindex="-1"></a>  </span>
<span id="cb247-438"><a href="simulační-studie-1.html#cb247-438" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_discr&#39;</span>, </span>
<span id="cb247-439"><a href="simulační-studie-1.html#cb247-439" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb247-440"><a href="simulační-studie-1.html#cb247-440" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb247-441"><a href="simulační-studie-1.html#cb247-441" tabindex="-1"></a>  </span>
<span id="cb247-442"><a href="simulační-studie-1.html#cb247-442" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb247-443"><a href="simulační-studie-1.html#cb247-443" tabindex="-1"></a>  </span>
<span id="cb247-444"><a href="simulační-studie-1.html#cb247-444" tabindex="-1"></a>  <span class="do">### 6.2) Skóre hlavních komponent</span></span>
<span id="cb247-445"><a href="simulační-studie-1.html#cb247-445" tabindex="-1"></a>  </span>
<span id="cb247-446"><a href="simulační-studie-1.html#cb247-446" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb247-447"><a href="simulační-studie-1.html#cb247-447" tabindex="-1"></a>  clf.RF.PCA <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb247-448"><a href="simulační-studie-1.html#cb247-448" tabindex="-1"></a>                             <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb247-449"><a href="simulační-studie-1.html#cb247-449" tabindex="-1"></a>                             <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb247-450"><a href="simulační-studie-1.html#cb247-450" tabindex="-1"></a>                             <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb247-451"><a href="simulační-studie-1.html#cb247-451" tabindex="-1"></a>  </span>
<span id="cb247-452"><a href="simulační-studie-1.html#cb247-452" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb247-453"><a href="simulační-studie-1.html#cb247-453" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb247-454"><a href="simulační-studie-1.html#cb247-454" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb247-455"><a href="simulační-studie-1.html#cb247-455" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-456"><a href="simulační-studie-1.html#cb247-456" tabindex="-1"></a>    </span>
<span id="cb247-457"><a href="simulační-studie-1.html#cb247-457" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb247-458"><a href="simulační-studie-1.html#cb247-458" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb247-459"><a href="simulační-studie-1.html#cb247-459" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb247-460"><a href="simulační-studie-1.html#cb247-460" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-461"><a href="simulační-studie-1.html#cb247-461" tabindex="-1"></a>  </span>
<span id="cb247-462"><a href="simulační-studie-1.html#cb247-462" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_score&#39;</span>, </span>
<span id="cb247-463"><a href="simulační-studie-1.html#cb247-463" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb247-464"><a href="simulační-studie-1.html#cb247-464" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb247-465"><a href="simulační-studie-1.html#cb247-465" tabindex="-1"></a>  </span>
<span id="cb247-466"><a href="simulační-studie-1.html#cb247-466" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb247-467"><a href="simulační-studie-1.html#cb247-467" tabindex="-1"></a>  </span>
<span id="cb247-468"><a href="simulační-studie-1.html#cb247-468" tabindex="-1"></a>  <span class="do">### 6.3) Bázové koeficienty</span></span>
<span id="cb247-469"><a href="simulační-studie-1.html#cb247-469" tabindex="-1"></a>  </span>
<span id="cb247-470"><a href="simulační-studie-1.html#cb247-470" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb247-471"><a href="simulační-studie-1.html#cb247-471" tabindex="-1"></a>  clf.RF.Bbasis <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb247-472"><a href="simulační-studie-1.html#cb247-472" tabindex="-1"></a>                                <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb247-473"><a href="simulační-studie-1.html#cb247-473" tabindex="-1"></a>                                <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb247-474"><a href="simulační-studie-1.html#cb247-474" tabindex="-1"></a>                                <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb247-475"><a href="simulační-studie-1.html#cb247-475" tabindex="-1"></a>  </span>
<span id="cb247-476"><a href="simulační-studie-1.html#cb247-476" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb247-477"><a href="simulační-studie-1.html#cb247-477" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb247-478"><a href="simulační-studie-1.html#cb247-478" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb247-479"><a href="simulační-studie-1.html#cb247-479" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-480"><a href="simulační-studie-1.html#cb247-480" tabindex="-1"></a>    </span>
<span id="cb247-481"><a href="simulační-studie-1.html#cb247-481" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb247-482"><a href="simulační-studie-1.html#cb247-482" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb247-483"><a href="simulační-studie-1.html#cb247-483" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb247-484"><a href="simulační-studie-1.html#cb247-484" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-485"><a href="simulační-studie-1.html#cb247-485" tabindex="-1"></a>  </span>
<span id="cb247-486"><a href="simulační-studie-1.html#cb247-486" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_Bbasis&#39;</span>, </span>
<span id="cb247-487"><a href="simulační-studie-1.html#cb247-487" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb247-488"><a href="simulační-studie-1.html#cb247-488" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb247-489"><a href="simulační-studie-1.html#cb247-489" tabindex="-1"></a>  </span>
<span id="cb247-490"><a href="simulační-studie-1.html#cb247-490" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb247-491"><a href="simulační-studie-1.html#cb247-491" tabindex="-1"></a>  </span>
<span id="cb247-492"><a href="simulační-studie-1.html#cb247-492" tabindex="-1"></a>  <span class="do">## 7) SVM</span></span>
<span id="cb247-493"><a href="simulační-studie-1.html#cb247-493" tabindex="-1"></a>  </span>
<span id="cb247-494"><a href="simulační-studie-1.html#cb247-494" tabindex="-1"></a>  <span class="do">### 7.1) Diskretizace intervalu</span></span>
<span id="cb247-495"><a href="simulační-studie-1.html#cb247-495" tabindex="-1"></a>  </span>
<span id="cb247-496"><a href="simulační-studie-1.html#cb247-496" tabindex="-1"></a>  clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb247-497"><a href="simulační-studie-1.html#cb247-497" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb247-498"><a href="simulační-studie-1.html#cb247-498" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb247-499"><a href="simulační-studie-1.html#cb247-499" tabindex="-1"></a>                   <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb247-500"><a href="simulační-studie-1.html#cb247-500" tabindex="-1"></a>  </span>
<span id="cb247-501"><a href="simulační-studie-1.html#cb247-501" tabindex="-1"></a>  clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb247-502"><a href="simulační-studie-1.html#cb247-502" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb247-503"><a href="simulační-studie-1.html#cb247-503" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb247-504"><a href="simulační-studie-1.html#cb247-504" tabindex="-1"></a>                   <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb247-505"><a href="simulační-studie-1.html#cb247-505" tabindex="-1"></a>  </span>
<span id="cb247-506"><a href="simulační-studie-1.html#cb247-506" tabindex="-1"></a>  clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb247-507"><a href="simulační-studie-1.html#cb247-507" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb247-508"><a href="simulační-studie-1.html#cb247-508" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb247-509"><a href="simulační-studie-1.html#cb247-509" tabindex="-1"></a>                   <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb247-510"><a href="simulační-studie-1.html#cb247-510" tabindex="-1"></a>  </span>
<span id="cb247-511"><a href="simulační-studie-1.html#cb247-511" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb247-512"><a href="simulační-studie-1.html#cb247-512" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data)</span>
<span id="cb247-513"><a href="simulační-studie-1.html#cb247-513" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb247-514"><a href="simulační-studie-1.html#cb247-514" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-515"><a href="simulační-studie-1.html#cb247-515" tabindex="-1"></a>  </span>
<span id="cb247-516"><a href="simulační-studie-1.html#cb247-516" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data)</span>
<span id="cb247-517"><a href="simulační-studie-1.html#cb247-517" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb247-518"><a href="simulační-studie-1.html#cb247-518" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-519"><a href="simulační-studie-1.html#cb247-519" tabindex="-1"></a>  </span>
<span id="cb247-520"><a href="simulační-studie-1.html#cb247-520" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data)</span>
<span id="cb247-521"><a href="simulační-studie-1.html#cb247-521" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb247-522"><a href="simulační-studie-1.html#cb247-522" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-523"><a href="simulační-studie-1.html#cb247-523" tabindex="-1"></a>  </span>
<span id="cb247-524"><a href="simulační-studie-1.html#cb247-524" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb247-525"><a href="simulační-studie-1.html#cb247-525" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb247-526"><a href="simulační-studie-1.html#cb247-526" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb247-527"><a href="simulační-studie-1.html#cb247-527" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-528"><a href="simulační-studie-1.html#cb247-528" tabindex="-1"></a>  </span>
<span id="cb247-529"><a href="simulační-studie-1.html#cb247-529" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb247-530"><a href="simulační-studie-1.html#cb247-530" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb247-531"><a href="simulační-studie-1.html#cb247-531" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-532"><a href="simulační-studie-1.html#cb247-532" tabindex="-1"></a>  </span>
<span id="cb247-533"><a href="simulační-studie-1.html#cb247-533" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb247-534"><a href="simulační-studie-1.html#cb247-534" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb247-535"><a href="simulační-studie-1.html#cb247-535" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-536"><a href="simulační-studie-1.html#cb247-536" tabindex="-1"></a>  </span>
<span id="cb247-537"><a href="simulační-studie-1.html#cb247-537" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - diskr&#39;</span>, </span>
<span id="cb247-538"><a href="simulační-studie-1.html#cb247-538" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - diskr&#39;</span>, </span>
<span id="cb247-539"><a href="simulační-studie-1.html#cb247-539" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - diskr&#39;</span>), </span>
<span id="cb247-540"><a href="simulační-studie-1.html#cb247-540" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l,</span>
<span id="cb247-541"><a href="simulační-studie-1.html#cb247-541" tabindex="-1"></a>                                      presnost.train.p, presnost.train.r),</span>
<span id="cb247-542"><a href="simulační-studie-1.html#cb247-542" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb247-543"><a href="simulační-studie-1.html#cb247-543" tabindex="-1"></a>                                     presnost.test.p, presnost.test.r))</span>
<span id="cb247-544"><a href="simulační-studie-1.html#cb247-544" tabindex="-1"></a>  </span>
<span id="cb247-545"><a href="simulační-studie-1.html#cb247-545" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb247-546"><a href="simulační-studie-1.html#cb247-546" tabindex="-1"></a>  </span>
<span id="cb247-547"><a href="simulační-studie-1.html#cb247-547" tabindex="-1"></a>  <span class="do">### 7.2) Skóre hlavních komponent</span></span>
<span id="cb247-548"><a href="simulační-studie-1.html#cb247-548" tabindex="-1"></a>  </span>
<span id="cb247-549"><a href="simulační-studie-1.html#cb247-549" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb247-550"><a href="simulační-studie-1.html#cb247-550" tabindex="-1"></a>  clf.SVM.l.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb247-551"><a href="simulační-studie-1.html#cb247-551" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb247-552"><a href="simulační-studie-1.html#cb247-552" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb247-553"><a href="simulační-studie-1.html#cb247-553" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb247-554"><a href="simulační-studie-1.html#cb247-554" tabindex="-1"></a>  </span>
<span id="cb247-555"><a href="simulační-studie-1.html#cb247-555" tabindex="-1"></a>  clf.SVM.p.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb247-556"><a href="simulační-studie-1.html#cb247-556" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb247-557"><a href="simulační-studie-1.html#cb247-557" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb247-558"><a href="simulační-studie-1.html#cb247-558" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb247-559"><a href="simulační-studie-1.html#cb247-559" tabindex="-1"></a>  </span>
<span id="cb247-560"><a href="simulační-studie-1.html#cb247-560" tabindex="-1"></a>  clf.SVM.r.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb247-561"><a href="simulační-studie-1.html#cb247-561" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb247-562"><a href="simulační-studie-1.html#cb247-562" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb247-563"><a href="simulační-studie-1.html#cb247-563" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb247-564"><a href="simulační-studie-1.html#cb247-564" tabindex="-1"></a>  </span>
<span id="cb247-565"><a href="simulační-studie-1.html#cb247-565" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb247-566"><a href="simulační-studie-1.html#cb247-566" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb247-567"><a href="simulační-studie-1.html#cb247-567" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb247-568"><a href="simulační-studie-1.html#cb247-568" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-569"><a href="simulační-studie-1.html#cb247-569" tabindex="-1"></a>  </span>
<span id="cb247-570"><a href="simulační-studie-1.html#cb247-570" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb247-571"><a href="simulační-studie-1.html#cb247-571" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb247-572"><a href="simulační-studie-1.html#cb247-572" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-573"><a href="simulační-studie-1.html#cb247-573" tabindex="-1"></a>  </span>
<span id="cb247-574"><a href="simulační-studie-1.html#cb247-574" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb247-575"><a href="simulační-studie-1.html#cb247-575" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb247-576"><a href="simulační-studie-1.html#cb247-576" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-577"><a href="simulační-studie-1.html#cb247-577" tabindex="-1"></a>    </span>
<span id="cb247-578"><a href="simulační-studie-1.html#cb247-578" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb247-579"><a href="simulační-studie-1.html#cb247-579" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb247-580"><a href="simulační-studie-1.html#cb247-580" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb247-581"><a href="simulační-studie-1.html#cb247-581" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-582"><a href="simulační-studie-1.html#cb247-582" tabindex="-1"></a>  </span>
<span id="cb247-583"><a href="simulační-studie-1.html#cb247-583" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb247-584"><a href="simulační-studie-1.html#cb247-584" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb247-585"><a href="simulační-studie-1.html#cb247-585" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-586"><a href="simulační-studie-1.html#cb247-586" tabindex="-1"></a>  </span>
<span id="cb247-587"><a href="simulační-studie-1.html#cb247-587" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb247-588"><a href="simulační-studie-1.html#cb247-588" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb247-589"><a href="simulační-studie-1.html#cb247-589" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-590"><a href="simulační-studie-1.html#cb247-590" tabindex="-1"></a>  </span>
<span id="cb247-591"><a href="simulační-studie-1.html#cb247-591" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - PCA&#39;</span>, </span>
<span id="cb247-592"><a href="simulační-studie-1.html#cb247-592" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - PCA&#39;</span>, </span>
<span id="cb247-593"><a href="simulační-studie-1.html#cb247-593" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - PCA&#39;</span>), </span>
<span id="cb247-594"><a href="simulační-studie-1.html#cb247-594" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, </span>
<span id="cb247-595"><a href="simulační-studie-1.html#cb247-595" tabindex="-1"></a>                                      presnost.train.p, presnost.train.r),</span>
<span id="cb247-596"><a href="simulační-studie-1.html#cb247-596" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb247-597"><a href="simulační-studie-1.html#cb247-597" tabindex="-1"></a>                                     presnost.test.p, presnost.test.r))</span>
<span id="cb247-598"><a href="simulační-studie-1.html#cb247-598" tabindex="-1"></a>  </span>
<span id="cb247-599"><a href="simulační-studie-1.html#cb247-599" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb247-600"><a href="simulační-studie-1.html#cb247-600" tabindex="-1"></a>  </span>
<span id="cb247-601"><a href="simulační-studie-1.html#cb247-601" tabindex="-1"></a>  <span class="do">### 7.3) Bázové koeficienty</span></span>
<span id="cb247-602"><a href="simulační-studie-1.html#cb247-602" tabindex="-1"></a>  </span>
<span id="cb247-603"><a href="simulační-studie-1.html#cb247-603" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb247-604"><a href="simulační-studie-1.html#cb247-604" tabindex="-1"></a>  clf.SVM.l.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb247-605"><a href="simulační-studie-1.html#cb247-605" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb247-606"><a href="simulační-studie-1.html#cb247-606" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb247-607"><a href="simulační-studie-1.html#cb247-607" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb247-608"><a href="simulační-studie-1.html#cb247-608" tabindex="-1"></a>  </span>
<span id="cb247-609"><a href="simulační-studie-1.html#cb247-609" tabindex="-1"></a>  clf.SVM.p.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb247-610"><a href="simulační-studie-1.html#cb247-610" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb247-611"><a href="simulační-studie-1.html#cb247-611" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb247-612"><a href="simulační-studie-1.html#cb247-612" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb247-613"><a href="simulační-studie-1.html#cb247-613" tabindex="-1"></a>  </span>
<span id="cb247-614"><a href="simulační-studie-1.html#cb247-614" tabindex="-1"></a>  clf.SVM.r.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb247-615"><a href="simulační-studie-1.html#cb247-615" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb247-616"><a href="simulační-studie-1.html#cb247-616" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb247-617"><a href="simulační-studie-1.html#cb247-617" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb247-618"><a href="simulační-studie-1.html#cb247-618" tabindex="-1"></a>  </span>
<span id="cb247-619"><a href="simulační-studie-1.html#cb247-619" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb247-620"><a href="simulační-studie-1.html#cb247-620" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb247-621"><a href="simulační-studie-1.html#cb247-621" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb247-622"><a href="simulační-studie-1.html#cb247-622" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-623"><a href="simulační-studie-1.html#cb247-623" tabindex="-1"></a>  </span>
<span id="cb247-624"><a href="simulační-studie-1.html#cb247-624" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb247-625"><a href="simulační-studie-1.html#cb247-625" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb247-626"><a href="simulační-studie-1.html#cb247-626" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-627"><a href="simulační-studie-1.html#cb247-627" tabindex="-1"></a>  </span>
<span id="cb247-628"><a href="simulační-studie-1.html#cb247-628" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb247-629"><a href="simulační-studie-1.html#cb247-629" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb247-630"><a href="simulační-studie-1.html#cb247-630" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-631"><a href="simulační-studie-1.html#cb247-631" tabindex="-1"></a>    </span>
<span id="cb247-632"><a href="simulační-studie-1.html#cb247-632" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb247-633"><a href="simulační-studie-1.html#cb247-633" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb247-634"><a href="simulační-studie-1.html#cb247-634" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb247-635"><a href="simulační-studie-1.html#cb247-635" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-636"><a href="simulační-studie-1.html#cb247-636" tabindex="-1"></a>  </span>
<span id="cb247-637"><a href="simulační-studie-1.html#cb247-637" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb247-638"><a href="simulační-studie-1.html#cb247-638" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb247-639"><a href="simulační-studie-1.html#cb247-639" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-640"><a href="simulační-studie-1.html#cb247-640" tabindex="-1"></a>  </span>
<span id="cb247-641"><a href="simulační-studie-1.html#cb247-641" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb247-642"><a href="simulační-studie-1.html#cb247-642" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb247-643"><a href="simulační-studie-1.html#cb247-643" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-644"><a href="simulační-studie-1.html#cb247-644" tabindex="-1"></a>  </span>
<span id="cb247-645"><a href="simulační-studie-1.html#cb247-645" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - Bbasis&#39;</span>, </span>
<span id="cb247-646"><a href="simulační-studie-1.html#cb247-646" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - Bbasis&#39;</span>, </span>
<span id="cb247-647"><a href="simulační-studie-1.html#cb247-647" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - Bbasis&#39;</span>), </span>
<span id="cb247-648"><a href="simulační-studie-1.html#cb247-648" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, </span>
<span id="cb247-649"><a href="simulační-studie-1.html#cb247-649" tabindex="-1"></a>                                      presnost.train.p, presnost.train.r),</span>
<span id="cb247-650"><a href="simulační-studie-1.html#cb247-650" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb247-651"><a href="simulační-studie-1.html#cb247-651" tabindex="-1"></a>                                     presnost.test.p, presnost.test.r))</span>
<span id="cb247-652"><a href="simulační-studie-1.html#cb247-652" tabindex="-1"></a></span>
<span id="cb247-653"><a href="simulační-studie-1.html#cb247-653" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb247-654"><a href="simulační-studie-1.html#cb247-654" tabindex="-1"></a>  </span>
<span id="cb247-655"><a href="simulační-studie-1.html#cb247-655" tabindex="-1"></a>  <span class="do">### 7.4) Projekce na B-splinovou bázi</span></span>
<span id="cb247-656"><a href="simulační-studie-1.html#cb247-656" tabindex="-1"></a>  </span>
<span id="cb247-657"><a href="simulační-studie-1.html#cb247-657" tabindex="-1"></a>  <span class="co"># hodnoty pro B-splinovou bazi</span></span>
<span id="cb247-658"><a href="simulační-studie-1.html#cb247-658" tabindex="-1"></a>  rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb247-659"><a href="simulační-studie-1.html#cb247-659" tabindex="-1"></a>  norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb247-660"><a href="simulační-studie-1.html#cb247-660" tabindex="-1"></a>  n_basis_min <span class="ot">&lt;-</span> norder</span>
<span id="cb247-661"><a href="simulační-studie-1.html#cb247-661" tabindex="-1"></a>  n_basis_max <span class="ot">&lt;-</span> <span class="fu">length</span>(t) <span class="sc">+</span> norder <span class="sc">-</span> <span class="dv">2</span> <span class="sc">-</span> <span class="dv">10</span></span>
<span id="cb247-662"><a href="simulační-studie-1.html#cb247-662" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> n_basis_min<span class="sc">:</span>n_basis_max </span>
<span id="cb247-663"><a href="simulační-studie-1.html#cb247-663" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb247-664"><a href="simulační-studie-1.html#cb247-664" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">SVM.l =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb247-665"><a href="simulační-studie-1.html#cb247-665" tabindex="-1"></a>                     <span class="at">SVM.p =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb247-666"><a href="simulační-studie-1.html#cb247-666" tabindex="-1"></a>                     <span class="at">SVM.r =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv))</span>
<span id="cb247-667"><a href="simulační-studie-1.html#cb247-667" tabindex="-1"></a>  </span>
<span id="cb247-668"><a href="simulační-studie-1.html#cb247-668" tabindex="-1"></a>  <span class="cf">for</span> (d <span class="cf">in</span> dimensions) {</span>
<span id="cb247-669"><a href="simulační-studie-1.html#cb247-669" tabindex="-1"></a>    bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb247-670"><a href="simulační-studie-1.html#cb247-670" tabindex="-1"></a>                                   <span class="at">nbasis =</span> d)</span>
<span id="cb247-671"><a href="simulační-studie-1.html#cb247-671" tabindex="-1"></a>    Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="at">argvals =</span> t, <span class="at">basisobj =</span> bbasis) </span>
<span id="cb247-672"><a href="simulační-studie-1.html#cb247-672" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb247-673"><a href="simulační-studie-1.html#cb247-673" tabindex="-1"></a>    </span>
<span id="cb247-674"><a href="simulační-studie-1.html#cb247-674" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb247-675"><a href="simulační-studie-1.html#cb247-675" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb247-676"><a href="simulační-studie-1.html#cb247-676" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XX.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb247-677"><a href="simulační-studie-1.html#cb247-677" tabindex="-1"></a>      </span>
<span id="cb247-678"><a href="simulační-studie-1.html#cb247-678" tabindex="-1"></a>      data.projection.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[cv_sample, ])</span>
<span id="cb247-679"><a href="simulační-studie-1.html#cb247-679" tabindex="-1"></a>      data.projection.train.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[cv_sample])</span>
<span id="cb247-680"><a href="simulační-studie-1.html#cb247-680" tabindex="-1"></a>      data.projection.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb247-681"><a href="simulační-studie-1.html#cb247-681" tabindex="-1"></a>      Y.test.cv <span class="ot">&lt;-</span> Y.train[<span class="sc">!</span>cv_sample]</span>
<span id="cb247-682"><a href="simulační-studie-1.html#cb247-682" tabindex="-1"></a>      data.projection.test.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test.cv)</span>
<span id="cb247-683"><a href="simulační-studie-1.html#cb247-683" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb247-684"><a href="simulační-studie-1.html#cb247-684" tabindex="-1"></a>      clf.SVM.l.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb247-685"><a href="simulační-studie-1.html#cb247-685" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb247-686"><a href="simulační-studie-1.html#cb247-686" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb247-687"><a href="simulační-studie-1.html#cb247-687" tabindex="-1"></a>                              <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb247-688"><a href="simulační-studie-1.html#cb247-688" tabindex="-1"></a>      </span>
<span id="cb247-689"><a href="simulační-studie-1.html#cb247-689" tabindex="-1"></a>      clf.SVM.p.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb247-690"><a href="simulační-studie-1.html#cb247-690" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb247-691"><a href="simulační-studie-1.html#cb247-691" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb247-692"><a href="simulační-studie-1.html#cb247-692" tabindex="-1"></a>                              <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb247-693"><a href="simulační-studie-1.html#cb247-693" tabindex="-1"></a>      </span>
<span id="cb247-694"><a href="simulační-studie-1.html#cb247-694" tabindex="-1"></a>      clf.SVM.r.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb247-695"><a href="simulační-studie-1.html#cb247-695" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb247-696"><a href="simulační-studie-1.html#cb247-696" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb247-697"><a href="simulační-studie-1.html#cb247-697" tabindex="-1"></a>                              <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb247-698"><a href="simulační-studie-1.html#cb247-698" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb247-699"><a href="simulační-studie-1.html#cb247-699" tabindex="-1"></a>      <span class="do">## linear kernel</span></span>
<span id="cb247-700"><a href="simulační-studie-1.html#cb247-700" tabindex="-1"></a>      predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.projection,</span>
<span id="cb247-701"><a href="simulační-studie-1.html#cb247-701" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb247-702"><a href="simulační-studie-1.html#cb247-702" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb247-703"><a href="simulační-studie-1.html#cb247-703" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-704"><a href="simulační-studie-1.html#cb247-704" tabindex="-1"></a>      <span class="do">## polynomial kernel</span></span>
<span id="cb247-705"><a href="simulační-studie-1.html#cb247-705" tabindex="-1"></a>      predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.projection, </span>
<span id="cb247-706"><a href="simulační-studie-1.html#cb247-706" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb247-707"><a href="simulační-studie-1.html#cb247-707" tabindex="-1"></a>      presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb247-708"><a href="simulační-studie-1.html#cb247-708" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-709"><a href="simulační-studie-1.html#cb247-709" tabindex="-1"></a>      <span class="do">## radial kernel</span></span>
<span id="cb247-710"><a href="simulační-studie-1.html#cb247-710" tabindex="-1"></a>      predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.projection,</span>
<span id="cb247-711"><a href="simulační-studie-1.html#cb247-711" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb247-712"><a href="simulační-studie-1.html#cb247-712" tabindex="-1"></a>      presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb247-713"><a href="simulační-studie-1.html#cb247-713" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-714"><a href="simulační-studie-1.html#cb247-714" tabindex="-1"></a>      </span>
<span id="cb247-715"><a href="simulační-studie-1.html#cb247-715" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane d a fold</span></span>
<span id="cb247-716"><a href="simulační-studie-1.html#cb247-716" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb247-717"><a href="simulační-studie-1.html#cb247-717" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb247-718"><a href="simulační-studie-1.html#cb247-718" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb247-719"><a href="simulační-studie-1.html#cb247-719" tabindex="-1"></a>    }</span>
<span id="cb247-720"><a href="simulační-studie-1.html#cb247-720" tabindex="-1"></a>  }</span>
<span id="cb247-721"><a href="simulační-studie-1.html#cb247-721" tabindex="-1"></a>  </span>
<span id="cb247-722"><a href="simulační-studie-1.html#cb247-722" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb247-723"><a href="simulační-studie-1.html#cb247-723" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb247-724"><a href="simulační-studie-1.html#cb247-724" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb247-725"><a href="simulační-studie-1.html#cb247-725" tabindex="-1"></a>  }</span>
<span id="cb247-726"><a href="simulační-studie-1.html#cb247-726" tabindex="-1"></a>  </span>
<span id="cb247-727"><a href="simulační-studie-1.html#cb247-727" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb247-728"><a href="simulační-studie-1.html#cb247-728" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb247-729"><a href="simulační-studie-1.html#cb247-729" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb247-730"><a href="simulační-studie-1.html#cb247-730" tabindex="-1"></a>  </span>
<span id="cb247-731"><a href="simulační-studie-1.html#cb247-731" tabindex="-1"></a>  <span class="co"># ulozime optimalni d do datove tabulky</span></span>
<span id="cb247-732"><a href="simulační-studie-1.html#cb247-732" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb247-733"><a href="simulační-studie-1.html#cb247-733" tabindex="-1"></a>  </span>
<span id="cb247-734"><a href="simulační-studie-1.html#cb247-734" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb247-735"><a href="simulační-studie-1.html#cb247-735" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - projection&#39;</span>, </span>
<span id="cb247-736"><a href="simulační-studie-1.html#cb247-736" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb247-737"><a href="simulační-studie-1.html#cb247-737" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - projection&#39;</span>), </span>
<span id="cb247-738"><a href="simulační-studie-1.html#cb247-738" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb247-739"><a href="simulační-studie-1.html#cb247-739" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb247-740"><a href="simulační-studie-1.html#cb247-740" tabindex="-1"></a>  </span>
<span id="cb247-741"><a href="simulační-studie-1.html#cb247-741" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb247-742"><a href="simulační-studie-1.html#cb247-742" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb247-743"><a href="simulační-studie-1.html#cb247-743" tabindex="-1"></a>    bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb247-744"><a href="simulační-studie-1.html#cb247-744" tabindex="-1"></a>                                   <span class="at">nbasis =</span> d.opt[kernel_number])</span>
<span id="cb247-745"><a href="simulační-studie-1.html#cb247-745" tabindex="-1"></a>    Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="at">argvals =</span> t, <span class="at">basisobj =</span> bbasis) </span>
<span id="cb247-746"><a href="simulační-studie-1.html#cb247-746" tabindex="-1"></a>    </span>
<span id="cb247-747"><a href="simulační-studie-1.html#cb247-747" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb247-748"><a href="simulační-studie-1.html#cb247-748" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb247-749"><a href="simulační-studie-1.html#cb247-749" tabindex="-1"></a>    </span>
<span id="cb247-750"><a href="simulační-studie-1.html#cb247-750" tabindex="-1"></a>    data.projection.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train)</span>
<span id="cb247-751"><a href="simulační-studie-1.html#cb247-751" tabindex="-1"></a>    data.projection.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb247-752"><a href="simulační-studie-1.html#cb247-752" tabindex="-1"></a>    </span>
<span id="cb247-753"><a href="simulační-studie-1.html#cb247-753" tabindex="-1"></a>    data.projection.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.test)</span>
<span id="cb247-754"><a href="simulační-studie-1.html#cb247-754" tabindex="-1"></a>    data.projection.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb247-755"><a href="simulační-studie-1.html#cb247-755" tabindex="-1"></a>    </span>
<span id="cb247-756"><a href="simulační-studie-1.html#cb247-756" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb247-757"><a href="simulační-studie-1.html#cb247-757" tabindex="-1"></a>    clf.SVM.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train,</span>
<span id="cb247-758"><a href="simulační-studie-1.html#cb247-758" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb247-759"><a href="simulační-studie-1.html#cb247-759" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb247-760"><a href="simulační-studie-1.html#cb247-760" tabindex="-1"></a>                              <span class="at">kernel =</span> kernel_type)</span>
<span id="cb247-761"><a href="simulační-studie-1.html#cb247-761" tabindex="-1"></a>    </span>
<span id="cb247-762"><a href="simulační-studie-1.html#cb247-762" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb247-763"><a href="simulační-studie-1.html#cb247-763" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.train)</span>
<span id="cb247-764"><a href="simulační-studie-1.html#cb247-764" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb247-765"><a href="simulační-studie-1.html#cb247-765" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-766"><a href="simulační-studie-1.html#cb247-766" tabindex="-1"></a>      </span>
<span id="cb247-767"><a href="simulační-studie-1.html#cb247-767" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb247-768"><a href="simulační-studie-1.html#cb247-768" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.test)</span>
<span id="cb247-769"><a href="simulační-studie-1.html#cb247-769" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb247-770"><a href="simulační-studie-1.html#cb247-770" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-771"><a href="simulační-studie-1.html#cb247-771" tabindex="-1"></a>    </span>
<span id="cb247-772"><a href="simulační-studie-1.html#cb247-772" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb247-773"><a href="simulační-studie-1.html#cb247-773" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb247-774"><a href="simulační-studie-1.html#cb247-774" tabindex="-1"></a>  }</span>
<span id="cb247-775"><a href="simulační-studie-1.html#cb247-775" tabindex="-1"></a>  </span>
<span id="cb247-776"><a href="simulační-studie-1.html#cb247-776" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb247-777"><a href="simulační-studie-1.html#cb247-777" tabindex="-1"></a>  </span>
<span id="cb247-778"><a href="simulační-studie-1.html#cb247-778" tabindex="-1"></a>  <span class="do">## 7.5) SVM + RKHS</span></span>
<span id="cb247-779"><a href="simulační-studie-1.html#cb247-779" tabindex="-1"></a>  </span>
<span id="cb247-780"><a href="simulační-studie-1.html#cb247-780" tabindex="-1"></a>  <span class="do">### Gaussovo jadro</span></span>
<span id="cb247-781"><a href="simulační-studie-1.html#cb247-781" tabindex="-1"></a>  </span>
<span id="cb247-782"><a href="simulační-studie-1.html#cb247-782" tabindex="-1"></a>  <span class="co"># jadro a jadrova matice ... Gaussovske s parametrem gamma</span></span>
<span id="cb247-783"><a href="simulační-studie-1.html#cb247-783" tabindex="-1"></a>  Gauss.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, gamma) {</span>
<span id="cb247-784"><a href="simulační-studie-1.html#cb247-784" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>gamma <span class="sc">*</span> <span class="fu">norm</span>(<span class="fu">c</span>(x <span class="sc">-</span> y) <span class="sc">|&gt;</span> <span class="fu">t</span>(), <span class="at">type =</span> <span class="st">&#39;F&#39;</span>)))</span>
<span id="cb247-785"><a href="simulační-studie-1.html#cb247-785" tabindex="-1"></a>  }</span>
<span id="cb247-786"><a href="simulační-studie-1.html#cb247-786" tabindex="-1"></a>  </span>
<span id="cb247-787"><a href="simulační-studie-1.html#cb247-787" tabindex="-1"></a>  Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, gamma) {</span>
<span id="cb247-788"><a href="simulační-studie-1.html#cb247-788" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb247-789"><a href="simulační-studie-1.html#cb247-789" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb247-790"><a href="simulační-studie-1.html#cb247-790" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb247-791"><a href="simulační-studie-1.html#cb247-791" tabindex="-1"></a>        K[i, j] <span class="ot">&lt;-</span> <span class="fu">Gauss.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], <span class="at">gamma =</span> gamma)</span>
<span id="cb247-792"><a href="simulační-studie-1.html#cb247-792" tabindex="-1"></a>      }</span>
<span id="cb247-793"><a href="simulační-studie-1.html#cb247-793" tabindex="-1"></a>    }</span>
<span id="cb247-794"><a href="simulační-studie-1.html#cb247-794" tabindex="-1"></a>    <span class="fu">return</span>(K)</span>
<span id="cb247-795"><a href="simulační-studie-1.html#cb247-795" tabindex="-1"></a>  }</span>
<span id="cb247-796"><a href="simulační-studie-1.html#cb247-796" tabindex="-1"></a>  </span>
<span id="cb247-797"><a href="simulační-studie-1.html#cb247-797" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb247-798"><a href="simulační-studie-1.html#cb247-798" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb247-799"><a href="simulační-studie-1.html#cb247-799" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb247-800"><a href="simulační-studie-1.html#cb247-800" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb247-801"><a href="simulační-studie-1.html#cb247-801" tabindex="-1"></a>  </span>
<span id="cb247-802"><a href="simulační-studie-1.html#cb247-802" tabindex="-1"></a>  <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb247-803"><a href="simulační-studie-1.html#cb247-803" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">40</span>, <span class="at">by =</span><span class="dv">2</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb247-804"><a href="simulační-studie-1.html#cb247-804" tabindex="-1"></a>  gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">15</span>)</span>
<span id="cb247-805"><a href="simulační-studie-1.html#cb247-805" tabindex="-1"></a>  </span>
<span id="cb247-806"><a href="simulační-studie-1.html#cb247-806" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb247-807"><a href="simulační-studie-1.html#cb247-807" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb247-808"><a href="simulační-studie-1.html#cb247-808" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb247-809"><a href="simulační-studie-1.html#cb247-809" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb247-810"><a href="simulační-studie-1.html#cb247-810" tabindex="-1"></a>  dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">gamma =</span> <span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma.cv, <span class="dv">3</span>)),</span>
<span id="cb247-811"><a href="simulační-studie-1.html#cb247-811" tabindex="-1"></a>                    <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb247-812"><a href="simulační-studie-1.html#cb247-812" tabindex="-1"></a>                    <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb247-813"><a href="simulační-studie-1.html#cb247-813" tabindex="-1"></a>  </span>
<span id="cb247-814"><a href="simulační-studie-1.html#cb247-814" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb247-815"><a href="simulační-studie-1.html#cb247-815" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb247-816"><a href="simulační-studie-1.html#cb247-816" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb247-817"><a href="simulační-studie-1.html#cb247-817" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb247-818"><a href="simulační-studie-1.html#cb247-818" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb247-819"><a href="simulační-studie-1.html#cb247-819" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb247-820"><a href="simulační-studie-1.html#cb247-820" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names))</span>
<span id="cb247-821"><a href="simulační-studie-1.html#cb247-821" tabindex="-1"></a>  </span>
<span id="cb247-822"><a href="simulační-studie-1.html#cb247-822" tabindex="-1"></a>  <span class="co"># samotna CV</span></span>
<span id="cb247-823"><a href="simulační-studie-1.html#cb247-823" tabindex="-1"></a>  <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb247-824"><a href="simulační-studie-1.html#cb247-824" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb247-825"><a href="simulační-studie-1.html#cb247-825" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb247-826"><a href="simulační-studie-1.html#cb247-826" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb247-827"><a href="simulační-studie-1.html#cb247-827" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb247-828"><a href="simulační-studie-1.html#cb247-828" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb247-829"><a href="simulační-studie-1.html#cb247-829" tabindex="-1"></a>    </span>
<span id="cb247-830"><a href="simulační-studie-1.html#cb247-830" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb247-831"><a href="simulační-studie-1.html#cb247-831" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb247-832"><a href="simulační-studie-1.html#cb247-832" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb247-833"><a href="simulační-studie-1.html#cb247-833" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb247-834"><a href="simulační-studie-1.html#cb247-834" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb247-835"><a href="simulační-studie-1.html#cb247-835" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb247-836"><a href="simulační-studie-1.html#cb247-836" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb247-837"><a href="simulační-studie-1.html#cb247-837" tabindex="-1"></a>                      <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb247-838"><a href="simulační-studie-1.html#cb247-838" tabindex="-1"></a>                      <span class="at">gamma =</span> gamma)</span>
<span id="cb247-839"><a href="simulační-studie-1.html#cb247-839" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb247-840"><a href="simulační-studie-1.html#cb247-840" tabindex="-1"></a>    }</span>
<span id="cb247-841"><a href="simulační-studie-1.html#cb247-841" tabindex="-1"></a>    </span>
<span id="cb247-842"><a href="simulační-studie-1.html#cb247-842" tabindex="-1"></a>    <span class="co"># projdeme dimenze</span></span>
<span id="cb247-843"><a href="simulační-studie-1.html#cb247-843" tabindex="-1"></a>    <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb247-844"><a href="simulační-studie-1.html#cb247-844" tabindex="-1"></a>      Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb247-845"><a href="simulační-studie-1.html#cb247-845" tabindex="-1"></a>                            <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb247-846"><a href="simulační-studie-1.html#cb247-846" tabindex="-1"></a>                            <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb247-847"><a href="simulační-studie-1.html#cb247-847" tabindex="-1"></a>      <span class="co"># vypocet reprezentace</span></span>
<span id="cb247-848"><a href="simulační-studie-1.html#cb247-848" tabindex="-1"></a>      <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb247-849"><a href="simulační-studie-1.html#cb247-849" tabindex="-1"></a>        Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb247-850"><a href="simulační-studie-1.html#cb247-850" tabindex="-1"></a>                               alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb247-851"><a href="simulační-studie-1.html#cb247-851" tabindex="-1"></a>      }</span>
<span id="cb247-852"><a href="simulační-studie-1.html#cb247-852" tabindex="-1"></a>      <span class="co"># projdeme folds</span></span>
<span id="cb247-853"><a href="simulační-studie-1.html#cb247-853" tabindex="-1"></a>      <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb247-854"><a href="simulační-studie-1.html#cb247-854" tabindex="-1"></a>        <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb247-855"><a href="simulační-studie-1.html#cb247-855" tabindex="-1"></a>        fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb247-856"><a href="simulační-studie-1.html#cb247-856" tabindex="-1"></a>        <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb247-857"><a href="simulační-studie-1.html#cb247-857" tabindex="-1"></a>        XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb247-858"><a href="simulační-studie-1.html#cb247-858" tabindex="-1"></a>        XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb247-859"><a href="simulační-studie-1.html#cb247-859" tabindex="-1"></a>        <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb247-860"><a href="simulační-studie-1.html#cb247-860" tabindex="-1"></a>        Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb247-861"><a href="simulační-studie-1.html#cb247-861" tabindex="-1"></a>                                    <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb247-862"><a href="simulační-studie-1.html#cb247-862" tabindex="-1"></a>                                    <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb247-863"><a href="simulační-studie-1.html#cb247-863" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb247-864"><a href="simulační-studie-1.html#cb247-864" tabindex="-1"></a>        <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb247-865"><a href="simulační-studie-1.html#cb247-865" tabindex="-1"></a>        <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb247-866"><a href="simulační-studie-1.html#cb247-866" tabindex="-1"></a>          kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb247-867"><a href="simulační-studie-1.html#cb247-867" tabindex="-1"></a>        </span>
<span id="cb247-868"><a href="simulační-studie-1.html#cb247-868" tabindex="-1"></a>          data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb247-869"><a href="simulační-studie-1.html#cb247-869" tabindex="-1"></a>          data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb247-870"><a href="simulační-studie-1.html#cb247-870" tabindex="-1"></a>          </span>
<span id="cb247-871"><a href="simulační-studie-1.html#cb247-871" tabindex="-1"></a>          data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb247-872"><a href="simulační-studie-1.html#cb247-872" tabindex="-1"></a>          data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb247-873"><a href="simulační-studie-1.html#cb247-873" tabindex="-1"></a>          </span>
<span id="cb247-874"><a href="simulační-studie-1.html#cb247-874" tabindex="-1"></a>          <span class="co"># sestrojeni modelu</span></span>
<span id="cb247-875"><a href="simulační-studie-1.html#cb247-875" tabindex="-1"></a>          clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb247-876"><a href="simulační-studie-1.html#cb247-876" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb247-877"><a href="simulační-studie-1.html#cb247-877" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb247-878"><a href="simulační-studie-1.html#cb247-878" tabindex="-1"></a>                              <span class="at">kernel =</span> kernel_type)</span>
<span id="cb247-879"><a href="simulační-studie-1.html#cb247-879" tabindex="-1"></a>          </span>
<span id="cb247-880"><a href="simulační-studie-1.html#cb247-880" tabindex="-1"></a>          <span class="co"># presnost na validacnich datech</span></span>
<span id="cb247-881"><a href="simulační-studie-1.html#cb247-881" tabindex="-1"></a>          predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb247-882"><a href="simulační-studie-1.html#cb247-882" tabindex="-1"></a>          presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb247-883"><a href="simulační-studie-1.html#cb247-883" tabindex="-1"></a>            <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-884"><a href="simulační-studie-1.html#cb247-884" tabindex="-1"></a>          </span>
<span id="cb247-885"><a href="simulační-studie-1.html#cb247-885" tabindex="-1"></a>          <span class="co"># ulozeni vysledku</span></span>
<span id="cb247-886"><a href="simulační-studie-1.html#cb247-886" tabindex="-1"></a>          Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb247-887"><a href="simulační-studie-1.html#cb247-887" tabindex="-1"></a>        }</span>
<span id="cb247-888"><a href="simulační-studie-1.html#cb247-888" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb247-889"><a href="simulační-studie-1.html#cb247-889" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb247-890"><a href="simulační-studie-1.html#cb247-890" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb247-891"><a href="simulační-studie-1.html#cb247-891" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb247-892"><a href="simulační-studie-1.html#cb247-892" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb247-893"><a href="simulační-studie-1.html#cb247-893" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb247-894"><a href="simulační-studie-1.html#cb247-894" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb247-895"><a href="simulační-studie-1.html#cb247-895" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb247-896"><a href="simulační-studie-1.html#cb247-896" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb247-897"><a href="simulační-studie-1.html#cb247-897" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb247-898"><a href="simulační-studie-1.html#cb247-898" tabindex="-1"></a>      }</span>
<span id="cb247-899"><a href="simulační-studie-1.html#cb247-899" tabindex="-1"></a>    }</span>
<span id="cb247-900"><a href="simulační-studie-1.html#cb247-900" tabindex="-1"></a>  }</span>
<span id="cb247-901"><a href="simulační-studie-1.html#cb247-901" tabindex="-1"></a>  </span>
<span id="cb247-902"><a href="simulační-studie-1.html#cb247-902" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb247-903"><a href="simulační-studie-1.html#cb247-903" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb247-904"><a href="simulační-studie-1.html#cb247-904" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb247-905"><a href="simulační-studie-1.html#cb247-905" tabindex="-1"></a>  }</span>
<span id="cb247-906"><a href="simulační-studie-1.html#cb247-906" tabindex="-1"></a>  </span>
<span id="cb247-907"><a href="simulační-studie-1.html#cb247-907" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb247-908"><a href="simulační-studie-1.html#cb247-908" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb247-909"><a href="simulační-studie-1.html#cb247-909" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv))</span>
<span id="cb247-910"><a href="simulační-studie-1.html#cb247-910" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.opt)</span>
<span id="cb247-911"><a href="simulační-studie-1.html#cb247-911" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb247-912"><a href="simulační-studie-1.html#cb247-912" tabindex="-1"></a>  </span>
<span id="cb247-913"><a href="simulační-studie-1.html#cb247-913" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb247-914"><a href="simulační-studie-1.html#cb247-914" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb247-915"><a href="simulační-studie-1.html#cb247-915" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb247-916"><a href="simulační-studie-1.html#cb247-916" tabindex="-1"></a>  d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb247-917"><a href="simulační-studie-1.html#cb247-917" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb247-918"><a href="simulační-studie-1.html#cb247-918" tabindex="-1"></a>  </span>
<span id="cb247-919"><a href="simulační-studie-1.html#cb247-919" tabindex="-1"></a>  err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb247-920"><a href="simulační-studie-1.html#cb247-920" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb247-921"><a href="simulační-studie-1.html#cb247-921" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb247-922"><a href="simulační-studie-1.html#cb247-922" tabindex="-1"></a>  df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">gamma =</span> gamma.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb247-923"><a href="simulační-studie-1.html#cb247-923" tabindex="-1"></a>             <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb247-924"><a href="simulační-studie-1.html#cb247-924" tabindex="-1"></a>             <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb247-925"><a href="simulační-studie-1.html#cb247-925" tabindex="-1"></a>  </span>
<span id="cb247-926"><a href="simulační-studie-1.html#cb247-926" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb247-927"><a href="simulační-studie-1.html#cb247-927" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb247-928"><a href="simulační-studie-1.html#cb247-928" tabindex="-1"></a>  <span class="co"># pridame i testovaci data</span></span>
<span id="cb247-929"><a href="simulační-studie-1.html#cb247-929" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb247-930"><a href="simulační-studie-1.html#cb247-930" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb247-931"><a href="simulační-studie-1.html#cb247-931" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, </span>
<span id="cb247-932"><a href="simulační-studie-1.html#cb247-932" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, </span>
<span id="cb247-933"><a href="simulační-studie-1.html#cb247-933" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>), </span>
<span id="cb247-934"><a href="simulační-studie-1.html#cb247-934" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb247-935"><a href="simulační-studie-1.html#cb247-935" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb247-936"><a href="simulační-studie-1.html#cb247-936" tabindex="-1"></a>  </span>
<span id="cb247-937"><a href="simulační-studie-1.html#cb247-937" tabindex="-1"></a>  <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb247-938"><a href="simulační-studie-1.html#cb247-938" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb247-939"><a href="simulační-studie-1.html#cb247-939" tabindex="-1"></a>    <span class="co"># spocitame matici K</span></span>
<span id="cb247-940"><a href="simulační-studie-1.html#cb247-940" tabindex="-1"></a>    gamma <span class="ot">&lt;-</span> gamma.opt[kernel_number] <span class="co"># hodnota gamma pomoci CV</span></span>
<span id="cb247-941"><a href="simulační-studie-1.html#cb247-941" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb247-942"><a href="simulační-studie-1.html#cb247-942" tabindex="-1"></a>    </span>
<span id="cb247-943"><a href="simulační-studie-1.html#cb247-943" tabindex="-1"></a>    <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb247-944"><a href="simulační-studie-1.html#cb247-944" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb247-945"><a href="simulační-studie-1.html#cb247-945" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb247-946"><a href="simulační-studie-1.html#cb247-946" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb247-947"><a href="simulační-studie-1.html#cb247-947" tabindex="-1"></a>    <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb247-948"><a href="simulační-studie-1.html#cb247-948" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb247-949"><a href="simulační-studie-1.html#cb247-949" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb247-950"><a href="simulační-studie-1.html#cb247-950" tabindex="-1"></a>    </span>
<span id="cb247-951"><a href="simulační-studie-1.html#cb247-951" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb247-952"><a href="simulační-studie-1.html#cb247-952" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb247-953"><a href="simulační-studie-1.html#cb247-953" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb247-954"><a href="simulační-studie-1.html#cb247-954" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb247-955"><a href="simulační-studie-1.html#cb247-955" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb247-956"><a href="simulační-studie-1.html#cb247-956" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb247-957"><a href="simulační-studie-1.html#cb247-957" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb247-958"><a href="simulační-studie-1.html#cb247-958" tabindex="-1"></a>                      <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb247-959"><a href="simulační-studie-1.html#cb247-959" tabindex="-1"></a>                      <span class="at">gamma =</span> gamma)</span>
<span id="cb247-960"><a href="simulační-studie-1.html#cb247-960" tabindex="-1"></a>      <span class="co"># urceni alpha</span></span>
<span id="cb247-961"><a href="simulační-studie-1.html#cb247-961" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb247-962"><a href="simulační-studie-1.html#cb247-962" tabindex="-1"></a>    }</span>
<span id="cb247-963"><a href="simulační-studie-1.html#cb247-963" tabindex="-1"></a>    <span class="co"># d</span></span>
<span id="cb247-964"><a href="simulační-studie-1.html#cb247-964" tabindex="-1"></a>    d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb247-965"><a href="simulační-studie-1.html#cb247-965" tabindex="-1"></a>    </span>
<span id="cb247-966"><a href="simulační-studie-1.html#cb247-966" tabindex="-1"></a>    <span class="co"># urceni vektoru lambda</span></span>
<span id="cb247-967"><a href="simulační-studie-1.html#cb247-967" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb247-968"><a href="simulační-studie-1.html#cb247-968" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb247-969"><a href="simulační-studie-1.html#cb247-969" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb247-970"><a href="simulační-studie-1.html#cb247-970" tabindex="-1"></a>    </span>
<span id="cb247-971"><a href="simulační-studie-1.html#cb247-971" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb247-972"><a href="simulační-studie-1.html#cb247-972" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb247-973"><a href="simulační-studie-1.html#cb247-973" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb247-974"><a href="simulační-studie-1.html#cb247-974" tabindex="-1"></a>    }</span>
<span id="cb247-975"><a href="simulační-studie-1.html#cb247-975" tabindex="-1"></a>    </span>
<span id="cb247-976"><a href="simulační-studie-1.html#cb247-976" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb247-977"><a href="simulační-studie-1.html#cb247-977" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb247-978"><a href="simulační-studie-1.html#cb247-978" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb247-979"><a href="simulační-studie-1.html#cb247-979" tabindex="-1"></a>  </span>
<span id="cb247-980"><a href="simulační-studie-1.html#cb247-980" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb247-981"><a href="simulační-studie-1.html#cb247-981" tabindex="-1"></a>  </span>
<span id="cb247-982"><a href="simulační-studie-1.html#cb247-982" tabindex="-1"></a>    data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb247-983"><a href="simulační-studie-1.html#cb247-983" tabindex="-1"></a>    data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb247-984"><a href="simulační-studie-1.html#cb247-984" tabindex="-1"></a>    </span>
<span id="cb247-985"><a href="simulační-studie-1.html#cb247-985" tabindex="-1"></a>    data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb247-986"><a href="simulační-studie-1.html#cb247-986" tabindex="-1"></a>    data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb247-987"><a href="simulační-studie-1.html#cb247-987" tabindex="-1"></a>    </span>
<span id="cb247-988"><a href="simulační-studie-1.html#cb247-988" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb247-989"><a href="simulační-studie-1.html#cb247-989" tabindex="-1"></a>    clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb247-990"><a href="simulační-studie-1.html#cb247-990" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb247-991"><a href="simulační-studie-1.html#cb247-991" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb247-992"><a href="simulační-studie-1.html#cb247-992" tabindex="-1"></a>                        <span class="at">kernel =</span> kernel_type)</span>
<span id="cb247-993"><a href="simulační-studie-1.html#cb247-993" tabindex="-1"></a>    </span>
<span id="cb247-994"><a href="simulační-studie-1.html#cb247-994" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb247-995"><a href="simulační-studie-1.html#cb247-995" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb247-996"><a href="simulační-studie-1.html#cb247-996" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb247-997"><a href="simulační-studie-1.html#cb247-997" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-998"><a href="simulační-studie-1.html#cb247-998" tabindex="-1"></a>      </span>
<span id="cb247-999"><a href="simulační-studie-1.html#cb247-999" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb247-1000"><a href="simulační-studie-1.html#cb247-1000" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb247-1001"><a href="simulační-studie-1.html#cb247-1001" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb247-1002"><a href="simulační-studie-1.html#cb247-1002" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-1003"><a href="simulační-studie-1.html#cb247-1003" tabindex="-1"></a>    </span>
<span id="cb247-1004"><a href="simulační-studie-1.html#cb247-1004" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb247-1005"><a href="simulační-studie-1.html#cb247-1005" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb247-1006"><a href="simulační-studie-1.html#cb247-1006" tabindex="-1"></a>  }</span>
<span id="cb247-1007"><a href="simulační-studie-1.html#cb247-1007" tabindex="-1"></a>  </span>
<span id="cb247-1008"><a href="simulační-studie-1.html#cb247-1008" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb247-1009"><a href="simulační-studie-1.html#cb247-1009" tabindex="-1"></a></span>
<span id="cb247-1010"><a href="simulační-studie-1.html#cb247-1010" tabindex="-1"></a>  <span class="do">### Polynomialni jadro</span></span>
<span id="cb247-1011"><a href="simulační-studie-1.html#cb247-1011" tabindex="-1"></a>  </span>
<span id="cb247-1012"><a href="simulační-studie-1.html#cb247-1012" tabindex="-1"></a>  <span class="co"># jadro a jadrova matice ... polynomialni s parametrem p</span></span>
<span id="cb247-1013"><a href="simulační-studie-1.html#cb247-1013" tabindex="-1"></a>  Poly.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, p) {</span>
<span id="cb247-1014"><a href="simulační-studie-1.html#cb247-1014" tabindex="-1"></a>    <span class="fu">return</span>((<span class="dv">1</span> <span class="sc">+</span> x <span class="sc">*</span> y)<span class="sc">^</span>p)</span>
<span id="cb247-1015"><a href="simulační-studie-1.html#cb247-1015" tabindex="-1"></a>  }</span>
<span id="cb247-1016"><a href="simulační-studie-1.html#cb247-1016" tabindex="-1"></a>  </span>
<span id="cb247-1017"><a href="simulační-studie-1.html#cb247-1017" tabindex="-1"></a>  Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, p) {</span>
<span id="cb247-1018"><a href="simulační-studie-1.html#cb247-1018" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb247-1019"><a href="simulační-studie-1.html#cb247-1019" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb247-1020"><a href="simulační-studie-1.html#cb247-1020" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb247-1021"><a href="simulační-studie-1.html#cb247-1021" tabindex="-1"></a>        K[i, j] <span class="ot">&lt;-</span> <span class="fu">Poly.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], p)</span>
<span id="cb247-1022"><a href="simulační-studie-1.html#cb247-1022" tabindex="-1"></a>      }</span>
<span id="cb247-1023"><a href="simulační-studie-1.html#cb247-1023" tabindex="-1"></a>    }</span>
<span id="cb247-1024"><a href="simulační-studie-1.html#cb247-1024" tabindex="-1"></a>    <span class="fu">return</span>(K)</span>
<span id="cb247-1025"><a href="simulační-studie-1.html#cb247-1025" tabindex="-1"></a>  }</span>
<span id="cb247-1026"><a href="simulační-studie-1.html#cb247-1026" tabindex="-1"></a>  </span>
<span id="cb247-1027"><a href="simulační-studie-1.html#cb247-1027" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb247-1028"><a href="simulační-studie-1.html#cb247-1028" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb247-1029"><a href="simulační-studie-1.html#cb247-1029" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb247-1030"><a href="simulační-studie-1.html#cb247-1030" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb247-1031"><a href="simulační-studie-1.html#cb247-1031" tabindex="-1"></a>  </span>
<span id="cb247-1032"><a href="simulační-studie-1.html#cb247-1032" tabindex="-1"></a>  <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb247-1033"><a href="simulační-studie-1.html#cb247-1033" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">2</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb247-1034"><a href="simulační-studie-1.html#cb247-1034" tabindex="-1"></a>  poly.cv <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb247-1035"><a href="simulační-studie-1.html#cb247-1035" tabindex="-1"></a>  </span>
<span id="cb247-1036"><a href="simulační-studie-1.html#cb247-1036" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb247-1037"><a href="simulační-studie-1.html#cb247-1037" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb247-1038"><a href="simulační-studie-1.html#cb247-1038" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb247-1039"><a href="simulační-studie-1.html#cb247-1039" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro dane p a vrstvy odpovidaji folds</span></span>
<span id="cb247-1040"><a href="simulační-studie-1.html#cb247-1040" tabindex="-1"></a>  dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, poly.cv),</span>
<span id="cb247-1041"><a href="simulační-studie-1.html#cb247-1041" tabindex="-1"></a>                    <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb247-1042"><a href="simulační-studie-1.html#cb247-1042" tabindex="-1"></a>                    <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb247-1043"><a href="simulační-studie-1.html#cb247-1043" tabindex="-1"></a>  </span>
<span id="cb247-1044"><a href="simulační-studie-1.html#cb247-1044" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb247-1045"><a href="simulační-studie-1.html#cb247-1045" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb247-1046"><a href="simulační-studie-1.html#cb247-1046" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb247-1047"><a href="simulační-studie-1.html#cb247-1047" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb247-1048"><a href="simulační-studie-1.html#cb247-1048" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb247-1049"><a href="simulační-studie-1.html#cb247-1049" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb247-1050"><a href="simulační-studie-1.html#cb247-1050" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names))</span>
<span id="cb247-1051"><a href="simulační-studie-1.html#cb247-1051" tabindex="-1"></a>  </span>
<span id="cb247-1052"><a href="simulační-studie-1.html#cb247-1052" tabindex="-1"></a>  <span class="co"># samotna CV</span></span>
<span id="cb247-1053"><a href="simulační-studie-1.html#cb247-1053" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> poly.cv) {</span>
<span id="cb247-1054"><a href="simulační-studie-1.html#cb247-1054" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb247-1055"><a href="simulační-studie-1.html#cb247-1055" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb247-1056"><a href="simulační-studie-1.html#cb247-1056" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb247-1057"><a href="simulační-studie-1.html#cb247-1057" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb247-1058"><a href="simulační-studie-1.html#cb247-1058" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb247-1059"><a href="simulační-studie-1.html#cb247-1059" tabindex="-1"></a>    </span>
<span id="cb247-1060"><a href="simulační-studie-1.html#cb247-1060" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb247-1061"><a href="simulační-studie-1.html#cb247-1061" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb247-1062"><a href="simulační-studie-1.html#cb247-1062" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb247-1063"><a href="simulační-studie-1.html#cb247-1063" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb247-1064"><a href="simulační-studie-1.html#cb247-1064" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb247-1065"><a href="simulační-studie-1.html#cb247-1065" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb247-1066"><a href="simulační-studie-1.html#cb247-1066" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb247-1067"><a href="simulační-studie-1.html#cb247-1067" tabindex="-1"></a>                      <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb247-1068"><a href="simulační-studie-1.html#cb247-1068" tabindex="-1"></a>                      <span class="at">degree =</span> p)</span>
<span id="cb247-1069"><a href="simulační-studie-1.html#cb247-1069" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb247-1070"><a href="simulační-studie-1.html#cb247-1070" tabindex="-1"></a>    }</span>
<span id="cb247-1071"><a href="simulační-studie-1.html#cb247-1071" tabindex="-1"></a>    </span>
<span id="cb247-1072"><a href="simulační-studie-1.html#cb247-1072" tabindex="-1"></a>    <span class="co"># projdeme dimenze</span></span>
<span id="cb247-1073"><a href="simulační-studie-1.html#cb247-1073" tabindex="-1"></a>    <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb247-1074"><a href="simulační-studie-1.html#cb247-1074" tabindex="-1"></a>      Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb247-1075"><a href="simulační-studie-1.html#cb247-1075" tabindex="-1"></a>                            <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb247-1076"><a href="simulační-studie-1.html#cb247-1076" tabindex="-1"></a>                            <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb247-1077"><a href="simulační-studie-1.html#cb247-1077" tabindex="-1"></a>      <span class="co"># vypocet reprezentace</span></span>
<span id="cb247-1078"><a href="simulační-studie-1.html#cb247-1078" tabindex="-1"></a>      <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb247-1079"><a href="simulační-studie-1.html#cb247-1079" tabindex="-1"></a>        Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb247-1080"><a href="simulační-studie-1.html#cb247-1080" tabindex="-1"></a>                               alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb247-1081"><a href="simulační-studie-1.html#cb247-1081" tabindex="-1"></a>      }</span>
<span id="cb247-1082"><a href="simulační-studie-1.html#cb247-1082" tabindex="-1"></a>      <span class="co"># projdeme folds</span></span>
<span id="cb247-1083"><a href="simulační-studie-1.html#cb247-1083" tabindex="-1"></a>      <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb247-1084"><a href="simulační-studie-1.html#cb247-1084" tabindex="-1"></a>        <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb247-1085"><a href="simulační-studie-1.html#cb247-1085" tabindex="-1"></a>        fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb247-1086"><a href="simulační-studie-1.html#cb247-1086" tabindex="-1"></a>        <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb247-1087"><a href="simulační-studie-1.html#cb247-1087" tabindex="-1"></a>        XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb247-1088"><a href="simulační-studie-1.html#cb247-1088" tabindex="-1"></a>        XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb247-1089"><a href="simulační-studie-1.html#cb247-1089" tabindex="-1"></a>        <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb247-1090"><a href="simulační-studie-1.html#cb247-1090" tabindex="-1"></a>        Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb247-1091"><a href="simulační-studie-1.html#cb247-1091" tabindex="-1"></a>                                    <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb247-1092"><a href="simulační-studie-1.html#cb247-1092" tabindex="-1"></a>                                    <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb247-1093"><a href="simulační-studie-1.html#cb247-1093" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb247-1094"><a href="simulační-studie-1.html#cb247-1094" tabindex="-1"></a>        <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb247-1095"><a href="simulační-studie-1.html#cb247-1095" tabindex="-1"></a>        <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb247-1096"><a href="simulační-studie-1.html#cb247-1096" tabindex="-1"></a>          kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb247-1097"><a href="simulační-studie-1.html#cb247-1097" tabindex="-1"></a>        </span>
<span id="cb247-1098"><a href="simulační-studie-1.html#cb247-1098" tabindex="-1"></a>          data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb247-1099"><a href="simulační-studie-1.html#cb247-1099" tabindex="-1"></a>          data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb247-1100"><a href="simulační-studie-1.html#cb247-1100" tabindex="-1"></a>          </span>
<span id="cb247-1101"><a href="simulační-studie-1.html#cb247-1101" tabindex="-1"></a>          data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb247-1102"><a href="simulační-studie-1.html#cb247-1102" tabindex="-1"></a>          data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb247-1103"><a href="simulační-studie-1.html#cb247-1103" tabindex="-1"></a>          </span>
<span id="cb247-1104"><a href="simulační-studie-1.html#cb247-1104" tabindex="-1"></a>          <span class="co"># sestrojeni modelu</span></span>
<span id="cb247-1105"><a href="simulační-studie-1.html#cb247-1105" tabindex="-1"></a>          clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb247-1106"><a href="simulační-studie-1.html#cb247-1106" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb247-1107"><a href="simulační-studie-1.html#cb247-1107" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb247-1108"><a href="simulační-studie-1.html#cb247-1108" tabindex="-1"></a>                              <span class="at">kernel =</span> kernel_type)</span>
<span id="cb247-1109"><a href="simulační-studie-1.html#cb247-1109" tabindex="-1"></a>          </span>
<span id="cb247-1110"><a href="simulační-studie-1.html#cb247-1110" tabindex="-1"></a>          <span class="co"># presnost na validacnich datech</span></span>
<span id="cb247-1111"><a href="simulační-studie-1.html#cb247-1111" tabindex="-1"></a>          predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb247-1112"><a href="simulační-studie-1.html#cb247-1112" tabindex="-1"></a>          presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb247-1113"><a href="simulační-studie-1.html#cb247-1113" tabindex="-1"></a>            <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-1114"><a href="simulační-studie-1.html#cb247-1114" tabindex="-1"></a>          </span>
<span id="cb247-1115"><a href="simulační-studie-1.html#cb247-1115" tabindex="-1"></a>          <span class="co"># ulozeni vysledku</span></span>
<span id="cb247-1116"><a href="simulační-studie-1.html#cb247-1116" tabindex="-1"></a>          Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb247-1117"><a href="simulační-studie-1.html#cb247-1117" tabindex="-1"></a>        }</span>
<span id="cb247-1118"><a href="simulační-studie-1.html#cb247-1118" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb247-1119"><a href="simulační-studie-1.html#cb247-1119" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb247-1120"><a href="simulační-studie-1.html#cb247-1120" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb247-1121"><a href="simulační-studie-1.html#cb247-1121" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb247-1122"><a href="simulační-studie-1.html#cb247-1122" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb247-1123"><a href="simulační-studie-1.html#cb247-1123" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb247-1124"><a href="simulační-studie-1.html#cb247-1124" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb247-1125"><a href="simulační-studie-1.html#cb247-1125" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb247-1126"><a href="simulační-studie-1.html#cb247-1126" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb247-1127"><a href="simulační-studie-1.html#cb247-1127" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb247-1128"><a href="simulační-studie-1.html#cb247-1128" tabindex="-1"></a>      }</span>
<span id="cb247-1129"><a href="simulační-studie-1.html#cb247-1129" tabindex="-1"></a>    }</span>
<span id="cb247-1130"><a href="simulační-studie-1.html#cb247-1130" tabindex="-1"></a>  }</span>
<span id="cb247-1131"><a href="simulační-studie-1.html#cb247-1131" tabindex="-1"></a>  </span>
<span id="cb247-1132"><a href="simulační-studie-1.html#cb247-1132" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb247-1133"><a href="simulační-studie-1.html#cb247-1133" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb247-1134"><a href="simulační-studie-1.html#cb247-1134" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb247-1135"><a href="simulační-studie-1.html#cb247-1135" tabindex="-1"></a>  }</span>
<span id="cb247-1136"><a href="simulační-studie-1.html#cb247-1136" tabindex="-1"></a>  </span>
<span id="cb247-1137"><a href="simulační-studie-1.html#cb247-1137" tabindex="-1"></a>  poly.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb247-1138"><a href="simulační-studie-1.html#cb247-1138" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb247-1139"><a href="simulační-studie-1.html#cb247-1139" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv))</span>
<span id="cb247-1140"><a href="simulační-studie-1.html#cb247-1140" tabindex="-1"></a>  poly.opt[poly.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(poly.opt)</span>
<span id="cb247-1141"><a href="simulační-studie-1.html#cb247-1141" tabindex="-1"></a>  poly.opt <span class="ot">&lt;-</span> poly.cv[poly.opt]</span>
<span id="cb247-1142"><a href="simulační-studie-1.html#cb247-1142" tabindex="-1"></a>  </span>
<span id="cb247-1143"><a href="simulační-studie-1.html#cb247-1143" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb247-1144"><a href="simulační-studie-1.html#cb247-1144" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb247-1145"><a href="simulační-studie-1.html#cb247-1145" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb247-1146"><a href="simulační-studie-1.html#cb247-1146" tabindex="-1"></a>  d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb247-1147"><a href="simulační-studie-1.html#cb247-1147" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb247-1148"><a href="simulační-studie-1.html#cb247-1148" tabindex="-1"></a>  </span>
<span id="cb247-1149"><a href="simulační-studie-1.html#cb247-1149" tabindex="-1"></a>  err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb247-1150"><a href="simulační-studie-1.html#cb247-1150" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb247-1151"><a href="simulační-studie-1.html#cb247-1151" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb247-1152"><a href="simulační-studie-1.html#cb247-1152" tabindex="-1"></a>  df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">p =</span> poly.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb247-1153"><a href="simulační-studie-1.html#cb247-1153" tabindex="-1"></a>             <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb247-1154"><a href="simulační-studie-1.html#cb247-1154" tabindex="-1"></a>             <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb247-1155"><a href="simulační-studie-1.html#cb247-1155" tabindex="-1"></a>  </span>
<span id="cb247-1156"><a href="simulační-studie-1.html#cb247-1156" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb247-1157"><a href="simulační-studie-1.html#cb247-1157" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb247-1158"><a href="simulační-studie-1.html#cb247-1158" tabindex="-1"></a>  <span class="co"># pridame i testovaci data</span></span>
<span id="cb247-1159"><a href="simulační-studie-1.html#cb247-1159" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb247-1160"><a href="simulační-studie-1.html#cb247-1160" tabindex="-1"></a>  </span>
<span id="cb247-1161"><a href="simulační-studie-1.html#cb247-1161" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb247-1162"><a href="simulační-studie-1.html#cb247-1162" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - poly&#39;</span>, </span>
<span id="cb247-1163"><a href="simulační-studie-1.html#cb247-1163" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - RKHS - poly&#39;</span>, </span>
<span id="cb247-1164"><a href="simulační-studie-1.html#cb247-1164" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - RKHS - poly&#39;</span>), </span>
<span id="cb247-1165"><a href="simulační-studie-1.html#cb247-1165" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb247-1166"><a href="simulační-studie-1.html#cb247-1166" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb247-1167"><a href="simulační-studie-1.html#cb247-1167" tabindex="-1"></a>  </span>
<span id="cb247-1168"><a href="simulační-studie-1.html#cb247-1168" tabindex="-1"></a>  <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb247-1169"><a href="simulační-studie-1.html#cb247-1169" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb247-1170"><a href="simulační-studie-1.html#cb247-1170" tabindex="-1"></a>    <span class="co"># spocitame matici K</span></span>
<span id="cb247-1171"><a href="simulační-studie-1.html#cb247-1171" tabindex="-1"></a>    p <span class="ot">&lt;-</span> poly.opt[kernel_number] <span class="co"># hodnota gamma pomoci CV</span></span>
<span id="cb247-1172"><a href="simulační-studie-1.html#cb247-1172" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb247-1173"><a href="simulační-studie-1.html#cb247-1173" tabindex="-1"></a>    </span>
<span id="cb247-1174"><a href="simulační-studie-1.html#cb247-1174" tabindex="-1"></a>    <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb247-1175"><a href="simulační-studie-1.html#cb247-1175" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb247-1176"><a href="simulační-studie-1.html#cb247-1176" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb247-1177"><a href="simulační-studie-1.html#cb247-1177" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb247-1178"><a href="simulační-studie-1.html#cb247-1178" tabindex="-1"></a>    <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb247-1179"><a href="simulační-studie-1.html#cb247-1179" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb247-1180"><a href="simulační-studie-1.html#cb247-1180" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb247-1181"><a href="simulační-studie-1.html#cb247-1181" tabindex="-1"></a>    </span>
<span id="cb247-1182"><a href="simulační-studie-1.html#cb247-1182" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb247-1183"><a href="simulační-studie-1.html#cb247-1183" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb247-1184"><a href="simulační-studie-1.html#cb247-1184" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb247-1185"><a href="simulační-studie-1.html#cb247-1185" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb247-1186"><a href="simulační-studie-1.html#cb247-1186" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb247-1187"><a href="simulační-studie-1.html#cb247-1187" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb247-1188"><a href="simulační-studie-1.html#cb247-1188" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb247-1189"><a href="simulační-studie-1.html#cb247-1189" tabindex="-1"></a>                      <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb247-1190"><a href="simulační-studie-1.html#cb247-1190" tabindex="-1"></a>                      <span class="at">degree =</span> p)</span>
<span id="cb247-1191"><a href="simulační-studie-1.html#cb247-1191" tabindex="-1"></a>      <span class="co"># urceni alpha</span></span>
<span id="cb247-1192"><a href="simulační-studie-1.html#cb247-1192" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb247-1193"><a href="simulační-studie-1.html#cb247-1193" tabindex="-1"></a>    }</span>
<span id="cb247-1194"><a href="simulační-studie-1.html#cb247-1194" tabindex="-1"></a>    <span class="co"># d</span></span>
<span id="cb247-1195"><a href="simulační-studie-1.html#cb247-1195" tabindex="-1"></a>    d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb247-1196"><a href="simulační-studie-1.html#cb247-1196" tabindex="-1"></a>    </span>
<span id="cb247-1197"><a href="simulační-studie-1.html#cb247-1197" tabindex="-1"></a>    <span class="co"># urceni vektoru lambda</span></span>
<span id="cb247-1198"><a href="simulační-studie-1.html#cb247-1198" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb247-1199"><a href="simulační-studie-1.html#cb247-1199" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb247-1200"><a href="simulační-studie-1.html#cb247-1200" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb247-1201"><a href="simulační-studie-1.html#cb247-1201" tabindex="-1"></a>    </span>
<span id="cb247-1202"><a href="simulační-studie-1.html#cb247-1202" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb247-1203"><a href="simulační-studie-1.html#cb247-1203" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb247-1204"><a href="simulační-studie-1.html#cb247-1204" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb247-1205"><a href="simulační-studie-1.html#cb247-1205" tabindex="-1"></a>    }</span>
<span id="cb247-1206"><a href="simulační-studie-1.html#cb247-1206" tabindex="-1"></a>    </span>
<span id="cb247-1207"><a href="simulační-studie-1.html#cb247-1207" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb247-1208"><a href="simulační-studie-1.html#cb247-1208" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb247-1209"><a href="simulační-studie-1.html#cb247-1209" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb247-1210"><a href="simulační-studie-1.html#cb247-1210" tabindex="-1"></a>  </span>
<span id="cb247-1211"><a href="simulační-studie-1.html#cb247-1211" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb247-1212"><a href="simulační-studie-1.html#cb247-1212" tabindex="-1"></a>  </span>
<span id="cb247-1213"><a href="simulační-studie-1.html#cb247-1213" tabindex="-1"></a>    data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb247-1214"><a href="simulační-studie-1.html#cb247-1214" tabindex="-1"></a>    data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb247-1215"><a href="simulační-studie-1.html#cb247-1215" tabindex="-1"></a>    </span>
<span id="cb247-1216"><a href="simulační-studie-1.html#cb247-1216" tabindex="-1"></a>    data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb247-1217"><a href="simulační-studie-1.html#cb247-1217" tabindex="-1"></a>    data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb247-1218"><a href="simulační-studie-1.html#cb247-1218" tabindex="-1"></a>    </span>
<span id="cb247-1219"><a href="simulační-studie-1.html#cb247-1219" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb247-1220"><a href="simulační-studie-1.html#cb247-1220" tabindex="-1"></a>    clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb247-1221"><a href="simulační-studie-1.html#cb247-1221" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb247-1222"><a href="simulační-studie-1.html#cb247-1222" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb247-1223"><a href="simulační-studie-1.html#cb247-1223" tabindex="-1"></a>                        <span class="at">kernel =</span> kernel_type)</span>
<span id="cb247-1224"><a href="simulační-studie-1.html#cb247-1224" tabindex="-1"></a>    </span>
<span id="cb247-1225"><a href="simulační-studie-1.html#cb247-1225" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb247-1226"><a href="simulační-studie-1.html#cb247-1226" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb247-1227"><a href="simulační-studie-1.html#cb247-1227" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb247-1228"><a href="simulační-studie-1.html#cb247-1228" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-1229"><a href="simulační-studie-1.html#cb247-1229" tabindex="-1"></a>      </span>
<span id="cb247-1230"><a href="simulační-studie-1.html#cb247-1230" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb247-1231"><a href="simulační-studie-1.html#cb247-1231" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb247-1232"><a href="simulační-studie-1.html#cb247-1232" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb247-1233"><a href="simulační-studie-1.html#cb247-1233" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-1234"><a href="simulační-studie-1.html#cb247-1234" tabindex="-1"></a>    </span>
<span id="cb247-1235"><a href="simulační-studie-1.html#cb247-1235" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb247-1236"><a href="simulační-studie-1.html#cb247-1236" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb247-1237"><a href="simulační-studie-1.html#cb247-1237" tabindex="-1"></a>  }</span>
<span id="cb247-1238"><a href="simulační-studie-1.html#cb247-1238" tabindex="-1"></a>  </span>
<span id="cb247-1239"><a href="simulační-studie-1.html#cb247-1239" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb247-1240"><a href="simulační-studie-1.html#cb247-1240" tabindex="-1"></a>  </span>
<span id="cb247-1241"><a href="simulační-studie-1.html#cb247-1241" tabindex="-1"></a>  <span class="do">### Linearni jadro</span></span>
<span id="cb247-1242"><a href="simulační-studie-1.html#cb247-1242" tabindex="-1"></a>  </span>
<span id="cb247-1243"><a href="simulační-studie-1.html#cb247-1243" tabindex="-1"></a>  <span class="co"># jadro a jadrova matice ... polynomialni s parametrem p</span></span>
<span id="cb247-1244"><a href="simulační-studie-1.html#cb247-1244" tabindex="-1"></a>  Linear.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb247-1245"><a href="simulační-studie-1.html#cb247-1245" tabindex="-1"></a>    <span class="fu">return</span>(x <span class="sc">*</span> y)</span>
<span id="cb247-1246"><a href="simulační-studie-1.html#cb247-1246" tabindex="-1"></a>  }</span>
<span id="cb247-1247"><a href="simulační-studie-1.html#cb247-1247" tabindex="-1"></a>  </span>
<span id="cb247-1248"><a href="simulační-studie-1.html#cb247-1248" tabindex="-1"></a>  Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb247-1249"><a href="simulační-studie-1.html#cb247-1249" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb247-1250"><a href="simulační-studie-1.html#cb247-1250" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb247-1251"><a href="simulační-studie-1.html#cb247-1251" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb247-1252"><a href="simulační-studie-1.html#cb247-1252" tabindex="-1"></a>        K[i, j] <span class="ot">&lt;-</span> <span class="fu">Linear.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j])</span>
<span id="cb247-1253"><a href="simulační-studie-1.html#cb247-1253" tabindex="-1"></a>      }</span>
<span id="cb247-1254"><a href="simulační-studie-1.html#cb247-1254" tabindex="-1"></a>    }</span>
<span id="cb247-1255"><a href="simulační-studie-1.html#cb247-1255" tabindex="-1"></a>    <span class="fu">return</span>(K)</span>
<span id="cb247-1256"><a href="simulační-studie-1.html#cb247-1256" tabindex="-1"></a>  }</span>
<span id="cb247-1257"><a href="simulační-studie-1.html#cb247-1257" tabindex="-1"></a>  </span>
<span id="cb247-1258"><a href="simulační-studie-1.html#cb247-1258" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb247-1259"><a href="simulační-studie-1.html#cb247-1259" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb247-1260"><a href="simulační-studie-1.html#cb247-1260" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb247-1261"><a href="simulační-studie-1.html#cb247-1261" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb247-1262"><a href="simulační-studie-1.html#cb247-1262" tabindex="-1"></a>  </span>
<span id="cb247-1263"><a href="simulační-studie-1.html#cb247-1263" tabindex="-1"></a>  <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb247-1264"><a href="simulační-studie-1.html#cb247-1264" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">2</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb247-1265"><a href="simulační-studie-1.html#cb247-1265" tabindex="-1"></a>  </span>
<span id="cb247-1266"><a href="simulační-studie-1.html#cb247-1266" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb247-1267"><a href="simulační-studie-1.html#cb247-1267" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb247-1268"><a href="simulační-studie-1.html#cb247-1268" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane d</span></span>
<span id="cb247-1269"><a href="simulační-studie-1.html#cb247-1269" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro vrstvy odpovidaji folds</span></span>
<span id="cb247-1270"><a href="simulační-studie-1.html#cb247-1270" tabindex="-1"></a>  dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb247-1271"><a href="simulační-studie-1.html#cb247-1271" tabindex="-1"></a>                    <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb247-1272"><a href="simulační-studie-1.html#cb247-1272" tabindex="-1"></a>  </span>
<span id="cb247-1273"><a href="simulační-studie-1.html#cb247-1273" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb247-1274"><a href="simulační-studie-1.html#cb247-1274" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb247-1275"><a href="simulační-studie-1.html#cb247-1275" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb247-1276"><a href="simulační-studie-1.html#cb247-1276" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb247-1277"><a href="simulační-studie-1.html#cb247-1277" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb247-1278"><a href="simulační-studie-1.html#cb247-1278" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb247-1279"><a href="simulační-studie-1.html#cb247-1279" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names))</span>
<span id="cb247-1280"><a href="simulační-studie-1.html#cb247-1280" tabindex="-1"></a>  </span>
<span id="cb247-1281"><a href="simulační-studie-1.html#cb247-1281" tabindex="-1"></a>  <span class="co"># samotna CV</span></span>
<span id="cb247-1282"><a href="simulační-studie-1.html#cb247-1282" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb247-1283"><a href="simulační-studie-1.html#cb247-1283" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb247-1284"><a href="simulační-studie-1.html#cb247-1284" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb247-1285"><a href="simulační-studie-1.html#cb247-1285" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb247-1286"><a href="simulační-studie-1.html#cb247-1286" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb247-1287"><a href="simulační-studie-1.html#cb247-1287" tabindex="-1"></a>  </span>
<span id="cb247-1288"><a href="simulační-studie-1.html#cb247-1288" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb247-1289"><a href="simulační-studie-1.html#cb247-1289" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb247-1290"><a href="simulační-studie-1.html#cb247-1290" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb247-1291"><a href="simulační-studie-1.html#cb247-1291" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb247-1292"><a href="simulační-studie-1.html#cb247-1292" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb247-1293"><a href="simulační-studie-1.html#cb247-1293" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb247-1294"><a href="simulační-studie-1.html#cb247-1294" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb247-1295"><a href="simulační-studie-1.html#cb247-1295" tabindex="-1"></a>                    <span class="at">epsilon =</span> <span class="fl">0.1</span>)</span>
<span id="cb247-1296"><a href="simulační-studie-1.html#cb247-1296" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb247-1297"><a href="simulační-studie-1.html#cb247-1297" tabindex="-1"></a>  }</span>
<span id="cb247-1298"><a href="simulační-studie-1.html#cb247-1298" tabindex="-1"></a>  </span>
<span id="cb247-1299"><a href="simulační-studie-1.html#cb247-1299" tabindex="-1"></a>  <span class="co"># projdeme dimenze</span></span>
<span id="cb247-1300"><a href="simulační-studie-1.html#cb247-1300" tabindex="-1"></a>  <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb247-1301"><a href="simulační-studie-1.html#cb247-1301" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb247-1302"><a href="simulační-studie-1.html#cb247-1302" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb247-1303"><a href="simulační-studie-1.html#cb247-1303" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb247-1304"><a href="simulační-studie-1.html#cb247-1304" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb247-1305"><a href="simulační-studie-1.html#cb247-1305" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb247-1306"><a href="simulační-studie-1.html#cb247-1306" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb247-1307"><a href="simulační-studie-1.html#cb247-1307" tabindex="-1"></a>                             alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb247-1308"><a href="simulační-studie-1.html#cb247-1308" tabindex="-1"></a>    }</span>
<span id="cb247-1309"><a href="simulační-studie-1.html#cb247-1309" tabindex="-1"></a>    <span class="co"># projdeme folds</span></span>
<span id="cb247-1310"><a href="simulační-studie-1.html#cb247-1310" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb247-1311"><a href="simulační-studie-1.html#cb247-1311" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb247-1312"><a href="simulační-studie-1.html#cb247-1312" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb247-1313"><a href="simulační-studie-1.html#cb247-1313" tabindex="-1"></a>      <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb247-1314"><a href="simulační-studie-1.html#cb247-1314" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb247-1315"><a href="simulační-studie-1.html#cb247-1315" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb247-1316"><a href="simulační-studie-1.html#cb247-1316" tabindex="-1"></a>      <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb247-1317"><a href="simulační-studie-1.html#cb247-1317" tabindex="-1"></a>      Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb247-1318"><a href="simulační-studie-1.html#cb247-1318" tabindex="-1"></a>                                  <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb247-1319"><a href="simulační-studie-1.html#cb247-1319" tabindex="-1"></a>                                  <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb247-1320"><a href="simulační-studie-1.html#cb247-1320" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb247-1321"><a href="simulační-studie-1.html#cb247-1321" tabindex="-1"></a>      <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb247-1322"><a href="simulační-studie-1.html#cb247-1322" tabindex="-1"></a>      <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb247-1323"><a href="simulační-studie-1.html#cb247-1323" tabindex="-1"></a>        kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb247-1324"><a href="simulační-studie-1.html#cb247-1324" tabindex="-1"></a>      </span>
<span id="cb247-1325"><a href="simulační-studie-1.html#cb247-1325" tabindex="-1"></a>        data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb247-1326"><a href="simulační-studie-1.html#cb247-1326" tabindex="-1"></a>        data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb247-1327"><a href="simulační-studie-1.html#cb247-1327" tabindex="-1"></a>        </span>
<span id="cb247-1328"><a href="simulační-studie-1.html#cb247-1328" tabindex="-1"></a>        data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb247-1329"><a href="simulační-studie-1.html#cb247-1329" tabindex="-1"></a>        data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb247-1330"><a href="simulační-studie-1.html#cb247-1330" tabindex="-1"></a>        </span>
<span id="cb247-1331"><a href="simulační-studie-1.html#cb247-1331" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb247-1332"><a href="simulační-studie-1.html#cb247-1332" tabindex="-1"></a>        clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb247-1333"><a href="simulační-studie-1.html#cb247-1333" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb247-1334"><a href="simulační-studie-1.html#cb247-1334" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb247-1335"><a href="simulační-studie-1.html#cb247-1335" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb247-1336"><a href="simulační-studie-1.html#cb247-1336" tabindex="-1"></a>        </span>
<span id="cb247-1337"><a href="simulační-studie-1.html#cb247-1337" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb247-1338"><a href="simulační-studie-1.html#cb247-1338" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb247-1339"><a href="simulační-studie-1.html#cb247-1339" tabindex="-1"></a>        presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb247-1340"><a href="simulační-studie-1.html#cb247-1340" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-1341"><a href="simulační-studie-1.html#cb247-1341" tabindex="-1"></a>        </span>
<span id="cb247-1342"><a href="simulační-studie-1.html#cb247-1342" tabindex="-1"></a>        <span class="co"># ulozeni vysledku</span></span>
<span id="cb247-1343"><a href="simulační-studie-1.html#cb247-1343" tabindex="-1"></a>        Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb247-1344"><a href="simulační-studie-1.html#cb247-1344" tabindex="-1"></a>      }</span>
<span id="cb247-1345"><a href="simulační-studie-1.html#cb247-1345" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb247-1346"><a href="simulační-studie-1.html#cb247-1346" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb247-1347"><a href="simulační-studie-1.html#cb247-1347" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb247-1348"><a href="simulační-studie-1.html#cb247-1348" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb247-1349"><a href="simulační-studie-1.html#cb247-1349" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb247-1350"><a href="simulační-studie-1.html#cb247-1350" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb247-1351"><a href="simulační-studie-1.html#cb247-1351" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb247-1352"><a href="simulační-studie-1.html#cb247-1352" tabindex="-1"></a>    }</span>
<span id="cb247-1353"><a href="simulační-studie-1.html#cb247-1353" tabindex="-1"></a>  }</span>
<span id="cb247-1354"><a href="simulační-studie-1.html#cb247-1354" tabindex="-1"></a>  </span>
<span id="cb247-1355"><a href="simulační-studie-1.html#cb247-1355" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb247-1356"><a href="simulační-studie-1.html#cb247-1356" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb247-1357"><a href="simulační-studie-1.html#cb247-1357" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb247-1358"><a href="simulační-studie-1.html#cb247-1358" tabindex="-1"></a>  }</span>
<span id="cb247-1359"><a href="simulační-studie-1.html#cb247-1359" tabindex="-1"></a>  </span>
<span id="cb247-1360"><a href="simulační-studie-1.html#cb247-1360" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb247-1361"><a href="simulační-studie-1.html#cb247-1361" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb247-1362"><a href="simulační-studie-1.html#cb247-1362" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb247-1363"><a href="simulační-studie-1.html#cb247-1363" tabindex="-1"></a>  d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb247-1364"><a href="simulační-studie-1.html#cb247-1364" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb247-1365"><a href="simulační-studie-1.html#cb247-1365" tabindex="-1"></a>  </span>
<span id="cb247-1366"><a href="simulační-studie-1.html#cb247-1366" tabindex="-1"></a>  err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb247-1367"><a href="simulační-studie-1.html#cb247-1367" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb247-1368"><a href="simulační-studie-1.html#cb247-1368" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb247-1369"><a href="simulační-studie-1.html#cb247-1369" tabindex="-1"></a>  df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb247-1370"><a href="simulační-studie-1.html#cb247-1370" tabindex="-1"></a>             <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb247-1371"><a href="simulační-studie-1.html#cb247-1371" tabindex="-1"></a>             <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb247-1372"><a href="simulační-studie-1.html#cb247-1372" tabindex="-1"></a>  </span>
<span id="cb247-1373"><a href="simulační-studie-1.html#cb247-1373" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb247-1374"><a href="simulační-studie-1.html#cb247-1374" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb247-1375"><a href="simulační-studie-1.html#cb247-1375" tabindex="-1"></a>  <span class="co"># pridame i testovaci data</span></span>
<span id="cb247-1376"><a href="simulační-studie-1.html#cb247-1376" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb247-1377"><a href="simulační-studie-1.html#cb247-1377" tabindex="-1"></a>  </span>
<span id="cb247-1378"><a href="simulační-studie-1.html#cb247-1378" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb247-1379"><a href="simulační-studie-1.html#cb247-1379" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - linear&#39;</span>, </span>
<span id="cb247-1380"><a href="simulační-studie-1.html#cb247-1380" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - RKHS - linear&#39;</span>, </span>
<span id="cb247-1381"><a href="simulační-studie-1.html#cb247-1381" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - RKHS - linear&#39;</span>), </span>
<span id="cb247-1382"><a href="simulační-studie-1.html#cb247-1382" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb247-1383"><a href="simulační-studie-1.html#cb247-1383" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb247-1384"><a href="simulační-studie-1.html#cb247-1384" tabindex="-1"></a>  </span>
<span id="cb247-1385"><a href="simulační-studie-1.html#cb247-1385" tabindex="-1"></a>  <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb247-1386"><a href="simulační-studie-1.html#cb247-1386" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb247-1387"><a href="simulační-studie-1.html#cb247-1387" tabindex="-1"></a>    <span class="co"># spocitame matici K</span></span>
<span id="cb247-1388"><a href="simulační-studie-1.html#cb247-1388" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb247-1389"><a href="simulační-studie-1.html#cb247-1389" tabindex="-1"></a>    </span>
<span id="cb247-1390"><a href="simulační-studie-1.html#cb247-1390" tabindex="-1"></a>    <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb247-1391"><a href="simulační-studie-1.html#cb247-1391" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb247-1392"><a href="simulační-studie-1.html#cb247-1392" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb247-1393"><a href="simulační-studie-1.html#cb247-1393" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb247-1394"><a href="simulační-studie-1.html#cb247-1394" tabindex="-1"></a>    <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb247-1395"><a href="simulační-studie-1.html#cb247-1395" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb247-1396"><a href="simulační-studie-1.html#cb247-1396" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb247-1397"><a href="simulační-studie-1.html#cb247-1397" tabindex="-1"></a>    </span>
<span id="cb247-1398"><a href="simulační-studie-1.html#cb247-1398" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb247-1399"><a href="simulační-studie-1.html#cb247-1399" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb247-1400"><a href="simulační-studie-1.html#cb247-1400" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb247-1401"><a href="simulační-studie-1.html#cb247-1401" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb247-1402"><a href="simulační-studie-1.html#cb247-1402" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb247-1403"><a href="simulační-studie-1.html#cb247-1403" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb247-1404"><a href="simulační-studie-1.html#cb247-1404" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb247-1405"><a href="simulační-studie-1.html#cb247-1405" tabindex="-1"></a>                      <span class="at">epsilon =</span> <span class="fl">0.1</span>)</span>
<span id="cb247-1406"><a href="simulační-studie-1.html#cb247-1406" tabindex="-1"></a>      <span class="co"># urceni alpha</span></span>
<span id="cb247-1407"><a href="simulační-studie-1.html#cb247-1407" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb247-1408"><a href="simulační-studie-1.html#cb247-1408" tabindex="-1"></a>    }</span>
<span id="cb247-1409"><a href="simulační-studie-1.html#cb247-1409" tabindex="-1"></a>    <span class="co"># d</span></span>
<span id="cb247-1410"><a href="simulační-studie-1.html#cb247-1410" tabindex="-1"></a>    d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb247-1411"><a href="simulační-studie-1.html#cb247-1411" tabindex="-1"></a>    </span>
<span id="cb247-1412"><a href="simulační-studie-1.html#cb247-1412" tabindex="-1"></a>    <span class="co"># urceni vektoru lambda</span></span>
<span id="cb247-1413"><a href="simulační-studie-1.html#cb247-1413" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb247-1414"><a href="simulační-studie-1.html#cb247-1414" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb247-1415"><a href="simulační-studie-1.html#cb247-1415" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb247-1416"><a href="simulační-studie-1.html#cb247-1416" tabindex="-1"></a>    </span>
<span id="cb247-1417"><a href="simulační-studie-1.html#cb247-1417" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb247-1418"><a href="simulační-studie-1.html#cb247-1418" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb247-1419"><a href="simulační-studie-1.html#cb247-1419" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb247-1420"><a href="simulační-studie-1.html#cb247-1420" tabindex="-1"></a>    }</span>
<span id="cb247-1421"><a href="simulační-studie-1.html#cb247-1421" tabindex="-1"></a>    </span>
<span id="cb247-1422"><a href="simulační-studie-1.html#cb247-1422" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb247-1423"><a href="simulační-studie-1.html#cb247-1423" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb247-1424"><a href="simulační-studie-1.html#cb247-1424" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb247-1425"><a href="simulační-studie-1.html#cb247-1425" tabindex="-1"></a>  </span>
<span id="cb247-1426"><a href="simulační-studie-1.html#cb247-1426" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb247-1427"><a href="simulační-studie-1.html#cb247-1427" tabindex="-1"></a>  </span>
<span id="cb247-1428"><a href="simulační-studie-1.html#cb247-1428" tabindex="-1"></a>    data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb247-1429"><a href="simulační-studie-1.html#cb247-1429" tabindex="-1"></a>    data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb247-1430"><a href="simulační-studie-1.html#cb247-1430" tabindex="-1"></a>    </span>
<span id="cb247-1431"><a href="simulační-studie-1.html#cb247-1431" tabindex="-1"></a>    data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb247-1432"><a href="simulační-studie-1.html#cb247-1432" tabindex="-1"></a>    data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb247-1433"><a href="simulační-studie-1.html#cb247-1433" tabindex="-1"></a>    </span>
<span id="cb247-1434"><a href="simulační-studie-1.html#cb247-1434" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb247-1435"><a href="simulační-studie-1.html#cb247-1435" tabindex="-1"></a>    clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb247-1436"><a href="simulační-studie-1.html#cb247-1436" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb247-1437"><a href="simulační-studie-1.html#cb247-1437" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb247-1438"><a href="simulační-studie-1.html#cb247-1438" tabindex="-1"></a>                        <span class="at">kernel =</span> kernel_type)</span>
<span id="cb247-1439"><a href="simulační-studie-1.html#cb247-1439" tabindex="-1"></a>    </span>
<span id="cb247-1440"><a href="simulační-studie-1.html#cb247-1440" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb247-1441"><a href="simulační-studie-1.html#cb247-1441" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb247-1442"><a href="simulační-studie-1.html#cb247-1442" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb247-1443"><a href="simulační-studie-1.html#cb247-1443" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-1444"><a href="simulační-studie-1.html#cb247-1444" tabindex="-1"></a>      </span>
<span id="cb247-1445"><a href="simulační-studie-1.html#cb247-1445" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb247-1446"><a href="simulační-studie-1.html#cb247-1446" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb247-1447"><a href="simulační-studie-1.html#cb247-1447" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb247-1448"><a href="simulační-studie-1.html#cb247-1448" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-1449"><a href="simulační-studie-1.html#cb247-1449" tabindex="-1"></a>    </span>
<span id="cb247-1450"><a href="simulační-studie-1.html#cb247-1450" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb247-1451"><a href="simulační-studie-1.html#cb247-1451" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb247-1452"><a href="simulační-studie-1.html#cb247-1452" tabindex="-1"></a>  }</span>
<span id="cb247-1453"><a href="simulační-studie-1.html#cb247-1453" tabindex="-1"></a>  </span>
<span id="cb247-1454"><a href="simulační-studie-1.html#cb247-1454" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb247-1455"><a href="simulační-studie-1.html#cb247-1455" tabindex="-1"></a>  </span>
<span id="cb247-1456"><a href="simulační-studie-1.html#cb247-1456" tabindex="-1"></a>  <span class="do">## pridame vysledky do objektu SIMULACE</span></span>
<span id="cb247-1457"><a href="simulační-studie-1.html#cb247-1457" tabindex="-1"></a>  </span>
<span id="cb247-1458"><a href="simulační-studie-1.html#cb247-1458" tabindex="-1"></a>  SIMULACE<span class="sc">$</span>train[sim, ] <span class="ot">&lt;-</span> RESULTS<span class="sc">$</span>Err.train</span>
<span id="cb247-1459"><a href="simulační-studie-1.html#cb247-1459" tabindex="-1"></a>  SIMULACE<span class="sc">$</span>test[sim, ] <span class="ot">&lt;-</span> RESULTS<span class="sc">$</span>Err.test</span>
<span id="cb247-1460"><a href="simulační-studie-1.html#cb247-1460" tabindex="-1"></a>}</span></code></pre></div>
</details>
<pre><code>## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
<pre><code>## Warning: glm.fit: algorithm did not converge</code></pre>
<pre><code>## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
<pre><code>## Warning: glm.fit: algorithm did not converge</code></pre>
<pre><code>## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
<p>Nyní spočítáme průměrné testovací a trénovací chybovosti pro jednotlivé klasifikační metody.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="simulační-studie-1.html#cb253-1" tabindex="-1"></a><span class="co"># dame do vysledne tabulky</span></span>
<span id="cb253-2"><a href="simulační-studie-1.html#cb253-2" tabindex="-1"></a></span>
<span id="cb253-3"><a href="simulační-studie-1.html#cb253-3" tabindex="-1"></a>SIMULACE.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Err.train =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>train, <span class="dv">2</span>, mean),</span>
<span id="cb253-4"><a href="simulační-studie-1.html#cb253-4" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>test, <span class="dv">2</span>, mean),</span>
<span id="cb253-5"><a href="simulační-studie-1.html#cb253-5" tabindex="-1"></a>                          <span class="at">SD.train =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>train, <span class="dv">2</span>, sd),</span>
<span id="cb253-6"><a href="simulační-studie-1.html#cb253-6" tabindex="-1"></a>                          <span class="at">SD.test =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>test, <span class="dv">2</span>, sd))</span></code></pre></div>
</details>
<div id="výsledky-1" class="section level3 hasAnchor" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Výsledky<a href="simulační-studie-1.html#výsledky-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<table>
<caption><span id="tab:unnamed-chunk-119">Tabulka 3.9: </span>Souhrnné výsledky použitých metod na simulovaných datech. <span class="math inline">\(\widehat{Err}_{train}\)</span> značí odhad trénovací chybovosti, <span class="math inline">\(\widehat{Err}_{test}\)</span> testovací chybovosti, <span class="math inline">\(\widehat{SD}_{train}\)</span> odhad směrodatné odchylky trénovacích chybovostí a <span class="math inline">\(\widehat{SD}_{test}\)</span> je odhad směrodatné odchylky testovacích chybovostí.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{train}\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{test}\)</span></th>
<th align="right"><span class="math inline">\(\widehat{SD}_{train}\)</span></th>
<th align="right"><span class="math inline">\(\widehat{SD}_{test}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>KNN</td>
<td align="right">0.2396</td>
<td align="right">0.2423</td>
<td align="right">0.0411</td>
<td align="right">0.0620</td>
</tr>
<tr class="even">
<td>LDA</td>
<td align="right">0.2257</td>
<td align="right">0.2350</td>
<td align="right">0.0394</td>
<td align="right">0.0666</td>
</tr>
<tr class="odd">
<td>QDA</td>
<td align="right">0.2211</td>
<td align="right">0.2350</td>
<td align="right">0.0423</td>
<td align="right">0.0692</td>
</tr>
<tr class="even">
<td>LR_functional</td>
<td align="right">0.2006</td>
<td align="right">0.2347</td>
<td align="right">0.0371</td>
<td align="right">0.0666</td>
</tr>
<tr class="odd">
<td>LR_score</td>
<td align="right">0.2240</td>
<td align="right">0.2373</td>
<td align="right">0.0412</td>
<td align="right">0.0678</td>
</tr>
<tr class="even">
<td>Tree_discr</td>
<td align="right">0.1926</td>
<td align="right">0.2687</td>
<td align="right">0.0420</td>
<td align="right">0.0531</td>
</tr>
<tr class="odd">
<td>Tree_score</td>
<td align="right">0.2134</td>
<td align="right">0.2850</td>
<td align="right">0.0375</td>
<td align="right">0.0643</td>
</tr>
<tr class="even">
<td>Tree_Bbasis</td>
<td align="right">0.1911</td>
<td align="right">0.2747</td>
<td align="right">0.0390</td>
<td align="right">0.0617</td>
</tr>
<tr class="odd">
<td>RF_discr</td>
<td align="right">0.0180</td>
<td align="right">0.2563</td>
<td align="right">0.0103</td>
<td align="right">0.0567</td>
</tr>
<tr class="even">
<td>RF_score</td>
<td align="right">0.0414</td>
<td align="right">0.2597</td>
<td align="right">0.0166</td>
<td align="right">0.0680</td>
</tr>
<tr class="odd">
<td>RF_Bbasis</td>
<td align="right">0.0209</td>
<td align="right">0.2503</td>
<td align="right">0.0122</td>
<td align="right">0.0589</td>
</tr>
<tr class="even">
<td>SVM linear - diskr</td>
<td align="right">0.2087</td>
<td align="right">0.2237</td>
<td align="right">0.0347</td>
<td align="right">0.0583</td>
</tr>
<tr class="odd">
<td>SVM poly - diskr</td>
<td align="right">0.2279</td>
<td align="right">0.2770</td>
<td align="right">0.0398</td>
<td align="right">0.0690</td>
</tr>
<tr class="even">
<td>SVM rbf - diskr</td>
<td align="right">0.1936</td>
<td align="right">0.2293</td>
<td align="right">0.0326</td>
<td align="right">0.0625</td>
</tr>
<tr class="odd">
<td>SVM linear - PCA</td>
<td align="right">0.2249</td>
<td align="right">0.2330</td>
<td align="right">0.0420</td>
<td align="right">0.0648</td>
</tr>
<tr class="even">
<td>SVM poly - PCA</td>
<td align="right">0.2384</td>
<td align="right">0.2820</td>
<td align="right">0.0457</td>
<td align="right">0.0717</td>
</tr>
<tr class="odd">
<td>SVM rbf - PCA</td>
<td align="right">0.1971</td>
<td align="right">0.2390</td>
<td align="right">0.0383</td>
<td align="right">0.0649</td>
</tr>
<tr class="even">
<td>SVM linear - Bbasis</td>
<td align="right">0.2100</td>
<td align="right">0.2277</td>
<td align="right">0.0353</td>
<td align="right">0.0599</td>
</tr>
<tr class="odd">
<td>SVM poly - Bbasis</td>
<td align="right">0.2276</td>
<td align="right">0.2727</td>
<td align="right">0.0393</td>
<td align="right">0.0702</td>
</tr>
<tr class="even">
<td>SVM rbf - Bbasis</td>
<td align="right">0.1941</td>
<td align="right">0.2297</td>
<td align="right">0.0327</td>
<td align="right">0.0644</td>
</tr>
<tr class="odd">
<td>SVM linear - projection</td>
<td align="right">0.1817</td>
<td align="right">0.2413</td>
<td align="right">0.0376</td>
<td align="right">0.0696</td>
</tr>
<tr class="even">
<td>SVM poly - projection</td>
<td align="right">0.1711</td>
<td align="right">0.2970</td>
<td align="right">0.0419</td>
<td align="right">0.0802</td>
</tr>
<tr class="odd">
<td>SVM rbf - projection</td>
<td align="right">0.1531</td>
<td align="right">0.2697</td>
<td align="right">0.0425</td>
<td align="right">0.0708</td>
</tr>
<tr class="even">
<td>SVM linear - RKHS - radial</td>
<td align="right">0.2653</td>
<td align="right">0.3533</td>
<td align="right">0.0372</td>
<td align="right">0.0735</td>
</tr>
<tr class="odd">
<td>SVM poly - RKHS - radial</td>
<td align="right">0.2383</td>
<td align="right">0.3807</td>
<td align="right">0.0502</td>
<td align="right">0.0792</td>
</tr>
<tr class="even">
<td>SVM rbf - RKHS - radial</td>
<td align="right">0.2444</td>
<td align="right">0.3550</td>
<td align="right">0.0440</td>
<td align="right">0.0717</td>
</tr>
<tr class="odd">
<td>SVM linear - RKHS - poly</td>
<td align="right">0.3833</td>
<td align="right">0.4400</td>
<td align="right">0.0966</td>
<td align="right">0.1047</td>
</tr>
<tr class="even">
<td>SVM poly - RKHS - poly</td>
<td align="right">0.3844</td>
<td align="right">0.4453</td>
<td align="right">0.0882</td>
<td align="right">0.1006</td>
</tr>
<tr class="odd">
<td>SVM rbf - RKHS - poly</td>
<td align="right">0.3860</td>
<td align="right">0.4407</td>
<td align="right">0.0929</td>
<td align="right">0.0997</td>
</tr>
<tr class="even">
<td>SVM linear - RKHS - linear</td>
<td align="right">0.2980</td>
<td align="right">0.3720</td>
<td align="right">0.0520</td>
<td align="right">0.0761</td>
</tr>
<tr class="odd">
<td>SVM poly - RKHS - linear</td>
<td align="right">0.2647</td>
<td align="right">0.3853</td>
<td align="right">0.0496</td>
<td align="right">0.0810</td>
</tr>
<tr class="even">
<td>SVM rbf - RKHS - linear</td>
<td align="right">0.2890</td>
<td align="right">0.3693</td>
<td align="right">0.0389</td>
<td align="right">0.0781</td>
</tr>
</tbody>
</table>
<p>V tabulce výše jsou uvedeny všechny vypočtené charakteristiky.
Jsou zde uvedeny také směrodatné odchylky, abychom mohli porovnat jakousi stálost či míru variability jednotlivých metod.</p>
<p>Nakonec ještě můžeme graficky zobrazit vypočtené hodnoty ze simulace pro jednotlivé klasifikační metody pomocí krabicových diagramů, zvlášť pro testovací a trénovací chybovosti.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="simulační-studie-1.html#cb254-1" tabindex="-1"></a><span class="co"># pro trenovaci data</span></span>
<span id="cb254-2"><a href="simulační-studie-1.html#cb254-2" tabindex="-1"></a>SIMULACE<span class="sc">$</span>train <span class="sc">|&gt;</span> </span>
<span id="cb254-3"><a href="simulační-studie-1.html#cb254-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> methods, <span class="at">names_to =</span> <span class="st">&#39;method&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb254-4"><a href="simulační-studie-1.html#cb254-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb254-5"><a href="simulační-studie-1.html#cb254-5" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb254-6"><a href="simulační-studie-1.html#cb254-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> Err, <span class="at">fill =</span> method, <span class="at">colour =</span> method, <span class="at">alpha =</span> <span class="fl">0.3</span>)) <span class="sc">+</span> </span>
<span id="cb254-7"><a href="simulační-studie-1.html#cb254-7" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">&quot;white&quot;</span>, <span class="at">outlier.shape =</span> <span class="dv">16</span>, <span class="at">outlier.size =</span> <span class="dv">0</span>, </span>
<span id="cb254-8"><a href="simulační-studie-1.html#cb254-8" tabindex="-1"></a>               <span class="at">notch =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb254-9"><a href="simulační-studie-1.html#cb254-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb254-10"><a href="simulační-studie-1.html#cb254-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Klasifikační metoda&#39;</span>,</span>
<span id="cb254-11"><a href="simulační-studie-1.html#cb254-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(Err)[train])) <span class="sc">+</span> </span>
<span id="cb254-12"><a href="simulační-studie-1.html#cb254-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb254-13"><a href="simulační-studie-1.html#cb254-13" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">40</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb254-14"><a href="simulační-studie-1.html#cb254-14" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.15</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb254-15"><a href="simulační-studie-1.html#cb254-15" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb254-16"><a href="simulační-studie-1.html#cb254-16" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">shape =</span> <span class="st">&#39;+&#39;</span>,</span>
<span id="cb254-17"><a href="simulační-studie-1.html#cb254-17" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>)<span class="sc">+</span> </span>
<span id="cb254-18"><a href="simulační-studie-1.html#cb254-18" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">min</span>(SIMULACE.df<span class="sc">$</span>Err.train), </span>
<span id="cb254-19"><a href="simulační-studie-1.html#cb254-19" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-120"></span>
<img src="02-Simulace_2_files/figure-html/unnamed-chunk-120-1.png" alt="Krabicové diagramy trénovacích chybovostí pro 100 simulací zvlášť pro jednotlivé klasifikační metody. Černými symboly $+$ jsou vyznačeny průměry." width="672" />
<p class="caption">
Obrázek 3.18: Krabicové diagramy trénovacích chybovostí pro 100 simulací zvlášť pro jednotlivé klasifikační metody. Černými symboly <span class="math inline">\(+\)</span> jsou vyznačeny průměry.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="simulační-studie-1.html#cb255-1" tabindex="-1"></a><span class="co"># pro testovaci data</span></span>
<span id="cb255-2"><a href="simulační-studie-1.html#cb255-2" tabindex="-1"></a>SIMULACE<span class="sc">$</span>test <span class="sc">|&gt;</span> </span>
<span id="cb255-3"><a href="simulační-studie-1.html#cb255-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> methods, <span class="at">names_to =</span> <span class="st">&#39;method&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb255-4"><a href="simulační-studie-1.html#cb255-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb255-5"><a href="simulační-studie-1.html#cb255-5" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb255-6"><a href="simulační-studie-1.html#cb255-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> Err, <span class="at">fill =</span> method, <span class="at">colour =</span> method, <span class="at">alpha =</span> <span class="fl">0.3</span>)) <span class="sc">+</span> </span>
<span id="cb255-7"><a href="simulační-studie-1.html#cb255-7" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">&quot;white&quot;</span>, <span class="at">outlier.shape =</span> <span class="dv">16</span>, <span class="at">outlier.size =</span> <span class="dv">0</span>, </span>
<span id="cb255-8"><a href="simulační-studie-1.html#cb255-8" tabindex="-1"></a>               <span class="at">notch =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb255-9"><a href="simulační-studie-1.html#cb255-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb255-10"><a href="simulační-studie-1.html#cb255-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Klasifikační metoda&#39;</span>,</span>
<span id="cb255-11"><a href="simulační-studie-1.html#cb255-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(Err)[test])) <span class="sc">+</span> </span>
<span id="cb255-12"><a href="simulační-studie-1.html#cb255-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb255-13"><a href="simulační-studie-1.html#cb255-13" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">40</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb255-14"><a href="simulační-studie-1.html#cb255-14" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.15</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb255-15"><a href="simulační-studie-1.html#cb255-15" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb255-16"><a href="simulační-studie-1.html#cb255-16" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">shape =</span> <span class="st">&#39;+&#39;</span>,</span>
<span id="cb255-17"><a href="simulační-studie-1.html#cb255-17" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span> </span>
<span id="cb255-18"><a href="simulační-studie-1.html#cb255-18" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">min</span>(SIMULACE.df<span class="sc">$</span>Err.test), </span>
<span id="cb255-19"><a href="simulační-studie-1.html#cb255-19" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-122"></span>
<img src="02-Simulace_2_files/figure-html/unnamed-chunk-122-1.png" alt="Krabicové diagramy testovacích chybovostí pro 100 simulací zvlášť pro jednotlivé klasifikační metody. Černými symboly $+$ jsou vyznačeny průměry." width="672" />
<p class="caption">
Obrázek 3.19: Krabicové diagramy testovacích chybovostí pro 100 simulací zvlášť pro jednotlivé klasifikační metody. Černými symboly <span class="math inline">\(+\)</span> jsou vyznačeny průměry.
</p>
</div>
<p>Nakonec se podívejme, jaké hodnoty hyperparametrů byly nejčastější volbou.</p>
<table>
<caption><span id="tab:unnamed-chunk-124">Tabulka 3.10: </span>Mediány hodnot hyperparametrů pro vybrané metody, u nichž se určoval nějaký hyperparametr pomocí cross-validace.</caption>
<thead>
<tr class="header">
<th align="center"><span class="math inline">\(K\)</span> pro KNN</th>
<th align="right"><span class="math inline">\(d\)</span> pro SVM linear</th>
<th align="center"><span class="math inline">\(d\)</span> pro SVM poly</th>
<th align="right"><span class="math inline">\(d\)</span> pro SVM radial</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">12</td>
<td align="right">7</td>
<td align="center">6</td>
<td align="right">5</td>
</tr>
</tbody>
</table>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="simulační-studie-1.html#cb256-1" tabindex="-1"></a>CV_RESULTS <span class="sc">|&gt;</span> </span>
<span id="cb256-2"><a href="simulační-studie-1.html#cb256-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> CV_RESULTS <span class="sc">|&gt;</span> <span class="fu">colnames</span>(), <span class="at">names_to =</span> <span class="st">&#39;method&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;hyperparameter&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb256-3"><a href="simulační-studie-1.html#cb256-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, </span>
<span id="cb256-4"><a href="simulační-studie-1.html#cb256-4" tabindex="-1"></a>                         <span class="at">levels =</span> CV_RESULTS <span class="sc">|&gt;</span> <span class="fu">colnames</span>(), </span>
<span id="cb256-5"><a href="simulační-studie-1.html#cb256-5" tabindex="-1"></a>                         <span class="at">labels =</span> CV_RESULTS <span class="sc">|&gt;</span> <span class="fu">colnames</span>(), <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb256-6"><a href="simulační-studie-1.html#cb256-6" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb256-7"><a href="simulační-studie-1.html#cb256-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb256-8"><a href="simulační-studie-1.html#cb256-8" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb256-9"><a href="simulační-studie-1.html#cb256-9" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span> </span>
<span id="cb256-10"><a href="simulační-studie-1.html#cb256-10" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb256-11"><a href="simulační-studie-1.html#cb256-11" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>) <span class="sc">+</span></span>
<span id="cb256-12"><a href="simulační-studie-1.html#cb256-12" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hodnoty hyperparametru&#39;</span>,</span>
<span id="cb256-13"><a href="simulační-studie-1.html#cb256-13" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolutní počet&#39;</span>) <span class="sc">+</span> </span>
<span id="cb256-14"><a href="simulační-studie-1.html#cb256-14" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-125"></span>
<img src="02-Simulace_2_files/figure-html/unnamed-chunk-125-1.png" alt="Krabicové diagramy hodnot hyperparametrů." width="672" />
<p class="caption">
Obrázek 3.20: Krabicové diagramy hodnot hyperparametrů.
</p>
</div>

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="tabulka-výsledků-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="aplikace-na-reálných-datech-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": null,
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/Tomas-Pompa/MastersThesis/blob/main/02-Simulace_2.Rmd",
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
