<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Kapitola 12 Aplikace na reálných datech 3 | Diplomová práce</title>
  <meta name="description" content="Kapitola 12 Aplikace na reálných datech 3 | Diplomová práce" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Kapitola 12 Aplikace na reálných datech 3 | Diplomová práce" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Kapitola 12 Aplikace na reálných datech 3 | Diplomová práce" />
  
  
  

<meta name="author" content="Tomáš Pompa" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="aplikace2.html"/>
<link rel="next" href="aplikace-na-reálných-datech-4.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/codefolding-lua-1.1/codefolding-lua.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="sci-lg-eng-rgb.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>SVM pro funkcionální data</a></li>
<li class="part"><span><b>Simulační studie</b></span></li>
<li class="chapter" data-level="1" data-path="simulace1.html"><a href="simulace1.html"><i class="fa fa-check"></i><b>1</b> Simulace 1</a>
<ul>
<li class="chapter" data-level="1.1" data-path="simulace1.html"><a href="simulace1.html#simulace-funkcionálních-dat"><i class="fa fa-check"></i><b>1.1</b> Simulace funkcionálních dat</a></li>
<li class="chapter" data-level="1.2" data-path="simulace1.html"><a href="simulace1.html#vyhlazení-pozorovaných-křivek"><i class="fa fa-check"></i><b>1.2</b> Vyhlazení pozorovaných křivek</a></li>
<li class="chapter" data-level="1.3" data-path="simulace1.html"><a href="simulace1.html#klasifikace-křivek"><i class="fa fa-check"></i><b>1.3</b> Klasifikace křivek</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="simulace1.html"><a href="simulace1.html#k-nejbližších-sousedů"><i class="fa fa-check"></i><b>1.3.1</b> <span class="math inline">\(K\)</span> nejbližších sousedů</a></li>
<li class="chapter" data-level="1.3.2" data-path="simulace1.html"><a href="simulace1.html#lineární-diskriminační-analýza"><i class="fa fa-check"></i><b>1.3.2</b> Lineární diskriminační analýza</a></li>
<li class="chapter" data-level="1.3.3" data-path="simulace1.html"><a href="simulace1.html#kvadratická-diskriminační-analýza"><i class="fa fa-check"></i><b>1.3.3</b> Kvadratická diskriminační analýza</a></li>
<li class="chapter" data-level="1.3.4" data-path="simulace1.html"><a href="simulace1.html#logistická-regrese"><i class="fa fa-check"></i><b>1.3.4</b> Logistická regrese</a></li>
<li class="chapter" data-level="1.3.5" data-path="simulace1.html"><a href="simulace1.html#rozhodovací-stromy"><i class="fa fa-check"></i><b>1.3.5</b> Rozhodovací stromy</a></li>
<li class="chapter" data-level="1.3.6" data-path="simulace1.html"><a href="simulace1.html#náhodné-lesy"><i class="fa fa-check"></i><b>1.3.6</b> Náhodné lesy</a></li>
<li class="chapter" data-level="1.3.7" data-path="simulace1.html"><a href="simulace1.html#support-vector-machines"><i class="fa fa-check"></i><b>1.3.7</b> Support Vector Machines</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="simulace1.html"><a href="simulace1.html#tabulka-výsledků"><i class="fa fa-check"></i><b>1.4</b> Tabulka výsledků</a></li>
<li class="chapter" data-level="1.5" data-path="simulace1.html"><a href="simulace1.html#simulační-studie"><i class="fa fa-check"></i><b>1.5</b> Simulační studie</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="simulace1.html"><a href="simulace1.html#výsledky"><i class="fa fa-check"></i><b>1.5.1</b> Výsledky</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="simulace2.html"><a href="simulace2.html"><i class="fa fa-check"></i><b>2</b> Simulace 2</a>
<ul>
<li class="chapter" data-level="2.1" data-path="simulace2.html"><a href="simulace2.html#simulace-funkcionálních-dat-1"><i class="fa fa-check"></i><b>2.1</b> Simulace funkcionálních dat</a></li>
<li class="chapter" data-level="2.2" data-path="simulace2.html"><a href="simulace2.html#vyhlazení-pozorovaných-křivek-1"><i class="fa fa-check"></i><b>2.2</b> Vyhlazení pozorovaných křivek</a></li>
<li class="chapter" data-level="2.3" data-path="simulace2.html"><a href="simulace2.html#klasifikace-křivek-1"><i class="fa fa-check"></i><b>2.3</b> Klasifikace křivek</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="simulace2.html"><a href="simulace2.html#k-nejbližších-sousedů-1"><i class="fa fa-check"></i><b>2.3.1</b> <span class="math inline">\(K\)</span> nejbližších sousedů</a></li>
<li class="chapter" data-level="2.3.2" data-path="simulace2.html"><a href="simulace2.html#lineární-diskriminační-analýza-1"><i class="fa fa-check"></i><b>2.3.2</b> Lineární diskriminační analýza</a></li>
<li class="chapter" data-level="2.3.3" data-path="simulace2.html"><a href="simulace2.html#kvadratická-diskriminační-analýza-1"><i class="fa fa-check"></i><b>2.3.3</b> Kvadratická diskriminační analýza</a></li>
<li class="chapter" data-level="2.3.4" data-path="simulace2.html"><a href="simulace2.html#logistická-regrese-1"><i class="fa fa-check"></i><b>2.3.4</b> Logistická regrese</a></li>
<li class="chapter" data-level="2.3.5" data-path="simulace2.html"><a href="simulace2.html#rozhodovací-stromy-1"><i class="fa fa-check"></i><b>2.3.5</b> Rozhodovací stromy</a></li>
<li class="chapter" data-level="2.3.6" data-path="simulace2.html"><a href="simulace2.html#náhodné-lesy-1"><i class="fa fa-check"></i><b>2.3.6</b> Náhodné lesy</a></li>
<li class="chapter" data-level="2.3.7" data-path="simulace2.html"><a href="simulace2.html#support-vector-machines-1"><i class="fa fa-check"></i><b>2.3.7</b> Support Vector Machines</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="simulace2.html"><a href="simulace2.html#tabulka-výsledků-1"><i class="fa fa-check"></i><b>2.4</b> Tabulka výsledků</a></li>
<li class="chapter" data-level="2.5" data-path="simulace2.html"><a href="simulace2.html#simulační-studie-1"><i class="fa fa-check"></i><b>2.5</b> Simulační studie</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="simulace2.html"><a href="simulace2.html#výsledky-1"><i class="fa fa-check"></i><b>2.5.1</b> Výsledky</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="simulace2sigma.html"><a href="simulace2sigma.html"><i class="fa fa-check"></i><b>3</b> Závislost na parametru <span class="math inline">\(\sigma^2\)</span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="simulace2sigma.html"><a href="simulace2sigma.html#simulace-funkcionálních-dat-2"><i class="fa fa-check"></i><b>3.1</b> Simulace funkcionálních dat</a></li>
<li class="chapter" data-level="3.2" data-path="simulace2sigma.html"><a href="simulace2sigma.html#vyhlazení-pozorovaných-křivek-2"><i class="fa fa-check"></i><b>3.2</b> Vyhlazení pozorovaných křivek</a></li>
<li class="chapter" data-level="3.3" data-path="simulace2sigma.html"><a href="simulace2sigma.html#klasifikace-křivek-2"><i class="fa fa-check"></i><b>3.3</b> Klasifikace křivek</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="simulace2sigma.html"><a href="simulace2sigma.html#k-nejbližších-sousedů-2"><i class="fa fa-check"></i><b>3.3.1</b> <span class="math inline">\(K\)</span> nejbližších sousedů</a></li>
<li class="chapter" data-level="3.3.2" data-path="simulace2sigma.html"><a href="simulace2sigma.html#lineární-diskriminační-analýza-2"><i class="fa fa-check"></i><b>3.3.2</b> Lineární diskriminační analýza</a></li>
<li class="chapter" data-level="3.3.3" data-path="simulace2sigma.html"><a href="simulace2sigma.html#kvadratická-diskriminační-analýza-2"><i class="fa fa-check"></i><b>3.3.3</b> Kvadratická diskriminační analýza</a></li>
<li class="chapter" data-level="3.3.4" data-path="simulace2sigma.html"><a href="simulace2sigma.html#support-vector-machines-2"><i class="fa fa-check"></i><b>3.3.4</b> Support Vector Machines</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="simulace2sigma.html"><a href="simulace2sigma.html#tabulka-výsledků-2"><i class="fa fa-check"></i><b>3.4</b> Tabulka výsledků</a></li>
<li class="chapter" data-level="3.5" data-path="simulace2sigma.html"><a href="simulace2sigma.html#simulační-studie-2"><i class="fa fa-check"></i><b>3.5</b> Simulační studie</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="simulace2sigma.html"><a href="simulace2sigma.html#grafický-výstup"><i class="fa fa-check"></i><b>3.5.1</b> Grafický výstup</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simulace2shift.html"><a href="simulace2shift.html"><i class="fa fa-check"></i><b>4</b> Závislost na parametru <span class="math inline">\(\sigma_{shift}\)</span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="simulace2shift.html"><a href="simulace2shift.html#simulace-funkcionálních-dat-3"><i class="fa fa-check"></i><b>4.1</b> Simulace funkcionálních dat</a></li>
<li class="chapter" data-level="4.2" data-path="simulace2shift.html"><a href="simulace2shift.html#vyhlazení-pozorovaných-křivek-3"><i class="fa fa-check"></i><b>4.2</b> Vyhlazení pozorovaných křivek</a></li>
<li class="chapter" data-level="4.3" data-path="simulace2shift.html"><a href="simulace2shift.html#klasifikace-křivek-3"><i class="fa fa-check"></i><b>4.3</b> Klasifikace křivek</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="simulace2shift.html"><a href="simulace2shift.html#k-nejbližších-sousedů-3"><i class="fa fa-check"></i><b>4.3.1</b> <span class="math inline">\(K\)</span> nejbližších sousedů</a></li>
<li class="chapter" data-level="4.3.2" data-path="simulace2shift.html"><a href="simulace2shift.html#lineární-diskriminační-analýza-3"><i class="fa fa-check"></i><b>4.3.2</b> Lineární diskriminační analýza</a></li>
<li class="chapter" data-level="4.3.3" data-path="simulace2shift.html"><a href="simulace2shift.html#kvadratická-diskriminační-analýza-3"><i class="fa fa-check"></i><b>4.3.3</b> Kvadratická diskriminační analýza</a></li>
<li class="chapter" data-level="4.3.4" data-path="simulace2shift.html"><a href="simulace2shift.html#support-vector-machines-3"><i class="fa fa-check"></i><b>4.3.4</b> Support Vector Machines</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="simulace2shift.html"><a href="simulace2shift.html#tabulka-výsledků-3"><i class="fa fa-check"></i><b>4.4</b> Tabulka výsledků</a></li>
<li class="chapter" data-level="4.5" data-path="simulace2shift.html"><a href="simulace2shift.html#simulační-studie-3"><i class="fa fa-check"></i><b>4.5</b> Simulační studie</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="simulace2shift.html"><a href="simulace2shift.html#grafický-výstup-1"><i class="fa fa-check"></i><b>4.5.1</b> Grafický výstup</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="simulace3.html"><a href="simulace3.html"><i class="fa fa-check"></i><b>5</b> Simulace 3</a>
<ul>
<li class="chapter" data-level="5.1" data-path="simulace3.html"><a href="simulace3.html#simulace-funkcionálních-dat-4"><i class="fa fa-check"></i><b>5.1</b> Simulace funkcionálních dat</a></li>
<li class="chapter" data-level="5.2" data-path="simulace3.html"><a href="simulace3.html#vyhlazení-pozorovaných-křivek-4"><i class="fa fa-check"></i><b>5.2</b> Vyhlazení pozorovaných křivek</a></li>
<li class="chapter" data-level="5.3" data-path="simulace3.html"><a href="simulace3.html#klasifikace-křivek-4"><i class="fa fa-check"></i><b>5.3</b> Klasifikace křivek</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="simulace3.html"><a href="simulace3.html#k-nejbližších-sousedů-4"><i class="fa fa-check"></i><b>5.3.1</b> <span class="math inline">\(K\)</span> nejbližších sousedů</a></li>
<li class="chapter" data-level="5.3.2" data-path="simulace3.html"><a href="simulace3.html#lineární-diskriminační-analýza-4"><i class="fa fa-check"></i><b>5.3.2</b> Lineární diskriminační analýza</a></li>
<li class="chapter" data-level="5.3.3" data-path="simulace3.html"><a href="simulace3.html#kvadratická-diskriminační-analýza-4"><i class="fa fa-check"></i><b>5.3.3</b> Kvadratická diskriminační analýza</a></li>
<li class="chapter" data-level="5.3.4" data-path="simulace3.html"><a href="simulace3.html#logistická-regrese-2"><i class="fa fa-check"></i><b>5.3.4</b> Logistická regrese</a></li>
<li class="chapter" data-level="5.3.5" data-path="simulace3.html"><a href="simulace3.html#rozhodovací-stromy-2"><i class="fa fa-check"></i><b>5.3.5</b> Rozhodovací stromy</a></li>
<li class="chapter" data-level="5.3.6" data-path="simulace3.html"><a href="simulace3.html#náhodné-lesy-2"><i class="fa fa-check"></i><b>5.3.6</b> Náhodné lesy</a></li>
<li class="chapter" data-level="5.3.7" data-path="simulace3.html"><a href="simulace3.html#support-vector-machines-4"><i class="fa fa-check"></i><b>5.3.7</b> Support Vector Machines</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="simulace3.html"><a href="simulace3.html#tabulka-výsledků-4"><i class="fa fa-check"></i><b>5.4</b> Tabulka výsledků</a></li>
<li class="chapter" data-level="5.5" data-path="simulace3.html"><a href="simulace3.html#simulační-studie-4"><i class="fa fa-check"></i><b>5.5</b> Simulační studie</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="simulace3.html"><a href="simulace3.html#výsledky-2"><i class="fa fa-check"></i><b>5.5.1</b> Výsledky</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="simulace3sigma.html"><a href="simulace3sigma.html"><i class="fa fa-check"></i><b>6</b> Závislost na parametru <span class="math inline">\(\sigma^2\)</span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="simulace3sigma.html"><a href="simulace3sigma.html#simulace-funkcionálních-dat-5"><i class="fa fa-check"></i><b>6.1</b> Simulace funkcionálních dat</a></li>
<li class="chapter" data-level="6.2" data-path="simulace3sigma.html"><a href="simulace3sigma.html#vyhlazení-pozorovaných-křivek-5"><i class="fa fa-check"></i><b>6.2</b> Vyhlazení pozorovaných křivek</a></li>
<li class="chapter" data-level="6.3" data-path="simulace3sigma.html"><a href="simulace3sigma.html#klasifikace-křivek-5"><i class="fa fa-check"></i><b>6.3</b> Klasifikace křivek</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="simulace3sigma.html"><a href="simulace3sigma.html#k-nejbližších-sousedů-5"><i class="fa fa-check"></i><b>6.3.1</b> <span class="math inline">\(K\)</span> nejbližších sousedů</a></li>
<li class="chapter" data-level="6.3.2" data-path="simulace3sigma.html"><a href="simulace3sigma.html#lineární-diskriminační-analýza-5"><i class="fa fa-check"></i><b>6.3.2</b> Lineární diskriminační analýza</a></li>
<li class="chapter" data-level="6.3.3" data-path="simulace3sigma.html"><a href="simulace3sigma.html#kvadratická-diskriminační-analýza-5"><i class="fa fa-check"></i><b>6.3.3</b> Kvadratická diskriminační analýza</a></li>
<li class="chapter" data-level="6.3.4" data-path="simulace3sigma.html"><a href="simulace3sigma.html#logistická-regrese-3"><i class="fa fa-check"></i><b>6.3.4</b> Logistická regrese</a></li>
<li class="chapter" data-level="6.3.5" data-path="simulace3sigma.html"><a href="simulace3sigma.html#support-vector-machines-5"><i class="fa fa-check"></i><b>6.3.5</b> Support Vector Machines</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="simulace3sigma.html"><a href="simulace3sigma.html#tabulka-výsledků-5"><i class="fa fa-check"></i><b>6.4</b> Tabulka výsledků</a></li>
<li class="chapter" data-level="6.5" data-path="simulace3sigma.html"><a href="simulace3sigma.html#simulační-studie-5"><i class="fa fa-check"></i><b>6.5</b> Simulační studie</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simulace3shift.html"><a href="simulace3shift.html"><i class="fa fa-check"></i><b>7</b> Závislost na parametru <span class="math inline">\(\sigma_{shift}\)</span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="simulace3shift.html"><a href="simulace3shift.html#simulace-funkcionálních-dat-6"><i class="fa fa-check"></i><b>7.1</b> Simulace funkcionálních dat</a></li>
<li class="chapter" data-level="7.2" data-path="simulace3shift.html"><a href="simulace3shift.html#vyhlazení-pozorovaných-křivek-6"><i class="fa fa-check"></i><b>7.2</b> Vyhlazení pozorovaných křivek</a></li>
<li class="chapter" data-level="7.3" data-path="simulace3shift.html"><a href="simulace3shift.html#klasifikace-křivek-6"><i class="fa fa-check"></i><b>7.3</b> Klasifikace křivek</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="simulace3shift.html"><a href="simulace3shift.html#k-nejbližších-sousedů-6"><i class="fa fa-check"></i><b>7.3.1</b> <span class="math inline">\(K\)</span> nejbližších sousedů</a></li>
<li class="chapter" data-level="7.3.2" data-path="simulace3shift.html"><a href="simulace3shift.html#lineární-diskriminační-analýza-6"><i class="fa fa-check"></i><b>7.3.2</b> Lineární diskriminační analýza</a></li>
<li class="chapter" data-level="7.3.3" data-path="simulace3shift.html"><a href="simulace3shift.html#kvadratická-diskriminační-analýza-6"><i class="fa fa-check"></i><b>7.3.3</b> Kvadratická diskriminační analýza</a></li>
<li class="chapter" data-level="7.3.4" data-path="simulace3shift.html"><a href="simulace3shift.html#logistická-regrese-4"><i class="fa fa-check"></i><b>7.3.4</b> Logistická regrese</a></li>
<li class="chapter" data-level="7.3.5" data-path="simulace3shift.html"><a href="simulace3shift.html#support-vector-machines-6"><i class="fa fa-check"></i><b>7.3.5</b> Support Vector Machines</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="simulace3shift.html"><a href="simulace3shift.html#tabulka-výsledků-6"><i class="fa fa-check"></i><b>7.4</b> Tabulka výsledků</a></li>
<li class="chapter" data-level="7.5" data-path="simulace3shift.html"><a href="simulace3shift.html#simulační-studie-6"><i class="fa fa-check"></i><b>7.5</b> Simulační studie</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="simulace3shift.html"><a href="simulace3shift.html#grafický-výstup-2"><i class="fa fa-check"></i><b>7.5.1</b> Grafický výstup</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulace3diskr.html"><a href="simulace3diskr.html"><i class="fa fa-check"></i><b>8</b> Závislost na diskretizaci</a>
<ul>
<li class="chapter" data-level="8.1" data-path="simulace3diskr.html"><a href="simulace3diskr.html#simulace-funkcionálních-dat-7"><i class="fa fa-check"></i><b>8.1</b> Simulace funkcionálních dat</a></li>
<li class="chapter" data-level="8.2" data-path="simulace3diskr.html"><a href="simulace3diskr.html#vyhlazení-pozorovaných-křivek-7"><i class="fa fa-check"></i><b>8.2</b> Vyhlazení pozorovaných křivek</a></li>
<li class="chapter" data-level="8.3" data-path="simulace3diskr.html"><a href="simulace3diskr.html#klasif3diskr"><i class="fa fa-check"></i><b>8.3</b> Klasifikace křivek</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="simulace3diskr.html"><a href="simulace3diskr.html#rozhodovací-stromy-3"><i class="fa fa-check"></i><b>8.3.1</b> Rozhodovací stromy</a></li>
<li class="chapter" data-level="8.3.2" data-path="simulace3diskr.html"><a href="simulace3diskr.html#náhodné-lesy-3"><i class="fa fa-check"></i><b>8.3.2</b> Náhodné lesy</a></li>
<li class="chapter" data-level="8.3.3" data-path="simulace3diskr.html"><a href="simulace3diskr.html#support-vector-machines-7"><i class="fa fa-check"></i><b>8.3.3</b> Support Vector Machines</a></li>
<li class="chapter" data-level="8.3.4" data-path="simulace3diskr.html"><a href="simulace3diskr.html#tabulka-výsledků-7"><i class="fa fa-check"></i><b>8.3.4</b> Tabulka výsledků</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="simulace3diskr.html"><a href="simulace3diskr.html#simul3diskr"><i class="fa fa-check"></i><b>8.4</b> Simulační studie</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="simulace3diskr.html"><a href="simulace3diskr.html#grafický-výstup-3"><i class="fa fa-check"></i><b>8.4.1</b> Grafický výstup</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="simulace4.html"><a href="simulace4.html"><i class="fa fa-check"></i><b>9</b> Simulace 4</a>
<ul>
<li class="chapter" data-level="9.1" data-path="simulace4.html"><a href="simulace4.html#klasifikace-na-základě-první-derivace"><i class="fa fa-check"></i><b>9.1</b> Klasifikace na základě první derivace</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="simulace4.html"><a href="simulace4.html#vyhlazení-pozorovaných-křivek-8"><i class="fa fa-check"></i><b>9.1.1</b> Vyhlazení pozorovaných křivek</a></li>
<li class="chapter" data-level="9.1.2" data-path="simulace4.html"><a href="simulace4.html#výpočet-derivací"><i class="fa fa-check"></i><b>9.1.2</b> Výpočet derivací</a></li>
<li class="chapter" data-level="9.1.3" data-path="simulace4.html"><a href="simulace4.html#klasifikace-křivek-7"><i class="fa fa-check"></i><b>9.1.3</b> Klasifikace křivek</a></li>
<li class="chapter" data-level="9.1.4" data-path="simulace4.html"><a href="simulace4.html#simulační-studie-7"><i class="fa fa-check"></i><b>9.1.4</b> Simulační studie</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="simulace4.html"><a href="simulace4.html#klasifikace-na-základě-druhé-derivace"><i class="fa fa-check"></i><b>9.2</b> Klasifikace na základě druhé derivace</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="simulace4.html"><a href="simulace4.html#vyhlazení-pozorovaných-křivek-9"><i class="fa fa-check"></i><b>9.2.1</b> Vyhlazení pozorovaných křivek</a></li>
<li class="chapter" data-level="9.2.2" data-path="simulace4.html"><a href="simulace4.html#výpočet-derivací-1"><i class="fa fa-check"></i><b>9.2.2</b> Výpočet derivací</a></li>
<li class="chapter" data-level="9.2.3" data-path="simulace4.html"><a href="simulace4.html#klasifikace-křivek-8"><i class="fa fa-check"></i><b>9.2.3</b> Klasifikace křivek</a></li>
<li class="chapter" data-level="9.2.4" data-path="simulace4.html"><a href="simulace4.html#simulační-studie-8"><i class="fa fa-check"></i><b>9.2.4</b> Simulační studie</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Aplikace na datech</b></span></li>
<li class="chapter" data-level="10" data-path="aplikace1.html"><a href="aplikace1.html"><i class="fa fa-check"></i><b>10</b> Aplikace na reálných datech 1</a>
<ul>
<li class="chapter" data-level="10.1" data-path="aplikace1.html"><a href="aplikace1.html#vyhlazení-pozorovaných-křivek-10"><i class="fa fa-check"></i><b>10.1</b> Vyhlazení pozorovaných křivek</a></li>
<li class="chapter" data-level="10.2" data-path="aplikace1.html"><a href="aplikace1.html#klasifikace-křivek-9"><i class="fa fa-check"></i><b>10.2</b> Klasifikace křivek</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="aplikace1.html"><a href="aplikace1.html#k-nejbližších-sousedů-9"><i class="fa fa-check"></i><b>10.2.1</b> <span class="math inline">\(K\)</span> nejbližších sousedů</a></li>
<li class="chapter" data-level="10.2.2" data-path="aplikace1.html"><a href="aplikace1.html#lineární-diskriminační-analýza-9"><i class="fa fa-check"></i><b>10.2.2</b> Lineární diskriminační analýza</a></li>
<li class="chapter" data-level="10.2.3" data-path="aplikace1.html"><a href="aplikace1.html#kvadratická-diskriminační-analýza-9"><i class="fa fa-check"></i><b>10.2.3</b> Kvadratická diskriminační analýza</a></li>
<li class="chapter" data-level="10.2.4" data-path="aplikace1.html"><a href="aplikace1.html#logistická-regrese-7"><i class="fa fa-check"></i><b>10.2.4</b> Logistická regrese</a></li>
<li class="chapter" data-level="10.2.5" data-path="aplikace1.html"><a href="aplikace1.html#rozhodovací-stromy-6"><i class="fa fa-check"></i><b>10.2.5</b> Rozhodovací stromy</a></li>
<li class="chapter" data-level="10.2.6" data-path="aplikace1.html"><a href="aplikace1.html#náhodné-lesy-6"><i class="fa fa-check"></i><b>10.2.6</b> Náhodné lesy</a></li>
<li class="chapter" data-level="10.2.7" data-path="aplikace1.html"><a href="aplikace1.html#support-vector-machines-10"><i class="fa fa-check"></i><b>10.2.7</b> Support Vector Machines</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="aplikace1.html"><a href="aplikace1.html#tabulka-výsledků-10"><i class="fa fa-check"></i><b>10.3</b> Tabulka výsledků</a></li>
<li class="chapter" data-level="10.4" data-path="aplikace1.html"><a href="aplikace1.html#simstudyA1"><i class="fa fa-check"></i><b>10.4</b> Simulační studie</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="aplikace1.html"><a href="aplikace1.html#výsledky-5"><i class="fa fa-check"></i><b>10.4.1</b> Výsledky</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="aplikace2.html"><a href="aplikace2.html"><i class="fa fa-check"></i><b>11</b> Aplikace na reálných datech 2</a>
<ul>
<li class="chapter" data-level="11.1" data-path="aplikace2.html"><a href="aplikace2.html#vyhlazení-pozorovaných-křivek-11"><i class="fa fa-check"></i><b>11.1</b> Vyhlazení pozorovaných křivek</a></li>
<li class="chapter" data-level="11.2" data-path="aplikace2.html"><a href="aplikace2.html#klasifikace-křivek-10"><i class="fa fa-check"></i><b>11.2</b> Klasifikace křivek</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="aplikace2.html"><a href="aplikace2.html#k-nejbližších-sousedů-10"><i class="fa fa-check"></i><b>11.2.1</b> <span class="math inline">\(K\)</span> nejbližších sousedů</a></li>
<li class="chapter" data-level="11.2.2" data-path="aplikace2.html"><a href="aplikace2.html#lineární-diskriminační-analýza-10"><i class="fa fa-check"></i><b>11.2.2</b> Lineární diskriminační analýza</a></li>
<li class="chapter" data-level="11.2.3" data-path="aplikace2.html"><a href="aplikace2.html#kvadratická-diskriminační-analýza-10"><i class="fa fa-check"></i><b>11.2.3</b> Kvadratická diskriminační analýza</a></li>
<li class="chapter" data-level="11.2.4" data-path="aplikace2.html"><a href="aplikace2.html#logistická-regrese-8"><i class="fa fa-check"></i><b>11.2.4</b> Logistická regrese</a></li>
<li class="chapter" data-level="11.2.5" data-path="aplikace2.html"><a href="aplikace2.html#rozhodovací-stromy-7"><i class="fa fa-check"></i><b>11.2.5</b> Rozhodovací stromy</a></li>
<li class="chapter" data-level="11.2.6" data-path="aplikace2.html"><a href="aplikace2.html#náhodné-lesy-7"><i class="fa fa-check"></i><b>11.2.6</b> Náhodné lesy</a></li>
<li class="chapter" data-level="11.2.7" data-path="aplikace2.html"><a href="aplikace2.html#support-vector-machines-11"><i class="fa fa-check"></i><b>11.2.7</b> Support Vector Machines</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="aplikace2.html"><a href="aplikace2.html#tabulka-výsledků-11"><i class="fa fa-check"></i><b>11.3</b> Tabulka výsledků</a></li>
<li class="chapter" data-level="11.4" data-path="aplikace2.html"><a href="aplikace2.html#klasifikace-dalších-fonémů"><i class="fa fa-check"></i><b>11.4</b> Klasifikace dalších fonémů</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="aplikace2.html"><a href="aplikace2.html#ao-proti-dcl"><i class="fa fa-check"></i><b>11.4.1</b> <em>ao</em> proti <em>dcl</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="aplikace3.html"><a href="aplikace3.html"><i class="fa fa-check"></i><b>12</b> Aplikace na reálných datech 3</a>
<ul>
<li class="chapter" data-level="12.1" data-path="aplikace3.html"><a href="aplikace3.html#vyhlazení-pozorovaných-křivek-13"><i class="fa fa-check"></i><b>12.1</b> Vyhlazení pozorovaných křivek</a></li>
<li class="chapter" data-level="12.2" data-path="aplikace3.html"><a href="aplikace3.html#výpočet-derivací-2"><i class="fa fa-check"></i><b>12.2</b> Výpočet derivací</a></li>
<li class="chapter" data-level="12.3" data-path="aplikace3.html"><a href="aplikace3.html#klasifikace-křivek-12"><i class="fa fa-check"></i><b>12.3</b> Klasifikace křivek</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="aplikace3.html"><a href="aplikace3.html#k-nejbližších-sousedů-11"><i class="fa fa-check"></i><b>12.3.1</b> <span class="math inline">\(K\)</span> nejbližších sousedů</a></li>
<li class="chapter" data-level="12.3.2" data-path="aplikace3.html"><a href="aplikace3.html#lineární-diskriminační-analýza-12"><i class="fa fa-check"></i><b>12.3.2</b> Lineární diskriminační analýza</a></li>
<li class="chapter" data-level="12.3.3" data-path="aplikace3.html"><a href="aplikace3.html#kvadratická-diskriminační-analýza-11"><i class="fa fa-check"></i><b>12.3.3</b> Kvadratická diskriminační analýza</a></li>
<li class="chapter" data-level="12.3.4" data-path="aplikace3.html"><a href="aplikace3.html#logistická-regrese-10"><i class="fa fa-check"></i><b>12.3.4</b> Logistická regrese</a></li>
<li class="chapter" data-level="12.3.5" data-path="aplikace3.html"><a href="aplikace3.html#rozhodovací-stromy-8"><i class="fa fa-check"></i><b>12.3.5</b> Rozhodovací stromy</a></li>
<li class="chapter" data-level="12.3.6" data-path="aplikace3.html"><a href="aplikace3.html#náhodné-lesy-8"><i class="fa fa-check"></i><b>12.3.6</b> Náhodné lesy</a></li>
<li class="chapter" data-level="12.3.7" data-path="aplikace3.html"><a href="aplikace3.html#support-vector-machines-13"><i class="fa fa-check"></i><b>12.3.7</b> Support Vector Machines</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="aplikace3.html"><a href="aplikace3.html#tabulka-výsledků-13"><i class="fa fa-check"></i><b>12.4</b> Tabulka výsledků</a></li>
<li class="chapter" data-level="12.5" data-path="aplikace3.html"><a href="aplikace3.html#klasA3deriv"><i class="fa fa-check"></i><b>12.5</b> Klasifikace pomocí druhé derivace</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="aplikace3.html"><a href="aplikace3.html#k-nejbližších-sousedů-12"><i class="fa fa-check"></i><b>12.5.1</b> <span class="math inline">\(K\)</span> nejbližších sousedů</a></li>
<li class="chapter" data-level="12.5.2" data-path="aplikace3.html"><a href="aplikace3.html#lineární-diskriminační-analýza-13"><i class="fa fa-check"></i><b>12.5.2</b> Lineární diskriminační analýza</a></li>
<li class="chapter" data-level="12.5.3" data-path="aplikace3.html"><a href="aplikace3.html#kvadratická-diskriminační-analýza-12"><i class="fa fa-check"></i><b>12.5.3</b> Kvadratická diskriminační analýza</a></li>
<li class="chapter" data-level="12.5.4" data-path="aplikace3.html"><a href="aplikace3.html#logistická-regrese-11"><i class="fa fa-check"></i><b>12.5.4</b> Logistická regrese</a></li>
<li class="chapter" data-level="12.5.5" data-path="aplikace3.html"><a href="aplikace3.html#rozhodovací-stromy-9"><i class="fa fa-check"></i><b>12.5.5</b> Rozhodovací stromy</a></li>
<li class="chapter" data-level="12.5.6" data-path="aplikace3.html"><a href="aplikace3.html#náhodné-lesy-9"><i class="fa fa-check"></i><b>12.5.6</b> Náhodné lesy</a></li>
<li class="chapter" data-level="12.5.7" data-path="aplikace3.html"><a href="aplikace3.html#support-vector-machines-14"><i class="fa fa-check"></i><b>12.5.7</b> Support Vector Machines</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="aplikace3.html"><a href="aplikace3.html#tabulka-výsledků-14"><i class="fa fa-check"></i><b>12.6</b> Tabulka výsledků</a></li>
<li class="chapter" data-level="12.7" data-path="aplikace3.html"><a href="aplikace3.html#simstudyA3"><i class="fa fa-check"></i><b>12.7</b> Simulační studie</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="aplikace3.html"><a href="aplikace3.html#simulace-pro-nederivovaná-data"><i class="fa fa-check"></i><b>12.7.1</b> Simulace pro nederivovaná data</a></li>
<li class="chapter" data-level="12.7.2" data-path="aplikace3.html"><a href="aplikace3.html#simulace-pro-derivovaná-data"><i class="fa fa-check"></i><b>12.7.2</b> Simulace pro derivovaná data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="aplikace-na-reálných-datech-4.html"><a href="aplikace-na-reálných-datech-4.html"><i class="fa fa-check"></i><b>13</b> Aplikace na reálných datech 4</a>
<ul>
<li class="chapter" data-level="13.1" data-path="aplikace-na-reálných-datech-4.html"><a href="aplikace-na-reálných-datech-4.html#handwrit-data"><i class="fa fa-check"></i><b>13.1</b> <code>handwrit</code> data</a></li>
<li class="chapter" data-level="13.2" data-path="aplikace-na-reálných-datech-4.html"><a href="aplikace-na-reálných-datech-4.html#growth-data"><i class="fa fa-check"></i><b>13.2</b> <code>growth</code> data</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="podpůrné-materiály-pro-diplomovou-práci.html"><a href="podpůrné-materiály-pro-diplomovou-práci.html"><i class="fa fa-check"></i><b>14</b> Podpůrné materiály pro diplomovou práci</a>
<ul>
<li class="chapter" data-level="14.1" data-path="podpůrné-materiály-pro-diplomovou-práci.html"><a href="podpůrné-materiály-pro-diplomovou-práci.html#materiály-pro-kapitolu-1"><i class="fa fa-check"></i><b>14.1</b> Materiály pro Kapitolu 1</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="podpůrné-materiály-pro-diplomovou-práci.html"><a href="podpůrné-materiály-pro-diplomovou-práci.html#funkcionální-průměr"><i class="fa fa-check"></i><b>14.1.1</b> Funkcionální průměr</a></li>
<li class="chapter" data-level="14.1.2" data-path="podpůrné-materiály-pro-diplomovou-práci.html"><a href="podpůrné-materiály-pro-diplomovou-práci.html#variance"><i class="fa fa-check"></i><b>14.1.2</b> Variance</a></li>
<li class="chapter" data-level="14.1.3" data-path="podpůrné-materiály-pro-diplomovou-práci.html"><a href="podpůrné-materiály-pro-diplomovou-práci.html#kovariance-a-korelace"><i class="fa fa-check"></i><b>14.1.3</b> Kovariance a Korelace</a></li>
<li class="chapter" data-level="14.1.4" data-path="podpůrné-materiály-pro-diplomovou-práci.html"><a href="podpůrné-materiály-pro-diplomovou-práci.html#b-splinová-báze"><i class="fa fa-check"></i><b>14.1.4</b> B-splinová báze</a></li>
<li class="chapter" data-level="14.1.5" data-path="podpůrné-materiály-pro-diplomovou-práci.html"><a href="podpůrné-materiály-pro-diplomovou-práci.html#fourierova-báze"><i class="fa fa-check"></i><b>14.1.5</b> Fourierova báze</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="podpůrné-materiály-pro-diplomovou-práci.html"><a href="podpůrné-materiály-pro-diplomovou-práci.html#materiály-pro-kapitolu-2"><i class="fa fa-check"></i><b>14.2</b> Materiály pro Kapitolu 2</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="podpůrné-materiály-pro-diplomovou-práci.html"><a href="podpůrné-materiály-pro-diplomovou-práci.html#počet-bázových-funkcí-a-výsledný-odhad"><i class="fa fa-check"></i><b>14.2.1</b> Počet bázových funkcí a výsledný odhad</a></li>
<li class="chapter" data-level="14.2.2" data-path="podpůrné-materiály-pro-diplomovou-práci.html"><a href="podpůrné-materiály-pro-diplomovou-práci.html#volba-lambda"><i class="fa fa-check"></i><b>14.2.2</b> Volba <span class="math inline">\(\lambda\)</span></a></li>
<li class="chapter" data-level="14.2.3" data-path="podpůrné-materiály-pro-diplomovou-práci.html"><a href="podpůrné-materiály-pro-diplomovou-práci.html#vyhlazení-s-optimální-lambda"><i class="fa fa-check"></i><b>14.2.3</b> Vyhlazení s optimální <span class="math inline">\(\lambda\)</span></a></li>
<li class="chapter" data-level="14.2.4" data-path="podpůrné-materiály-pro-diplomovou-práci.html"><a href="podpůrné-materiály-pro-diplomovou-práci.html#funkcionální-pca"><i class="fa fa-check"></i><b>14.2.4</b> Funkcionální PCA</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="podpůrné-materiály-pro-diplomovou-práci.html"><a href="podpůrné-materiály-pro-diplomovou-práci.html#materiály-pro-kapitolu-3"><i class="fa fa-check"></i><b>14.3</b> Materiály pro Kapitolu 3</a></li>
<li class="chapter" data-level="14.4" data-path="podpůrné-materiály-pro-diplomovou-práci.html"><a href="podpůrné-materiály-pro-diplomovou-práci.html#materiály-pro-kapitolu-4"><i class="fa fa-check"></i><b>14.4</b> Materiály pro Kapitolu 4</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="podpůrné-materiály-pro-diplomovou-práci.html"><a href="podpůrné-materiály-pro-diplomovou-práci.html#maximal-margin-classifier"><i class="fa fa-check"></i><b>14.4.1</b> Maximal margin classifier</a></li>
<li class="chapter" data-level="14.4.2" data-path="podpůrné-materiály-pro-diplomovou-práci.html"><a href="podpůrné-materiály-pro-diplomovou-práci.html#support-vector-classifier"><i class="fa fa-check"></i><b>14.4.2</b> Support vector classifier</a></li>
<li class="chapter" data-level="14.4.3" data-path="podpůrné-materiály-pro-diplomovou-práci.html"><a href="podpůrné-materiály-pro-diplomovou-práci.html#support-vector-machines-15"><i class="fa fa-check"></i><b>14.4.3</b> Support vector machines</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="podpůrné-materiály-pro-diplomovou-práci.html"><a href="podpůrné-materiály-pro-diplomovou-práci.html#materiály-pro-kapitolu-5"><i class="fa fa-check"></i><b>14.5</b> Materiály pro Kapitolu 5</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="podpůrné-materiály-pro-diplomovou-práci.html"><a href="podpůrné-materiály-pro-diplomovou-práci.html#diskretizace-intervalu-25"><i class="fa fa-check"></i><b>14.5.1</b> Diskretizace intervalu</a></li>
<li class="chapter" data-level="14.5.2" data-path="podpůrné-materiály-pro-diplomovou-práci.html"><a href="podpůrné-materiály-pro-diplomovou-práci.html#support-vector-regression-svr"><i class="fa fa-check"></i><b>14.5.2</b> Support vector regression (SVR)</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="podpůrné-materiály-pro-diplomovou-práci.html"><a href="podpůrné-materiály-pro-diplomovou-práci.html#materiály-pro-kapitolu-6"><i class="fa fa-check"></i><b>14.6</b> Materiály pro Kapitolu 6</a></li>
<li class="chapter" data-level="14.7" data-path="podpůrné-materiály-pro-diplomovou-práci.html"><a href="podpůrné-materiály-pro-diplomovou-práci.html#materiály-pro-kapitolu-7"><i class="fa fa-check"></i><b>14.7</b> Materiály pro Kapitolu 7</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Diplomová práce</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="aplikace3" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">Kapitola 12</span> Aplikace na reálných datech 3<a href="aplikace3.html#aplikace3" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Stejně jako v předchozí kapitole se budeme v této části dokumentu zabývat aplikací dříve popsaných metod (pro více podrobností viz například sekci <a href="simulace1.html#simulace1">1</a>) na reálná data <code>tecator</code>, která jsou dostupná například v balíčku <code>ddalpha</code>. Podrobný popis dat pak můžeme nalézt <a href="https://search.r-project.org/CRAN/refmans/ddalpha/html/dataf.tecator.html">zde</a>. Jedná se o datový soubor obsahující spektrometrické křivky (absorbanční křivky měřené ve 100 vlnových délkách).</p>
<p>Pro každý kus jemně nasekaného masa pozorujeme jednu spektrometrickou křivku, která odpovídá absorbanci naměřené při 100 vlnových délkách. Kusy jsou rozděleny podle <a href="https://link.springer.com/book/10.1007/0-387-36620-2">Ferratyho a Vieu (2006)</a> do dvou tříd: s malým (<span class="math inline">\(&lt; 20\,\%\)</span>) a velkým (<span class="math inline">\(\geq 20\,\%\)</span>) obsahem tuku získaným analytickým chemickým zpracováním. Naším cílem bude klasifikovat spektrometrické křivky na intervalu <span class="math inline">\(I = [850 \text{ nm}, 1050 \text{ nm}]\)</span> na základě obsahu tuku. Jak uvidíme z výsledků v části <a href="aplikace3.html#klasA3deriv">12.5</a>, je výhodné uvažovat druhou derivaci křivek.</p>
<p>Začněme nejprve s načtením a vykreslením dat. Data jsou uložena poněkud složitě, proto pro lepší budou práci s nimi si je uložíme do praktičtějšího formátu. Pojmenujeme si také příslušné sloupce podle toho, zda obsah tuku je malý (<code>small</code>) nebo velký (<code>large</code>).</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="aplikace3.html#cb1-1" tabindex="-1"></a><span class="co"># nacteni dat </span></span>
<span id="cb1-2"><a href="aplikace3.html#cb1-2" tabindex="-1"></a><span class="fu">library</span>(fda)</span>
<span id="cb1-3"><a href="aplikace3.html#cb1-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="aplikace3.html#cb1-4" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-5"><a href="aplikace3.html#cb1-5" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-6"><a href="aplikace3.html#cb1-6" tabindex="-1"></a><span class="fu">library</span>(ddalpha)</span>
<span id="cb1-7"><a href="aplikace3.html#cb1-7" tabindex="-1"></a></span>
<span id="cb1-8"><a href="aplikace3.html#cb1-8" tabindex="-1"></a>data <span class="ot">&lt;-</span> ddalpha<span class="sc">::</span><span class="fu">dataf.tecator</span>()</span>
<span id="cb1-9"><a href="aplikace3.html#cb1-9" tabindex="-1"></a></span>
<span id="cb1-10"><a href="aplikace3.html#cb1-10" tabindex="-1"></a>data.gr <span class="ot">&lt;-</span> data<span class="sc">$</span>dataf[[<span class="dv">1</span>]]<span class="sc">$</span>vals</span>
<span id="cb1-11"><a href="aplikace3.html#cb1-11" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(data<span class="sc">$</span>labels)) {</span>
<span id="cb1-12"><a href="aplikace3.html#cb1-12" tabindex="-1"></a>  data.gr <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data.gr, data<span class="sc">$</span>dataf[[i]]<span class="sc">$</span>vals)</span>
<span id="cb1-13"><a href="aplikace3.html#cb1-13" tabindex="-1"></a>  }</span>
<span id="cb1-14"><a href="aplikace3.html#cb1-14" tabindex="-1"></a>data.gr <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">data.frame</span>(<span class="at">wave =</span> data<span class="sc">$</span>dataf[[<span class="dv">1</span>]]<span class="sc">$</span>args),</span>
<span id="cb1-15"><a href="aplikace3.html#cb1-15" tabindex="-1"></a>                 <span class="fu">t</span>(data.gr))</span>
<span id="cb1-16"><a href="aplikace3.html#cb1-16" tabindex="-1"></a></span>
<span id="cb1-17"><a href="aplikace3.html#cb1-17" tabindex="-1"></a><span class="co"># vektor trid</span></span>
<span id="cb1-18"><a href="aplikace3.html#cb1-18" tabindex="-1"></a>labels <span class="ot">&lt;-</span> data<span class="sc">$</span>labels <span class="sc">|&gt;</span> <span class="fu">unlist</span>()</span>
<span id="cb1-19"><a href="aplikace3.html#cb1-19" tabindex="-1"></a><span class="co"># prejmenovani podle tridy</span></span>
<span id="cb1-20"><a href="aplikace3.html#cb1-20" tabindex="-1"></a><span class="fu">colnames</span>(data.gr) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;wavelength&#39;</span>,</span>
<span id="cb1-21"><a href="aplikace3.html#cb1-21" tabindex="-1"></a>                       <span class="fu">paste0</span>(labels, <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(data<span class="sc">$</span>labels)))</span></code></pre></div>
</details>
<p>Spektrometrické křivky si vykresleme podle skupiny.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="aplikace3.html#cb2-1" tabindex="-1"></a>abs.labs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Obsah tuku &lt; 20 %&quot;</span>, <span class="st">&quot;Obsah tuku &gt; 20 %&quot;</span>)</span>
<span id="cb2-2"><a href="aplikace3.html#cb2-2" tabindex="-1"></a><span class="fu">names</span>(abs.labs) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;small&#39;</span>, <span class="st">&#39;large&#39;</span>)</span>
<span id="cb2-3"><a href="aplikace3.html#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="aplikace3.html#cb2-4" tabindex="-1"></a><span class="fu">pivot_longer</span>(data.gr, <span class="at">cols =</span> large1<span class="sc">:</span>large215, <span class="at">names_to =</span> <span class="st">&#39;sample&#39;</span>,</span>
<span id="cb2-5"><a href="aplikace3.html#cb2-5" tabindex="-1"></a>                        <span class="at">values_to =</span> <span class="st">&#39;absorbance&#39;</span>, <span class="at">cols_vary =</span> <span class="st">&#39;slowest&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-6"><a href="aplikace3.html#cb2-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="fu">as.factor</span>(sample),</span>
<span id="cb2-7"><a href="aplikace3.html#cb2-7" tabindex="-1"></a>         <span class="at">Abs =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(labels, <span class="at">each =</span> <span class="fu">length</span>(data.gr<span class="sc">$</span>wavelength)), </span>
<span id="cb2-8"><a href="aplikace3.html#cb2-8" tabindex="-1"></a>                      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;small&#39;</span>, <span class="st">&#39;large&#39;</span>))) <span class="sc">|&gt;</span></span>
<span id="cb2-9"><a href="aplikace3.html#cb2-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> wavelength, <span class="at">y =</span> absorbance, <span class="at">colour =</span> Abs, <span class="at">group =</span> sample)) <span class="sc">+</span> </span>
<span id="cb2-10"><a href="aplikace3.html#cb2-10" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb2-11"><a href="aplikace3.html#cb2-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb2-12"><a href="aplikace3.html#cb2-12" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Abs,</span>
<span id="cb2-13"><a href="aplikace3.html#cb2-13" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Abs =</span> abs.labs)) <span class="sc">+</span> </span>
<span id="cb2-14"><a href="aplikace3.html#cb2-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Vlnová délka [v nm]&quot;</span>,</span>
<span id="cb2-15"><a href="aplikace3.html#cb2-15" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Absorbance&quot;</span>,</span>
<span id="cb2-16"><a href="aplikace3.html#cb2-16" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&quot;Obsah tuku&quot;</span>) <span class="sc">+</span> </span>
<span id="cb2-17"><a href="aplikace3.html#cb2-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>) <span class="sc">+</span></span>
<span id="cb2-18"><a href="aplikace3.html#cb2-18" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">labels =</span> abs.labs)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-2"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-2-1.png" alt="Absorpční křivky podle skupiny." width="672" />
<p class="caption">
Obrázek 12.1: Absorpční křivky podle skupiny.
</p>
</div>
<div id="vyhlazení-pozorovaných-křivek-13" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> Vyhlazení pozorovaných křivek<a href="aplikace3.html#vyhlazení-pozorovaných-křivek-13" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Nyní převedeme pozorované diskrétní hodnoty (vektory hodnot) na funkcionální objekty, se kterými budeme následně pracovat.
Jelikož se nejedná o periodické křivky na intervalu <span class="math inline">\(I = [850, 1050]\)</span>, využijeme k vyhlazení B-sline bázi.</p>
<p>Za uzly bereme celý vektor <code>wavelength</code>, standardně bychom uvažovali kubické spliny, protože ale budeme chtít pracovat s druhou derivací, volíme <code>norder = 6</code>. Ze stejného důvodu budeme penalizovat čtvrtou derivaci funkcí.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="aplikace3.html#cb3-1" tabindex="-1"></a>t <span class="ot">&lt;-</span> data.gr<span class="sc">$</span>wavelength</span>
<span id="cb3-2"><a href="aplikace3.html#cb3-2" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb3-3"><a href="aplikace3.html#cb3-3" tabindex="-1"></a>breaks <span class="ot">&lt;-</span> t</span>
<span id="cb3-4"><a href="aplikace3.html#cb3-4" tabindex="-1"></a>norder <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb3-5"><a href="aplikace3.html#cb3-5" tabindex="-1"></a></span>
<span id="cb3-6"><a href="aplikace3.html#cb3-6" tabindex="-1"></a>bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb3-7"><a href="aplikace3.html#cb3-7" tabindex="-1"></a>                               <span class="at">norder =</span> norder, </span>
<span id="cb3-8"><a href="aplikace3.html#cb3-8" tabindex="-1"></a>                               <span class="at">breaks =</span> breaks)</span>
<span id="cb3-9"><a href="aplikace3.html#cb3-9" tabindex="-1"></a></span>
<span id="cb3-10"><a href="aplikace3.html#cb3-10" tabindex="-1"></a>curv.Lfd <span class="ot">&lt;-</span> <span class="fu">int2Lfd</span>(<span class="dv">4</span>) <span class="co"># penalizujeme 4. derivaci</span></span></code></pre></div>
</details>
<p>Najdeme vhodnou hodnotu vyhlazovacího parametru <span class="math inline">\(\lambda &gt; 0\)</span> pomocí <span class="math inline">\(GCV(\lambda)\)</span>, tedy pomocí zobecněné cross–validace.
Hodnotu <span class="math inline">\(\lambda\)</span> budeme uvažovat pro obě pohlaví stejnou, neboť pro testovací pozorování bychom dopředu nevěděli, kterou hodnotu <span class="math inline">\(\lambda\)</span> máme v případě rozdílné volby pro každou třídu volit.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="aplikace3.html#cb4-1" tabindex="-1"></a><span class="co"># spojeni pozorovani do jedne matice</span></span>
<span id="cb4-2"><a href="aplikace3.html#cb4-2" tabindex="-1"></a>XX <span class="ot">&lt;-</span> data.gr[, <span class="sc">-</span><span class="dv">1</span>] <span class="sc">|&gt;</span> <span class="fu">as.matrix</span>()</span>
<span id="cb4-3"><a href="aplikace3.html#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="aplikace3.html#cb4-4" tabindex="-1"></a>lambda.vect <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">to =</span> <span class="fl">0.5</span>, <span class="at">length.out =</span> <span class="dv">50</span>) <span class="co"># vektor lambd</span></span>
<span id="cb4-5"><a href="aplikace3.html#cb4-5" tabindex="-1"></a>gcv <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="at">length =</span> <span class="fu">length</span>(lambda.vect)) <span class="co"># prazdny vektor pro ulozebi GCV</span></span>
<span id="cb4-6"><a href="aplikace3.html#cb4-6" tabindex="-1"></a></span>
<span id="cb4-7"><a href="aplikace3.html#cb4-7" tabindex="-1"></a><span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambda.vect)) {</span>
<span id="cb4-8"><a href="aplikace3.html#cb4-8" tabindex="-1"></a>  curv.Fdpar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.vect[index])</span>
<span id="cb4-9"><a href="aplikace3.html#cb4-9" tabindex="-1"></a>  BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.Fdpar) <span class="co"># vyhlazeni</span></span>
<span id="cb4-10"><a href="aplikace3.html#cb4-10" tabindex="-1"></a>  gcv[index] <span class="ot">&lt;-</span> <span class="fu">mean</span>(BSmooth<span class="sc">$</span>gcv) <span class="co"># prumer pres vsechny pozorovane krivky</span></span>
<span id="cb4-11"><a href="aplikace3.html#cb4-11" tabindex="-1"></a>}</span>
<span id="cb4-12"><a href="aplikace3.html#cb4-12" tabindex="-1"></a></span>
<span id="cb4-13"><a href="aplikace3.html#cb4-13" tabindex="-1"></a>GCV <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb4-14"><a href="aplikace3.html#cb4-14" tabindex="-1"></a>  <span class="at">lambda =</span> <span class="fu">round</span>(<span class="fu">log10</span>(lambda.vect), <span class="dv">3</span>),</span>
<span id="cb4-15"><a href="aplikace3.html#cb4-15" tabindex="-1"></a>  <span class="at">GCV =</span> gcv</span>
<span id="cb4-16"><a href="aplikace3.html#cb4-16" tabindex="-1"></a>)</span>
<span id="cb4-17"><a href="aplikace3.html#cb4-17" tabindex="-1"></a></span>
<span id="cb4-18"><a href="aplikace3.html#cb4-18" tabindex="-1"></a><span class="co"># najdeme hodnotu minima</span></span>
<span id="cb4-19"><a href="aplikace3.html#cb4-19" tabindex="-1"></a>lambda.opt <span class="ot">&lt;-</span> lambda.vect[<span class="fu">which.min</span>(gcv)]</span></code></pre></div>
</details>
<p>Pro lepší znázornění si vykreslíme průběh <span class="math inline">\(GCV(\lambda)\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="aplikace3.html#cb5-1" tabindex="-1"></a>GCV <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lambda, <span class="at">y =</span> GCV)) <span class="sc">+</span> </span>
<span id="cb5-2"><a href="aplikace3.html#cb5-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb5-3"><a href="aplikace3.html#cb5-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.7</span>) <span class="sc">+</span> </span>
<span id="cb5-4"><a href="aplikace3.html#cb5-4" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb5-5"><a href="aplikace3.html#cb5-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(log[<span class="dv">10</span>](lambda), <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb5-6"><a href="aplikace3.html#cb5-6" tabindex="-1"></a>                        lambda[optimal] <span class="sc">==</span> .(<span class="fu">round</span>(lambda.opt, <span class="dv">4</span>)))),</span>
<span id="cb5-7"><a href="aplikace3.html#cb5-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">GCV</span>(lambda))) <span class="sc">+</span> </span>
<span id="cb5-8"><a href="aplikace3.html#cb5-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(lambda.opt), <span class="at">y =</span> <span class="fu">min</span>(gcv)), <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-5"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-5-1.png" alt="Průběh $GCV(\lambda)$ pro zvolený vektor $\boldsymbol\lambda$. Na ose $x$ jsou hodnoty vyneseny v logaritmické škále při základu 10. Červeně je znázorněna optimální hodnota vyhlazovacího parametru $\lambda_{optimal}$." width="672" />
<p class="caption">
Obrázek 12.2: Průběh <span class="math inline">\(GCV(\lambda)\)</span> pro zvolený vektor <span class="math inline">\(\boldsymbol\lambda\)</span>. Na ose <span class="math inline">\(x\)</span> jsou hodnoty vyneseny v logaritmické škále při základu 10. Červeně je znázorněna optimální hodnota vyhlazovacího parametru <span class="math inline">\(\lambda_{optimal}\)</span>.
</p>
</div>
<p>S touto optimální volbou vyhlazovacího parametru <span class="math inline">\(\lambda\)</span> nyní vyhladíme všechny funkce.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="aplikace3.html#cb6-1" tabindex="-1"></a>curv.fdPar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.opt)</span>
<span id="cb6-2"><a href="aplikace3.html#cb6-2" tabindex="-1"></a>BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.fdPar)</span>
<span id="cb6-3"><a href="aplikace3.html#cb6-3" tabindex="-1"></a>XXfd <span class="ot">&lt;-</span> BSmooth<span class="sc">$</span>fd</span>
<span id="cb6-4"><a href="aplikace3.html#cb6-4" tabindex="-1"></a></span>
<span id="cb6-5"><a href="aplikace3.html#cb6-5" tabindex="-1"></a>fdobjSmootheval <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> XXfd, <span class="at">evalarg =</span> t)</span></code></pre></div>
</details>
<p>Ještě znázorněme všechny křivky včetně průměru zvlášť pro každou třídu.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="aplikace3.html#cb7-1" tabindex="-1"></a><span class="fu">library</span>(tikzDevice)</span>
<span id="cb7-2"><a href="aplikace3.html#cb7-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">dim</span>(XX)[<span class="dv">2</span>]</span>
<span id="cb7-3"><a href="aplikace3.html#cb7-3" tabindex="-1"></a></span>
<span id="cb7-4"><a href="aplikace3.html#cb7-4" tabindex="-1"></a>DFsmooth <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb7-5"><a href="aplikace3.html#cb7-5" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, n),</span>
<span id="cb7-6"><a href="aplikace3.html#cb7-6" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">each =</span> <span class="fu">length</span>(t))),</span>
<span id="cb7-7"><a href="aplikace3.html#cb7-7" tabindex="-1"></a>  <span class="at">Smooth =</span> <span class="fu">c</span>(fdobjSmootheval),</span>
<span id="cb7-8"><a href="aplikace3.html#cb7-8" tabindex="-1"></a>  <span class="at">Fat =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(labels, <span class="at">each =</span> <span class="fu">length</span>(t)), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;small&#39;</span>, <span class="st">&#39;large&#39;</span>))</span>
<span id="cb7-9"><a href="aplikace3.html#cb7-9" tabindex="-1"></a>)</span>
<span id="cb7-10"><a href="aplikace3.html#cb7-10" tabindex="-1"></a></span>
<span id="cb7-11"><a href="aplikace3.html#cb7-11" tabindex="-1"></a>DFmean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb7-12"><a href="aplikace3.html#cb7-12" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span>),</span>
<span id="cb7-13"><a href="aplikace3.html#cb7-13" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">eval.fd</span>(<span class="at">fdobj =</span> <span class="fu">mean.fd</span>(XXfd[labels <span class="sc">==</span> <span class="st">&#39;small&#39;</span>]), <span class="at">evalarg =</span> t),</span>
<span id="cb7-14"><a href="aplikace3.html#cb7-14" tabindex="-1"></a>           <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> <span class="fu">mean.fd</span>(XXfd[labels <span class="sc">==</span> <span class="st">&#39;large&#39;</span>]), <span class="at">evalarg =</span> t)),</span>
<span id="cb7-15"><a href="aplikace3.html#cb7-15" tabindex="-1"></a>  <span class="co"># c(apply(fdobjSmootheval[ , labels == &#39;small&#39;], 1, mean), </span></span>
<span id="cb7-16"><a href="aplikace3.html#cb7-16" tabindex="-1"></a>  <span class="co">#           apply(fdobjSmootheval[ , labels == &#39;large&#39;], 1, mean)),</span></span>
<span id="cb7-17"><a href="aplikace3.html#cb7-17" tabindex="-1"></a>  <span class="at">Fat =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;small&#39;</span>, <span class="st">&#39;large&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(t)),</span>
<span id="cb7-18"><a href="aplikace3.html#cb7-18" tabindex="-1"></a>                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;small&#39;</span>, <span class="st">&#39;large&#39;</span>))</span>
<span id="cb7-19"><a href="aplikace3.html#cb7-19" tabindex="-1"></a>)</span>
<span id="cb7-20"><a href="aplikace3.html#cb7-20" tabindex="-1"></a></span>
<span id="cb7-21"><a href="aplikace3.html#cb7-21" tabindex="-1"></a>DFsmooth <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Smooth, <span class="at">color =</span> Fat)) <span class="sc">+</span> </span>
<span id="cb7-22"><a href="aplikace3.html#cb7-22" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.05</span>, <span class="fu">aes</span>(<span class="at">group =</span> time), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb7-23"><a href="aplikace3.html#cb7-23" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb7-24"><a href="aplikace3.html#cb7-24" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Fat,</span>
<span id="cb7-25"><a href="aplikace3.html#cb7-25" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Fat =</span> abs.labs)</span>
<span id="cb7-26"><a href="aplikace3.html#cb7-26" tabindex="-1"></a>             ) <span class="sc">+</span> </span>
<span id="cb7-27"><a href="aplikace3.html#cb7-27" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Vlnová délka&quot;</span>,</span>
<span id="cb7-28"><a href="aplikace3.html#cb7-28" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Absorbance&quot;</span>,</span>
<span id="cb7-29"><a href="aplikace3.html#cb7-29" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&quot;Obsah tuku&quot;</span>) <span class="sc">+</span> </span>
<span id="cb7-30"><a href="aplikace3.html#cb7-30" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>) <span class="sc">+</span></span>
<span id="cb7-31"><a href="aplikace3.html#cb7-31" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> DFmean, <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Mean), </span>
<span id="cb7-32"><a href="aplikace3.html#cb7-32" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">&#39;grey2&#39;</span>, <span class="at">linewidth =</span> <span class="fl">1.25</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>) <span class="sc">+</span></span>
<span id="cb7-33"><a href="aplikace3.html#cb7-33" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;tomato&#39;</span>, <span class="st">&#39;deepskyblue2&#39;</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-7"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-7-1.png" alt="Vykreslení všech vyhlazených pozorovaných křivek, barevně jsou odlišeny křivky podle třídy Černou čarou je zakreslen průměr pro každou třídu." width="672" />
<p class="caption">
Obrázek 12.3: Vykreslení všech vyhlazených pozorovaných křivek, barevně jsou odlišeny křivky podle třídy Černou čarou je zakreslen průměr pro každou třídu.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="aplikace3.html#cb8-1" tabindex="-1"></a><span class="co"># ggsave(&quot;figures/kap7_tecator_curves_mean.tex&quot;, device = tikz, width = 9, height = 4.5)</span></span></code></pre></div>
</details>
<p>Vidíme, že křivky pro obě skupiny (podle obsahu tuku) jsou poměrně podobné, černou čarou je znázorněn průměr. Křivky se liší zejména uprostřed intervalu, kde u tučnějších vzorků nastává o jeden lokální extrém více, naopak u méně tučných vzorků vypadají křivky jednodušeji pouze s jedním extrémem.</p>
</div>
<div id="výpočet-derivací-2" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> Výpočet derivací<a href="aplikace3.html#výpočet-derivací-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Jak jsme již zmínili výše, bude výhodné klasifikovat křivky na základě druhé derivace. K výpočtu derivace pro funkcionální objekt využijeme v <code>R</code> funkci <code>deriv.fd()</code> z balíčku <code>fda</code>. Jelikož chceme klasifikovat na základě druhé derivace, volíme argument <code>Lfdobj = 2</code>. Využití těchto dat bude ukázáno v Sekci <a href="aplikace3.html#klasA3deriv">12.5</a>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="aplikace3.html#cb9-1" tabindex="-1"></a>XXder <span class="ot">&lt;-</span> <span class="fu">deriv.fd</span>(XXfd, <span class="dv">2</span>)</span>
<span id="cb9-2"><a href="aplikace3.html#cb9-2" tabindex="-1"></a>ttt <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(t), <span class="fu">max</span>(t), <span class="at">length =</span> <span class="dv">501</span>)</span>
<span id="cb9-3"><a href="aplikace3.html#cb9-3" tabindex="-1"></a>fdobjSmootheval_der2 <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> XXder, </span>
<span id="cb9-4"><a href="aplikace3.html#cb9-4" tabindex="-1"></a>                                <span class="at">evalarg =</span> ttt)</span></code></pre></div>
</details>
<p>Ještě znázorněme všechny křivky včetně průměru zvlášť pro každou třídu.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="aplikace3.html#cb10-1" tabindex="-1"></a>DFsmooth <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb10-2"><a href="aplikace3.html#cb10-2" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(ttt, n),</span>
<span id="cb10-3"><a href="aplikace3.html#cb10-3" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">each =</span> <span class="fu">length</span>(ttt))),</span>
<span id="cb10-4"><a href="aplikace3.html#cb10-4" tabindex="-1"></a>  <span class="at">Smooth =</span> <span class="fu">c</span>(fdobjSmootheval_der2),</span>
<span id="cb10-5"><a href="aplikace3.html#cb10-5" tabindex="-1"></a>  <span class="at">Fat =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(labels, <span class="at">each =</span> <span class="fu">length</span>(ttt)), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;small&#39;</span>, <span class="st">&#39;large&#39;</span>))</span>
<span id="cb10-6"><a href="aplikace3.html#cb10-6" tabindex="-1"></a>)</span>
<span id="cb10-7"><a href="aplikace3.html#cb10-7" tabindex="-1"></a></span>
<span id="cb10-8"><a href="aplikace3.html#cb10-8" tabindex="-1"></a>DFmean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb10-9"><a href="aplikace3.html#cb10-9" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(ttt, <span class="dv">2</span>),</span>
<span id="cb10-10"><a href="aplikace3.html#cb10-10" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">eval.fd</span>(<span class="at">fdobj =</span> <span class="fu">mean.fd</span>(XXder[labels <span class="sc">==</span> <span class="st">&#39;small&#39;</span>]), <span class="at">evalarg =</span> ttt),</span>
<span id="cb10-11"><a href="aplikace3.html#cb10-11" tabindex="-1"></a>           <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> <span class="fu">mean.fd</span>(XXder[labels <span class="sc">==</span> <span class="st">&#39;large&#39;</span>]), <span class="at">evalarg =</span> ttt)),</span>
<span id="cb10-12"><a href="aplikace3.html#cb10-12" tabindex="-1"></a>  <span class="at">Fat =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;small&#39;</span>, <span class="st">&#39;large&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(ttt)),</span>
<span id="cb10-13"><a href="aplikace3.html#cb10-13" tabindex="-1"></a>                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;small&#39;</span>, <span class="st">&#39;large&#39;</span>))</span>
<span id="cb10-14"><a href="aplikace3.html#cb10-14" tabindex="-1"></a>)</span>
<span id="cb10-15"><a href="aplikace3.html#cb10-15" tabindex="-1"></a></span>
<span id="cb10-16"><a href="aplikace3.html#cb10-16" tabindex="-1"></a>DFsmooth <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Smooth, <span class="at">color =</span> Fat)) <span class="sc">+</span> </span>
<span id="cb10-17"><a href="aplikace3.html#cb10-17" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.05</span>, <span class="fu">aes</span>(<span class="at">group =</span> time), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb10-18"><a href="aplikace3.html#cb10-18" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb10-19"><a href="aplikace3.html#cb10-19" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Fat<span class="co">#,</span></span>
<span id="cb10-20"><a href="aplikace3.html#cb10-20" tabindex="-1"></a>             <span class="co">#labeller = labeller(Fat = abs.labs)</span></span>
<span id="cb10-21"><a href="aplikace3.html#cb10-21" tabindex="-1"></a>             ) <span class="sc">+</span> </span>
<span id="cb10-22"><a href="aplikace3.html#cb10-22" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Vlnová délka&quot;</span>,</span>
<span id="cb10-23"><a href="aplikace3.html#cb10-23" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Absorbance&quot;</span>,</span>
<span id="cb10-24"><a href="aplikace3.html#cb10-24" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&quot;Obsah tuku&quot;</span>) <span class="sc">+</span> </span>
<span id="cb10-25"><a href="aplikace3.html#cb10-25" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>) <span class="sc">+</span></span>
<span id="cb10-26"><a href="aplikace3.html#cb10-26" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> DFmean, <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Mean), </span>
<span id="cb10-27"><a href="aplikace3.html#cb10-27" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">&#39;grey2&#39;</span>, <span class="at">linewidth =</span> <span class="fl">1.25</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>) <span class="sc">+</span></span>
<span id="cb10-28"><a href="aplikace3.html#cb10-28" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;tomato&#39;</span>, <span class="st">&#39;deepskyblue2&#39;</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-9"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-9-1.png" alt="Vykreslení všech vyhlazených pozorovaných křivek, barevně jsou odlišeny křivky podle příslušnosti do klasifikační třídy. Černou čarou je zakreslen průměr pro každou třídu." width="672" />
<p class="caption">
Obrázek 12.4: Vykreslení všech vyhlazených pozorovaných křivek, barevně jsou odlišeny křivky podle příslušnosti do klasifikační třídy. Černou čarou je zakreslen průměr pro každou třídu.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="aplikace3.html#cb11-1" tabindex="-1"></a><span class="co"># ggsave(&quot;figures/kap7_tecator_curves_derivatives.tex&quot;, device = tikz, width = 9, height = 4.5)</span></span></code></pre></div>
</details>
<p>Vidíme z obrázku výše, že nyní se průměrné křivky mezi oběma skupinami vzorků liší mnohem výrazněji než v případě původních nederivovaných křivek.</p>
</div>
<div id="klasifikace-křivek-12" class="section level2 hasAnchor" number="12.3">
<h2><span class="header-section-number">12.3</span> Klasifikace křivek<a href="aplikace3.html#klasifikace-křivek-12" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>V první části této kapitoly se budeme věnovat klasifikaci původních nederivovaných křivek. Klasifikaci na základě druhé derivace původních křivek uvidíme dále v Sekci <a href="aplikace3.html#klasA3deriv">12.5</a>.
Nejprve načteme potřebné knihovny pro klasifikaci.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="aplikace3.html#cb12-1" tabindex="-1"></a><span class="fu">library</span>(caTools) <span class="co"># pro rozdeleni na testovaci a trenovaci</span></span>
<span id="cb12-2"><a href="aplikace3.html#cb12-2" tabindex="-1"></a><span class="fu">library</span>(caret) <span class="co"># pro k-fold CV</span></span>
<span id="cb12-3"><a href="aplikace3.html#cb12-3" tabindex="-1"></a><span class="fu">library</span>(fda.usc) <span class="co"># pro KNN, fLR</span></span>
<span id="cb12-4"><a href="aplikace3.html#cb12-4" tabindex="-1"></a><span class="fu">library</span>(MASS) <span class="co"># pro LDA</span></span>
<span id="cb12-5"><a href="aplikace3.html#cb12-5" tabindex="-1"></a><span class="fu">library</span>(fdapace)</span>
<span id="cb12-6"><a href="aplikace3.html#cb12-6" tabindex="-1"></a><span class="fu">library</span>(pracma)</span>
<span id="cb12-7"><a href="aplikace3.html#cb12-7" tabindex="-1"></a><span class="fu">library</span>(refund) <span class="co"># pro LR na skorech</span></span>
<span id="cb12-8"><a href="aplikace3.html#cb12-8" tabindex="-1"></a><span class="fu">library</span>(nnet) <span class="co"># pro LR na skorech</span></span>
<span id="cb12-9"><a href="aplikace3.html#cb12-9" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb12-10"><a href="aplikace3.html#cb12-10" tabindex="-1"></a><span class="fu">library</span>(rpart) <span class="co"># stromy</span></span>
<span id="cb12-11"><a href="aplikace3.html#cb12-11" tabindex="-1"></a><span class="fu">library</span>(rattle) <span class="co"># grafika</span></span>
<span id="cb12-12"><a href="aplikace3.html#cb12-12" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb12-13"><a href="aplikace3.html#cb12-13" tabindex="-1"></a><span class="fu">library</span>(randomForest) <span class="co"># nahodny les</span></span>
<span id="cb12-14"><a href="aplikace3.html#cb12-14" tabindex="-1"></a></span>
<span id="cb12-15"><a href="aplikace3.html#cb12-15" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span></code></pre></div>
</details>
<p>Rozdělíme data v poměru 30:70 na testovací a trénovací část, abychom mohli stanovit úspěšnost klasifikace jednotlivých metod. Trénovací část použijeme při konstrukci klasifikátoru a testovací na výpočet chyby klasifikace a případně dalších charakteristik našeho modelu. Výsledné klasifikátory podle těchto spočtených charakteristik můžeme následně porovnat mezi sebou z pohledu jejich úspěšnosti klasifikace.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="aplikace3.html#cb13-1" tabindex="-1"></a><span class="co"># rozdeleni na testovaci a trenovaci cast</span></span>
<span id="cb13-2"><a href="aplikace3.html#cb13-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb13-3"><a href="aplikace3.html#cb13-3" tabindex="-1"></a>split <span class="ot">&lt;-</span> <span class="fu">sample.split</span>(XXfd<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb13-4"><a href="aplikace3.html#cb13-4" tabindex="-1"></a></span>
<span id="cb13-5"><a href="aplikace3.html#cb13-5" tabindex="-1"></a><span class="co"># vytvoreni vektoru 0 a 1, 0 pro &lt; 20 a 1 pro &gt; 20 </span></span>
<span id="cb13-6"><a href="aplikace3.html#cb13-6" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(labels <span class="sc">==</span> <span class="st">&#39;large&#39;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb13-7"><a href="aplikace3.html#cb13-7" tabindex="-1"></a></span>
<span id="cb13-8"><a href="aplikace3.html#cb13-8" tabindex="-1"></a>X.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-9"><a href="aplikace3.html#cb13-9" tabindex="-1"></a>X.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb13-10"><a href="aplikace3.html#cb13-10" tabindex="-1"></a></span>
<span id="cb13-11"><a href="aplikace3.html#cb13-11" tabindex="-1"></a>Y.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-12"><a href="aplikace3.html#cb13-12" tabindex="-1"></a>Y.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</details>
<p>Ještě se podíváme na zastoupení jednotlivých skupin v testovací a trénovací části dat.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="aplikace3.html#cb14-1" tabindex="-1"></a><span class="co"># absolutni zastoupeni</span></span>
<span id="cb14-2"><a href="aplikace3.html#cb14-2" tabindex="-1"></a><span class="fu">table</span>(Y.train)</span></code></pre></div>
</details>
<pre><code>## Y.train
##  0  1 
## 91 59</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="aplikace3.html#cb16-1" tabindex="-1"></a><span class="fu">table</span>(Y.test)</span></code></pre></div>
</details>
<pre><code>## Y.test
##  0  1 
## 47 18</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="aplikace3.html#cb18-1" tabindex="-1"></a><span class="co"># relativni zastoupeni</span></span>
<span id="cb18-2"><a href="aplikace3.html#cb18-2" tabindex="-1"></a><span class="fu">table</span>(Y.train) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">table</span>(Y.train))</span></code></pre></div>
</details>
<pre><code>## Y.train
##         0         1 
## 0.6066667 0.3933333</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="aplikace3.html#cb20-1" tabindex="-1"></a><span class="fu">table</span>(Y.test) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">table</span>(Y.test))</span></code></pre></div>
</details>
<pre><code>## Y.test
##         0         1 
## 0.7230769 0.2769231</code></pre>
<div id="k-nejbližších-sousedů-11" class="section level3 hasAnchor" number="12.3.1">
<h3><span class="header-section-number">12.3.1</span> <span class="math inline">\(K\)</span> nejbližších sousedů<a href="aplikace3.html#k-nejbližších-sousedů-11" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Začněme neparametrickou klasifikační metodou, a to metodou <span class="math inline">\(K\)</span> nejbližších sousedů.
Nejprve si vytvoříme potřebné objekty tak, abychom s nimi mohli pomocí funkce <code>classif.knn()</code> z knihovny <code>fda.usc</code> dále pracovat.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="aplikace3.html#cb22-1" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb22-2"><a href="aplikace3.html#cb22-2" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.train))</span></code></pre></div>
</details>
<p>Nyní můžeme definovat model a podívat se na jeho úspěšnost klasifikace.
Poslední otázkou však zůstává, jak volit optimální počet sousedů <span class="math inline">\(K\)</span>.
Mohli bychom tento počet volit jako takové <span class="math inline">\(K\)</span>, při kterém nastává minimální chybovost na trénovacích datech.
To by ale mohlo vést k přeučení modelu, proto využijeme cross-validaci.
Vzhledem k výpočetní náročnosti a rozsahu souboru zvolíme <span class="math inline">\(k\)</span>-násobnou CV, my zvolíme například hodnotu <span class="math inline">\(k = {10}\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="aplikace3.html#cb23-1" tabindex="-1"></a><span class="co"># model pro vsechna trenovaci data pro K = 1, 2, ..., sqrt(n_train)</span></span>
<span id="cb23-2"><a href="aplikace3.html#cb23-2" tabindex="-1"></a>neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, </span>
<span id="cb23-3"><a href="aplikace3.html#cb23-3" tabindex="-1"></a>                            <span class="at">fdataobj =</span> x.train, </span>
<span id="cb23-4"><a href="aplikace3.html#cb23-4" tabindex="-1"></a>                            <span class="at">knn =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">round</span>(<span class="fu">sqrt</span>(<span class="fu">length</span>(y.train))))) </span>
<span id="cb23-5"><a href="aplikace3.html#cb23-5" tabindex="-1"></a></span>
<span id="cb23-6"><a href="aplikace3.html#cb23-6" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> neighb.model<span class="sc">$</span>max.prob <span class="co"># minimalni chybovost</span></span></code></pre></div>
</details>
<pre><code>## [1] 0.1466667</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="aplikace3.html#cb25-1" tabindex="-1"></a>(K.opt <span class="ot">&lt;-</span> neighb.model<span class="sc">$</span>h.opt) <span class="co"># optimalni hodnota K</span></span></code></pre></div>
</details>
<pre><code>## [1] 1</code></pre>
<p>Proveďme předchozí postup pro trénovací data, která rozdělíme na <span class="math inline">\(k\)</span> částí a tedy zopakujeme tuto část kódu <span class="math inline">\(k\)</span>-krát.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="aplikace3.html#cb27-1" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb27-2"><a href="aplikace3.html#cb27-2" tabindex="-1"></a>neighbours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">ceiling</span>(<span class="fu">sqrt</span>(<span class="fu">length</span>(y.train))))) <span class="co"># pocet sousedu </span></span>
<span id="cb27-3"><a href="aplikace3.html#cb27-3" tabindex="-1"></a></span>
<span id="cb27-4"><a href="aplikace3.html#cb27-4" tabindex="-1"></a><span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb27-5"><a href="aplikace3.html#cb27-5" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb27-6"><a href="aplikace3.html#cb27-6" tabindex="-1"></a></span>
<span id="cb27-7"><a href="aplikace3.html#cb27-7" tabindex="-1"></a><span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb27-8"><a href="aplikace3.html#cb27-8" tabindex="-1"></a><span class="co"># ve sloupcich budou hodnoty presnosti pro danou cast trenovaci mnoziny</span></span>
<span id="cb27-9"><a href="aplikace3.html#cb27-9" tabindex="-1"></a><span class="co"># v radcich budou hodnoty pro danou hodnotu K sousedu</span></span>
<span id="cb27-10"><a href="aplikace3.html#cb27-10" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(neighbours), <span class="at">ncol =</span> k_cv)</span>
<span id="cb27-11"><a href="aplikace3.html#cb27-11" tabindex="-1"></a></span>
<span id="cb27-12"><a href="aplikace3.html#cb27-12" tabindex="-1"></a><span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb27-13"><a href="aplikace3.html#cb27-13" tabindex="-1"></a>  <span class="co"># definujeme danou indexovou mnozinu</span></span>
<span id="cb27-14"><a href="aplikace3.html#cb27-14" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb27-15"><a href="aplikace3.html#cb27-15" tabindex="-1"></a>    </span>
<span id="cb27-16"><a href="aplikace3.html#cb27-16" tabindex="-1"></a>  x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb27-17"><a href="aplikace3.html#cb27-17" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb27-18"><a href="aplikace3.html#cb27-18" tabindex="-1"></a>  y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb27-19"><a href="aplikace3.html#cb27-19" tabindex="-1"></a>    <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb27-20"><a href="aplikace3.html#cb27-20" tabindex="-1"></a>  </span>
<span id="cb27-21"><a href="aplikace3.html#cb27-21" tabindex="-1"></a>  x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb27-22"><a href="aplikace3.html#cb27-22" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb27-23"><a href="aplikace3.html#cb27-23" tabindex="-1"></a>  y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb27-24"><a href="aplikace3.html#cb27-24" tabindex="-1"></a>    <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb27-25"><a href="aplikace3.html#cb27-25" tabindex="-1"></a>  </span>
<span id="cb27-26"><a href="aplikace3.html#cb27-26" tabindex="-1"></a>  <span class="co"># projdeme kazdou cast ... k-krat zopakujeme</span></span>
<span id="cb27-27"><a href="aplikace3.html#cb27-27" tabindex="-1"></a>  <span class="cf">for</span>(neighbour <span class="cf">in</span> neighbours) {</span>
<span id="cb27-28"><a href="aplikace3.html#cb27-28" tabindex="-1"></a>    <span class="co"># model pro konkretni volbu K</span></span>
<span id="cb27-29"><a href="aplikace3.html#cb27-29" tabindex="-1"></a>    neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train.cv, </span>
<span id="cb27-30"><a href="aplikace3.html#cb27-30" tabindex="-1"></a>                              <span class="at">fdataobj =</span> x.train.cv, </span>
<span id="cb27-31"><a href="aplikace3.html#cb27-31" tabindex="-1"></a>                              <span class="at">knn =</span> neighbour) </span>
<span id="cb27-32"><a href="aplikace3.html#cb27-32" tabindex="-1"></a>    <span class="co"># predikce na validacni casti</span></span>
<span id="cb27-33"><a href="aplikace3.html#cb27-33" tabindex="-1"></a>    model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb27-34"><a href="aplikace3.html#cb27-34" tabindex="-1"></a>                                    <span class="at">new.fdataobj =</span> x.test.cv)</span>
<span id="cb27-35"><a href="aplikace3.html#cb27-35" tabindex="-1"></a>    <span class="co"># presnost na validacni casti</span></span>
<span id="cb27-36"><a href="aplikace3.html#cb27-36" tabindex="-1"></a>    presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, model.neighb.predict) <span class="sc">|&gt;</span> </span>
<span id="cb27-37"><a href="aplikace3.html#cb27-37" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb27-38"><a href="aplikace3.html#cb27-38" tabindex="-1"></a>    </span>
<span id="cb27-39"><a href="aplikace3.html#cb27-39" tabindex="-1"></a>    <span class="co"># presnost vlozime na pozici pro dane K a fold</span></span>
<span id="cb27-40"><a href="aplikace3.html#cb27-40" tabindex="-1"></a>    CV.results[neighbour, index] <span class="ot">&lt;-</span> presnost</span>
<span id="cb27-41"><a href="aplikace3.html#cb27-41" tabindex="-1"></a>  }</span>
<span id="cb27-42"><a href="aplikace3.html#cb27-42" tabindex="-1"></a>}</span>
<span id="cb27-43"><a href="aplikace3.html#cb27-43" tabindex="-1"></a></span>
<span id="cb27-44"><a href="aplikace3.html#cb27-44" tabindex="-1"></a><span class="co"># spocitame prumerne presnosti pro jednotliva K pres folds</span></span>
<span id="cb27-45"><a href="aplikace3.html#cb27-45" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb27-46"><a href="aplikace3.html#cb27-46" tabindex="-1"></a>K.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(CV.results)</span>
<span id="cb27-47"><a href="aplikace3.html#cb27-47" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb27-48"><a href="aplikace3.html#cb27-48" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">K =</span> neighbours, <span class="at">CV =</span> CV.results)</span></code></pre></div>
</details>
<p>Vidíme, že nejlépe vychází hodnota parametru <span class="math inline">\(K\)</span> jako 1 s hodnotou chybovosti spočtenou pomocí 10-násobné CV 0.1478.
Pro přehlednost si ještě vykresleme průběh validační chybovosti v závislosti na počtu sousedů <span class="math inline">\(K\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="aplikace3.html#cb28-1" tabindex="-1"></a>CV.results <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> K, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> CV)) <span class="sc">+</span> </span>
<span id="cb28-2"><a href="aplikace3.html#cb28-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span> </span>
<span id="cb28-3"><a href="aplikace3.html#cb28-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb28-4"><a href="aplikace3.html#cb28-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> K.opt, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv), <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb28-5"><a href="aplikace3.html#cb28-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb28-6"><a href="aplikace3.html#cb28-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(K, <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb28-7"><a href="aplikace3.html#cb28-7" tabindex="-1"></a>                        K[optimal] <span class="sc">==</span> .(K.opt))),</span>
<span id="cb28-8"><a href="aplikace3.html#cb28-8" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Validační chybovost&#39;</span>) <span class="sc">+</span> </span>
<span id="cb28-9"><a href="aplikace3.html#cb28-9" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> neighbours)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-16"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-16-1.png" alt="Závislost validační chybovosti na hodnotě $K$, tedy na počtu sousedů." width="672" />
<p class="caption">
Obrázek 12.5: Závislost validační chybovosti na hodnotě <span class="math inline">\(K\)</span>, tedy na počtu sousedů.
</p>
</div>
<p>Nyní známe optimální hodnotu parametru <span class="math inline">\(K\)</span> a tudíž můžeme sestavit finální model.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="aplikace3.html#cb29-1" tabindex="-1"></a>neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, <span class="at">fdataobj =</span> x.train, <span class="at">knn =</span> K.opt)</span>
<span id="cb29-2"><a href="aplikace3.html#cb29-2" tabindex="-1"></a></span>
<span id="cb29-3"><a href="aplikace3.html#cb29-3" tabindex="-1"></a><span class="co"># predikce</span></span>
<span id="cb29-4"><a href="aplikace3.html#cb29-4" tabindex="-1"></a>model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb29-5"><a href="aplikace3.html#cb29-5" tabindex="-1"></a>                                <span class="at">new.fdataobj =</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb29-6"><a href="aplikace3.html#cb29-6" tabindex="-1"></a></span>
<span id="cb29-7"><a href="aplikace3.html#cb29-7" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb29-8"><a href="aplikace3.html#cb29-8" tabindex="-1"></a>presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.test)), model.neighb.predict) <span class="sc">|&gt;</span></span>
<span id="cb29-9"><a href="aplikace3.html#cb29-9" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span></span>
<span id="cb29-10"><a href="aplikace3.html#cb29-10" tabindex="-1"></a>  <span class="fu">diag</span>() <span class="sc">|&gt;</span></span>
<span id="cb29-11"><a href="aplikace3.html#cb29-11" tabindex="-1"></a>  <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Vidíme tedy, že chybovost modelu sestrojeného pomocí metody <span class="math inline">\(K\)</span> nejbližších sousedů s optimální volbou <span class="math inline">\(K_{optimal}\)</span> rovnou 1, kterou jsme určili cross-validací, je na trénovacích datech rovna 0.1467 a na testovacích datech 0.1692.</p>
<p>K porovnání jendotlivých modelů můžeme použít oba typy chybovostí, pro přehlednost si je budeme ukládat do tabulky.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="aplikace3.html#cb30-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;KNN&#39;</span>, </span>
<span id="cb30-2"><a href="aplikace3.html#cb30-2" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> neighb.model<span class="sc">$</span>max.prob,</span>
<span id="cb30-3"><a href="aplikace3.html#cb30-3" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost)</span></code></pre></div>
</details>
</div>
<div id="lineární-diskriminační-analýza-12" class="section level3 hasAnchor" number="12.3.2">
<h3><span class="header-section-number">12.3.2</span> Lineární diskriminační analýza<a href="aplikace3.html#lineární-diskriminační-analýza-12" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Jako druhou metodu pro sestrojení klasifikátoru budeme uvažovat lineární diskriminační analýzu (LDA).
Jelikož tato metoda nelze aplikovat na funkcionální data, musíme je nejprve diskretizovat, což provedeme pomocí funkcionální analýzy hlavních komponent.
Klasifikační algoritmus následně provedeme na skórech prvních <span class="math inline">\(p\)</span> hlavních komponent.
Počet komponent <span class="math inline">\(p\)</span> zvolíme tak, aby prvních <span class="math inline">\(p\)</span> hlavních komponent dohromady vysvětlovalo alespoň 90 % variability v datech.</p>
<p>Proveďme tedy nejprve funkcionální analýzu hlavních komponent a určeme počet <span class="math inline">\(p\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="aplikace3.html#cb31-1" tabindex="-1"></a><span class="co"># analyza hlavnich komponent</span></span>
<span id="cb31-2"><a href="aplikace3.html#cb31-2" tabindex="-1"></a>data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> <span class="dv">10</span>) <span class="co"># nharm - maximalni pocet HK</span></span>
<span id="cb31-3"><a href="aplikace3.html#cb31-3" tabindex="-1"></a>nharm <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">cumsum</span>(data.PCA<span class="sc">$</span>varprop) <span class="sc">&gt;=</span> <span class="fl">0.9</span>)[<span class="dv">1</span>] <span class="co"># urceni p</span></span>
<span id="cb31-4"><a href="aplikace3.html#cb31-4" tabindex="-1"></a><span class="cf">if</span>(nharm <span class="sc">==</span> <span class="dv">1</span>) nharm <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># aby bylo mozne vykreslovat grafy,</span></span>
<span id="cb31-5"><a href="aplikace3.html#cb31-5" tabindex="-1"></a><span class="co"># potrebujeme alespon 2 HK</span></span>
<span id="cb31-6"><a href="aplikace3.html#cb31-6" tabindex="-1"></a></span>
<span id="cb31-7"><a href="aplikace3.html#cb31-7" tabindex="-1"></a>data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> nharm) </span>
<span id="cb31-8"><a href="aplikace3.html#cb31-8" tabindex="-1"></a>data.PCA.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA<span class="sc">$</span>scores) <span class="co"># skore prvnich p HK</span></span>
<span id="cb31-9"><a href="aplikace3.html#cb31-9" tabindex="-1"></a>data.PCA.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train) <span class="co"># prislusnost do trid</span></span></code></pre></div>
</details>
<p>V tomto konkrétním případě jsme za počet hlavních komponent vzali <span class="math inline">\(p=\)</span> 2, které dohromady vysvětlují 99.57 <span class="math inline">\(\%\)</span> variability v datech.
První hlavní komponenta potom vysvětluje 98.47 % a druhá 1.09 <span class="math inline">\(\%\)</span> variability.
Graficky si můžeme zobrazit hodnoty skórů prvních dvou hlavních komponent, barevně odlišených podle příslušnosti do klasifikační třídy.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="aplikace3.html#cb32-1" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb32-2"><a href="aplikace3.html#cb32-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb32-3"><a href="aplikace3.html#cb32-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1. hlavní komponenta (vysvětlená variabilita&#39;</span>, </span>
<span id="cb32-4"><a href="aplikace3.html#cb32-4" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb32-5"><a href="aplikace3.html#cb32-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2. hlavní komponenta (&#39;</span>, </span>
<span id="cb32-6"><a href="aplikace3.html#cb32-6" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb32-7"><a href="aplikace3.html#cb32-7" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Obsah tuku&#39;</span>) <span class="sc">+</span></span>
<span id="cb32-8"><a href="aplikace3.html#cb32-8" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;malý&quot;</span>, <span class="st">&quot;velký&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb32-9"><a href="aplikace3.html#cb32-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-20"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-20-1.png" alt="Hodnoty skórů prvních dvou hlavních komponent pro trénovací data. Barevně jsou odlišeny body podle příslušnosti do klasifikační třídy." width="672" />
<p class="caption">
Obrázek 12.6: Hodnoty skórů prvních dvou hlavních komponent pro trénovací data. Barevně jsou odlišeny body podle příslušnosti do klasifikační třídy.
</p>
</div>
<p>Abychom mohli určit přesnost klasifikace na testovacích datech, potřebujeme spočítat skóre pro první 2 hlavní komponenty pro testovací data.
Tato skóre určíme pomocí vzorce:</p>
<p><span class="math display">\[
\xi_{i, j} = \int \left( X_i(t) - \mu(t)\right) \cdot \rho_j(t)\text dt,
\]</span>
kde <span class="math inline">\(\mu(t)\)</span> je střední hodnota (průměrná funkce) a <span class="math inline">\(\rho_j(t)\)</span> vlastní funkce (funkcionální hlavní komponenty).</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="aplikace3.html#cb33-1" tabindex="-1"></a><span class="co"># vypocet skoru testovacich funkci</span></span>
<span id="cb33-2"><a href="aplikace3.html#cb33-2" tabindex="-1"></a>scores <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> nharm, <span class="at">nrow =</span> <span class="fu">length</span>(Y.test)) <span class="co"># prazdna matice</span></span>
<span id="cb33-3"><a href="aplikace3.html#cb33-3" tabindex="-1"></a></span>
<span id="cb33-4"><a href="aplikace3.html#cb33-4" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(scores)[<span class="dv">1</span>]) {</span>
<span id="cb33-5"><a href="aplikace3.html#cb33-5" tabindex="-1"></a>  xfd <span class="ot">=</span> X.test[k] <span class="sc">-</span> data.PCA<span class="sc">$</span>meanfd[<span class="dv">1</span>] <span class="co"># k-te pozorovani - prumerna funkce</span></span>
<span id="cb33-6"><a href="aplikace3.html#cb33-6" tabindex="-1"></a>  scores[k, ] <span class="ot">=</span> <span class="fu">inprod</span>(xfd, data.PCA<span class="sc">$</span>harmonics) </span>
<span id="cb33-7"><a href="aplikace3.html#cb33-7" tabindex="-1"></a>  <span class="co"># skalarni soucin rezidua a vlastnich funkci rho (funkcionalni hlavni komponenty)</span></span>
<span id="cb33-8"><a href="aplikace3.html#cb33-8" tabindex="-1"></a>}</span>
<span id="cb33-9"><a href="aplikace3.html#cb33-9" tabindex="-1"></a></span>
<span id="cb33-10"><a href="aplikace3.html#cb33-10" tabindex="-1"></a>data.PCA.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(scores)</span>
<span id="cb33-11"><a href="aplikace3.html#cb33-11" tabindex="-1"></a>data.PCA.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb33-12"><a href="aplikace3.html#cb33-12" tabindex="-1"></a><span class="fu">colnames</span>(data.PCA.test) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data.PCA.train) </span></code></pre></div>
</details>
<p>Nyní již můžeme sestrojit klasifikátor na trénovací části dat.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="aplikace3.html#cb34-1" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb34-2"><a href="aplikace3.html#cb34-2" tabindex="-1"></a>clf.LDA <span class="ot">&lt;-</span> <span class="fu">lda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb34-3"><a href="aplikace3.html#cb34-3" tabindex="-1"></a></span>
<span id="cb34-4"><a href="aplikace3.html#cb34-4" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb34-5"><a href="aplikace3.html#cb34-5" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb34-6"><a href="aplikace3.html#cb34-6" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb34-7"><a href="aplikace3.html#cb34-7" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb34-8"><a href="aplikace3.html#cb34-8" tabindex="-1"></a>  </span>
<span id="cb34-9"><a href="aplikace3.html#cb34-9" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb34-10"><a href="aplikace3.html#cb34-10" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb34-11"><a href="aplikace3.html#cb34-11" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb34-12"><a href="aplikace3.html#cb34-12" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Spočítali jsme jednak chybovost klasifikátoru na trénovacích (32 %), tak i na testovacích datech (29.23 %).</p>
<p>Pro grafické znázornění metody můžeme zaznačit dělící hranici do grafu skórů prvních dvou hlavních komponent.
Tuto hranici spočítáme na husté síti bodů a zobrazíme ji pomocí funkce <code>geom_contour()</code>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="aplikace3.html#cb35-1" tabindex="-1"></a><span class="co"># pridame diskriminacni hranici</span></span>
<span id="cb35-2"><a href="aplikace3.html#cb35-2" tabindex="-1"></a>np <span class="ot">&lt;-</span> <span class="dv">1001</span> <span class="co"># pocet bodu site</span></span>
<span id="cb35-3"><a href="aplikace3.html#cb35-3" tabindex="-1"></a><span class="co"># x-ova osa ... 1. HK</span></span>
<span id="cb35-4"><a href="aplikace3.html#cb35-4" tabindex="-1"></a>nd.x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(data.PCA.train<span class="sc">$</span>V1), </span>
<span id="cb35-5"><a href="aplikace3.html#cb35-5" tabindex="-1"></a>            <span class="at">to =</span> <span class="fu">max</span>(data.PCA.train<span class="sc">$</span>V1), <span class="at">length.out =</span> np)</span>
<span id="cb35-6"><a href="aplikace3.html#cb35-6" tabindex="-1"></a><span class="co"># y-ova osa ... 2. HK</span></span>
<span id="cb35-7"><a href="aplikace3.html#cb35-7" tabindex="-1"></a>nd.y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(data.PCA.train<span class="sc">$</span>V2), </span>
<span id="cb35-8"><a href="aplikace3.html#cb35-8" tabindex="-1"></a>            <span class="at">to =</span> <span class="fu">max</span>(data.PCA.train<span class="sc">$</span>V2), <span class="at">length.out =</span> np)</span>
<span id="cb35-9"><a href="aplikace3.html#cb35-9" tabindex="-1"></a><span class="co"># pripad pro 2 HK ... p = 2</span></span>
<span id="cb35-10"><a href="aplikace3.html#cb35-10" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y)</span>
<span id="cb35-11"><a href="aplikace3.html#cb35-11" tabindex="-1"></a><span class="co"># pokud p = 3</span></span>
<span id="cb35-12"><a href="aplikace3.html#cb35-12" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(data.PCA.train)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">4</span>) {</span>
<span id="cb35-13"><a href="aplikace3.html#cb35-13" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y, <span class="at">V3 =</span> data.PCA.train<span class="sc">$</span>V3[<span class="dv">1</span>])}</span>
<span id="cb35-14"><a href="aplikace3.html#cb35-14" tabindex="-1"></a><span class="co"># pokud p = 4</span></span>
<span id="cb35-15"><a href="aplikace3.html#cb35-15" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(data.PCA.train)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">5</span>) {</span>
<span id="cb35-16"><a href="aplikace3.html#cb35-16" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y, <span class="at">V3 =</span> data.PCA.train<span class="sc">$</span>V3[<span class="dv">1</span>],</span>
<span id="cb35-17"><a href="aplikace3.html#cb35-17" tabindex="-1"></a>                    <span class="at">V4 =</span> data.PCA.train<span class="sc">$</span>V4[<span class="dv">1</span>])}</span>
<span id="cb35-18"><a href="aplikace3.html#cb35-18" tabindex="-1"></a><span class="co"># pokud p = 5</span></span>
<span id="cb35-19"><a href="aplikace3.html#cb35-19" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(data.PCA.train)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">6</span>) {</span>
<span id="cb35-20"><a href="aplikace3.html#cb35-20" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y, <span class="at">V3 =</span> data.PCA.train<span class="sc">$</span>V3[<span class="dv">1</span>],</span>
<span id="cb35-21"><a href="aplikace3.html#cb35-21" tabindex="-1"></a>                    <span class="at">V4 =</span> data.PCA.train<span class="sc">$</span>V4[<span class="dv">1</span>], <span class="at">V5 =</span> data.PCA.train<span class="sc">$</span>V5[<span class="dv">1</span>])}</span>
<span id="cb35-22"><a href="aplikace3.html#cb35-22" tabindex="-1"></a></span>
<span id="cb35-23"><a href="aplikace3.html#cb35-23" tabindex="-1"></a><span class="co"># pridame Y = 0, 1</span></span>
<span id="cb35-24"><a href="aplikace3.html#cb35-24" tabindex="-1"></a>nd <span class="ot">&lt;-</span> nd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">prd =</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> nd)<span class="sc">$</span>class))</span>
<span id="cb35-25"><a href="aplikace3.html#cb35-25" tabindex="-1"></a></span>
<span id="cb35-26"><a href="aplikace3.html#cb35-26" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb35-27"><a href="aplikace3.html#cb35-27" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb35-28"><a href="aplikace3.html#cb35-28" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1. hlavní komponenta (vysvětlená variabilita&#39;</span>, </span>
<span id="cb35-29"><a href="aplikace3.html#cb35-29" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb35-30"><a href="aplikace3.html#cb35-30" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2. hlavní komponenta (&#39;</span>, </span>
<span id="cb35-31"><a href="aplikace3.html#cb35-31" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb35-32"><a href="aplikace3.html#cb35-32" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Obsah tuku&#39;</span>) <span class="sc">+</span></span>
<span id="cb35-33"><a href="aplikace3.html#cb35-33" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;malý&quot;</span>, <span class="st">&quot;velký&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb35-34"><a href="aplikace3.html#cb35-34" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb35-35"><a href="aplikace3.html#cb35-35" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-23"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-23-1.png" alt="Skóre prvních dvou hlavních komponent, barevně odlišené podle klasifikační třídy Černě je vyznačena dělící hranice (přímka v rovině prvních dvou hlavních komponent) mezi třídami sestrojená pomocí LDA." width="672" />
<p class="caption">
Obrázek 12.7: Skóre prvních dvou hlavních komponent, barevně odlišené podle klasifikační třídy Černě je vyznačena dělící hranice (přímka v rovině prvních dvou hlavních komponent) mezi třídami sestrojená pomocí LDA.
</p>
</div>
<p>Vidíme, že dělící hranicí je přímka, lineární funkce v prostoru 2D, což jsme ostatně od LDA čekali.
Nakonec přidáme chybovosti do souhrnné tabulky.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="aplikace3.html#cb36-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LDA&#39;</span>, </span>
<span id="cb36-2"><a href="aplikace3.html#cb36-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb36-3"><a href="aplikace3.html#cb36-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb36-4"><a href="aplikace3.html#cb36-4" tabindex="-1"></a></span>
<span id="cb36-5"><a href="aplikace3.html#cb36-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="kvadratická-diskriminační-analýza-11" class="section level3 hasAnchor" number="12.3.3">
<h3><span class="header-section-number">12.3.3</span> Kvadratická diskriminační analýza<a href="aplikace3.html#kvadratická-diskriminační-analýza-11" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Jako další sestrojme klasifikátor pomocí kvadratické diskriminační analýzy (QDA).
Jedná se o analogický případ jako LDA s tím rozdílem, že nyní připouštíme pro každou ze tříd rozdílnou kovarianční matici normálního rozdělení, ze kterého pocházejí příslušné skóry.
Tento vypuštěný předpoklad o rovnosti kovariančních matic vede ke kvadratické hranici mezi třídami.</p>
<p>V <code>R</code> se provede QDA analogicky jako LDA v předchozí části, tedy opět bychom pomocí funkcionální analýzy hlavních komponent spočítali skóre pro trénovací i testovací funkce, sestrojili klasifikátor na skórech prvních <span class="math inline">\(p\)</span> hlavních komponent a pomocí něj predikovali příslušnost testovacích křivek do třídy <span class="math inline">\(Y^* \in \{0, 1\}\)</span>.</p>
<p>Funkcionální PCA provádět nemusíme, využijeme výsledků z části LDA.</p>
<p>Můžeme tedy rovnou přistoupit k sestrojení klasifikátoru, což provedeme pomocí funkce <code>qda()</code>.
Následně spočítáme přesnost klasifikátoru na testovacích a trénovacích datech.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="aplikace3.html#cb37-1" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb37-2"><a href="aplikace3.html#cb37-2" tabindex="-1"></a>clf.QDA <span class="ot">&lt;-</span> <span class="fu">qda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb37-3"><a href="aplikace3.html#cb37-3" tabindex="-1"></a></span>
<span id="cb37-4"><a href="aplikace3.html#cb37-4" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb37-5"><a href="aplikace3.html#cb37-5" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb37-6"><a href="aplikace3.html#cb37-6" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb37-7"><a href="aplikace3.html#cb37-7" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb37-8"><a href="aplikace3.html#cb37-8" tabindex="-1"></a>  </span>
<span id="cb37-9"><a href="aplikace3.html#cb37-9" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb37-10"><a href="aplikace3.html#cb37-10" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb37-11"><a href="aplikace3.html#cb37-11" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb37-12"><a href="aplikace3.html#cb37-12" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Spočítali jsme tedy jednak chybovost klasifikátoru na trénovacích (32 %), tak i na testovacích datech (30.77 %).</p>
<p>Pro grafické znázornění metody můžeme zaznačit dělící hranici do grafu skórů prvních dvou hlavních komponent.
Tuto hranici spočítáme na husté síti bodů a zobrazíme ji pomocí funkce <code>geom_contour()</code> stejně jako v případě LDA.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="aplikace3.html#cb38-1" tabindex="-1"></a>nd <span class="ot">&lt;-</span> nd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">prd =</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> nd)<span class="sc">$</span>class))</span>
<span id="cb38-2"><a href="aplikace3.html#cb38-2" tabindex="-1"></a></span>
<span id="cb38-3"><a href="aplikace3.html#cb38-3" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb38-4"><a href="aplikace3.html#cb38-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb38-5"><a href="aplikace3.html#cb38-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1. hlavní komponenta (vysvětlená variabilita&#39;</span>, </span>
<span id="cb38-6"><a href="aplikace3.html#cb38-6" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb38-7"><a href="aplikace3.html#cb38-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2. hlavní komponenta (&#39;</span>, </span>
<span id="cb38-8"><a href="aplikace3.html#cb38-8" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb38-9"><a href="aplikace3.html#cb38-9" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Obsah tuku&#39;</span>) <span class="sc">+</span></span>
<span id="cb38-10"><a href="aplikace3.html#cb38-10" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;malý&quot;</span>, <span class="st">&quot;velký&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb38-11"><a href="aplikace3.html#cb38-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb38-12"><a href="aplikace3.html#cb38-12" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-29"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-29-1.png" alt="Skóre prvních dvou hlavních komponent, barevně odlišené podle klasifikační třídy Černě je vyznačena dělící hranice (parabola v rovině prvních dvou hlavních komponent) mezi třídami sestrojená pomocí QDA." width="672" />
<p class="caption">
Obrázek 12.8: Skóre prvních dvou hlavních komponent, barevně odlišené podle klasifikační třídy Černě je vyznačena dělící hranice (parabola v rovině prvních dvou hlavních komponent) mezi třídami sestrojená pomocí QDA.
</p>
</div>
<p>Všimněme si, že dělící hranicí mezi klasifikačními třídami je nyní parabola.</p>
<p>Nakonec ještě doplníme chybovosti do souhrnné tabulky.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="aplikace3.html#cb39-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;QDA&#39;</span>, </span>
<span id="cb39-2"><a href="aplikace3.html#cb39-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb39-3"><a href="aplikace3.html#cb39-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb39-4"><a href="aplikace3.html#cb39-4" tabindex="-1"></a></span>
<span id="cb39-5"><a href="aplikace3.html#cb39-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="logistická-regrese-10" class="section level3 hasAnchor" number="12.3.4">
<h3><span class="header-section-number">12.3.4</span> Logistická regrese<a href="aplikace3.html#logistická-regrese-10" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Logistickou regresi můžeme provést dvěma způsoby.
Jednak použít funkcionální obdobu klasické logistické regrese, druhak klasickou mnohorozměrnou logistickou regresi, kterou provedeme na skórech prvních <span class="math inline">\(p\)</span> hlavních komponent.</p>
<div id="funkcionální-logistická-regrese-9" class="section level4 hasAnchor" number="12.3.4.1">
<h4><span class="header-section-number">12.3.4.1</span> Funkcionální logistická regrese<a href="aplikace3.html#funkcionální-logistická-regrese-9" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Analogicky jako v případě konečné dimenze vstupních dat uvažujeme logistický model ve tvaru:</p>
<p><span class="math display">\[
g\left(\mathbb E [Y|X = x]\right) = \eta (x) = g(\pi(x)) = \alpha + \int \beta(t)\cdot x(t) \text d t,
\]</span>
kde <span class="math inline">\(\eta(x)\)</span> je lineární prediktor nabývající hodnot z intervalu <span class="math inline">\((-\infty, \infty)\)</span>, <span class="math inline">\(g(\cdot)\)</span> je <em>linková funkce</em>, v případě logistické regrese se jedná o logitovou funkci <span class="math inline">\(g: (0,1) \rightarrow \mathbb R,\ g(p) = \ln\frac{p}{1-p}\)</span> a <span class="math inline">\(\pi(x)\)</span> podmíněná pravděpodobnost</p>
<p><span class="math display">\[
\pi(x) = \text{Pr}(Y = 1 | X = x) = g^{-1}(\eta(x)) = \frac{\text e^{\alpha + \int \beta(t)\cdot x(t) \text d t}}{1 + \text e^{\alpha + \int \beta(t)\cdot x(t) \text d t}},
\]</span></p>
<p>přičemž <span class="math inline">\(\alpha\)</span> je konstanta a <span class="math inline">\(\beta(t) \in L^2[a, b]\)</span> je parametrická funkce.
Naším cílem je odhadnout tuto parametrickou funkci.</p>
<p>Pro funkcionální logistickou regresi použijeme funkci <code>fregre.glm()</code> z balíčku <code>fda.usc</code>.
Nejprve si vytvoříme vhodné objekty pro konstrukci klasifikátoru.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="aplikace3.html#cb40-1" tabindex="-1"></a><span class="co"># vytvorime vhodne objekty</span></span>
<span id="cb40-2"><a href="aplikace3.html#cb40-2" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb40-3"><a href="aplikace3.html#cb40-3" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Y.train) </span>
<span id="cb40-4"><a href="aplikace3.html#cb40-4" tabindex="-1"></a></span>
<span id="cb40-5"><a href="aplikace3.html#cb40-5" tabindex="-1"></a><span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb40-6"><a href="aplikace3.html#cb40-6" tabindex="-1"></a>tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb40-7"><a href="aplikace3.html#cb40-7" tabindex="-1"></a></span>
<span id="cb40-8"><a href="aplikace3.html#cb40-8" tabindex="-1"></a>dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb40-9"><a href="aplikace3.html#cb40-9" tabindex="-1"></a><span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb40-10"><a href="aplikace3.html#cb40-10" tabindex="-1"></a></span>
<span id="cb40-11"><a href="aplikace3.html#cb40-11" tabindex="-1"></a><span class="co"># potrebujeme zvolit bazi pro funkcionalni pozorovani, klasicky volime </span></span>
<span id="cb40-12"><a href="aplikace3.html#cb40-12" tabindex="-1"></a><span class="co"># stejnou bazi jako je ta pouzita pro vyhlazeni krivek. Tato volba vsak</span></span>
<span id="cb40-13"><a href="aplikace3.html#cb40-13" tabindex="-1"></a><span class="co"># vede k numericke chybe, zvolime proto bazi s mensim poctem bazovych funkci.</span></span>
<span id="cb40-14"><a href="aplikace3.html#cb40-14" tabindex="-1"></a><span class="co"># Po vyzkouseni nekolika moznosti se zda, ze 7 funkci je dostatecne mnoho.</span></span>
<span id="cb40-15"><a href="aplikace3.html#cb40-15" tabindex="-1"></a>nbasis.x <span class="ot">&lt;-</span> <span class="dv">7</span></span>
<span id="cb40-16"><a href="aplikace3.html#cb40-16" tabindex="-1"></a></span>
<span id="cb40-17"><a href="aplikace3.html#cb40-17" tabindex="-1"></a><span class="co"># B-spline baze </span></span>
<span id="cb40-18"><a href="aplikace3.html#cb40-18" tabindex="-1"></a>basis1 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> nbasis.x)</span></code></pre></div>
</details>
<p>Abychom mohli odhadnout parametrickou funkci <span class="math inline">\(\beta(t)\)</span>, potřebujeme ji vyjádřit v nějaké bazické reprezentaci, v našem případě B-splinové bázi.
K tomu však potřebujeme najít vhodný počet bázových funkcí.
To bychom mohli určit na základě chybovosti na trénovacích datech, avšak tato data budou upřenostňovat výběr velkého počtu bází a bude docházet k přeučení modelu.</p>
<p>Ilustrujme si to na následujícím případě.
Pro každý z počtu bází <span class="math inline">\(n_{basis} \in \{4, 5, \dots, 30\}\)</span> natrénujeme model na trénovacích datech, určíme na nich chybovost a také spočítáme chybovost na testovacích datech.
Připomeňme, že k výběru vhodného počtu bází nemůžeme využít stejná data jako pro odhad testovací chybovosti, neboť bychom tuto chybovost podcenili.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="aplikace3.html#cb41-1" tabindex="-1"></a>n.basis.max <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb41-2"><a href="aplikace3.html#cb41-2" tabindex="-1"></a>n.basis <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span>n.basis.max</span>
<span id="cb41-3"><a href="aplikace3.html#cb41-3" tabindex="-1"></a>pred.baz <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(n.basis), <span class="at">ncol =</span> <span class="dv">2</span>, </span>
<span id="cb41-4"><a href="aplikace3.html#cb41-4" tabindex="-1"></a>                   <span class="at">dimnames =</span> <span class="fu">list</span>(n.basis, <span class="fu">c</span>(<span class="st">&#39;Err.train&#39;</span>, <span class="st">&#39;Err.test&#39;</span>)))</span>
<span id="cb41-5"><a href="aplikace3.html#cb41-5" tabindex="-1"></a></span>
<span id="cb41-6"><a href="aplikace3.html#cb41-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> n.basis) {</span>
<span id="cb41-7"><a href="aplikace3.html#cb41-7" tabindex="-1"></a>  <span class="co"># baze pro bety</span></span>
<span id="cb41-8"><a href="aplikace3.html#cb41-8" tabindex="-1"></a>  basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> i)</span>
<span id="cb41-9"><a href="aplikace3.html#cb41-9" tabindex="-1"></a>  <span class="co"># vztah</span></span>
<span id="cb41-10"><a href="aplikace3.html#cb41-10" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb41-11"><a href="aplikace3.html#cb41-11" tabindex="-1"></a>  <span class="co"># baze pro x a bety</span></span>
<span id="cb41-12"><a href="aplikace3.html#cb41-12" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) <span class="co"># vyhlazene data</span></span>
<span id="cb41-13"><a href="aplikace3.html#cb41-13" tabindex="-1"></a>  basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb41-14"><a href="aplikace3.html#cb41-14" tabindex="-1"></a>  <span class="co"># vstupni data do modelu</span></span>
<span id="cb41-15"><a href="aplikace3.html#cb41-15" tabindex="-1"></a>  ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb41-16"><a href="aplikace3.html#cb41-16" tabindex="-1"></a>  <span class="co"># binomicky model ... model logisticke regrese</span></span>
<span id="cb41-17"><a href="aplikace3.html#cb41-17" tabindex="-1"></a>  model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb41-18"><a href="aplikace3.html#cb41-18" tabindex="-1"></a>                          <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb41-19"><a href="aplikace3.html#cb41-19" tabindex="-1"></a>  </span>
<span id="cb41-20"><a href="aplikace3.html#cb41-20" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb41-21"><a href="aplikace3.html#cb41-21" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> ldata)</span>
<span id="cb41-22"><a href="aplikace3.html#cb41-22" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb41-23"><a href="aplikace3.html#cb41-23" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb41-24"><a href="aplikace3.html#cb41-24" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb41-25"><a href="aplikace3.html#cb41-25" tabindex="-1"></a>    </span>
<span id="cb41-26"><a href="aplikace3.html#cb41-26" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb41-27"><a href="aplikace3.html#cb41-27" tabindex="-1"></a>  newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(Y.test), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb41-28"><a href="aplikace3.html#cb41-28" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb41-29"><a href="aplikace3.html#cb41-29" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb41-30"><a href="aplikace3.html#cb41-30" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb41-31"><a href="aplikace3.html#cb41-31" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb41-32"><a href="aplikace3.html#cb41-32" tabindex="-1"></a>  </span>
<span id="cb41-33"><a href="aplikace3.html#cb41-33" tabindex="-1"></a>  <span class="co"># vlozime do matice</span></span>
<span id="cb41-34"><a href="aplikace3.html#cb41-34" tabindex="-1"></a>  pred.baz[<span class="fu">as.character</span>(i), ] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb41-35"><a href="aplikace3.html#cb41-35" tabindex="-1"></a>} </span>
<span id="cb41-36"><a href="aplikace3.html#cb41-36" tabindex="-1"></a></span>
<span id="cb41-37"><a href="aplikace3.html#cb41-37" tabindex="-1"></a>pred.baz <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred.baz)</span>
<span id="cb41-38"><a href="aplikace3.html#cb41-38" tabindex="-1"></a>pred.baz<span class="sc">$</span>n.basis <span class="ot">&lt;-</span> n.basis</span></code></pre></div>
</details>
<p>Znázorněme si průběh obou typů chybovostí v grafu v závislosti na počtu bazických funkcí.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="aplikace3.html#cb42-1" tabindex="-1"></a>n.basis.beta.opt <span class="ot">&lt;-</span> pred.baz<span class="sc">$</span>n.basis[<span class="fu">which.min</span>(pred.baz<span class="sc">$</span>Err.test)]</span>
<span id="cb42-2"><a href="aplikace3.html#cb42-2" tabindex="-1"></a></span>
<span id="cb42-3"><a href="aplikace3.html#cb42-3" tabindex="-1"></a>pred.baz <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> Err.test)) <span class="sc">+</span> </span>
<span id="cb42-4"><a href="aplikace3.html#cb42-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb42-5"><a href="aplikace3.html#cb42-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> Err.train), <span class="at">colour =</span> <span class="st">&#39;deepskyblue3&#39;</span>, </span>
<span id="cb42-6"><a href="aplikace3.html#cb42-6" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb42-7"><a href="aplikace3.html#cb42-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb42-8"><a href="aplikace3.html#cb42-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> Err.train), <span class="at">colour =</span> <span class="st">&#39;deepskyblue3&#39;</span>, </span>
<span id="cb42-9"><a href="aplikace3.html#cb42-9" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb42-10"><a href="aplikace3.html#cb42-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis.beta.opt, <span class="at">y =</span> <span class="fu">min</span>(pred.baz<span class="sc">$</span>Err.test)),</span>
<span id="cb42-11"><a href="aplikace3.html#cb42-11" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb42-12"><a href="aplikace3.html#cb42-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb42-13"><a href="aplikace3.html#cb42-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(n[basis], <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb42-14"><a href="aplikace3.html#cb42-14" tabindex="-1"></a>                        n[optimal] <span class="sc">==</span> .(n.basis.beta.opt))),</span>
<span id="cb42-15"><a href="aplikace3.html#cb42-15" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">&#39;Chybovost&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-33"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-33-1.png" alt="Závislost testovací a trénovací chybovosti na počtu bázových funkcí pro $\beta$. Červeným bodem je znázorněn optimální počet $n_{optimal}$ zvolený jako minimum testovací chybovosti, černou čarou je vykreslena testovací a modrou přerušovanou čarou je vykreslen průběh trénovací chybovosti." width="672" />
<p class="caption">
Obrázek 12.9: Závislost testovací a trénovací chybovosti na počtu bázových funkcí pro <span class="math inline">\(\beta\)</span>. Červeným bodem je znázorněn optimální počet <span class="math inline">\(n_{optimal}\)</span> zvolený jako minimum testovací chybovosti, černou čarou je vykreslena testovací a modrou přerušovanou čarou je vykreslen průběh trénovací chybovosti.
</p>
</div>
<p>Vidíme, že s rostoucím počtem bází pro <span class="math inline">\(\beta(t)\)</span> má trénovací chybovost (modrá čára) tendenci klesat a tedy bychom na jejím základě volili velké hodnoty <span class="math inline">\(n_{basis}\)</span>.
Naopak optimální volbou na základě testovací chybovosti je <span class="math inline">\(n\)</span> rovno 6, tedy výrazně menší hodnota než 30.
Naopak s rostoucím <span class="math inline">\(n\)</span> roste testovací chyvost, což ukazuje na přeučení modelu.</p>
<p>Z výše uvedených důvodů pro určení optimálního počtu bazických funkcí pro <span class="math inline">\(\beta(t)\)</span> využijeme 10-ti násobnou cross-validaci.
Jako maximální počet uvažovaných bazických funkcí bereme 25, neboť jak jsme viděli výše, nad touto hodnotou dochází již k přeučení modelu.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="aplikace3.html#cb43-1" tabindex="-1"></a><span class="do">### 10-fold cross-validation</span></span>
<span id="cb43-2"><a href="aplikace3.html#cb43-2" tabindex="-1"></a>n.basis.max <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb43-3"><a href="aplikace3.html#cb43-3" tabindex="-1"></a>n.basis <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span>n.basis.max</span>
<span id="cb43-4"><a href="aplikace3.html#cb43-4" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb43-5"><a href="aplikace3.html#cb43-5" tabindex="-1"></a><span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb43-6"><a href="aplikace3.html#cb43-6" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb43-7"><a href="aplikace3.html#cb43-7" tabindex="-1"></a><span class="do">## prvky, ktere se behem cyklu nemeni</span></span>
<span id="cb43-8"><a href="aplikace3.html#cb43-8" tabindex="-1"></a><span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb43-9"><a href="aplikace3.html#cb43-9" tabindex="-1"></a>tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb43-10"><a href="aplikace3.html#cb43-10" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(tt)</span>
<span id="cb43-11"><a href="aplikace3.html#cb43-11" tabindex="-1"></a><span class="co"># B-spline baze </span></span>
<span id="cb43-12"><a href="aplikace3.html#cb43-12" tabindex="-1"></a>basis1 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> nbasis.x)</span>
<span id="cb43-13"><a href="aplikace3.html#cb43-13" tabindex="-1"></a><span class="co"># vztah</span></span>
<span id="cb43-14"><a href="aplikace3.html#cb43-14" tabindex="-1"></a>f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb43-15"><a href="aplikace3.html#cb43-15" tabindex="-1"></a><span class="co"># baze pro x</span></span>
<span id="cb43-16"><a href="aplikace3.html#cb43-16" tabindex="-1"></a>basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1)</span>
<span id="cb43-17"><a href="aplikace3.html#cb43-17" tabindex="-1"></a><span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb43-18"><a href="aplikace3.html#cb43-18" tabindex="-1"></a><span class="co"># ve sloupcich budou hodnoty presnosti pro danou cast trenovaci mnoziny</span></span>
<span id="cb43-19"><a href="aplikace3.html#cb43-19" tabindex="-1"></a><span class="co"># v radcich budou hodnoty pro dany pocet bazi</span></span>
<span id="cb43-20"><a href="aplikace3.html#cb43-20" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(n.basis), <span class="at">ncol =</span> k_cv, </span>
<span id="cb43-21"><a href="aplikace3.html#cb43-21" tabindex="-1"></a>                     <span class="at">dimnames =</span> <span class="fu">list</span>(n.basis, <span class="dv">1</span><span class="sc">:</span>k_cv))</span></code></pre></div>
</details>
<p>Nyní již máme vše připravené pro spočítání chybovosti na každé z deseti podmnožin trénovací množiny.
Následně určíme průměr a jako optimální <span class="math inline">\(n\)</span> vezmeme argument minima validační chybovosti.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="aplikace3.html#cb44-1" tabindex="-1"></a><span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb44-2"><a href="aplikace3.html#cb44-2" tabindex="-1"></a>  <span class="co"># definujeme danou indexovou mnozinu</span></span>
<span id="cb44-3"><a href="aplikace3.html#cb44-3" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb44-4"><a href="aplikace3.html#cb44-4" tabindex="-1"></a>    </span>
<span id="cb44-5"><a href="aplikace3.html#cb44-5" tabindex="-1"></a>  x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb44-6"><a href="aplikace3.html#cb44-6" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb44-7"><a href="aplikace3.html#cb44-7" tabindex="-1"></a>  y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb44-8"><a href="aplikace3.html#cb44-8" tabindex="-1"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb44-9"><a href="aplikace3.html#cb44-9" tabindex="-1"></a>  </span>
<span id="cb44-10"><a href="aplikace3.html#cb44-10" tabindex="-1"></a>  x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb44-11"><a href="aplikace3.html#cb44-11" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb44-12"><a href="aplikace3.html#cb44-12" tabindex="-1"></a>  y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb44-13"><a href="aplikace3.html#cb44-13" tabindex="-1"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb44-14"><a href="aplikace3.html#cb44-14" tabindex="-1"></a>  </span>
<span id="cb44-15"><a href="aplikace3.html#cb44-15" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train.cv) </span>
<span id="cb44-16"><a href="aplikace3.html#cb44-16" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb44-17"><a href="aplikace3.html#cb44-17" tabindex="-1"></a>  </span>
<span id="cb44-18"><a href="aplikace3.html#cb44-18" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> n.basis) {</span>
<span id="cb44-19"><a href="aplikace3.html#cb44-19" tabindex="-1"></a>    <span class="co"># baze pro bety</span></span>
<span id="cb44-20"><a href="aplikace3.html#cb44-20" tabindex="-1"></a>    basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, <span class="at">nbasis =</span> i)</span>
<span id="cb44-21"><a href="aplikace3.html#cb44-21" tabindex="-1"></a>    </span>
<span id="cb44-22"><a href="aplikace3.html#cb44-22" tabindex="-1"></a>    basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb44-23"><a href="aplikace3.html#cb44-23" tabindex="-1"></a>    <span class="co"># vstupni data do modelu</span></span>
<span id="cb44-24"><a href="aplikace3.html#cb44-24" tabindex="-1"></a>    ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train.cv)</span>
<span id="cb44-25"><a href="aplikace3.html#cb44-25" tabindex="-1"></a>    <span class="co"># binomicky model ... model logisticke regrese</span></span>
<span id="cb44-26"><a href="aplikace3.html#cb44-26" tabindex="-1"></a>    model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb44-27"><a href="aplikace3.html#cb44-27" tabindex="-1"></a>                            <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb44-28"><a href="aplikace3.html#cb44-28" tabindex="-1"></a>    </span>
<span id="cb44-29"><a href="aplikace3.html#cb44-29" tabindex="-1"></a>    <span class="co"># presnost na validacni casti </span></span>
<span id="cb44-30"><a href="aplikace3.html#cb44-30" tabindex="-1"></a>    newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(y.test.cv), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb44-31"><a href="aplikace3.html#cb44-31" tabindex="-1"></a>    predictions.valid <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb44-32"><a href="aplikace3.html#cb44-32" tabindex="-1"></a>    predictions.valid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.valid <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb44-33"><a href="aplikace3.html#cb44-33" tabindex="-1"></a>    presnost.valid <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, predictions.valid<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb44-34"><a href="aplikace3.html#cb44-34" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb44-35"><a href="aplikace3.html#cb44-35" tabindex="-1"></a>    </span>
<span id="cb44-36"><a href="aplikace3.html#cb44-36" tabindex="-1"></a>    <span class="co"># vlozime do matice</span></span>
<span id="cb44-37"><a href="aplikace3.html#cb44-37" tabindex="-1"></a>    CV.results[<span class="fu">as.character</span>(i), <span class="fu">as.character</span>(index)] <span class="ot">&lt;-</span> presnost.valid</span>
<span id="cb44-38"><a href="aplikace3.html#cb44-38" tabindex="-1"></a>  } </span>
<span id="cb44-39"><a href="aplikace3.html#cb44-39" tabindex="-1"></a>}</span>
<span id="cb44-40"><a href="aplikace3.html#cb44-40" tabindex="-1"></a></span>
<span id="cb44-41"><a href="aplikace3.html#cb44-41" tabindex="-1"></a><span class="co"># spocitame prumerne presnosti pro jednotliva n pres folds</span></span>
<span id="cb44-42"><a href="aplikace3.html#cb44-42" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb44-43"><a href="aplikace3.html#cb44-43" tabindex="-1"></a>n.basis.opt <span class="ot">&lt;-</span> n.basis[<span class="fu">which.max</span>(CV.results)]</span>
<span id="cb44-44"><a href="aplikace3.html#cb44-44" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span></code></pre></div>
</details>
<p>Vykresleme si ještě průběh validační chybovosti i se zvýrazněnou optimální hodnotou <span class="math inline">\(n_{optimal}\)</span> rovnou 24 s validační chybovostí 0.0488.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="aplikace3.html#cb45-1" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n.basis =</span> n.basis, <span class="at">CV =</span> CV.results)</span>
<span id="cb45-2"><a href="aplikace3.html#cb45-2" tabindex="-1"></a>CV.results <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> CV)) <span class="sc">+</span> </span>
<span id="cb45-3"><a href="aplikace3.html#cb45-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span> </span>
<span id="cb45-4"><a href="aplikace3.html#cb45-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb45-5"><a href="aplikace3.html#cb45-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis.opt, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv), <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb45-6"><a href="aplikace3.html#cb45-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb45-7"><a href="aplikace3.html#cb45-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(n[basis], <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb45-8"><a href="aplikace3.html#cb45-8" tabindex="-1"></a>                        n[optimal] <span class="sc">==</span> .(n.basis.opt))),</span>
<span id="cb45-9"><a href="aplikace3.html#cb45-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Validační chybovost&#39;</span>) <span class="sc">+</span> </span>
<span id="cb45-10"><a href="aplikace3.html#cb45-10" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> n.basis) <span class="sc">+</span> </span>
<span id="cb45-11"><a href="aplikace3.html#cb45-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-36"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-36-1.png" alt="Závislost validační chybovosti na hodnotě $n_{basis}$, tedy na počtu bází." width="672" />
<p class="caption">
Obrázek 12.10: Závislost validační chybovosti na hodnotě <span class="math inline">\(n_{basis}\)</span>, tedy na počtu bází.
</p>
</div>
<p>Nyní již tedy můžeme definovat finální model pomocí funkcionální logistické regrese, přičemž bázi pro <span class="math inline">\(\beta(t)\)</span> volíme B-splinovou bázi s 24 bázemi.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="aplikace3.html#cb46-1" tabindex="-1"></a><span class="co"># optimalni model</span></span>
<span id="cb46-2"><a href="aplikace3.html#cb46-2" tabindex="-1"></a>basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> n.basis.opt)</span>
<span id="cb46-3"><a href="aplikace3.html#cb46-3" tabindex="-1"></a>f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb46-4"><a href="aplikace3.html#cb46-4" tabindex="-1"></a><span class="co"># baze pro x a bety</span></span>
<span id="cb46-5"><a href="aplikace3.html#cb46-5" tabindex="-1"></a>basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb46-6"><a href="aplikace3.html#cb46-6" tabindex="-1"></a>basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb46-7"><a href="aplikace3.html#cb46-7" tabindex="-1"></a><span class="co"># vstupni data do modelu</span></span>
<span id="cb46-8"><a href="aplikace3.html#cb46-8" tabindex="-1"></a>dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb46-9"><a href="aplikace3.html#cb46-9" tabindex="-1"></a><span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb46-10"><a href="aplikace3.html#cb46-10" tabindex="-1"></a>ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb46-11"><a href="aplikace3.html#cb46-11" tabindex="-1"></a><span class="co"># binomicky model ... model logisticke regrese</span></span>
<span id="cb46-12"><a href="aplikace3.html#cb46-12" tabindex="-1"></a>model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb46-13"><a href="aplikace3.html#cb46-13" tabindex="-1"></a>                        <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b,</span>
<span id="cb46-14"><a href="aplikace3.html#cb46-14" tabindex="-1"></a>                        <span class="at">maxit =</span> <span class="dv">1000</span>, <span class="at">epsilon =</span> <span class="fl">1e-2</span>)</span>
<span id="cb46-15"><a href="aplikace3.html#cb46-15" tabindex="-1"></a></span>
<span id="cb46-16"><a href="aplikace3.html#cb46-16" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb46-17"><a href="aplikace3.html#cb46-17" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> ldata)</span>
<span id="cb46-18"><a href="aplikace3.html#cb46-18" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb46-19"><a href="aplikace3.html#cb46-19" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb46-20"><a href="aplikace3.html#cb46-20" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb46-21"><a href="aplikace3.html#cb46-21" tabindex="-1"></a>  </span>
<span id="cb46-22"><a href="aplikace3.html#cb46-22" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb46-23"><a href="aplikace3.html#cb46-23" tabindex="-1"></a>newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(Y.test), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb46-24"><a href="aplikace3.html#cb46-24" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb46-25"><a href="aplikace3.html#cb46-25" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb46-26"><a href="aplikace3.html#cb46-26" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb46-27"><a href="aplikace3.html#cb46-27" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Spočítali jsme trénovací chybovost (rovna 0 %) i testovací chybovost (rovna 6.15 %).
Pro lepší představu si ještě můžeme vykreslit hodnoty odhadnutých pravděpodobností příslušnosti do klasifikační třídy <span class="math inline">\(Y = 1\)</span> na trénovacích datech v závislosti na hodnotách lineárního prediktoru.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="aplikace3.html#cb47-1" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb47-2"><a href="aplikace3.html#cb47-2" tabindex="-1"></a>  <span class="at">linear.predictor =</span> model.glm<span class="sc">$</span>linear.predictors,</span>
<span id="cb47-3"><a href="aplikace3.html#cb47-3" tabindex="-1"></a>  <span class="at">response =</span> model.glm<span class="sc">$</span>fitted.values,</span>
<span id="cb47-4"><a href="aplikace3.html#cb47-4" tabindex="-1"></a>  <span class="at">Y =</span> <span class="fu">factor</span>(y.train)</span>
<span id="cb47-5"><a href="aplikace3.html#cb47-5" tabindex="-1"></a>) <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> linear.predictor, <span class="at">y =</span> response, <span class="at">colour =</span> Y)) <span class="sc">+</span> </span>
<span id="cb47-6"><a href="aplikace3.html#cb47-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb47-7"><a href="aplikace3.html#cb47-7" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;malý&quot;</span>, <span class="st">&quot;velký&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb47-8"><a href="aplikace3.html#cb47-8" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> <span class="dv">0</span>, <span class="at">intercept =</span> <span class="fl">0.5</span>), <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb47-9"><a href="aplikace3.html#cb47-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb47-10"><a href="aplikace3.html#cb47-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Lineární prediktor&#39;</span>,</span>
<span id="cb47-11"><a href="aplikace3.html#cb47-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Odhadnuté pravděpodobnosti Pr(Y = 1|X = x)&#39;</span>,</span>
<span id="cb47-12"><a href="aplikace3.html#cb47-12" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Obsah tuku&#39;</span>) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-38"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-38-1.png" alt="Závoslost odhadnutých pravděpodobností na hodnotách lineárního prediktoru. Barevně jsou odlišeny body podle příslušnosti do klasifikační třídy." width="672" />
<p class="caption">
Obrázek 12.11: Závoslost odhadnutých pravděpodobností na hodnotách lineárního prediktoru. Barevně jsou odlišeny body podle příslušnosti do klasifikační třídy.
</p>
</div>
<p>Můžeme si ještě pro informaci zobrazit průběh odhadnuté parametrické funkce <span class="math inline">\(\beta(t)\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="aplikace3.html#cb48-1" tabindex="-1"></a>t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(t), <span class="fu">max</span>(t), <span class="at">length =</span> <span class="dv">1001</span>)</span>
<span id="cb48-2"><a href="aplikace3.html#cb48-2" tabindex="-1"></a>beta.seq <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">evalarg =</span> t.seq, <span class="at">fdobj =</span> model.glm<span class="sc">$</span>beta.l<span class="sc">$</span>x)</span>
<span id="cb48-3"><a href="aplikace3.html#cb48-3" tabindex="-1"></a></span>
<span id="cb48-4"><a href="aplikace3.html#cb48-4" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">t =</span> t.seq, <span class="at">beta =</span> beta.seq) <span class="sc">|&gt;</span> </span>
<span id="cb48-5"><a href="aplikace3.html#cb48-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(t, beta)) <span class="sc">+</span> </span>
<span id="cb48-6"><a href="aplikace3.html#cb48-6" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> <span class="dv">0</span>, <span class="at">intercept =</span> <span class="dv">0</span>), <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, </span>
<span id="cb48-7"><a href="aplikace3.html#cb48-7" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span></span>
<span id="cb48-8"><a href="aplikace3.html#cb48-8" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb48-9"><a href="aplikace3.html#cb48-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb48-10"><a href="aplikace3.html#cb48-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb48-11"><a href="aplikace3.html#cb48-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(beta)(t))) <span class="sc">+</span> </span>
<span id="cb48-12"><a href="aplikace3.html#cb48-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb48-13"><a href="aplikace3.html#cb48-13" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-39"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-39-1.png" alt="Průběh odhadu parametrické funkce $\beta(t), t \in [850, 1050]$." width="672" />
<p class="caption">
Obrázek 12.12: Průběh odhadu parametrické funkce <span class="math inline">\(\beta(t), t \in [850, 1050]\)</span>.
</p>
</div>
<p>Výsledky opět přidáme do souhrnné tabulky.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="aplikace3.html#cb49-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR functional&#39;</span>, </span>
<span id="cb49-2"><a href="aplikace3.html#cb49-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb49-3"><a href="aplikace3.html#cb49-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb49-4"><a href="aplikace3.html#cb49-4" tabindex="-1"></a></span>
<span id="cb49-5"><a href="aplikace3.html#cb49-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="logistická-regrese-s-analýzou-hlavních-komponent-7" class="section level4 hasAnchor" number="12.3.4.2">
<h4><span class="header-section-number">12.3.4.2</span> Logistická regrese s analýzou hlavních komponent<a href="aplikace3.html#logistická-regrese-s-analýzou-hlavních-komponent-7" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Abychom mohli sestrojit tento klasifikátor, potřebujeme provést funkcionální analýzu hlavních komponent, určit vhodný počet komponent a spočítat hodnoty skórů pro testovací data.
To jsme již provedli v části u lineární diskriminační analýzy, proto využijeme tyto výsledky v následující části.</p>
<p>Můžeme tedy rovnou sestrojit model logistické regrese pomocí funkce <code>glm(, family = binomial)</code>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="aplikace3.html#cb50-1" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb50-2"><a href="aplikace3.html#cb50-2" tabindex="-1"></a>clf.LR <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span>  ., <span class="at">data =</span> data.PCA.train, <span class="at">family =</span> binomial)</span>
<span id="cb50-3"><a href="aplikace3.html#cb50-3" tabindex="-1"></a></span>
<span id="cb50-4"><a href="aplikace3.html#cb50-4" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb50-5"><a href="aplikace3.html#cb50-5" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.train, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb50-6"><a href="aplikace3.html#cb50-6" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb50-7"><a href="aplikace3.html#cb50-7" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb50-8"><a href="aplikace3.html#cb50-8" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb50-9"><a href="aplikace3.html#cb50-9" tabindex="-1"></a>  </span>
<span id="cb50-10"><a href="aplikace3.html#cb50-10" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb50-11"><a href="aplikace3.html#cb50-11" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.test, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb50-12"><a href="aplikace3.html#cb50-12" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb50-13"><a href="aplikace3.html#cb50-13" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb50-14"><a href="aplikace3.html#cb50-14" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Spočítali jsme tedy chybovost klasifikátoru na trénovacích (30.67 %) i na testovacích datech (29.23 %).</p>
<p>Pro grafické znázornění metody můžeme zaznačit dělící hranici do grafu skórů prvních dvou hlavních komponent.
Tuto hranici spočítáme na husté síti bodů a zobrazíme ji pomocí funkce <code>geom_contour()</code> stejně jako v případě LDA i QDA.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="aplikace3.html#cb51-1" tabindex="-1"></a>nd <span class="ot">&lt;-</span> nd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">prd =</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> nd,</span>
<span id="cb51-2"><a href="aplikace3.html#cb51-2" tabindex="-1"></a>                                            <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)))</span>
<span id="cb51-3"><a href="aplikace3.html#cb51-3" tabindex="-1"></a>nd<span class="sc">$</span>prd <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(nd<span class="sc">$</span>prd <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb51-4"><a href="aplikace3.html#cb51-4" tabindex="-1"></a></span>
<span id="cb51-5"><a href="aplikace3.html#cb51-5" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb51-6"><a href="aplikace3.html#cb51-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb51-7"><a href="aplikace3.html#cb51-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1. hlavní komponenta (vysvětlená variabilita&#39;</span>, </span>
<span id="cb51-8"><a href="aplikace3.html#cb51-8" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb51-9"><a href="aplikace3.html#cb51-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2. hlavní komponenta (&#39;</span>, </span>
<span id="cb51-10"><a href="aplikace3.html#cb51-10" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb51-11"><a href="aplikace3.html#cb51-11" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Obsah tuku&#39;</span>) <span class="sc">+</span></span>
<span id="cb51-12"><a href="aplikace3.html#cb51-12" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;malý&quot;</span>, <span class="st">&quot;velký&quot;</span>)) <span class="sc">+</span></span>
<span id="cb51-13"><a href="aplikace3.html#cb51-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb51-14"><a href="aplikace3.html#cb51-14" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-45"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-45-1.png" alt="Skóre prvních dvou hlavních komponent, barevně odlišené podle příslušnosti do klasifikační třídy. Černě je vyznačena dělící hranice (přímka v rovině prvních dvou hlavních komponent) mezi třídami sestrojená pomocí logistické regrese." width="672" />
<p class="caption">
Obrázek 12.13: Skóre prvních dvou hlavních komponent, barevně odlišené podle příslušnosti do klasifikační třídy. Černě je vyznačena dělící hranice (přímka v rovině prvních dvou hlavních komponent) mezi třídami sestrojená pomocí logistické regrese.
</p>
</div>
<p>Všimněme si, že dělící hranicí mezi klasifikačními třídami je nyní přímka jako v případě LDA.</p>
<p>Nakonec ještě doplníme chybovosti do souhrnné tabulky.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="aplikace3.html#cb52-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR score&#39;</span>, </span>
<span id="cb52-2"><a href="aplikace3.html#cb52-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb52-3"><a href="aplikace3.html#cb52-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb52-4"><a href="aplikace3.html#cb52-4" tabindex="-1"></a></span>
<span id="cb52-5"><a href="aplikace3.html#cb52-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
<div id="rozhodovací-stromy-8" class="section level3 hasAnchor" number="12.3.5">
<h3><span class="header-section-number">12.3.5</span> Rozhodovací stromy<a href="aplikace3.html#rozhodovací-stromy-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>V této části se podíváme na velmi odlišný přístup k sestrojení klasifikátoru, než byly například LDA či logistická regrese.
Rozhodovací stromy jsou velmi oblíbeným nástrojem ke klasifikaci, avšak jako v případě některých předchozích metod nejsou přímo určeny pro funkcionální data.
Existují však postupy, jak funkcionální objekty převést na mnohorozměrné a následně na ně aplikovat algoritmus rozhodovacích stromů.
Můžeme uvažovat následující postupy:</p>
<ul>
<li><p>algoritmus sestrojený na bázových koeficientech,</p></li>
<li><p>využití skórů hlavních komponent,</p></li>
<li><p>použít diskretizaci intervalu a vyhodnotit funkci jen na nějaké konečné síti bodů.</p></li>
</ul>
<p>My se nejprve zaměříme na diskretizaci intervalu a následně porovnáme výsledky se zbylými dvěma přístupy k sestrojení rozhodovacího stromu.</p>
<div id="diskretizace-intervalu-21" class="section level4 hasAnchor" number="12.3.5.1">
<h4><span class="header-section-number">12.3.5.1</span> Diskretizace intervalu<a href="aplikace3.html#diskretizace-intervalu-21" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Nejprve si musíme definovat body z intervalu <span class="math inline">\(I = [850, 1050]\)</span>, ve kterých funkce vyhodnotíme.
Následně vytvoříme objekt, ve kterém budou řádky představovat jednotlivé (diskretizované) funkce a sloupce časy.
Nakonec připojíme sloupec <span class="math inline">\(Y\)</span> s informací o příslušnosti do klasifikační třídy a totéž zopakujeme i pro testovací data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="aplikace3.html#cb53-1" tabindex="-1"></a><span class="co"># posloupnost bodu, ve kterych funkce vyhodnotime</span></span>
<span id="cb53-2"><a href="aplikace3.html#cb53-2" tabindex="-1"></a>t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(t), <span class="fu">max</span>(t), <span class="at">length =</span> <span class="dv">101</span>)</span>
<span id="cb53-3"><a href="aplikace3.html#cb53-3" tabindex="-1"></a>   </span>
<span id="cb53-4"><a href="aplikace3.html#cb53-4" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb53-5"><a href="aplikace3.html#cb53-5" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) <span class="co"># transpozice kvuli funkcim v radku</span></span>
<span id="cb53-6"><a href="aplikace3.html#cb53-6" tabindex="-1"></a>grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb53-7"><a href="aplikace3.html#cb53-7" tabindex="-1"></a></span>
<span id="cb53-8"><a href="aplikace3.html#cb53-8" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb53-9"><a href="aplikace3.html#cb53-9" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb53-10"><a href="aplikace3.html#cb53-10" tabindex="-1"></a>grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span></code></pre></div>
</details>
<p>Nyní můžeme sestrojit rozhodovací strom, ve kterém budou jakožto prediktory vystupovat všechny časy z vektoru <code>t.seq</code>.
Tato klasifikační není náchylná na multikolinearitu, tudíž se jí nemusíme zabývat.
Jako metriku zvolíme přesnost.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="aplikace3.html#cb54-1" tabindex="-1"></a><span class="co"># sestrojeni modelu</span></span>
<span id="cb54-2"><a href="aplikace3.html#cb54-2" tabindex="-1"></a>clf.tree <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb54-3"><a href="aplikace3.html#cb54-3" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb54-4"><a href="aplikace3.html#cb54-4" tabindex="-1"></a>                 <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb54-5"><a href="aplikace3.html#cb54-5" tabindex="-1"></a>                 <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb54-6"><a href="aplikace3.html#cb54-6" tabindex="-1"></a></span>
<span id="cb54-7"><a href="aplikace3.html#cb54-7" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb54-8"><a href="aplikace3.html#cb54-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data)</span>
<span id="cb54-9"><a href="aplikace3.html#cb54-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb54-10"><a href="aplikace3.html#cb54-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb54-11"><a href="aplikace3.html#cb54-11" tabindex="-1"></a>  </span>
<span id="cb54-12"><a href="aplikace3.html#cb54-12" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb54-13"><a href="aplikace3.html#cb54-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb54-14"><a href="aplikace3.html#cb54-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb54-15"><a href="aplikace3.html#cb54-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Chybovost klasifikátoru na testovacích datech je tedy 35.38 % a na trénovacích datech 29.33 %.</p>
<p>Graficky si rozhodovací strom můžeme vykreslit pomocí funkce <code>fancyRpartPlot()</code>.
Nastavíme barvy uzlů tak, aby reflektovaly předchozí barevné odlišení.
Jedná se o neprořezaný strom.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="aplikace3.html#cb55-1" tabindex="-1"></a><span class="fu">colnames</span>(grid.data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&#39;time:&#39;</span>, t.seq), <span class="st">&#39;Y&#39;</span>)</span>
<span id="cb55-2"><a href="aplikace3.html#cb55-2" tabindex="-1"></a><span class="fu">fancyRpartPlot</span>(<span class="fu">rpart</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, <span class="at">method =</span> <span class="st">&quot;class&quot;</span>),</span>
<span id="cb55-3"><a href="aplikace3.html#cb55-3" tabindex="-1"></a>               <span class="at">sub =</span> <span class="st">&#39;&#39;</span>, <span class="at">palettes =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>)) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-49"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-49-1.png" alt="Grafické znázornění neprořezaného rozhodovacího stromu. Modrými odstíny jsou vykresleny uzly příslušející klasifikační třídě 1 a červenými odstíny třídě 0." width="672" />
<p class="caption">
Obrázek 12.14: Grafické znázornění neprořezaného rozhodovacího stromu. Modrými odstíny jsou vykresleny uzly příslušející klasifikační třídě 1 a červenými odstíny třídě 0.
</p>
</div>
<p>Můžeme si také vykreslit již prořezaný finální rozhodovací strom.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="aplikace3.html#cb56-1" tabindex="-1"></a>rpart.plot<span class="sc">::</span><span class="fu">rpart.plot</span>(clf.tree<span class="sc">$</span>finalModel, <span class="co"># finalni model ... prorezany strom</span></span>
<span id="cb56-2"><a href="aplikace3.html#cb56-2" tabindex="-1"></a>                       <span class="at">extra =</span> <span class="dv">104</span>, <span class="co"># zobrazeni pozadovanych informaci</span></span>
<span id="cb56-3"><a href="aplikace3.html#cb56-3" tabindex="-1"></a>                       <span class="at">box.palette =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>),</span>
<span id="cb56-4"><a href="aplikace3.html#cb56-4" tabindex="-1"></a>                       <span class="at">branch.lty =</span> <span class="dv">3</span>, <span class="co"># dotted branch lines</span></span>
<span id="cb56-5"><a href="aplikace3.html#cb56-5" tabindex="-1"></a>                       <span class="at">shadow.col =</span> <span class="dv">0</span>, <span class="co"># shadows under the node boxes</span></span>
<span id="cb56-6"><a href="aplikace3.html#cb56-6" tabindex="-1"></a>                       <span class="at">nn =</span> <span class="cn">FALSE</span>, </span>
<span id="cb56-7"><a href="aplikace3.html#cb56-7" tabindex="-1"></a>                       <span class="at">under =</span> <span class="cn">FALSE</span>, </span>
<span id="cb56-8"><a href="aplikace3.html#cb56-8" tabindex="-1"></a>                       <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-50"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-50-1.png" alt="Finální prořezaný rozhodovací strom." width="672" />
<p class="caption">
Obrázek 12.15: Finální prořezaný rozhodovací strom.
</p>
</div>
<p>Nakonec opět přidejme trénovací a testovací chybovost do souhrnné tabulky.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="aplikace3.html#cb57-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree - diskr.&#39;</span>, </span>
<span id="cb57-2"><a href="aplikace3.html#cb57-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb57-3"><a href="aplikace3.html#cb57-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb57-4"><a href="aplikace3.html#cb57-4" tabindex="-1"></a></span>
<span id="cb57-5"><a href="aplikace3.html#cb57-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="skóre-hlavních-komponent-21" class="section level4 hasAnchor" number="12.3.5.2">
<h4><span class="header-section-number">12.3.5.2</span> Skóre hlavních komponent<a href="aplikace3.html#skóre-hlavních-komponent-21" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Další možností pro sestrojení rozhodovacího stromu je použít skóre hlavních komponent.
Jelikož jsme již skóre počítali pro předchozí klasifikační metody, využijeme těchto poznatků a sestrojíme rozhodovací strom na skórech prvních 2 hlavních komponent.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="aplikace3.html#cb58-1" tabindex="-1"></a><span class="co"># sestrojeni modelu</span></span>
<span id="cb58-2"><a href="aplikace3.html#cb58-2" tabindex="-1"></a>clf.tree.PCA <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb58-3"><a href="aplikace3.html#cb58-3" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb58-4"><a href="aplikace3.html#cb58-4" tabindex="-1"></a>                 <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb58-5"><a href="aplikace3.html#cb58-5" tabindex="-1"></a>                 <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb58-6"><a href="aplikace3.html#cb58-6" tabindex="-1"></a></span>
<span id="cb58-7"><a href="aplikace3.html#cb58-7" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb58-8"><a href="aplikace3.html#cb58-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb58-9"><a href="aplikace3.html#cb58-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb58-10"><a href="aplikace3.html#cb58-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb58-11"><a href="aplikace3.html#cb58-11" tabindex="-1"></a>  </span>
<span id="cb58-12"><a href="aplikace3.html#cb58-12" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb58-13"><a href="aplikace3.html#cb58-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb58-14"><a href="aplikace3.html#cb58-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb58-15"><a href="aplikace3.html#cb58-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Chybovost rozhodovacího stromu na testovacích datech je tedy 38.46 % a na trénovacích datech 32.67 %.</p>
<p>Graficky si rozhodovací strom sestrojený na skórech hlavních komponent můžeme vykreslit pomocí funkce <code>fancyRpartPlot()</code>.
Nastavíme barvy uzlů tak, aby reflektovaly předchozí barevné odlišení.
Jedná se o neprořezaný strom.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="aplikace3.html#cb59-1" tabindex="-1"></a><span class="fu">fancyRpartPlot</span>(<span class="fu">rpart</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, <span class="at">method =</span> <span class="st">&quot;class&quot;</span>),</span>
<span id="cb59-2"><a href="aplikace3.html#cb59-2" tabindex="-1"></a>               <span class="at">sub =</span> <span class="st">&#39;&#39;</span>, <span class="at">palettes =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>)) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-53"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-53-1.png" alt="Grafické znázornění neprořezaného rozhodovacího stromu sestrojeného na skórech hlavních komponent. Modrými odstíny jsou vykresleny uzly příslušející klasifikační třídě 1 a červenými odstíny třídě 0." width="672" />
<p class="caption">
Obrázek 12.16: Grafické znázornění neprořezaného rozhodovacího stromu sestrojeného na skórech hlavních komponent. Modrými odstíny jsou vykresleny uzly příslušející klasifikační třídě 1 a červenými odstíny třídě 0.
</p>
</div>
<p>Můžeme si také vykreslit již prořezaný finální rozhodovací strom.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="aplikace3.html#cb60-1" tabindex="-1"></a>rpart.plot<span class="sc">::</span><span class="fu">rpart.plot</span>(clf.tree.PCA<span class="sc">$</span>finalModel, <span class="co"># finalni model </span></span>
<span id="cb60-2"><a href="aplikace3.html#cb60-2" tabindex="-1"></a>                       <span class="at">extra =</span> <span class="dv">104</span>, <span class="co"># zobrazeni pozadovanych informaci</span></span>
<span id="cb60-3"><a href="aplikace3.html#cb60-3" tabindex="-1"></a>                       <span class="at">box.palette =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>),</span>
<span id="cb60-4"><a href="aplikace3.html#cb60-4" tabindex="-1"></a>                       <span class="at">branch.lty =</span> <span class="dv">3</span>, <span class="co"># dotted branch lines</span></span>
<span id="cb60-5"><a href="aplikace3.html#cb60-5" tabindex="-1"></a>                       <span class="at">shadow.col =</span> <span class="dv">0</span>, <span class="co"># shadows under the node boxes</span></span>
<span id="cb60-6"><a href="aplikace3.html#cb60-6" tabindex="-1"></a>                       <span class="at">nn =</span> <span class="cn">FALSE</span>, <span class="at">under =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-54"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-54-1.png" alt="Finální prořezaný rozhodovací strom." width="672" />
<p class="caption">
Obrázek 12.17: Finální prořezaný rozhodovací strom.
</p>
</div>
<p>Nakonec opět přidejme trénovací a testovací chybovost do souhrnné tabulky.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="aplikace3.html#cb61-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree - score&#39;</span>, </span>
<span id="cb61-2"><a href="aplikace3.html#cb61-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb61-3"><a href="aplikace3.html#cb61-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb61-4"><a href="aplikace3.html#cb61-4" tabindex="-1"></a></span>
<span id="cb61-5"><a href="aplikace3.html#cb61-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="bázové-koeficienty-21" class="section level4 hasAnchor" number="12.3.5.3">
<h4><span class="header-section-number">12.3.5.3</span> Bázové koeficienty<a href="aplikace3.html#bázové-koeficienty-21" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Poslední možností, kterou využijeme pro sestrojení rozhodovacího stromu, je použití koeficientů ve vyjádření funkcí v B-splinové bázi.</p>
<p>Nejprve si definujme potřebné datové soubory s koeficienty.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="aplikace3.html#cb62-1" tabindex="-1"></a><span class="co"># trenovaci dataset</span></span>
<span id="cb62-2"><a href="aplikace3.html#cb62-2" tabindex="-1"></a>data.Bbasis.train <span class="ot">&lt;-</span> <span class="fu">t</span>(X.train<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb62-3"><a href="aplikace3.html#cb62-3" tabindex="-1"></a>data.Bbasis.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb62-4"><a href="aplikace3.html#cb62-4" tabindex="-1"></a></span>
<span id="cb62-5"><a href="aplikace3.html#cb62-5" tabindex="-1"></a><span class="co"># testovaci dataset</span></span>
<span id="cb62-6"><a href="aplikace3.html#cb62-6" tabindex="-1"></a>data.Bbasis.test <span class="ot">&lt;-</span> <span class="fu">t</span>(X.test<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb62-7"><a href="aplikace3.html#cb62-7" tabindex="-1"></a>data.Bbasis.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span></code></pre></div>
</details>
<p>Nyní již můžeme sestrojit klasifikátor.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="aplikace3.html#cb63-1" tabindex="-1"></a><span class="co"># sestrojeni modelu</span></span>
<span id="cb63-2"><a href="aplikace3.html#cb63-2" tabindex="-1"></a>clf.tree.Bbasis <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb63-3"><a href="aplikace3.html#cb63-3" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb63-4"><a href="aplikace3.html#cb63-4" tabindex="-1"></a>                 <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb63-5"><a href="aplikace3.html#cb63-5" tabindex="-1"></a>                 <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb63-6"><a href="aplikace3.html#cb63-6" tabindex="-1"></a></span>
<span id="cb63-7"><a href="aplikace3.html#cb63-7" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb63-8"><a href="aplikace3.html#cb63-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb63-9"><a href="aplikace3.html#cb63-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb63-10"><a href="aplikace3.html#cb63-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb63-11"><a href="aplikace3.html#cb63-11" tabindex="-1"></a>  </span>
<span id="cb63-12"><a href="aplikace3.html#cb63-12" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb63-13"><a href="aplikace3.html#cb63-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb63-14"><a href="aplikace3.html#cb63-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb63-15"><a href="aplikace3.html#cb63-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Chybovost rozhodovacího stromu na trénovacích datech je tedy 22.67 % a na testovacích datech 24.62 %.</p>
<p>Graficky si rozhodovací strom sestrojený na koeficientech B-splinového vyjádření můžeme vykreslit pomocí funkce <code>fancyRpartPlot()</code>.
Nastavíme barvy uzlů tak, aby reflektovaly předchozí barevné odlišení.
Jedná se o neprořezaný strom.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="aplikace3.html#cb64-1" tabindex="-1"></a><span class="fu">fancyRpartPlot</span>(<span class="fu">rpart</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, <span class="at">method =</span> <span class="st">&quot;class&quot;</span>),</span>
<span id="cb64-2"><a href="aplikace3.html#cb64-2" tabindex="-1"></a>               <span class="at">sub =</span> <span class="st">&#39;&#39;</span>, <span class="at">palettes =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>)) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-58"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-58-1.png" alt="Grafické znázornění neprořezaného rozhodovacího stromu sestrojeného na bázových koeficientech. Modrými odstíny jsou vykresleny uzly příslušející klasifikační třídě 1 a červenými odstíny třídě 0." width="672" />
<p class="caption">
Obrázek 12.18: Grafické znázornění neprořezaného rozhodovacího stromu sestrojeného na bázových koeficientech. Modrými odstíny jsou vykresleny uzly příslušející klasifikační třídě 1 a červenými odstíny třídě 0.
</p>
</div>
<p>Můžeme si také vykreslit již prořezaný finální rozhodovací strom.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="aplikace3.html#cb65-1" tabindex="-1"></a>rpart.plot<span class="sc">::</span><span class="fu">rpart.plot</span>(clf.tree.Bbasis<span class="sc">$</span>finalModel, <span class="co"># finalni model </span></span>
<span id="cb65-2"><a href="aplikace3.html#cb65-2" tabindex="-1"></a>                       <span class="at">extra =</span> <span class="dv">104</span>, <span class="co"># zobrazeni pozadovanych informaci</span></span>
<span id="cb65-3"><a href="aplikace3.html#cb65-3" tabindex="-1"></a>                       <span class="at">box.palette =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>),</span>
<span id="cb65-4"><a href="aplikace3.html#cb65-4" tabindex="-1"></a>                       <span class="at">branch.lty =</span> <span class="dv">3</span>, <span class="co"># dotted branch lines</span></span>
<span id="cb65-5"><a href="aplikace3.html#cb65-5" tabindex="-1"></a>                       <span class="at">shadow.col =</span> <span class="dv">0</span>, <span class="co"># shadows under the node boxes</span></span>
<span id="cb65-6"><a href="aplikace3.html#cb65-6" tabindex="-1"></a>                       <span class="at">nn =</span> <span class="cn">FALSE</span>, <span class="at">under =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-59"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-59-1.png" alt="Finální prořezaný rozhodovací strom." width="672" />
<p class="caption">
Obrázek 12.19: Finální prořezaný rozhodovací strom.
</p>
</div>
<p>Nakonec opět přidejme trénovací a testovací chybovost do souhrnné tabulky.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="aplikace3.html#cb66-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree - Bbasis&#39;</span>, </span>
<span id="cb66-2"><a href="aplikace3.html#cb66-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb66-3"><a href="aplikace3.html#cb66-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb66-4"><a href="aplikace3.html#cb66-4" tabindex="-1"></a></span>
<span id="cb66-5"><a href="aplikace3.html#cb66-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
<div id="náhodné-lesy-8" class="section level3 hasAnchor" number="12.3.6">
<h3><span class="header-section-number">12.3.6</span> Náhodné lesy<a href="aplikace3.html#náhodné-lesy-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Klasifikátor sestrojený pomocí metody náhodných lesů spočívá v sestrojení několika jednotlivých rozhodovacích stromů, které se následně zkombinují a vytvoří společný klasifikátor (společným “hlasováním”).</p>
<p>Tak jako v případě rozhodovacích stromů máme několik možností na to, jaká data (konečně-rozměrná) použijeme pro sestrojení modelu.
Budeme opět uvažovat výše diskutované tři přístupy.
Datové soubory s příslušnými veličinami pro všechny tři přístupy již máme připravené z minulé sekce, proto můžeme přímo sestrojit dané modely, spočítat charakteristiky daného klasifikátoru a přidat výsledky do souhrnné tabulky.</p>
<div id="diskretizace-intervalu-22" class="section level4 hasAnchor" number="12.3.6.1">
<h4><span class="header-section-number">12.3.6.1</span> Diskretizace intervalu<a href="aplikace3.html#diskretizace-intervalu-22" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>V prvním případě využíváme vyhodnocení funkcí na dané síti bodů intervalu <span class="math inline">\(I = [850, 1050]\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="aplikace3.html#cb67-1" tabindex="-1"></a><span class="co"># sestrojeni modelu</span></span>
<span id="cb67-2"><a href="aplikace3.html#cb67-2" tabindex="-1"></a>clf.RF <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb67-3"><a href="aplikace3.html#cb67-3" tabindex="-1"></a>                       <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb67-4"><a href="aplikace3.html#cb67-4" tabindex="-1"></a>                       <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb67-5"><a href="aplikace3.html#cb67-5" tabindex="-1"></a>                       <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb67-6"><a href="aplikace3.html#cb67-6" tabindex="-1"></a></span>
<span id="cb67-7"><a href="aplikace3.html#cb67-7" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb67-8"><a href="aplikace3.html#cb67-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data)</span>
<span id="cb67-9"><a href="aplikace3.html#cb67-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb67-10"><a href="aplikace3.html#cb67-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb67-11"><a href="aplikace3.html#cb67-11" tabindex="-1"></a>  </span>
<span id="cb67-12"><a href="aplikace3.html#cb67-12" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb67-13"><a href="aplikace3.html#cb67-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb67-14"><a href="aplikace3.html#cb67-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb67-15"><a href="aplikace3.html#cb67-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Chybovost náhodného lesu na trénovacích datech je tedy 2 % a na testovacích datech 12.31 %.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="aplikace3.html#cb68-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RForest - diskr&#39;</span>, </span>
<span id="cb68-2"><a href="aplikace3.html#cb68-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb68-3"><a href="aplikace3.html#cb68-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb68-4"><a href="aplikace3.html#cb68-4" tabindex="-1"></a></span>
<span id="cb68-5"><a href="aplikace3.html#cb68-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="skóre-hlavních-komponent-22" class="section level4 hasAnchor" number="12.3.6.2">
<h4><span class="header-section-number">12.3.6.2</span> Skóre hlavních komponent<a href="aplikace3.html#skóre-hlavních-komponent-22" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>V tomto případě využijeme skóre prvních <span class="math inline">\(p =\)</span> 2 hlavních komponent.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="aplikace3.html#cb69-1" tabindex="-1"></a><span class="co"># sestrojeni modelu</span></span>
<span id="cb69-2"><a href="aplikace3.html#cb69-2" tabindex="-1"></a>clf.RF.PCA <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb69-3"><a href="aplikace3.html#cb69-3" tabindex="-1"></a>                           <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb69-4"><a href="aplikace3.html#cb69-4" tabindex="-1"></a>                           <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb69-5"><a href="aplikace3.html#cb69-5" tabindex="-1"></a>                           <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb69-6"><a href="aplikace3.html#cb69-6" tabindex="-1"></a></span>
<span id="cb69-7"><a href="aplikace3.html#cb69-7" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb69-8"><a href="aplikace3.html#cb69-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb69-9"><a href="aplikace3.html#cb69-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb69-10"><a href="aplikace3.html#cb69-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb69-11"><a href="aplikace3.html#cb69-11" tabindex="-1"></a>  </span>
<span id="cb69-12"><a href="aplikace3.html#cb69-12" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb69-13"><a href="aplikace3.html#cb69-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb69-14"><a href="aplikace3.html#cb69-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb69-15"><a href="aplikace3.html#cb69-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Chybovost náhodného lesu na trénovacích datech je tedy 4.67 % a na testovacích datech 30.77 %.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="aplikace3.html#cb70-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RForest - score&#39;</span>, </span>
<span id="cb70-2"><a href="aplikace3.html#cb70-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb70-3"><a href="aplikace3.html#cb70-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb70-4"><a href="aplikace3.html#cb70-4" tabindex="-1"></a></span>
<span id="cb70-5"><a href="aplikace3.html#cb70-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="bázové-koeficienty-22" class="section level4 hasAnchor" number="12.3.6.3">
<h4><span class="header-section-number">12.3.6.3</span> Bázové koeficienty<a href="aplikace3.html#bázové-koeficienty-22" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Nakonec použijeme vyjádření funkcí pomocí B-splinové báze.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="aplikace3.html#cb71-1" tabindex="-1"></a><span class="co"># sestrojeni modelu</span></span>
<span id="cb71-2"><a href="aplikace3.html#cb71-2" tabindex="-1"></a>clf.RF.Bbasis <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb71-3"><a href="aplikace3.html#cb71-3" tabindex="-1"></a>                              <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb71-4"><a href="aplikace3.html#cb71-4" tabindex="-1"></a>                              <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb71-5"><a href="aplikace3.html#cb71-5" tabindex="-1"></a>                              <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb71-6"><a href="aplikace3.html#cb71-6" tabindex="-1"></a></span>
<span id="cb71-7"><a href="aplikace3.html#cb71-7" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb71-8"><a href="aplikace3.html#cb71-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb71-9"><a href="aplikace3.html#cb71-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb71-10"><a href="aplikace3.html#cb71-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb71-11"><a href="aplikace3.html#cb71-11" tabindex="-1"></a>  </span>
<span id="cb71-12"><a href="aplikace3.html#cb71-12" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb71-13"><a href="aplikace3.html#cb71-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb71-14"><a href="aplikace3.html#cb71-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb71-15"><a href="aplikace3.html#cb71-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Chybovost tohoto klasifikátoru na trénovacích datech je 1.33 % a na testovacích datech 12.31 %.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="aplikace3.html#cb72-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RForest - Bbasis&#39;</span>, </span>
<span id="cb72-2"><a href="aplikace3.html#cb72-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb72-3"><a href="aplikace3.html#cb72-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb72-4"><a href="aplikace3.html#cb72-4" tabindex="-1"></a></span>
<span id="cb72-5"><a href="aplikace3.html#cb72-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
<div id="support-vector-machines-13" class="section level3 hasAnchor" number="12.3.7">
<h3><span class="header-section-number">12.3.7</span> Support Vector Machines<a href="aplikace3.html#support-vector-machines-13" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Nyní se podívejme na klasifikaci křivek pomocí metody podpůrných vektorů (ang. Support Vector Machines, SVM).
Výhodou této klasifikační metody je její výpočetní nenáročnost, neboť pro definici hraniční křivky mezi třídami využívá pouze několik (často málo) pozorování.</p>
<p>Hlavní výhodou SVM je použití tzv.
<em>jádrového triku</em> (kernel trick), pomocí kterého nahradíme obyčejný skalární součin jiným skalárním součinem transformovaných dat, aniž bychom tuto transformaci museli přímo definovat.
Tím dostaneme obecně nelineární dělící hranici mezi klasifikačními třídami.
<em>Jádro</em> (jádrová funkce, ang. kernel, kernel function) <span class="math inline">\(K\)</span> je taková funkce, která splňuje</p>
<p><span class="math display">\[
K(x_i, x_j) = \langle \phi(x_i), \phi(x_j) \rangle_{\mathcal H},
\]</span>
kde <span class="math inline">\(\phi\)</span> je nějaká (neznámá) transformace (ang. feature map), <span class="math inline">\(\mathcal H\)</span> je Hilbertův prostor a <span class="math inline">\(\langle \cdot, \cdot \rangle_{\mathcal H}\)</span> je nějaký skalární součin na tomto Hilbertově prostoru.</p>
<p>Nejčastěji se v praxi volí tři typy jádrových funkcí:</p>
<ul>
<li>lineární jádro – <span class="math inline">\(K(x_i, x_j) = \langle x_i, x_j \rangle\)</span>,</li>
<li>polynomiální jádro – <span class="math inline">\(K(x_i, x_j) = \big(\alpha_0 + \gamma \langle x_i, x_j \rangle \big)^d\)</span>,</li>
<li>radiální (gaussovské) jádro – <span class="math inline">\(\displaystyle{K(x_i, x_j) = \text e^{-\gamma \|x_i - x_j \|^2}}\)</span>.</li>
</ul>
<p>U všech výše zmíněných jader musíme zvolit konstantu <span class="math inline">\(C &gt; 0\)</span>, která udává míru penalizace za překročení dělící hranice mezi třídami (ang. inverse regularization parameter).
S rostoucí hodnotou <span class="math inline">\(C\)</span> bude metoda více penalizovat špatně klasifikovaná data a méně tvar hranice, naopak pro malé hodnoty <span class="math inline">\(C\)</span> metoda nedává takový význam špatně klasifikovaným datům, ale zaměřuje se více na penalizaci tvaru hranice.
Tato konstanta <span class="math inline">\(C\)</span> se defaultně volí rovna 1, můžeme ji určit i přímo například pomocí cross-validace.</p>
<p>Využitím cross-validace můžeme také určit optimální hodnoty ostatních hyperparametrů, které nyní závisí na naší volbě jádrové funkce.
V případě lineárního jádra nevolíme žádný další parametr kromě konstanty <span class="math inline">\(C\)</span>, u polynomiálního a radiálního jádra musíme určit hodnoty hyperparametrů <span class="math inline">\(\alpha_0, \gamma \text{ a } d\)</span>, jejichž defaultní hodnoty v <code>R</code> jsou postupně <span class="math inline">\(\alpha_0^{default} = 0, \gamma^{default} = \frac{1}{dim(\texttt{data})} \text{ a } d^{default} = 3\)</span>.
Volíme přitom <span class="math inline">\(\alpha_0^{default} = 1\)</span>, neboť tato hodnota dává výrazně lepší výsledky.</p>
<p>V případě funkcionálních dat máme několik možností, jak použít metodu SVM.
Nejjednodušší variantou je použít tuto klasifikační metodu přímo na diskretizovanou funkci (sekce <a href="aplikace3.html#diskrA3">12.3.7.1</a>).
Další možností je opět využít skóre hlavních komponent a klasifikovat křivky pomocí jejich reprezentace <a href="aplikace3.html#PCA-SVMA3">12.3.7.2</a>.
Další přímočarou variantou je využít vyjádření křivek pomocí B-splinové báze a klasifikovat křivky na základě koeficientů jejich vyjádření v této bázi (sekce <a href="aplikace3.html#basis-SVMA3">12.3.7.3</a>).</p>
<p>Složitější úvahou můžeme dospět k několika dalším možnostem, které využívají funkcionální podstatu dat.
Jednak můžeme místo klasifikace původní křivky využít její derivaci (případně druhou derivaci, třetí, …), druhak můžeme využít projekce funkcí na podprostor generovaný, např. B-splinovými, funkcemi (sekce <a href="aplikace3.html#projection-SVMA3">12.3.7.4</a>). Poslední metoda, kterou použijeme pro klasifikaci funkcionálních dat, spočívá v kombinaci projekce na určitý podprostor generovaný funkcemi (Reproducing Kernel Hilbert Space, RKHS) a klasifikace příslušné reprezentace. Tato metoda využívá kromě klasického SVM i SVM pro regresi, více uvádíme v sekci RKHS + SVM <a href="aplikace3.html#RKHS-SVMA3">12.3.7.5</a>.</p>
<div id="diskrA3" class="section level4 hasAnchor" number="12.3.7.1">
<h4><span class="header-section-number">12.3.7.1</span> Diskretizace intervalu<a href="aplikace3.html#diskrA3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Začněme nejprve aplikací metody podpůrných vektorů přímo na diskretizovaná data (vyhodnocení funkce na dané síti bodů na intervalu <span class="math inline">\(I = [850, 1050]\)</span>), přičemž budeme uvažovat všech tři výše zmíněné jádrové funkce.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="aplikace3.html#cb73-1" tabindex="-1"></a><span class="co"># set norm equal to one</span></span>
<span id="cb73-2"><a href="aplikace3.html#cb73-2" tabindex="-1"></a>norms <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb73-3"><a href="aplikace3.html#cb73-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">2</span>]) {</span>
<span id="cb73-4"><a href="aplikace3.html#cb73-4" tabindex="-1"></a>  norms <span class="ot">&lt;-</span> <span class="fu">c</span>(norms, <span class="fu">as.numeric</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">norm.fd</span>(BSmooth<span class="sc">$</span>fd[i])))</span>
<span id="cb73-5"><a href="aplikace3.html#cb73-5" tabindex="-1"></a>  }</span>
<span id="cb73-6"><a href="aplikace3.html#cb73-6" tabindex="-1"></a>XXfd_norm <span class="ot">&lt;-</span> XXfd </span>
<span id="cb73-7"><a href="aplikace3.html#cb73-7" tabindex="-1"></a>XXfd_norm<span class="sc">$</span>coefs <span class="ot">&lt;-</span> XXfd_norm<span class="sc">$</span>coefs <span class="sc">*</span> <span class="fu">matrix</span>(norms, </span>
<span id="cb73-8"><a href="aplikace3.html#cb73-8" tabindex="-1"></a>                                            <span class="at">ncol =</span> <span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">2</span>],</span>
<span id="cb73-9"><a href="aplikace3.html#cb73-9" tabindex="-1"></a>                                            <span class="at">nrow =</span> <span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">1</span>],</span>
<span id="cb73-10"><a href="aplikace3.html#cb73-10" tabindex="-1"></a>                                            <span class="at">byrow =</span> T)</span>
<span id="cb73-11"><a href="aplikace3.html#cb73-11" tabindex="-1"></a></span>
<span id="cb73-12"><a href="aplikace3.html#cb73-12" tabindex="-1"></a><span class="co"># rozdeleni na testovaci a trenovaci cast</span></span>
<span id="cb73-13"><a href="aplikace3.html#cb73-13" tabindex="-1"></a>X.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb73-14"><a href="aplikace3.html#cb73-14" tabindex="-1"></a>X.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb73-15"><a href="aplikace3.html#cb73-15" tabindex="-1"></a></span>
<span id="cb73-16"><a href="aplikace3.html#cb73-16" tabindex="-1"></a>Y.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb73-17"><a href="aplikace3.html#cb73-17" tabindex="-1"></a>Y.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb73-18"><a href="aplikace3.html#cb73-18" tabindex="-1"></a></span>
<span id="cb73-19"><a href="aplikace3.html#cb73-19" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb73-20"><a href="aplikace3.html#cb73-20" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) </span>
<span id="cb73-21"><a href="aplikace3.html#cb73-21" tabindex="-1"></a>grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb73-22"><a href="aplikace3.html#cb73-22" tabindex="-1"></a></span>
<span id="cb73-23"><a href="aplikace3.html#cb73-23" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb73-24"><a href="aplikace3.html#cb73-24" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb73-25"><a href="aplikace3.html#cb73-25" tabindex="-1"></a>grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span></code></pre></div>
</details>
<p>Nyní se pokusme, na rozdíl od postupu v předchozích kapitolách, hyperparametry klasifikátorů odhadnout z dat pomocí 10-násobné cross-validace. Vzhledem k tomu, že každé jádro má ve své definici jiné hyperparametry, budeme ke každé jádrové funkci přistupovat zvlášť. Nicméně hyperparametr <span class="math inline">\(C\)</span> vystupuje u všech jádrových funkcí, přičemž ale připouštíme, že se může jeho optimální hodnota mezi jádry lišit.</p>
<p>U všech třech jader projdeme hodnoty hyperparametru <span class="math inline">\(C\)</span> v intervalu <span class="math inline">\([10^{-3}, 10^{3}]\)</span>, přičemž u jádra polynomiálního zafixujeme hyperparametr <span class="math inline">\(p\)</span> na hodnotě 3, neboť pro jiné celočíselné hodnoty metoda nedává zdaleka tak dobré výsledky. Naopak pro radiální jádro využijeme k volbě optimální hodnoty hyperparametru <span class="math inline">\(\gamma\)</span> opět 10-násobnou CV, přičemž uvažujeme hodnoty v intervalu <span class="math inline">\([10^{-3}, 10^{2}]\)</span>. Zvolíme <code>coef0</code> <span class="math inline">\(= 1\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="aplikace3.html#cb74-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb74-2"><a href="aplikace3.html#cb74-2" tabindex="-1"></a></span>
<span id="cb74-3"><a href="aplikace3.html#cb74-3" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co">#  k-fold CV</span></span>
<span id="cb74-4"><a href="aplikace3.html#cb74-4" tabindex="-1"></a></span>
<span id="cb74-5"><a href="aplikace3.html#cb74-5" tabindex="-1"></a><span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb74-6"><a href="aplikace3.html#cb74-6" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb74-7"><a href="aplikace3.html#cb74-7" tabindex="-1"></a></span>
<span id="cb74-8"><a href="aplikace3.html#cb74-8" tabindex="-1"></a><span class="co"># ktere hodnoty gamma chceme uvazovat</span></span>
<span id="cb74-9"><a href="aplikace3.html#cb74-9" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">15</span>)</span>
<span id="cb74-10"><a href="aplikace3.html#cb74-10" tabindex="-1"></a>C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">20</span>)</span>
<span id="cb74-11"><a href="aplikace3.html#cb74-11" tabindex="-1"></a>p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb74-12"><a href="aplikace3.html#cb74-12" tabindex="-1"></a>coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb74-13"><a href="aplikace3.html#cb74-13" tabindex="-1"></a></span>
<span id="cb74-14"><a href="aplikace3.html#cb74-14" tabindex="-1"></a><span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb74-15"><a href="aplikace3.html#cb74-15" tabindex="-1"></a><span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb74-16"><a href="aplikace3.html#cb74-16" tabindex="-1"></a><span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb74-17"><a href="aplikace3.html#cb74-17" tabindex="-1"></a><span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb74-18"><a href="aplikace3.html#cb74-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb74-19"><a href="aplikace3.html#cb74-19" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb74-20"><a href="aplikace3.html#cb74-20" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb74-21"><a href="aplikace3.html#cb74-21" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb74-22"><a href="aplikace3.html#cb74-22" tabindex="-1"></a>)</span>
<span id="cb74-23"><a href="aplikace3.html#cb74-23" tabindex="-1"></a></span>
<span id="cb74-24"><a href="aplikace3.html#cb74-24" tabindex="-1"></a><span class="co"># nejprve projdeme hodnoty C</span></span>
<span id="cb74-25"><a href="aplikace3.html#cb74-25" tabindex="-1"></a><span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb74-26"><a href="aplikace3.html#cb74-26" tabindex="-1"></a>  <span class="co"># projdeme jednotlive folds</span></span>
<span id="cb74-27"><a href="aplikace3.html#cb74-27" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb74-28"><a href="aplikace3.html#cb74-28" tabindex="-1"></a>    <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb74-29"><a href="aplikace3.html#cb74-29" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb74-30"><a href="aplikace3.html#cb74-30" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb74-31"><a href="aplikace3.html#cb74-31" tabindex="-1"></a>    </span>
<span id="cb74-32"><a href="aplikace3.html#cb74-32" tabindex="-1"></a>    data.grid.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(grid.data[cv_sample, ])</span>
<span id="cb74-33"><a href="aplikace3.html#cb74-33" tabindex="-1"></a>    data.grid.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(grid.data[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb74-34"><a href="aplikace3.html#cb74-34" tabindex="-1"></a>    </span>
<span id="cb74-35"><a href="aplikace3.html#cb74-35" tabindex="-1"></a>    <span class="do">## LINEARNI JADRO</span></span>
<span id="cb74-36"><a href="aplikace3.html#cb74-36" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb74-37"><a href="aplikace3.html#cb74-37" tabindex="-1"></a>    clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb74-38"><a href="aplikace3.html#cb74-38" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb74-39"><a href="aplikace3.html#cb74-39" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb74-40"><a href="aplikace3.html#cb74-40" tabindex="-1"></a>                     <span class="at">cost =</span> C,</span>
<span id="cb74-41"><a href="aplikace3.html#cb74-41" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb74-42"><a href="aplikace3.html#cb74-42" tabindex="-1"></a>    </span>
<span id="cb74-43"><a href="aplikace3.html#cb74-43" tabindex="-1"></a>    <span class="co"># presnost na validacnich datech</span></span>
<span id="cb74-44"><a href="aplikace3.html#cb74-44" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb74-45"><a href="aplikace3.html#cb74-45" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb74-46"><a href="aplikace3.html#cb74-46" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb74-47"><a href="aplikace3.html#cb74-47" tabindex="-1"></a>    </span>
<span id="cb74-48"><a href="aplikace3.html#cb74-48" tabindex="-1"></a>    <span class="co"># presnosti vlozime na pozice pro dane C a fold</span></span>
<span id="cb74-49"><a href="aplikace3.html#cb74-49" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb74-50"><a href="aplikace3.html#cb74-50" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb74-51"><a href="aplikace3.html#cb74-51" tabindex="-1"></a>    </span>
<span id="cb74-52"><a href="aplikace3.html#cb74-52" tabindex="-1"></a>    <span class="do">## POLYNOMIALNI JADRO</span></span>
<span id="cb74-53"><a href="aplikace3.html#cb74-53" tabindex="-1"></a>    <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb74-54"><a href="aplikace3.html#cb74-54" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb74-55"><a href="aplikace3.html#cb74-55" tabindex="-1"></a>      clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb74-56"><a href="aplikace3.html#cb74-56" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb74-57"><a href="aplikace3.html#cb74-57" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb74-58"><a href="aplikace3.html#cb74-58" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb74-59"><a href="aplikace3.html#cb74-59" tabindex="-1"></a>                       <span class="at">coef0 =</span> coef0,</span>
<span id="cb74-60"><a href="aplikace3.html#cb74-60" tabindex="-1"></a>                       <span class="at">degree =</span> p,</span>
<span id="cb74-61"><a href="aplikace3.html#cb74-61" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb74-62"><a href="aplikace3.html#cb74-62" tabindex="-1"></a>      </span>
<span id="cb74-63"><a href="aplikace3.html#cb74-63" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb74-64"><a href="aplikace3.html#cb74-64" tabindex="-1"></a>      predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb74-65"><a href="aplikace3.html#cb74-65" tabindex="-1"></a>      presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb74-66"><a href="aplikace3.html#cb74-66" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb74-67"><a href="aplikace3.html#cb74-67" tabindex="-1"></a>      </span>
<span id="cb74-68"><a href="aplikace3.html#cb74-68" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C, p a fold</span></span>
<span id="cb74-69"><a href="aplikace3.html#cb74-69" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb74-70"><a href="aplikace3.html#cb74-70" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb74-71"><a href="aplikace3.html#cb74-71" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb74-72"><a href="aplikace3.html#cb74-72" tabindex="-1"></a>    }</span>
<span id="cb74-73"><a href="aplikace3.html#cb74-73" tabindex="-1"></a>        </span>
<span id="cb74-74"><a href="aplikace3.html#cb74-74" tabindex="-1"></a>    <span class="do">## RADIALNI JADRO</span></span>
<span id="cb74-75"><a href="aplikace3.html#cb74-75" tabindex="-1"></a>    <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb74-76"><a href="aplikace3.html#cb74-76" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb74-77"><a href="aplikace3.html#cb74-77" tabindex="-1"></a>      clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb74-78"><a href="aplikace3.html#cb74-78" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb74-79"><a href="aplikace3.html#cb74-79" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb74-80"><a href="aplikace3.html#cb74-80" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb74-81"><a href="aplikace3.html#cb74-81" tabindex="-1"></a>                       <span class="at">gamma =</span> gamma,</span>
<span id="cb74-82"><a href="aplikace3.html#cb74-82" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb74-83"><a href="aplikace3.html#cb74-83" tabindex="-1"></a>      </span>
<span id="cb74-84"><a href="aplikace3.html#cb74-84" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb74-85"><a href="aplikace3.html#cb74-85" tabindex="-1"></a>      predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb74-86"><a href="aplikace3.html#cb74-86" tabindex="-1"></a>      presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb74-87"><a href="aplikace3.html#cb74-87" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb74-88"><a href="aplikace3.html#cb74-88" tabindex="-1"></a>      </span>
<span id="cb74-89"><a href="aplikace3.html#cb74-89" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C, gamma a fold</span></span>
<span id="cb74-90"><a href="aplikace3.html#cb74-90" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb74-91"><a href="aplikace3.html#cb74-91" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb74-92"><a href="aplikace3.html#cb74-92" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb74-93"><a href="aplikace3.html#cb74-93" tabindex="-1"></a>    }</span>
<span id="cb74-94"><a href="aplikace3.html#cb74-94" tabindex="-1"></a>  }</span>
<span id="cb74-95"><a href="aplikace3.html#cb74-95" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Nyní zprůměrujeme výsledky 10-násobné CV tak, abychom pro jednu hodnotu hyperparametru (případně jednu kombinaci hodnot) měli jeden odhad validační chybovosti. Přitom určíme i optimální hodnoty jednotlivých hyperparametrů.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="aplikace3.html#cb75-1" tabindex="-1"></a><span class="co"># spocitame prumerne presnosti pro jednotliva C pres folds</span></span>
<span id="cb75-2"><a href="aplikace3.html#cb75-2" tabindex="-1"></a><span class="do">## Linearni jadro</span></span>
<span id="cb75-3"><a href="aplikace3.html#cb75-3" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb75-4"><a href="aplikace3.html#cb75-4" tabindex="-1"></a><span class="do">## Polynomialni jadro</span></span>
<span id="cb75-5"><a href="aplikace3.html#cb75-5" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb75-6"><a href="aplikace3.html#cb75-6" tabindex="-1"></a><span class="do">## Radialni jadro</span></span>
<span id="cb75-7"><a href="aplikace3.html#cb75-7" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb75-8"><a href="aplikace3.html#cb75-8" tabindex="-1"></a></span>
<span id="cb75-9"><a href="aplikace3.html#cb75-9" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb75-10"><a href="aplikace3.html#cb75-10" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb75-11"><a href="aplikace3.html#cb75-11" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb75-12"><a href="aplikace3.html#cb75-12" tabindex="-1"></a>C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb75-13"><a href="aplikace3.html#cb75-13" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb75-14"><a href="aplikace3.html#cb75-14" tabindex="-1"></a></span>
<span id="cb75-15"><a href="aplikace3.html#cb75-15" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb75-16"><a href="aplikace3.html#cb75-16" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb75-17"><a href="aplikace3.html#cb75-17" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb75-18"><a href="aplikace3.html#cb75-18" tabindex="-1"></a></span>
<span id="cb75-19"><a href="aplikace3.html#cb75-19" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb75-20"><a href="aplikace3.html#cb75-20" tabindex="-1"></a>p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb75-21"><a href="aplikace3.html#cb75-21" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb75-22"><a href="aplikace3.html#cb75-22" tabindex="-1"></a></span>
<span id="cb75-23"><a href="aplikace3.html#cb75-23" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb75-24"><a href="aplikace3.html#cb75-24" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb75-25"><a href="aplikace3.html#cb75-25" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span></code></pre></div>
</details>
<p>Podívejme se, jak dopadly optimální hodnoty. Pro <em>lineární jádro</em> máme optimální hodnotu <span class="math inline">\(C\)</span> rovnu 0.0379, pro <em>polynomiální jádro</em> je <span class="math inline">\(C\)</span> rovno 1.4384 a pro <em>radiální jádro</em> máme dvě optimální hodnoty, pro <span class="math inline">\(C\)</span> je optimální hodnota 12.7427 a pro <span class="math inline">\(\gamma\)</span> je to 0.0052. Validační chybovosti jsou postupně 0.0066667 pro lineární, 0.0195833 pro polynomiální a 0.0133333 pro radiální jádro.</p>
<p>Konečně můžeme sestrojit finální klasifikátory na celých trénovacích datech s hodnotami hyperparametrů určenými pomocí 10-násobné CV. Určíme také chybovosti na testovacích a také na trénovacích datech.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="aplikace3.html#cb76-1" tabindex="-1"></a><span class="co"># sestrojeni modelu</span></span>
<span id="cb76-2"><a href="aplikace3.html#cb76-2" tabindex="-1"></a>clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb76-3"><a href="aplikace3.html#cb76-3" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb76-4"><a href="aplikace3.html#cb76-4" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb76-5"><a href="aplikace3.html#cb76-5" tabindex="-1"></a>                 <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb76-6"><a href="aplikace3.html#cb76-6" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb76-7"><a href="aplikace3.html#cb76-7" tabindex="-1"></a></span>
<span id="cb76-8"><a href="aplikace3.html#cb76-8" tabindex="-1"></a>clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb76-9"><a href="aplikace3.html#cb76-9" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb76-10"><a href="aplikace3.html#cb76-10" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb76-11"><a href="aplikace3.html#cb76-11" tabindex="-1"></a>                 <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb76-12"><a href="aplikace3.html#cb76-12" tabindex="-1"></a>                 <span class="at">degree =</span> p.opt,</span>
<span id="cb76-13"><a href="aplikace3.html#cb76-13" tabindex="-1"></a>                 <span class="at">coef0 =</span> coef0,</span>
<span id="cb76-14"><a href="aplikace3.html#cb76-14" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb76-15"><a href="aplikace3.html#cb76-15" tabindex="-1"></a></span>
<span id="cb76-16"><a href="aplikace3.html#cb76-16" tabindex="-1"></a>clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb76-17"><a href="aplikace3.html#cb76-17" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb76-18"><a href="aplikace3.html#cb76-18" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>, </span>
<span id="cb76-19"><a href="aplikace3.html#cb76-19" tabindex="-1"></a>                 <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb76-20"><a href="aplikace3.html#cb76-20" tabindex="-1"></a>                 <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb76-21"><a href="aplikace3.html#cb76-21" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb76-22"><a href="aplikace3.html#cb76-22" tabindex="-1"></a></span>
<span id="cb76-23"><a href="aplikace3.html#cb76-23" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb76-24"><a href="aplikace3.html#cb76-24" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data)</span>
<span id="cb76-25"><a href="aplikace3.html#cb76-25" tabindex="-1"></a>presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb76-26"><a href="aplikace3.html#cb76-26" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb76-27"><a href="aplikace3.html#cb76-27" tabindex="-1"></a></span>
<span id="cb76-28"><a href="aplikace3.html#cb76-28" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data)</span>
<span id="cb76-29"><a href="aplikace3.html#cb76-29" tabindex="-1"></a>presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb76-30"><a href="aplikace3.html#cb76-30" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb76-31"><a href="aplikace3.html#cb76-31" tabindex="-1"></a></span>
<span id="cb76-32"><a href="aplikace3.html#cb76-32" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data)</span>
<span id="cb76-33"><a href="aplikace3.html#cb76-33" tabindex="-1"></a>presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb76-34"><a href="aplikace3.html#cb76-34" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb76-35"><a href="aplikace3.html#cb76-35" tabindex="-1"></a></span>
<span id="cb76-36"><a href="aplikace3.html#cb76-36" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb76-37"><a href="aplikace3.html#cb76-37" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb76-38"><a href="aplikace3.html#cb76-38" tabindex="-1"></a>presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb76-39"><a href="aplikace3.html#cb76-39" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb76-40"><a href="aplikace3.html#cb76-40" tabindex="-1"></a></span>
<span id="cb76-41"><a href="aplikace3.html#cb76-41" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb76-42"><a href="aplikace3.html#cb76-42" tabindex="-1"></a>presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb76-43"><a href="aplikace3.html#cb76-43" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb76-44"><a href="aplikace3.html#cb76-44" tabindex="-1"></a></span>
<span id="cb76-45"><a href="aplikace3.html#cb76-45" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb76-46"><a href="aplikace3.html#cb76-46" tabindex="-1"></a>presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb76-47"><a href="aplikace3.html#cb76-47" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Chybovost metody SVM na trénovacích datech je tedy 0.6667 % pro lineární jádro, 1.3333 % pro polynomiální jádro a 1.3333 % pro gaussovské jádro.
Na testovacích datech je potom chybovost metody 7.6923 % pro lineární jádro, 7.6923 % pro polynomiální jádro a 4.6154 % pro radiální jádro.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="aplikace3.html#cb77-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - diskr&#39;</span>, </span>
<span id="cb77-2"><a href="aplikace3.html#cb77-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - diskr&#39;</span>, </span>
<span id="cb77-3"><a href="aplikace3.html#cb77-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - diskr&#39;</span>), </span>
<span id="cb77-4"><a href="aplikace3.html#cb77-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb77-5"><a href="aplikace3.html#cb77-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb77-6"><a href="aplikace3.html#cb77-6" tabindex="-1"></a></span>
<span id="cb77-7"><a href="aplikace3.html#cb77-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="PCA-SVMA3" class="section level4 hasAnchor" number="12.3.7.2">
<h4><span class="header-section-number">12.3.7.2</span> Skóre hlavních komponent<a href="aplikace3.html#PCA-SVMA3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>V tomto případě využijeme skóre prvních <span class="math inline">\(p =\)</span> 2 hlavních komponent.</p>
<p>Nyní se pokusme, na rozdíl od postupu v předchozích kapitolách, hyperparametry klasifikátorů odhadnout z dat pomocí 10-násobné cross-validace. Vzhledem k tomu, že každé jádro má ve své definici jiné hyperparametry, budeme ke každé jádrové funkci přistupovat zvlášť. Nicméně hyperparametr <span class="math inline">\(C\)</span> vystupuje u všech jádrových funkcí, přičemž ale připouštíme, že se může jeho optimální hodnota mezi jádry lišit.</p>
<p>U všech třech jader projdeme hodnoty hyperparametru <span class="math inline">\(C\)</span> v intervalu <span class="math inline">\([10^{-3}, 10^{3}]\)</span>, přičemž u jádra polynomiálního zafixujeme hyperparametr <span class="math inline">\(p\)</span> na hodnotě 3, neboť pro jiné celočíselné hodnoty metoda nedává zdaleka tak dobré výsledky. Naopak pro radiální jádro využijeme k volbě optimální hodnoty hyperparametru <span class="math inline">\(\gamma\)</span> opět 10-násobnou CV, přičemž uvažujeme hodnoty v intervalu <span class="math inline">\([10^{-3}, 10^{2}]\)</span>. Zvolíme <code>coef0</code> <span class="math inline">\(= 1\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="aplikace3.html#cb78-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb78-2"><a href="aplikace3.html#cb78-2" tabindex="-1"></a></span>
<span id="cb78-3"><a href="aplikace3.html#cb78-3" tabindex="-1"></a><span class="co"># ktere hodnoty gamma chceme uvazovat</span></span>
<span id="cb78-4"><a href="aplikace3.html#cb78-4" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">15</span>)</span>
<span id="cb78-5"><a href="aplikace3.html#cb78-5" tabindex="-1"></a>C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">20</span>)</span>
<span id="cb78-6"><a href="aplikace3.html#cb78-6" tabindex="-1"></a>p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb78-7"><a href="aplikace3.html#cb78-7" tabindex="-1"></a>coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb78-8"><a href="aplikace3.html#cb78-8" tabindex="-1"></a></span>
<span id="cb78-9"><a href="aplikace3.html#cb78-9" tabindex="-1"></a><span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb78-10"><a href="aplikace3.html#cb78-10" tabindex="-1"></a><span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb78-11"><a href="aplikace3.html#cb78-11" tabindex="-1"></a><span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb78-12"><a href="aplikace3.html#cb78-12" tabindex="-1"></a><span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb78-13"><a href="aplikace3.html#cb78-13" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb78-14"><a href="aplikace3.html#cb78-14" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb78-15"><a href="aplikace3.html#cb78-15" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb78-16"><a href="aplikace3.html#cb78-16" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb78-17"><a href="aplikace3.html#cb78-17" tabindex="-1"></a>)</span>
<span id="cb78-18"><a href="aplikace3.html#cb78-18" tabindex="-1"></a></span>
<span id="cb78-19"><a href="aplikace3.html#cb78-19" tabindex="-1"></a><span class="co"># nejprve projdeme hodnoty C</span></span>
<span id="cb78-20"><a href="aplikace3.html#cb78-20" tabindex="-1"></a><span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb78-21"><a href="aplikace3.html#cb78-21" tabindex="-1"></a>  <span class="co"># projdeme jednotlive folds</span></span>
<span id="cb78-22"><a href="aplikace3.html#cb78-22" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb78-23"><a href="aplikace3.html#cb78-23" tabindex="-1"></a>    <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb78-24"><a href="aplikace3.html#cb78-24" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb78-25"><a href="aplikace3.html#cb78-25" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.PCA.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb78-26"><a href="aplikace3.html#cb78-26" tabindex="-1"></a>    </span>
<span id="cb78-27"><a href="aplikace3.html#cb78-27" tabindex="-1"></a>    data.PCA.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA.train[cv_sample, ])</span>
<span id="cb78-28"><a href="aplikace3.html#cb78-28" tabindex="-1"></a>    data.PCA.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb78-29"><a href="aplikace3.html#cb78-29" tabindex="-1"></a>    </span>
<span id="cb78-30"><a href="aplikace3.html#cb78-30" tabindex="-1"></a>    <span class="do">## LINEARNI JADRO</span></span>
<span id="cb78-31"><a href="aplikace3.html#cb78-31" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb78-32"><a href="aplikace3.html#cb78-32" tabindex="-1"></a>    clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb78-33"><a href="aplikace3.html#cb78-33" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb78-34"><a href="aplikace3.html#cb78-34" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb78-35"><a href="aplikace3.html#cb78-35" tabindex="-1"></a>                     <span class="at">cost =</span> C,</span>
<span id="cb78-36"><a href="aplikace3.html#cb78-36" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb78-37"><a href="aplikace3.html#cb78-37" tabindex="-1"></a>    </span>
<span id="cb78-38"><a href="aplikace3.html#cb78-38" tabindex="-1"></a>    <span class="co"># presnost na validacnich datech</span></span>
<span id="cb78-39"><a href="aplikace3.html#cb78-39" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb78-40"><a href="aplikace3.html#cb78-40" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb78-41"><a href="aplikace3.html#cb78-41" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb78-42"><a href="aplikace3.html#cb78-42" tabindex="-1"></a>    </span>
<span id="cb78-43"><a href="aplikace3.html#cb78-43" tabindex="-1"></a>    <span class="co"># presnosti vlozime na pozice pro dane C a fold</span></span>
<span id="cb78-44"><a href="aplikace3.html#cb78-44" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb78-45"><a href="aplikace3.html#cb78-45" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb78-46"><a href="aplikace3.html#cb78-46" tabindex="-1"></a>    </span>
<span id="cb78-47"><a href="aplikace3.html#cb78-47" tabindex="-1"></a>    <span class="do">## POLYNOMIALNI JADRO</span></span>
<span id="cb78-48"><a href="aplikace3.html#cb78-48" tabindex="-1"></a>    <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb78-49"><a href="aplikace3.html#cb78-49" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb78-50"><a href="aplikace3.html#cb78-50" tabindex="-1"></a>      clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb78-51"><a href="aplikace3.html#cb78-51" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb78-52"><a href="aplikace3.html#cb78-52" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb78-53"><a href="aplikace3.html#cb78-53" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb78-54"><a href="aplikace3.html#cb78-54" tabindex="-1"></a>                       <span class="at">coef0 =</span> coef0,</span>
<span id="cb78-55"><a href="aplikace3.html#cb78-55" tabindex="-1"></a>                       <span class="at">degree =</span> p,</span>
<span id="cb78-56"><a href="aplikace3.html#cb78-56" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb78-57"><a href="aplikace3.html#cb78-57" tabindex="-1"></a>      </span>
<span id="cb78-58"><a href="aplikace3.html#cb78-58" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb78-59"><a href="aplikace3.html#cb78-59" tabindex="-1"></a>      predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb78-60"><a href="aplikace3.html#cb78-60" tabindex="-1"></a>      presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb78-61"><a href="aplikace3.html#cb78-61" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb78-62"><a href="aplikace3.html#cb78-62" tabindex="-1"></a>      </span>
<span id="cb78-63"><a href="aplikace3.html#cb78-63" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C, p a fold</span></span>
<span id="cb78-64"><a href="aplikace3.html#cb78-64" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb78-65"><a href="aplikace3.html#cb78-65" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb78-66"><a href="aplikace3.html#cb78-66" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb78-67"><a href="aplikace3.html#cb78-67" tabindex="-1"></a>    }</span>
<span id="cb78-68"><a href="aplikace3.html#cb78-68" tabindex="-1"></a>        </span>
<span id="cb78-69"><a href="aplikace3.html#cb78-69" tabindex="-1"></a>    <span class="do">## RADIALNI JADRO</span></span>
<span id="cb78-70"><a href="aplikace3.html#cb78-70" tabindex="-1"></a>    <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb78-71"><a href="aplikace3.html#cb78-71" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb78-72"><a href="aplikace3.html#cb78-72" tabindex="-1"></a>      clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb78-73"><a href="aplikace3.html#cb78-73" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb78-74"><a href="aplikace3.html#cb78-74" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb78-75"><a href="aplikace3.html#cb78-75" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb78-76"><a href="aplikace3.html#cb78-76" tabindex="-1"></a>                       <span class="at">gamma =</span> gamma,</span>
<span id="cb78-77"><a href="aplikace3.html#cb78-77" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb78-78"><a href="aplikace3.html#cb78-78" tabindex="-1"></a>      </span>
<span id="cb78-79"><a href="aplikace3.html#cb78-79" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb78-80"><a href="aplikace3.html#cb78-80" tabindex="-1"></a>      predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb78-81"><a href="aplikace3.html#cb78-81" tabindex="-1"></a>      presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb78-82"><a href="aplikace3.html#cb78-82" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb78-83"><a href="aplikace3.html#cb78-83" tabindex="-1"></a>      </span>
<span id="cb78-84"><a href="aplikace3.html#cb78-84" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C, gamma a fold</span></span>
<span id="cb78-85"><a href="aplikace3.html#cb78-85" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb78-86"><a href="aplikace3.html#cb78-86" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb78-87"><a href="aplikace3.html#cb78-87" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb78-88"><a href="aplikace3.html#cb78-88" tabindex="-1"></a>    }</span>
<span id="cb78-89"><a href="aplikace3.html#cb78-89" tabindex="-1"></a>  }</span>
<span id="cb78-90"><a href="aplikace3.html#cb78-90" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Nyní zprůměrujeme výsledky 10-násobné CV tak, abychom pro jednu hodnotu hyperparametru (případně jednu kombinaci hodnot) měli jeden odhad validační chybovosti. Přitom určíme i optimální hodnoty jednotlivých hyperparametrů.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="aplikace3.html#cb79-1" tabindex="-1"></a><span class="co"># spocitame prumerne presnosti pro jednotliva C pres folds</span></span>
<span id="cb79-2"><a href="aplikace3.html#cb79-2" tabindex="-1"></a><span class="do">## Linearni jadro</span></span>
<span id="cb79-3"><a href="aplikace3.html#cb79-3" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb79-4"><a href="aplikace3.html#cb79-4" tabindex="-1"></a><span class="do">## Polynomialni jadro</span></span>
<span id="cb79-5"><a href="aplikace3.html#cb79-5" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb79-6"><a href="aplikace3.html#cb79-6" tabindex="-1"></a><span class="do">## Radialni jadro</span></span>
<span id="cb79-7"><a href="aplikace3.html#cb79-7" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb79-8"><a href="aplikace3.html#cb79-8" tabindex="-1"></a></span>
<span id="cb79-9"><a href="aplikace3.html#cb79-9" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb79-10"><a href="aplikace3.html#cb79-10" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb79-11"><a href="aplikace3.html#cb79-11" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb79-12"><a href="aplikace3.html#cb79-12" tabindex="-1"></a>C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb79-13"><a href="aplikace3.html#cb79-13" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb79-14"><a href="aplikace3.html#cb79-14" tabindex="-1"></a></span>
<span id="cb79-15"><a href="aplikace3.html#cb79-15" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb79-16"><a href="aplikace3.html#cb79-16" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb79-17"><a href="aplikace3.html#cb79-17" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb79-18"><a href="aplikace3.html#cb79-18" tabindex="-1"></a></span>
<span id="cb79-19"><a href="aplikace3.html#cb79-19" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb79-20"><a href="aplikace3.html#cb79-20" tabindex="-1"></a>p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb79-21"><a href="aplikace3.html#cb79-21" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb79-22"><a href="aplikace3.html#cb79-22" tabindex="-1"></a></span>
<span id="cb79-23"><a href="aplikace3.html#cb79-23" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb79-24"><a href="aplikace3.html#cb79-24" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb79-25"><a href="aplikace3.html#cb79-25" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span></code></pre></div>
</details>
<p>Podívejme se, jak dopadly optimální hodnoty. Pro <em>lineární jádro</em> máme optimální hodnotu <span class="math inline">\(C\)</span> rovnu 0.1624, pro <em>polynomiální jádro</em> je <span class="math inline">\(C\)</span> rovno 0.0785 a pro <em>radiální jádro</em> máme dvě optimální hodnoty, pro <span class="math inline">\(C\)</span> je optimální hodnota 26.3665 a pro <span class="math inline">\(\gamma\)</span> je to 1.6379. Validační chybovosti jsou postupně 0.328869 pro lineární, 0.328869 pro polynomiální a 0.2959524 pro radiální jádro.</p>
<p>Konečně můžeme sestrojit finální klasifikátory na celých trénovacích datech s hodnotami hyperparametrů určenými pomocí 10-násobné CV. Určíme také chybovosti na testovacích a také na trénovacích datech.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="aplikace3.html#cb80-1" tabindex="-1"></a><span class="co"># sestrojeni modelu</span></span>
<span id="cb80-2"><a href="aplikace3.html#cb80-2" tabindex="-1"></a>clf.SVM.l.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb80-3"><a href="aplikace3.html#cb80-3" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb80-4"><a href="aplikace3.html#cb80-4" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb80-5"><a href="aplikace3.html#cb80-5" tabindex="-1"></a>                     <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb80-6"><a href="aplikace3.html#cb80-6" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb80-7"><a href="aplikace3.html#cb80-7" tabindex="-1"></a></span>
<span id="cb80-8"><a href="aplikace3.html#cb80-8" tabindex="-1"></a>clf.SVM.p.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb80-9"><a href="aplikace3.html#cb80-9" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb80-10"><a href="aplikace3.html#cb80-10" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb80-11"><a href="aplikace3.html#cb80-11" tabindex="-1"></a>                     <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb80-12"><a href="aplikace3.html#cb80-12" tabindex="-1"></a>                     <span class="at">degree =</span> p.opt,</span>
<span id="cb80-13"><a href="aplikace3.html#cb80-13" tabindex="-1"></a>                     <span class="at">coef0 =</span> coef0,</span>
<span id="cb80-14"><a href="aplikace3.html#cb80-14" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb80-15"><a href="aplikace3.html#cb80-15" tabindex="-1"></a></span>
<span id="cb80-16"><a href="aplikace3.html#cb80-16" tabindex="-1"></a>clf.SVM.r.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb80-17"><a href="aplikace3.html#cb80-17" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb80-18"><a href="aplikace3.html#cb80-18" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb80-19"><a href="aplikace3.html#cb80-19" tabindex="-1"></a>                     <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb80-20"><a href="aplikace3.html#cb80-20" tabindex="-1"></a>                     <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb80-21"><a href="aplikace3.html#cb80-21" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb80-22"><a href="aplikace3.html#cb80-22" tabindex="-1"></a></span>
<span id="cb80-23"><a href="aplikace3.html#cb80-23" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb80-24"><a href="aplikace3.html#cb80-24" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb80-25"><a href="aplikace3.html#cb80-25" tabindex="-1"></a>presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb80-26"><a href="aplikace3.html#cb80-26" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb80-27"><a href="aplikace3.html#cb80-27" tabindex="-1"></a></span>
<span id="cb80-28"><a href="aplikace3.html#cb80-28" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb80-29"><a href="aplikace3.html#cb80-29" tabindex="-1"></a>presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb80-30"><a href="aplikace3.html#cb80-30" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb80-31"><a href="aplikace3.html#cb80-31" tabindex="-1"></a></span>
<span id="cb80-32"><a href="aplikace3.html#cb80-32" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb80-33"><a href="aplikace3.html#cb80-33" tabindex="-1"></a>presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb80-34"><a href="aplikace3.html#cb80-34" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb80-35"><a href="aplikace3.html#cb80-35" tabindex="-1"></a>  </span>
<span id="cb80-36"><a href="aplikace3.html#cb80-36" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb80-37"><a href="aplikace3.html#cb80-37" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb80-38"><a href="aplikace3.html#cb80-38" tabindex="-1"></a>presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb80-39"><a href="aplikace3.html#cb80-39" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb80-40"><a href="aplikace3.html#cb80-40" tabindex="-1"></a></span>
<span id="cb80-41"><a href="aplikace3.html#cb80-41" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb80-42"><a href="aplikace3.html#cb80-42" tabindex="-1"></a>presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb80-43"><a href="aplikace3.html#cb80-43" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb80-44"><a href="aplikace3.html#cb80-44" tabindex="-1"></a></span>
<span id="cb80-45"><a href="aplikace3.html#cb80-45" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb80-46"><a href="aplikace3.html#cb80-46" tabindex="-1"></a>presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb80-47"><a href="aplikace3.html#cb80-47" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Chybovost metody SVM aplikované na skóre hlavních komponent na trénovacích datech je tedy 32 % pro lineární jádro, 33.33 % pro polynomiální jádro a 16 % pro gaussovské jádro.
Na testovacích datech je potom chybovost metody 29.2308 % pro lineární jádro, 27.6923 % pro polynomiální jádro a 36.9231 % pro radiální jádro.</p>
<p>Pro grafické znázornění metody můžeme zaznačit dělící hranici do grafu skórů prvních dvou hlavních komponent.
Tuto hranici spočítáme na husté síti bodů a zobrazíme ji pomocí funkce <code>geom_contour()</code> stejně jako v předchozích případech, kdy jsme také vykreslovali klasifikační hranici.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="aplikace3.html#cb81-1" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">rbind</span>(nd, nd, nd) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb81-2"><a href="aplikace3.html#cb81-2" tabindex="-1"></a>   <span class="at">prd =</span> <span class="fu">c</span>(<span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)),</span>
<span id="cb81-3"><a href="aplikace3.html#cb81-3" tabindex="-1"></a>           <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)),</span>
<span id="cb81-4"><a href="aplikace3.html#cb81-4" tabindex="-1"></a>           <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>))),</span>
<span id="cb81-5"><a href="aplikace3.html#cb81-5" tabindex="-1"></a>   <span class="at">kernel =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;lineární&#39;</span>, <span class="st">&#39;polynomiální&#39;</span>, <span class="st">&#39;radiální&#39;</span>),</span>
<span id="cb81-6"><a href="aplikace3.html#cb81-6" tabindex="-1"></a>                <span class="at">each =</span> <span class="fu">length</span>(<span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.l.PCA, </span>
<span id="cb81-7"><a href="aplikace3.html#cb81-7" tabindex="-1"></a>                                                 <span class="at">newdata =</span> nd,</span>
<span id="cb81-8"><a href="aplikace3.html#cb81-8" tabindex="-1"></a>                                                 <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)))) <span class="sc">|&gt;</span></span>
<span id="cb81-9"><a href="aplikace3.html#cb81-9" tabindex="-1"></a>     <span class="fu">as.factor</span>())</span>
<span id="cb81-10"><a href="aplikace3.html#cb81-10" tabindex="-1"></a></span>
<span id="cb81-11"><a href="aplikace3.html#cb81-11" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb81-12"><a href="aplikace3.html#cb81-12" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb81-13"><a href="aplikace3.html#cb81-13" tabindex="-1"></a> <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1. hlavní komponenta (vysvětlená variabilita&#39;</span>, </span>
<span id="cb81-14"><a href="aplikace3.html#cb81-14" tabindex="-1"></a>                <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb81-15"><a href="aplikace3.html#cb81-15" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2. hlavní komponenta (&#39;</span>, </span>
<span id="cb81-16"><a href="aplikace3.html#cb81-16" tabindex="-1"></a>                <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb81-17"><a href="aplikace3.html#cb81-17" tabindex="-1"></a>      <span class="at">colour =</span> <span class="st">&#39;Obsah tuku&#39;</span>, </span>
<span id="cb81-18"><a href="aplikace3.html#cb81-18" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="st">&#39;Jádro&#39;</span>) <span class="sc">+</span></span>
<span id="cb81-19"><a href="aplikace3.html#cb81-19" tabindex="-1"></a> <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;malý&quot;</span>, <span class="st">&quot;velký&quot;</span>)) <span class="sc">+</span></span>
<span id="cb81-20"><a href="aplikace3.html#cb81-20" tabindex="-1"></a> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb81-21"><a href="aplikace3.html#cb81-21" tabindex="-1"></a> <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd, <span class="at">linetype =</span> kernel), </span>
<span id="cb81-22"><a href="aplikace3.html#cb81-22" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-76"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-76-1.png" alt="Skóre prvních dvou hlavních komponent, barevně odlišené podle příslušnosti do klasifikační třídy. Černě je vyznačena dělící hranice (přímka, resp. křivky v rovině prvních dvou hlavních komponent) mezi třídami sestrojená pomocí metody SVM." width="672" />
<p class="caption">
Obrázek 12.20: Skóre prvních dvou hlavních komponent, barevně odlišené podle příslušnosti do klasifikační třídy. Černě je vyznačena dělící hranice (přímka, resp. křivky v rovině prvních dvou hlavních komponent) mezi třídami sestrojená pomocí metody SVM.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="aplikace3.html#cb82-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - PCA&#39;</span>, </span>
<span id="cb82-2"><a href="aplikace3.html#cb82-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - PCA&#39;</span>, </span>
<span id="cb82-3"><a href="aplikace3.html#cb82-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - PCA&#39;</span>), </span>
<span id="cb82-4"><a href="aplikace3.html#cb82-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb82-5"><a href="aplikace3.html#cb82-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb82-6"><a href="aplikace3.html#cb82-6" tabindex="-1"></a></span>
<span id="cb82-7"><a href="aplikace3.html#cb82-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="basis-SVMA3" class="section level4 hasAnchor" number="12.3.7.3">
<h4><span class="header-section-number">12.3.7.3</span> Bázové koeficienty<a href="aplikace3.html#basis-SVMA3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Nakonec použijeme vyjádření funkcí pomocí B-splinové báze.
U všech třech jader projdeme hodnoty hyperparametru <span class="math inline">\(C\)</span> v intervalu <span class="math inline">\([10^{-3}, 10^{3}]\)</span>, přičemž u jádra polynomiálního zafixujeme hyperparametr <span class="math inline">\(p\)</span> na hodnotě 3, neboť pro jiné celočíselné hodnoty metoda nedává zdaleka tak dobré výsledky. Naopak pro radiální jádro využijeme k volbě optimální hodnoty hyperparametru <span class="math inline">\(\gamma\)</span> opět 10-násobnou CV, přičemž uvažujeme hodnoty v intervalu <span class="math inline">\([10^{-3}, 10^{2}]\)</span>. Zvolíme <code>coef0</code> <span class="math inline">\(= 1\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="aplikace3.html#cb83-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb83-2"><a href="aplikace3.html#cb83-2" tabindex="-1"></a></span>
<span id="cb83-3"><a href="aplikace3.html#cb83-3" tabindex="-1"></a><span class="co"># ktere hodnoty gamma chceme uvazovat</span></span>
<span id="cb83-4"><a href="aplikace3.html#cb83-4" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">15</span>)</span>
<span id="cb83-5"><a href="aplikace3.html#cb83-5" tabindex="-1"></a>C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">20</span>)</span>
<span id="cb83-6"><a href="aplikace3.html#cb83-6" tabindex="-1"></a>p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb83-7"><a href="aplikace3.html#cb83-7" tabindex="-1"></a>coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-8"><a href="aplikace3.html#cb83-8" tabindex="-1"></a></span>
<span id="cb83-9"><a href="aplikace3.html#cb83-9" tabindex="-1"></a><span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb83-10"><a href="aplikace3.html#cb83-10" tabindex="-1"></a><span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb83-11"><a href="aplikace3.html#cb83-11" tabindex="-1"></a><span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb83-12"><a href="aplikace3.html#cb83-12" tabindex="-1"></a><span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb83-13"><a href="aplikace3.html#cb83-13" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb83-14"><a href="aplikace3.html#cb83-14" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb83-15"><a href="aplikace3.html#cb83-15" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb83-16"><a href="aplikace3.html#cb83-16" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb83-17"><a href="aplikace3.html#cb83-17" tabindex="-1"></a>)</span>
<span id="cb83-18"><a href="aplikace3.html#cb83-18" tabindex="-1"></a></span>
<span id="cb83-19"><a href="aplikace3.html#cb83-19" tabindex="-1"></a><span class="co"># nejprve projdeme hodnoty C</span></span>
<span id="cb83-20"><a href="aplikace3.html#cb83-20" tabindex="-1"></a><span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb83-21"><a href="aplikace3.html#cb83-21" tabindex="-1"></a>  <span class="co"># projdeme jednotlive folds</span></span>
<span id="cb83-22"><a href="aplikace3.html#cb83-22" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb83-23"><a href="aplikace3.html#cb83-23" tabindex="-1"></a>    <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb83-24"><a href="aplikace3.html#cb83-24" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb83-25"><a href="aplikace3.html#cb83-25" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb83-26"><a href="aplikace3.html#cb83-26" tabindex="-1"></a>    </span>
<span id="cb83-27"><a href="aplikace3.html#cb83-27" tabindex="-1"></a>    data.Bbasis.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.Bbasis.train[cv_sample, ])</span>
<span id="cb83-28"><a href="aplikace3.html#cb83-28" tabindex="-1"></a>    data.Bbasis.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.Bbasis.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb83-29"><a href="aplikace3.html#cb83-29" tabindex="-1"></a>    </span>
<span id="cb83-30"><a href="aplikace3.html#cb83-30" tabindex="-1"></a>    <span class="do">## LINEARNI JADRO</span></span>
<span id="cb83-31"><a href="aplikace3.html#cb83-31" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb83-32"><a href="aplikace3.html#cb83-32" tabindex="-1"></a>    clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb83-33"><a href="aplikace3.html#cb83-33" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb83-34"><a href="aplikace3.html#cb83-34" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb83-35"><a href="aplikace3.html#cb83-35" tabindex="-1"></a>                     <span class="at">cost =</span> C,</span>
<span id="cb83-36"><a href="aplikace3.html#cb83-36" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb83-37"><a href="aplikace3.html#cb83-37" tabindex="-1"></a>    </span>
<span id="cb83-38"><a href="aplikace3.html#cb83-38" tabindex="-1"></a>    <span class="co"># presnost na validacnich datech</span></span>
<span id="cb83-39"><a href="aplikace3.html#cb83-39" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb83-40"><a href="aplikace3.html#cb83-40" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb83-41"><a href="aplikace3.html#cb83-41" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb83-42"><a href="aplikace3.html#cb83-42" tabindex="-1"></a>    </span>
<span id="cb83-43"><a href="aplikace3.html#cb83-43" tabindex="-1"></a>    <span class="co"># presnosti vlozime na pozice pro dane C a fold</span></span>
<span id="cb83-44"><a href="aplikace3.html#cb83-44" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb83-45"><a href="aplikace3.html#cb83-45" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb83-46"><a href="aplikace3.html#cb83-46" tabindex="-1"></a>    </span>
<span id="cb83-47"><a href="aplikace3.html#cb83-47" tabindex="-1"></a>    <span class="do">## POLYNOMIALNI JADRO</span></span>
<span id="cb83-48"><a href="aplikace3.html#cb83-48" tabindex="-1"></a>    <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb83-49"><a href="aplikace3.html#cb83-49" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb83-50"><a href="aplikace3.html#cb83-50" tabindex="-1"></a>      clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb83-51"><a href="aplikace3.html#cb83-51" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb83-52"><a href="aplikace3.html#cb83-52" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb83-53"><a href="aplikace3.html#cb83-53" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb83-54"><a href="aplikace3.html#cb83-54" tabindex="-1"></a>                       <span class="at">coef0 =</span> coef0,</span>
<span id="cb83-55"><a href="aplikace3.html#cb83-55" tabindex="-1"></a>                       <span class="at">degree =</span> p,</span>
<span id="cb83-56"><a href="aplikace3.html#cb83-56" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb83-57"><a href="aplikace3.html#cb83-57" tabindex="-1"></a>      </span>
<span id="cb83-58"><a href="aplikace3.html#cb83-58" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb83-59"><a href="aplikace3.html#cb83-59" tabindex="-1"></a>      predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, </span>
<span id="cb83-60"><a href="aplikace3.html#cb83-60" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb83-61"><a href="aplikace3.html#cb83-61" tabindex="-1"></a>      presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb83-62"><a href="aplikace3.html#cb83-62" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb83-63"><a href="aplikace3.html#cb83-63" tabindex="-1"></a>      </span>
<span id="cb83-64"><a href="aplikace3.html#cb83-64" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C, p a fold</span></span>
<span id="cb83-65"><a href="aplikace3.html#cb83-65" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb83-66"><a href="aplikace3.html#cb83-66" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb83-67"><a href="aplikace3.html#cb83-67" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb83-68"><a href="aplikace3.html#cb83-68" tabindex="-1"></a>    }</span>
<span id="cb83-69"><a href="aplikace3.html#cb83-69" tabindex="-1"></a>        </span>
<span id="cb83-70"><a href="aplikace3.html#cb83-70" tabindex="-1"></a>    <span class="do">## RADIALNI JADRO</span></span>
<span id="cb83-71"><a href="aplikace3.html#cb83-71" tabindex="-1"></a>    <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb83-72"><a href="aplikace3.html#cb83-72" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb83-73"><a href="aplikace3.html#cb83-73" tabindex="-1"></a>      clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb83-74"><a href="aplikace3.html#cb83-74" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb83-75"><a href="aplikace3.html#cb83-75" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb83-76"><a href="aplikace3.html#cb83-76" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb83-77"><a href="aplikace3.html#cb83-77" tabindex="-1"></a>                       <span class="at">gamma =</span> gamma,</span>
<span id="cb83-78"><a href="aplikace3.html#cb83-78" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb83-79"><a href="aplikace3.html#cb83-79" tabindex="-1"></a>      </span>
<span id="cb83-80"><a href="aplikace3.html#cb83-80" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb83-81"><a href="aplikace3.html#cb83-81" tabindex="-1"></a>      predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, </span>
<span id="cb83-82"><a href="aplikace3.html#cb83-82" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb83-83"><a href="aplikace3.html#cb83-83" tabindex="-1"></a>      presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb83-84"><a href="aplikace3.html#cb83-84" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb83-85"><a href="aplikace3.html#cb83-85" tabindex="-1"></a>      </span>
<span id="cb83-86"><a href="aplikace3.html#cb83-86" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C, gamma a fold</span></span>
<span id="cb83-87"><a href="aplikace3.html#cb83-87" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb83-88"><a href="aplikace3.html#cb83-88" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb83-89"><a href="aplikace3.html#cb83-89" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb83-90"><a href="aplikace3.html#cb83-90" tabindex="-1"></a>    }</span>
<span id="cb83-91"><a href="aplikace3.html#cb83-91" tabindex="-1"></a>  }</span>
<span id="cb83-92"><a href="aplikace3.html#cb83-92" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Nyní zprůměrujeme výsledky 10-násobné CV tak, abychom pro jednu hodnotu hyperparametru (případně jednu kombinaci hodnot) měli jeden odhad validační chybovosti. Přitom určíme i optimální hodnoty jednotlivých hyperparametrů.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="aplikace3.html#cb84-1" tabindex="-1"></a><span class="co"># spocitame prumerne presnosti pro jednotliva C pres folds</span></span>
<span id="cb84-2"><a href="aplikace3.html#cb84-2" tabindex="-1"></a><span class="do">## Linearni jadro</span></span>
<span id="cb84-3"><a href="aplikace3.html#cb84-3" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb84-4"><a href="aplikace3.html#cb84-4" tabindex="-1"></a><span class="do">## Polynomialni jadro</span></span>
<span id="cb84-5"><a href="aplikace3.html#cb84-5" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb84-6"><a href="aplikace3.html#cb84-6" tabindex="-1"></a><span class="do">## Radialni jadro</span></span>
<span id="cb84-7"><a href="aplikace3.html#cb84-7" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb84-8"><a href="aplikace3.html#cb84-8" tabindex="-1"></a></span>
<span id="cb84-9"><a href="aplikace3.html#cb84-9" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb84-10"><a href="aplikace3.html#cb84-10" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb84-11"><a href="aplikace3.html#cb84-11" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb84-12"><a href="aplikace3.html#cb84-12" tabindex="-1"></a>C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb84-13"><a href="aplikace3.html#cb84-13" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb84-14"><a href="aplikace3.html#cb84-14" tabindex="-1"></a></span>
<span id="cb84-15"><a href="aplikace3.html#cb84-15" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb84-16"><a href="aplikace3.html#cb84-16" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb84-17"><a href="aplikace3.html#cb84-17" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb84-18"><a href="aplikace3.html#cb84-18" tabindex="-1"></a></span>
<span id="cb84-19"><a href="aplikace3.html#cb84-19" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb84-20"><a href="aplikace3.html#cb84-20" tabindex="-1"></a>p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb84-21"><a href="aplikace3.html#cb84-21" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb84-22"><a href="aplikace3.html#cb84-22" tabindex="-1"></a></span>
<span id="cb84-23"><a href="aplikace3.html#cb84-23" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb84-24"><a href="aplikace3.html#cb84-24" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb84-25"><a href="aplikace3.html#cb84-25" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span></code></pre></div>
</details>
<p>Podívejme se, jak dopadly optimální hodnoty. Pro <em>lineární jádro</em> máme optimální hodnotu <span class="math inline">\(C\)</span> rovnu 6.1585, pro <em>polynomiální jádro</em> je <span class="math inline">\(C\)</span> rovno 54.5559 a pro <em>radiální jádro</em> máme dvě optimální hodnoty, pro <span class="math inline">\(C\)</span> je optimální hodnota 26.3665 a pro <span class="math inline">\(\gamma\)</span> je to 0.0118. Validační chybovosti jsou postupně 0.0195833 pro lineární, 0.0325 pro polynomiální a 0.0258333 pro radiální jádro.</p>
<p>Konečně můžeme sestrojit finální klasifikátory na celých trénovacích datech s hodnotami hyperparametrů určenými pomocí 10-násobné CV. Určíme také chybovosti na testovacích a také na trénovacích datech.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="aplikace3.html#cb85-1" tabindex="-1"></a><span class="co"># sestrojeni modelu</span></span>
<span id="cb85-2"><a href="aplikace3.html#cb85-2" tabindex="-1"></a>clf.SVM.l.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb85-3"><a href="aplikace3.html#cb85-3" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb85-4"><a href="aplikace3.html#cb85-4" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb85-5"><a href="aplikace3.html#cb85-5" tabindex="-1"></a>                        <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb85-6"><a href="aplikace3.html#cb85-6" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb85-7"><a href="aplikace3.html#cb85-7" tabindex="-1"></a></span>
<span id="cb85-8"><a href="aplikace3.html#cb85-8" tabindex="-1"></a>clf.SVM.p.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb85-9"><a href="aplikace3.html#cb85-9" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb85-10"><a href="aplikace3.html#cb85-10" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb85-11"><a href="aplikace3.html#cb85-11" tabindex="-1"></a>                        <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb85-12"><a href="aplikace3.html#cb85-12" tabindex="-1"></a>                        <span class="at">degree =</span> p.opt,</span>
<span id="cb85-13"><a href="aplikace3.html#cb85-13" tabindex="-1"></a>                        <span class="at">coef0 =</span> coef0,</span>
<span id="cb85-14"><a href="aplikace3.html#cb85-14" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb85-15"><a href="aplikace3.html#cb85-15" tabindex="-1"></a></span>
<span id="cb85-16"><a href="aplikace3.html#cb85-16" tabindex="-1"></a>clf.SVM.r.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb85-17"><a href="aplikace3.html#cb85-17" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb85-18"><a href="aplikace3.html#cb85-18" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb85-19"><a href="aplikace3.html#cb85-19" tabindex="-1"></a>                        <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb85-20"><a href="aplikace3.html#cb85-20" tabindex="-1"></a>                        <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb85-21"><a href="aplikace3.html#cb85-21" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb85-22"><a href="aplikace3.html#cb85-22" tabindex="-1"></a></span>
<span id="cb85-23"><a href="aplikace3.html#cb85-23" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb85-24"><a href="aplikace3.html#cb85-24" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb85-25"><a href="aplikace3.html#cb85-25" tabindex="-1"></a>presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb85-26"><a href="aplikace3.html#cb85-26" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb85-27"><a href="aplikace3.html#cb85-27" tabindex="-1"></a></span>
<span id="cb85-28"><a href="aplikace3.html#cb85-28" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb85-29"><a href="aplikace3.html#cb85-29" tabindex="-1"></a>presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb85-30"><a href="aplikace3.html#cb85-30" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb85-31"><a href="aplikace3.html#cb85-31" tabindex="-1"></a></span>
<span id="cb85-32"><a href="aplikace3.html#cb85-32" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb85-33"><a href="aplikace3.html#cb85-33" tabindex="-1"></a>presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb85-34"><a href="aplikace3.html#cb85-34" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb85-35"><a href="aplikace3.html#cb85-35" tabindex="-1"></a>  </span>
<span id="cb85-36"><a href="aplikace3.html#cb85-36" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb85-37"><a href="aplikace3.html#cb85-37" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb85-38"><a href="aplikace3.html#cb85-38" tabindex="-1"></a>presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb85-39"><a href="aplikace3.html#cb85-39" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb85-40"><a href="aplikace3.html#cb85-40" tabindex="-1"></a></span>
<span id="cb85-41"><a href="aplikace3.html#cb85-41" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb85-42"><a href="aplikace3.html#cb85-42" tabindex="-1"></a>presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb85-43"><a href="aplikace3.html#cb85-43" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb85-44"><a href="aplikace3.html#cb85-44" tabindex="-1"></a></span>
<span id="cb85-45"><a href="aplikace3.html#cb85-45" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb85-46"><a href="aplikace3.html#cb85-46" tabindex="-1"></a>presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb85-47"><a href="aplikace3.html#cb85-47" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Chybovost metody SVM aplikované na bázové koeficienty na trénovacích datech je tedy 0.67 % pro lineární jádro, 0.67 % pro polynomiální jádro a 1.33 % pro gaussovské jádro.
Na testovacích datech je potom chybovost metody 6.1538 % pro lineární jádro, 9.2308 % pro polynomiální jádro a 6.1538 % pro radiální jádro.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="aplikace3.html#cb86-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - Bbasis&#39;</span>, </span>
<span id="cb86-2"><a href="aplikace3.html#cb86-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - Bbasis&#39;</span>, </span>
<span id="cb86-3"><a href="aplikace3.html#cb86-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - Bbasis&#39;</span>), </span>
<span id="cb86-4"><a href="aplikace3.html#cb86-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb86-5"><a href="aplikace3.html#cb86-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb86-6"><a href="aplikace3.html#cb86-6" tabindex="-1"></a></span>
<span id="cb86-7"><a href="aplikace3.html#cb86-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="projection-SVMA3" class="section level4 hasAnchor" number="12.3.7.4">
<h4><span class="header-section-number">12.3.7.4</span> Projekce na B-splinovou bázi<a href="aplikace3.html#projection-SVMA3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Další možností, jak použít klasickou metodu SVM pro funkcionální data, je projektovat původní data na nějaký <span class="math inline">\(d\)</span>-dimenzionální podprostor našeho Hilbertova prostoru <span class="math inline">\(\mathcal H\)</span>, označme jej <span class="math inline">\(V_d\)</span>.
Předpokládejme, že tento podprostor <span class="math inline">\(V_d\)</span> má ortonormální bázi <span class="math inline">\(\{\Psi_j\}_{j = 1, \dots, d}\)</span>.
Definujeme transformaci <span class="math inline">\(P_{V_d}\)</span> jakožto ortogonální projekci na podprostor <span class="math inline">\(V_d\)</span>, tedy můžeme psát</p>
<p><span class="math display">\[
P_{V_d} (x) = \sum_{j = 1}^d \langle x, \Psi_j \rangle \Psi_j.
\]</span></p>
<p>Nyní můžeme pro klasifikaci použít koeficienty z ortogonální projekce, tedy aplikujeme standardní SVM na vektory <span class="math inline">\(\left( \langle x, \Psi_1 \rangle, \dots, \langle x, \Psi_d \rangle\right)^\top\)</span>.
Využitím této transformace jsme tedy definovali nové, tzv.
adaptované jádro, které je složené z ortogonální projekce <span class="math inline">\(P_{V_d}\)</span> a jádrové funkce standardní metody podpůrných vektorů.
Máme tedy (adaptované) jádro <span class="math inline">\(Q(x_i, x_j) = K(P_{V_d}(x_i), P_{V_d}(x_j))\)</span>.
Jde tedy o metodu redukce dimenze, kterou můžeme nazvat <em>filtrace</em>.</p>
<p>Pro samotnou projekci použijeme v <code>R</code> funkci <code>project.basis()</code> z knihovny <code>fda</code>.
Na jejím vstupu bude matice původních diskrétních (nevyhlazených) dat, hodnoty, ve kterých měříme hodnoty v matici původních dat a bázový objekt, na který chceme data projektovat.
My zvolíme projekci na B-splinovou bázi, protože využití Fourierovy báze není pro naše neperiodická data vhodné.</p>
<p>Dimenzi <span class="math inline">\(d\)</span> volíme buď z nějaké předchozí expertní znalosti, nebo pomocí cross-validace.
V našem případě určíme optimální dimenzi podprostoru <span class="math inline">\(V_d\)</span> pomocí <span class="math inline">\(k\)</span>-násobné cross-validace (volíme <span class="math inline">\(k \ll n\)</span> kvůli výpočetní náročnosti metody, často se volí <span class="math inline">\(k = 5\)</span> nebo <span class="math inline">\(k = 10\)</span>).
Požadujeme B-spliny řádu 4, pro počet bázových funkcí potom platí vztah</p>
<p><span class="math display">\[
n_{basis} = n_{breaks} + n_{order} - 2,
\]</span></p>
<p>kde <span class="math inline">\(n_{breaks}\)</span> je počet uzlů a <span class="math inline">\(n_{order} = 4\)</span>.
V <code>R</code> však hodnota <span class="math inline">\(n_{basis}\)</span> musí být alespoň <span class="math inline">\(n_{order} = 4\)</span> a pro velké hodnoty <span class="math inline">\(n_{basis}\)</span> již dochází k přefitování modelu, tudíž volíme za maximální <span class="math inline">\(n_{basis}\)</span> menší číslo, řekněme 20.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="aplikace3.html#cb87-1" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb87-2"><a href="aplikace3.html#cb87-2" tabindex="-1"></a></span>
<span id="cb87-3"><a href="aplikace3.html#cb87-3" tabindex="-1"></a><span class="co"># hodnoty pro B-splinovou bazi</span></span>
<span id="cb87-4"><a href="aplikace3.html#cb87-4" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb87-5"><a href="aplikace3.html#cb87-5" tabindex="-1"></a>norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb87-6"><a href="aplikace3.html#cb87-6" tabindex="-1"></a>n_basis_min <span class="ot">&lt;-</span> norder</span>
<span id="cb87-7"><a href="aplikace3.html#cb87-7" tabindex="-1"></a>n_basis_max <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb87-8"><a href="aplikace3.html#cb87-8" tabindex="-1"></a></span>
<span id="cb87-9"><a href="aplikace3.html#cb87-9" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> n_basis_min<span class="sc">:</span>n_basis_max <span class="co"># vsechny dimenze, ktere chceme vyzkouset</span></span>
<span id="cb87-10"><a href="aplikace3.html#cb87-10" tabindex="-1"></a></span>
<span id="cb87-11"><a href="aplikace3.html#cb87-11" tabindex="-1"></a><span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb87-12"><a href="aplikace3.html#cb87-12" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb87-13"><a href="aplikace3.html#cb87-13" tabindex="-1"></a></span>
<span id="cb87-14"><a href="aplikace3.html#cb87-14" tabindex="-1"></a><span class="co"># list se tremi slozkami ... maticemi pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb87-15"><a href="aplikace3.html#cb87-15" tabindex="-1"></a><span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb87-16"><a href="aplikace3.html#cb87-16" tabindex="-1"></a><span class="co"># ve sloupcich budou hodnoty presnosti pro danou cast trenovaci mnoziny</span></span>
<span id="cb87-17"><a href="aplikace3.html#cb87-17" tabindex="-1"></a><span class="co"># v radcich budou hodnoty pro danou hodnotu dimenze</span></span>
<span id="cb87-18"><a href="aplikace3.html#cb87-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">SVM.l =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb87-19"><a href="aplikace3.html#cb87-19" tabindex="-1"></a>                   <span class="at">SVM.p =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb87-20"><a href="aplikace3.html#cb87-20" tabindex="-1"></a>                   <span class="at">SVM.r =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv))</span>
<span id="cb87-21"><a href="aplikace3.html#cb87-21" tabindex="-1"></a></span>
<span id="cb87-22"><a href="aplikace3.html#cb87-22" tabindex="-1"></a><span class="cf">for</span> (d <span class="cf">in</span> dimensions) {</span>
<span id="cb87-23"><a href="aplikace3.html#cb87-23" tabindex="-1"></a>  <span class="co"># bazovy objekt</span></span>
<span id="cb87-24"><a href="aplikace3.html#cb87-24" tabindex="-1"></a>  bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb87-25"><a href="aplikace3.html#cb87-25" tabindex="-1"></a>                                 <span class="at">nbasis =</span> d)</span>
<span id="cb87-26"><a href="aplikace3.html#cb87-26" tabindex="-1"></a>  </span>
<span id="cb87-27"><a href="aplikace3.html#cb87-27" tabindex="-1"></a>  <span class="co"># projekce diskretnich dat na B-splinovou bazi o dimenzi d</span></span>
<span id="cb87-28"><a href="aplikace3.html#cb87-28" tabindex="-1"></a>  Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="co"># matice diskretnich dat</span></span>
<span id="cb87-29"><a href="aplikace3.html#cb87-29" tabindex="-1"></a>                              <span class="at">argvals =</span> t, <span class="co"># vektor argumentu</span></span>
<span id="cb87-30"><a href="aplikace3.html#cb87-30" tabindex="-1"></a>                              <span class="at">basisobj =</span> bbasis) <span class="co"># bazovy objekt</span></span>
<span id="cb87-31"><a href="aplikace3.html#cb87-31" tabindex="-1"></a>  </span>
<span id="cb87-32"><a href="aplikace3.html#cb87-32" tabindex="-1"></a>  <span class="co"># rozdeleni na trenovaci a testovaci data v ramci CV</span></span>
<span id="cb87-33"><a href="aplikace3.html#cb87-33" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb87-34"><a href="aplikace3.html#cb87-34" tabindex="-1"></a>  </span>
<span id="cb87-35"><a href="aplikace3.html#cb87-35" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb87-36"><a href="aplikace3.html#cb87-36" tabindex="-1"></a>    <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb87-37"><a href="aplikace3.html#cb87-37" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb87-38"><a href="aplikace3.html#cb87-38" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XX.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb87-39"><a href="aplikace3.html#cb87-39" tabindex="-1"></a>    </span>
<span id="cb87-40"><a href="aplikace3.html#cb87-40" tabindex="-1"></a>    data.projection.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[cv_sample, ])</span>
<span id="cb87-41"><a href="aplikace3.html#cb87-41" tabindex="-1"></a>    data.projection.train.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[cv_sample])</span>
<span id="cb87-42"><a href="aplikace3.html#cb87-42" tabindex="-1"></a>    </span>
<span id="cb87-43"><a href="aplikace3.html#cb87-43" tabindex="-1"></a>    data.projection.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb87-44"><a href="aplikace3.html#cb87-44" tabindex="-1"></a>    Y.test.cv <span class="ot">&lt;-</span> Y.train[<span class="sc">!</span>cv_sample]</span>
<span id="cb87-45"><a href="aplikace3.html#cb87-45" tabindex="-1"></a>    data.projection.test.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test.cv)</span>
<span id="cb87-46"><a href="aplikace3.html#cb87-46" tabindex="-1"></a>  </span>
<span id="cb87-47"><a href="aplikace3.html#cb87-47" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb87-48"><a href="aplikace3.html#cb87-48" tabindex="-1"></a>    clf.SVM.l.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb87-49"><a href="aplikace3.html#cb87-49" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb87-50"><a href="aplikace3.html#cb87-50" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb87-51"><a href="aplikace3.html#cb87-51" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb87-52"><a href="aplikace3.html#cb87-52" tabindex="-1"></a>    </span>
<span id="cb87-53"><a href="aplikace3.html#cb87-53" tabindex="-1"></a>    clf.SVM.p.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb87-54"><a href="aplikace3.html#cb87-54" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb87-55"><a href="aplikace3.html#cb87-55" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb87-56"><a href="aplikace3.html#cb87-56" tabindex="-1"></a>                            <span class="at">coef0 =</span> coef0,</span>
<span id="cb87-57"><a href="aplikace3.html#cb87-57" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb87-58"><a href="aplikace3.html#cb87-58" tabindex="-1"></a>    </span>
<span id="cb87-59"><a href="aplikace3.html#cb87-59" tabindex="-1"></a>    clf.SVM.r.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb87-60"><a href="aplikace3.html#cb87-60" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb87-61"><a href="aplikace3.html#cb87-61" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb87-62"><a href="aplikace3.html#cb87-62" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb87-63"><a href="aplikace3.html#cb87-63" tabindex="-1"></a>      </span>
<span id="cb87-64"><a href="aplikace3.html#cb87-64" tabindex="-1"></a>    <span class="co"># presnost na validacnich datech</span></span>
<span id="cb87-65"><a href="aplikace3.html#cb87-65" tabindex="-1"></a>    <span class="do">## linear kernel</span></span>
<span id="cb87-66"><a href="aplikace3.html#cb87-66" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.projection,</span>
<span id="cb87-67"><a href="aplikace3.html#cb87-67" tabindex="-1"></a>                                  <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb87-68"><a href="aplikace3.html#cb87-68" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb87-69"><a href="aplikace3.html#cb87-69" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb87-70"><a href="aplikace3.html#cb87-70" tabindex="-1"></a>    <span class="do">## polynomial kernel</span></span>
<span id="cb87-71"><a href="aplikace3.html#cb87-71" tabindex="-1"></a>    predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.projection, </span>
<span id="cb87-72"><a href="aplikace3.html#cb87-72" tabindex="-1"></a>                                  <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb87-73"><a href="aplikace3.html#cb87-73" tabindex="-1"></a>    presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb87-74"><a href="aplikace3.html#cb87-74" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb87-75"><a href="aplikace3.html#cb87-75" tabindex="-1"></a>    <span class="do">## radial kernel</span></span>
<span id="cb87-76"><a href="aplikace3.html#cb87-76" tabindex="-1"></a>    predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.projection,</span>
<span id="cb87-77"><a href="aplikace3.html#cb87-77" tabindex="-1"></a>                                  <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb87-78"><a href="aplikace3.html#cb87-78" tabindex="-1"></a>    presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb87-79"><a href="aplikace3.html#cb87-79" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb87-80"><a href="aplikace3.html#cb87-80" tabindex="-1"></a>    </span>
<span id="cb87-81"><a href="aplikace3.html#cb87-81" tabindex="-1"></a>    <span class="co"># presnosti vlozime na pozice pro dane d a fold</span></span>
<span id="cb87-82"><a href="aplikace3.html#cb87-82" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb87-83"><a href="aplikace3.html#cb87-83" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.p[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb87-84"><a href="aplikace3.html#cb87-84" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.r[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb87-85"><a href="aplikace3.html#cb87-85" tabindex="-1"></a>  }</span>
<span id="cb87-86"><a href="aplikace3.html#cb87-86" tabindex="-1"></a>}</span>
<span id="cb87-87"><a href="aplikace3.html#cb87-87" tabindex="-1"></a>  </span>
<span id="cb87-88"><a href="aplikace3.html#cb87-88" tabindex="-1"></a><span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb87-89"><a href="aplikace3.html#cb87-89" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb87-90"><a href="aplikace3.html#cb87-90" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb87-91"><a href="aplikace3.html#cb87-91" tabindex="-1"></a>}</span>
<span id="cb87-92"><a href="aplikace3.html#cb87-92" tabindex="-1"></a></span>
<span id="cb87-93"><a href="aplikace3.html#cb87-93" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb87-94"><a href="aplikace3.html#cb87-94" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb87-95"><a href="aplikace3.html#cb87-95" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb87-96"><a href="aplikace3.html#cb87-96" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb87-97"><a href="aplikace3.html#cb87-97" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb87-98"><a href="aplikace3.html#cb87-98" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb87-99"><a href="aplikace3.html#cb87-99" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">d_opt =</span> d.opt, <span class="at">ERR =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv,</span>
<span id="cb87-100"><a href="aplikace3.html#cb87-100" tabindex="-1"></a>           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<pre><code>##        d_opt        ERR
## linear     9 0.01958333
## poly       7 0.03297619
## radial     6 0.14125000</code></pre>
<p>Vidíme, že nejlépe vychází hodnota parametru <span class="math inline">\(d\)</span> jako 9 pro lineární jádro s hodnotou chybovosti spočtenou pomocí 10-násobné CV 0.0196, 7 pro polynomiální jádro s hodnotou spočtenou pomocí 10-násobné CV 0.033 a 6 pro radiální jádro s hodnotou chybovosti 0.1412.
Pro přehlednost si ještě vykresleme průběh validačních chybovostí v závislosti na dimenzi <span class="math inline">\(d\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="aplikace3.html#cb89-1" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> dimensions <span class="sc">|&gt;</span> <span class="fu">rep</span>(<span class="dv">3</span>), </span>
<span id="cb89-2"><a href="aplikace3.html#cb89-2" tabindex="-1"></a>                         <span class="at">CV =</span> <span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.l, </span>
<span id="cb89-3"><a href="aplikace3.html#cb89-3" tabindex="-1"></a>                                CV.results<span class="sc">$</span>SVM.p, </span>
<span id="cb89-4"><a href="aplikace3.html#cb89-4" tabindex="-1"></a>                                CV.results<span class="sc">$</span>SVM.r),</span>
<span id="cb89-5"><a href="aplikace3.html#cb89-5" tabindex="-1"></a>                         <span class="at">Kernel =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;lineární&#39;</span>, <span class="st">&#39;polynomiální&#39;</span>, <span class="st">&#39;radiální&#39;</span>), </span>
<span id="cb89-6"><a href="aplikace3.html#cb89-6" tabindex="-1"></a>                                      <span class="at">each =</span> <span class="fu">length</span>(dimensions)) <span class="sc">|&gt;</span> <span class="fu">factor</span>())</span>
<span id="cb89-7"><a href="aplikace3.html#cb89-7" tabindex="-1"></a>CV.results <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> CV, <span class="at">colour =</span> Kernel)) <span class="sc">+</span> </span>
<span id="cb89-8"><a href="aplikace3.html#cb89-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb89-9"><a href="aplikace3.html#cb89-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb89-10"><a href="aplikace3.html#cb89-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(d.opt,</span>
<span id="cb89-11"><a href="aplikace3.html#cb89-11" tabindex="-1"></a>                               presnost.opt.cv),</span>
<span id="cb89-12"><a href="aplikace3.html#cb89-12" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> d.opt, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb89-13"><a href="aplikace3.html#cb89-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb89-14"><a href="aplikace3.html#cb89-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(d)),</span>
<span id="cb89-15"><a href="aplikace3.html#cb89-15" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Validační chybovost&#39;</span>,</span>
<span id="cb89-16"><a href="aplikace3.html#cb89-16" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Jádro&#39;</span>) <span class="sc">+</span> </span>
<span id="cb89-17"><a href="aplikace3.html#cb89-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span> </span>
<span id="cb89-18"><a href="aplikace3.html#cb89-18" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> dimensions)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-83"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-83-1.png" alt="Závislost validační chybovosti na dimenzi podprostoru $V_d$, zvlášť pro všechna tři uvažovaná jádra v metodě SVM. Černými body jsou vyznačeny optimální hodnoty dimenze $V_d$ pro jednotlivé jádrové funkce." width="672" />
<p class="caption">
Obrázek 12.21: Závislost validační chybovosti na dimenzi podprostoru <span class="math inline">\(V_d\)</span>, zvlášť pro všechna tři uvažovaná jádra v metodě SVM. Černými body jsou vyznačeny optimální hodnoty dimenze <span class="math inline">\(V_d\)</span> pro jednotlivé jádrové funkce.
</p>
</div>
<p>Nyní již můžeme natrénovat jednotlivé klasifikátory na všech trénovacích datech a podívat se na jejich úspěšnost na testovacích datech.
Pro každou jádrovou funkci volíme dimenzi podprostoru, na který projektujeme, podle výsledků cross-validace.</p>
<p>V proměnné <code>Projection</code> máme uloženou matici koeficientů ortogonální projekce, tedy</p>
<p><span class="math display">\[
\texttt{Projection} = \begin{pmatrix}
\langle x_1, \Psi_1 \rangle &amp; \langle x_2, \Psi_1 \rangle &amp; \cdots &amp; \langle x_n, \Psi_1 \rangle\\
\langle x_1, \Psi_2 \rangle &amp; \langle x_2, \Psi_2 \rangle &amp; \cdots &amp; \langle x_n, \Psi_2 \rangle\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\langle x_1, \Psi_d \rangle &amp; \langle x_2, \Psi_d \rangle &amp; \dots &amp; \langle x_n, \Psi_d \rangle
\end{pmatrix}_{d \times n}.
\]</span></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="aplikace3.html#cb90-1" tabindex="-1"></a><span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb90-2"><a href="aplikace3.html#cb90-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - projection&#39;</span>, </span>
<span id="cb90-3"><a href="aplikace3.html#cb90-3" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb90-4"><a href="aplikace3.html#cb90-4" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - projection&#39;</span>), </span>
<span id="cb90-5"><a href="aplikace3.html#cb90-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb90-6"><a href="aplikace3.html#cb90-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb90-7"><a href="aplikace3.html#cb90-7" tabindex="-1"></a></span>
<span id="cb90-8"><a href="aplikace3.html#cb90-8" tabindex="-1"></a><span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb90-9"><a href="aplikace3.html#cb90-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb90-10"><a href="aplikace3.html#cb90-10" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb90-11"><a href="aplikace3.html#cb90-11" tabindex="-1"></a>  <span class="co"># bazovy objekt</span></span>
<span id="cb90-12"><a href="aplikace3.html#cb90-12" tabindex="-1"></a>  bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb90-13"><a href="aplikace3.html#cb90-13" tabindex="-1"></a>                                 <span class="at">nbasis =</span> d.opt[kernel_number])</span>
<span id="cb90-14"><a href="aplikace3.html#cb90-14" tabindex="-1"></a>  </span>
<span id="cb90-15"><a href="aplikace3.html#cb90-15" tabindex="-1"></a>  <span class="co"># projekce diskretnich dat na B-splinovou bazi</span></span>
<span id="cb90-16"><a href="aplikace3.html#cb90-16" tabindex="-1"></a>  Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="co"># matice diskretnich dat</span></span>
<span id="cb90-17"><a href="aplikace3.html#cb90-17" tabindex="-1"></a>                              <span class="at">argvals =</span> t, <span class="co"># vektor argumentu</span></span>
<span id="cb90-18"><a href="aplikace3.html#cb90-18" tabindex="-1"></a>                              <span class="at">basisobj =</span> bbasis) <span class="co"># bazovy objekt</span></span>
<span id="cb90-19"><a href="aplikace3.html#cb90-19" tabindex="-1"></a>  </span>
<span id="cb90-20"><a href="aplikace3.html#cb90-20" tabindex="-1"></a>  <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb90-21"><a href="aplikace3.html#cb90-21" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb90-22"><a href="aplikace3.html#cb90-22" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb90-23"><a href="aplikace3.html#cb90-23" tabindex="-1"></a>  </span>
<span id="cb90-24"><a href="aplikace3.html#cb90-24" tabindex="-1"></a>  data.projection.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train)</span>
<span id="cb90-25"><a href="aplikace3.html#cb90-25" tabindex="-1"></a>  data.projection.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb90-26"><a href="aplikace3.html#cb90-26" tabindex="-1"></a>  </span>
<span id="cb90-27"><a href="aplikace3.html#cb90-27" tabindex="-1"></a>  data.projection.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.test)</span>
<span id="cb90-28"><a href="aplikace3.html#cb90-28" tabindex="-1"></a>  data.projection.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb90-29"><a href="aplikace3.html#cb90-29" tabindex="-1"></a>  </span>
<span id="cb90-30"><a href="aplikace3.html#cb90-30" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb90-31"><a href="aplikace3.html#cb90-31" tabindex="-1"></a>  clf.SVM.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train,</span>
<span id="cb90-32"><a href="aplikace3.html#cb90-32" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb90-33"><a href="aplikace3.html#cb90-33" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb90-34"><a href="aplikace3.html#cb90-34" tabindex="-1"></a>                            <span class="at">coef0 =</span> coef0,</span>
<span id="cb90-35"><a href="aplikace3.html#cb90-35" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb90-36"><a href="aplikace3.html#cb90-36" tabindex="-1"></a>  </span>
<span id="cb90-37"><a href="aplikace3.html#cb90-37" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb90-38"><a href="aplikace3.html#cb90-38" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.train)</span>
<span id="cb90-39"><a href="aplikace3.html#cb90-39" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb90-40"><a href="aplikace3.html#cb90-40" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb90-41"><a href="aplikace3.html#cb90-41" tabindex="-1"></a>    </span>
<span id="cb90-42"><a href="aplikace3.html#cb90-42" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb90-43"><a href="aplikace3.html#cb90-43" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.test)</span>
<span id="cb90-44"><a href="aplikace3.html#cb90-44" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb90-45"><a href="aplikace3.html#cb90-45" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb90-46"><a href="aplikace3.html#cb90-46" tabindex="-1"></a>  </span>
<span id="cb90-47"><a href="aplikace3.html#cb90-47" tabindex="-1"></a>  <span class="co"># ulozeni vysledku</span></span>
<span id="cb90-48"><a href="aplikace3.html#cb90-48" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb90-49"><a href="aplikace3.html#cb90-49" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Chybovost metody SVM aplikované na bázové koeficienty na trénovacích datech je tedy 2 % pro lineární jádro, 2.67 % pro polynomiální jádro a 9.33 % pro gaussovské jádro.
Na testovacích datech je potom chybovost metody 6.15 % pro lineární jádro, 6.15 % pro polynomiální jádro a 10.77 % pro radiální jádro.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="aplikace3.html#cb91-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="RKHS-SVMA3" class="section level4 hasAnchor" number="12.3.7.5">
<h4><span class="header-section-number">12.3.7.5</span> RKHS + SVM<a href="aplikace3.html#RKHS-SVMA3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>V této sekci se podíváme na další možnost, jak využít metodu podpůrných vektorů pro klasifikaci funkcionálních dat.
V tomto případě půjde opět o již nám známý princip, kdy nejprve funkcionální data vyjádříme jakožto nějaké konečně-rozměrné objekty a na tyto objekty následně aplikujeme klasickou metodu SVM.</p>
<p>Nyní však metodu SVM použijeme i pro samotnou reprezentaci funkcionálních dat pomocí určitého konečně-rozměrného objektu.
Jak již název napovídá, půjde o kombinaci dvou konceptů – jednak metody podpůrných vektorů a druhak prostoru, který se nazývá v anglické literatuře <em>Reproducing Kernel Hilbert Space</em>.
Pro tento prostor je klíčovým pojmem <em>jádro</em> – <em>kernel</em>.</p>
<div class="definition">
<p><span id="def:kernel" class="definition"><strong>Definice 12.1  (Jádro) </strong></span>Jádro je taková funkce <span class="math inline">\(K : \mathcal X \times \mathcal X \rightarrow \mathbb R\)</span>, že pro každou dvojici <span class="math inline">\(\boldsymbol x, \tilde{\boldsymbol x} \in \mathcal X\)</span> platí
<span class="math display">\[\begin{equation*}
K(\boldsymbol x, \tilde{\boldsymbol x}) = \big\langle \boldsymbol\phi(\boldsymbol x), \boldsymbol\phi(\tilde{\boldsymbol x}) \big\rangle_{\mathcal H},
\end{equation*}\]</span>
kde <span class="math inline">\(\boldsymbol\phi : \mathcal X \rightarrow \mathcal H\)</span> je zobrazení z prostoru <span class="math inline">\(\mathcal X\)</span> do prostoru <span class="math inline">\(\mathcal H\)</span>.</p>
</div>
<p>Aby funkce byla jádrem, musí splňovat určité podmínky.</p>
<div class="lemma">
<p><span id="lem:unlabeled-div-1" class="lemma"><strong>Lemma 12.1  </strong></span>Nechť <span class="math inline">\(\mathcal X\)</span> je nějaký Hilbertův prostor. Potom symetrická funkce <span class="math inline">\(K : \mathcal X \times \mathcal X \rightarrow \mathbb R\)</span> je jádrem, pokud <span class="math inline">\(\forall k \geq 1, \boldsymbol x_1, \dots, \boldsymbol x_k \in \mathcal X\)</span> a <span class="math inline">\(c_1, \dots, c_k \in \mathbb R\)</span> platí
<span class="math display">\[\begin{equation*}
\sum_{i, j = 1}^k c_ic_j K(\boldsymbol x_i, \boldsymbol x_j) \geq 0.
\end{equation*}\]</span></p>
</div>
<p>Vlastnost výše se nazývá pozitivní semidefinitnost.
Platí také následující tvrzení.</p>
<div class="theorem">
<p><span id="thm:unlabeled-div-2" class="theorem"><strong>Tvrzení 12.1  </strong></span>Funkce <span class="math inline">\(K: \mathcal X \times \mathcal X \rightarrow \mathbb R\)</span> je jádrem právě tehdy, když existuje Hilbertův prostor <span class="math inline">\(\mathcal H\)</span> a zobrazení <span class="math inline">\(\boldsymbol\phi : \mathcal X \rightarrow \mathcal H\)</span> takové, že
<span class="math display">\[\begin{equation*}
K(\boldsymbol x, \tilde{\boldsymbol x}) = \big\langle \boldsymbol\phi(\boldsymbol x), \boldsymbol\phi(\tilde{\boldsymbol x}) \big\rangle_{\mathcal H} \quad \forall \boldsymbol x, \tilde{\boldsymbol x}\in \mathcal X.
\end{equation*}\]</span></p>
</div>
<p>Nyní již máme připravenou půdu pro zavedení pojmu <em>Reproducing Kernel Hilbert Space</em>.</p>
<div id="reproducing-kernel-hilbert-space-rkhs-7" class="section level5 hasAnchor" number="12.3.7.5.1">
<h5><span class="header-section-number">12.3.7.5.1</span> Reproducing Kernel Hilbert Space (RKHS)<a href="aplikace3.html#reproducing-kernel-hilbert-space-rkhs-7" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Uvažujme Hilbertův prostor <span class="math inline">\(\mathcal H\)</span> jakožto prostor funkcí.
Naším cílem je definovat prostor <span class="math inline">\(\mathcal H\)</span> a zobrazení <span class="math inline">\(\phi\)</span> takové, že <span class="math inline">\(\phi(x) \in \mathcal H, \ \forall x \in \mathcal X\)</span>.
Označme <span class="math inline">\(\phi(x) = k_x\)</span>.
Každé funkci <span class="math inline">\(x \in \mathcal X\)</span> tedy přiřadíme funkci <span class="math inline">\(x \mapsto k_x \in \mathcal H, k_x := K(x, \cdot), k_x: \mathcal X \rightarrow \mathbb R\)</span>.
Potom <span class="math inline">\(\phi: \mathcal X \rightarrow \mathbb R^{\mathcal X}\)</span>, můžeme tedy souhrnně napsat</p>
<p><span class="math display">\[
x \in \mathcal X \mapsto \phi(x) = k_x = K(x, \cdot) \in \mathcal H,
\]</span></p>
<p>Bod (funkce) <span class="math inline">\(x \in \mathcal X\)</span> je zobrazen na funkci <span class="math inline">\(k_x: \mathcal X \rightarrow \mathbb R, k_x(y) = K(x, y)\)</span>.</p>
<p>Uvažujme množinu všech obrazů <span class="math inline">\(\{k_x | x \in \mathcal X\}\)</span> a definujme lineární obal této množiny vektorů jakožto</p>
<p><span class="math display">\[
\mathcal G := \text{span}\{k_x | x \in \mathcal X\} = \left\{\sum_{i = 1}^r\alpha_i K(x_i, \cdot)\ \Big|\ \alpha_i \in \mathbb R, r \in \mathbb N, x_i \in \mathcal X\right\}.
\]</span></p>
<p>Potom skalární součin</p>
<p><span class="math display">\[
\langle k_x, k_y \rangle = \langle K(x, \cdot), K(y, \cdot) \rangle = K(x, y),\quad x, y \in \mathcal X
\]</span></p>
<p>a obecně</p>
<p><span class="math display">\[
f, g \in \mathcal G, f = \sum_i \alpha_i K(x_i, \cdot), g = \sum_j \beta_j K(y_j, \cdot), \\
\langle f, g \rangle_{\mathcal G} = \Big\langle \sum_i \alpha_i K(x_i, \cdot), \sum_j \beta_j K(y_j, \cdot) \Big\rangle = \sum_i\sum_j\alpha_i\beta_j \langle K(x_i, \cdot), K(y_j, \cdot) \rangle = \sum_i\sum_j\alpha_i\beta_j K(x_i, y_j).
\]</span></p>
<p>Prostor <span class="math inline">\(\mathcal H := \overline{\mathcal G}\)</span>, který je zúplněním prostoru <span class="math inline">\(\mathcal G\)</span>, nazýváme <em>Reproducing Kernel Hilbert Space</em> (RKHS).
Významnou vlastností tohoto prostoru je</p>
<p><span class="math display">\[
K(x, y) = \Big\langle \phi(x), \phi(y) \Big\rangle_{\mathcal H}.
\]</span></p>
<p><em>Poznámka:</em> Jméno Reproducing vychází z následujícího faktu.
Mějme libovolnou funkci <span class="math inline">\(f = \sum_i \alpha_i K(x_i, \cdot)\)</span>.
Potom</p>
<span class="math display">\[\begin{align*}
\langle K(x, \cdot), f\rangle &amp;= \langle K(x, \cdot), \sum_i \alpha_i K(x_i, \cdot) \rangle =\\
&amp;= \sum_i \alpha_i \langle K(x, \cdot), K(x_i, \cdot) \rangle = \sum_i \alpha_i K(x_i, x) = \\
&amp;= f(x)
\end{align*}\]</span>
<p><em>Vlastnosti:</em></p>
<ul>
<li><p>nechť <span class="math inline">\(\mathcal H\)</span> je Hilbertův prostor funkcí <span class="math inline">\(g: \mathcal X \rightarrow \mathbb R\)</span>.
Potom <span class="math inline">\(\mathcal H\)</span> je RKHS <span class="math inline">\(\Leftrightarrow\)</span> všechny funkcionály (evaluation functionals) <span class="math inline">\(\delta_x: \mathcal H \rightarrow \mathbb R, g \mapsto g(x)\)</span> jsou spojité,</p></li>
<li><p>pro dané jádro <span class="math inline">\(K\)</span> existuje právě jeden prostor RKHS (až na isometrickou izomofrii),</p></li>
<li><p>pro daný RKHS je jádro <span class="math inline">\(K\)</span> určeno jednoznačně,</p></li>
<li><p>funkce v RKHS jsou bodově korektně definovány,</p></li>
<li><p>RKHS je obecně nekonečně-rozměrný vektorový prostor, v praxi však pracujeme pouze s jeho konečně-rozměrným podprostorem.</p></li>
</ul>
<p>Na konec této sekce si uveďme jedno důležité tvrzení.</p>
<div class="theorem">
<p><span id="thm:representer" class="theorem"><strong>Tvrzení 12.2  (The representer theorem) </strong></span>Nechť <span class="math inline">\(K\)</span> je jádro a <span class="math inline">\(\mathcal H\)</span> je příslušný RKHS s normou a skalárním součinem <span class="math inline">\(\|\cdot\|_{\mathcal H}\)</span> a <span class="math inline">\(\langle \cdot, \cdot \rangle_{\mathcal H}\)</span>. Předpokládejme, že chceme zjistit lineární funkci <span class="math inline">\(f: \mathcal H \rightarrow \mathbb R\)</span> na Hilbertově prostoru <span class="math inline">\(\mathcal H\)</span> definovaného jádrem <span class="math inline">\(K\)</span>. Funkce <span class="math inline">\(f\)</span> má tvar <span class="math inline">\(f(x) = \langle \omega, x \rangle_{\mathcal H}\)</span> pro nějaké <span class="math inline">\(\omega \in \mathcal H\)</span>. Uvažujme regularizovaný minimalizační problém
<span class="math display" id="eq:repr-thm">\[\begin{equation}
\min_{\omega \in \mathcal H} R_n(\omega) + \lambda \Omega(\|\omega\|_{\mathcal H}),
\tag{12.1}
\end{equation}\]</span>
kde <span class="math inline">\(\Omega: [0, \infty) \rightarrow \mathbb R\)</span> je striktně monotonně rostoucí funkce (regularizer), <span class="math inline">\(R_n(\cdot)\)</span> je empirická ztráta (empirical risk) klasifikátoru vzhledem ke ztrátové funkci <span class="math inline">\(\ell\)</span>. Potom optimalizační úloha <a href="aplikace3.html#eq:repr-thm">(12.1)</a> má vždy optimální řešení a to je tvaru
<span class="math display" id="eq:optimal-thm">\[\begin{equation}
\omega^* = \sum_{i = 1}^n \alpha_i K(x_i, \cdot),
\tag{12.2}
\end{equation}\]</span>
kde <span class="math inline">\((x_i, y_i)_{i = 1, 2, \dots, n} \in \mathcal X \times \mathcal Y\)</span> je množina trénovacích hodnot.</p>
</div>
<p><span class="math inline">\(\mathcal H\)</span> je obecně nekočně-rozměrný prostor, ale pro konečný datový soubor velikosti <span class="math inline">\(n\)</span> má <span class="math inline">\(\mathcal H\)</span> dimenzi nejvýše <span class="math inline">\(n\)</span>.
Každý <span class="math inline">\(n\)</span>-dimenzionální podprostor Hilbertova prostoru je navíc izometrický s <span class="math inline">\(\mathbb R^n\)</span>, tudíž můžeme předpokládat, že zobrazení (feature map) zobrazuje právě do <span class="math inline">\(\mathbb R^n\)</span>.</p>
<p>Jádro <span class="math inline">\(K\)</span> je <em>univerzální</em> pokud RKHS <span class="math inline">\(\mathcal H\)</span> je hustá množina v <span class="math inline">\(\mathcal C(\mathcal X)\)</span> (množina spojitých funkcí).
Navíc platí následující poznatky:</p>
<ul>
<li>univerzální jádra jsou dobrá pro aproximaci,</li>
<li>Gaussovo jádro s pevnou hodnotou <span class="math inline">\(\sigma\)</span> je univerzální,</li>
<li>univerzalita je nutnou podmínkou pro konzistenci.</li>
</ul>
</div>
<div id="klasifikace-pomocí-rkhs-7" class="section level5 hasAnchor" number="12.3.7.5.2">
<h5><span class="header-section-number">12.3.7.5.2</span> Klasifikace pomocí RKHS<a href="aplikace3.html#klasifikace-pomocí-rkhs-7" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Základní myšlenkou je projekce původních dat na podprostor prostoru RKHS, označme jej <span class="math inline">\(\mathcal H_K\)</span> (index <span class="math inline">\({}_K\)</span> odkazuje na fakt, že tento prostor je definován jádrem <span class="math inline">\(K\)</span>).
Cílem je tedy transformovat křivku (pozorovaný objekt, funkce) na bod v RKHS.
Označme <span class="math inline">\(\{\hat c_1, \dots, \hat c_n\}\)</span> množinu pozorovaných křivek, přičemž každá křivka <span class="math inline">\(\hat c_l\)</span> je definována daty <span class="math inline">\(\{(\boldsymbol x_i, \boldsymbol y_{il}) \in \mathcal X \times \mathcal Y\}_{i = 1}^m\)</span>, kde <span class="math inline">\(\mathcal X\)</span> je prostor vstupních proměnných a nejčastěji <span class="math inline">\(\mathcal Y = \mathbb R\)</span>.
Předpokládejme, že pro každou funkci <span class="math inline">\(\hat c_l\)</span> existuje spojitá funkce <span class="math inline">\(c_l:\mathcal X \rightarrow \mathcal Y, \mathbb E[y_l|\boldsymbol x] = c_l(\boldsymbol x)\)</span>.
Předpokládejme také, že <span class="math inline">\(\boldsymbol x_i\)</span> jsou společné pro všechny křivky.</p>
<p>Muñoz a González ve svém článku<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> navrhují následující postup.
Křivku <span class="math inline">\(c_l^*\)</span> můžeme napsat ve tvaru</p>
<p><span class="math display">\[
c_l^*(\boldsymbol x) = \sum_{i = 1}^m \alpha_{il} K(\boldsymbol x_i, \boldsymbol x), \quad \forall \boldsymbol x \in \mathcal X,
\]</span></p>
<p>kde <span class="math inline">\(\alpha_{il} \in \mathbb R\)</span>.
Tyto koeficienty získáme v praxi řešením optimalizačního problému <span class="math display">\[
\text{argmin}_{c \in \mathcal H_K} \frac{1}{m} \sum_{i = 1}^m \big[|c(\boldsymbol x_i) - y_i| - \varepsilon\big]_+ + \gamma \|c\|_{K}^2, \gamma &gt; 0, \varepsilon \geq 0,
\]</span> tedy právě například pomocí metody SVM.
Díky známé vlastnosti této metody pak bude mnoho koeficientů <span class="math inline">\(\alpha_{il} = 0\)</span>.
Minimalizací výše uvedeného výrazu získáme funkce <span class="math inline">\(c_1^*, \dots, c_n^*\)</span> odpovídající původním křivkám <span class="math inline">\(\hat c_1, \dots, \hat c_n\)</span>.
Metoda SVM tedy dává smysluplnou reprezentaci původních křivek pomocí vektoru koeficientů <span class="math inline">\(\boldsymbol \alpha_l = (\alpha_{1l}, \dots, \alpha_{ml})^\top\)</span> pro <span class="math inline">\(\hat c_l\)</span>.
Tato reprezentace je však velmi nestabilní, neboť i při malé změně původních hodnot může dojít ke změně v množině podpůrných vektorů pro danou funkci, a tedy dojde k výrazné změně celé reprezentace této křivky (reprezentace není spojitá ve vstupních hodnotách).
Definujeme proto novou reprezentaci původních křivek, která již nebude trpět tímto nedostatkem.</p>
<div class="theorem">
<p><span id="thm:MaG" class="theorem"><strong>Tvrzení 12.3  (Muñoz-González) </strong></span>Nechť <span class="math inline">\(c\)</span> je funkce, jejíž pozorovaná verze je <span class="math inline">\(\hat c = \{(\boldsymbol x_i, y_{i}) \in \mathcal X \times \mathcal Y\}_{i = 1}^m\)</span> a <span class="math inline">\(K\)</span> je jádro s vlastními funkcemi <span class="math inline">\(\{\phi_1, \dots, \phi_d, \dots\}\)</span> (báze <span class="math inline">\(\mathcal H_K\)</span>). Potom funkce <span class="math inline">\(c^*(\boldsymbol x)\)</span> může být vyjádřena ve tvaru
<span class="math display">\[\begin{equation*}
c^*(\boldsymbol x) = \sum_{j = 1}^d \lambda_j^* \phi_j(\boldsymbol x),
\end{equation*}\]</span>
kde <span class="math inline">\(\lambda_j^*\)</span> jsou váhy projekce <span class="math inline">\(c^*(\boldsymbol x)\)</span> na prostor funkcí generovaný vlastními funkcemi jádra <span class="math inline">\(K\)</span> a <span class="math inline">\(d\)</span> je dimenze prostoru <span class="math inline">\(\mathcal H\)</span>. V praxi, kdy máme k dispozici pouze konečně mnoho pozorování, <span class="math inline">\(\lambda_j^*\)</span> mohou být odhadnuty pomocí
<span class="math display">\[\begin{equation*}
\hat\lambda_j^* = \hat\lambda_j \sum_{i = 1}^m \alpha_i\hat\phi_{ji}, \quad j = 1, 2, \dots, \hat d,
\end{equation*}\]</span>
kde <span class="math inline">\(\hat\lambda_j\)</span> je <span class="math inline">\(j\)</span>-té vlastní číslo příslušné <span class="math inline">\(j\)</span>-tému vlastnímu vektoru <span class="math inline">\(\hat\phi_j\)</span> matice <span class="math inline">\(K_S = \big(K(\boldsymbol x_i, \boldsymbol x_j)\big)_{i, j = 1}^m, \hat d = \text{rank}(K_S)\)</span> a <span class="math inline">\(\alpha_i\)</span> jsou řešením optimalizačního problému.</p>
</div>
</div>
<div id="implementace-metody-v-r-7" class="section level5 hasAnchor" number="12.3.7.5.3">
<h5><span class="header-section-number">12.3.7.5.3</span> Implementace metody v <code>R</code><a href="aplikace3.html#implementace-metody-v-r-7" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Z poslední části Tvrzení <a href="aplikace3.html#thm:MaG">12.3</a> vyplývá, jak máme spočítat v praxi reprezentace křivek.
Budeme pracovat s diskretizovanými daty po vyhlazení křivek.
Nejprve si definujeme jádro pro prostor RKHS.
Využijeme Gaussovské jádro s parametrem <span class="math inline">\(\gamma\)</span>.
Hodnota tohoto hyperparametru výrazně ovlivňuje chování a tedy i úspěšnost metody, proto jeho volbě musíme věnovat zvláštní pozornost (volíme pomocí cross-validace).</p>
<p>Jako dobrá volba hyperparametrů se po vyzkoušení zdají být hodnoty <span class="math inline">\(\varepsilon = 0.01\)</span> a <span class="math inline">\(C = 1\)</span>. Vzhledem k výpočetní náročnosti nebudeme tyto hyperparametry odhadovat pomocí CV.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="aplikace3.html#cb92-1" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb92-2"><a href="aplikace3.html#cb92-2" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="dv">1</span> </span></code></pre></div>
</details>
<div id="gaussovké-jádro-9" class="section level6 hasAnchor" number="12.3.7.5.3.1">
<h6><span class="header-section-number">12.3.7.5.3.1</span> Gaussovké jádro<a href="aplikace3.html#gaussovké-jádro-9" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="aplikace3.html#cb93-1" tabindex="-1"></a><span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb93-2"><a href="aplikace3.html#cb93-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb93-3"><a href="aplikace3.html#cb93-3" tabindex="-1"></a><span class="co"># pridame i testovaci data</span></span>
<span id="cb93-4"><a href="aplikace3.html#cb93-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb93-5"><a href="aplikace3.html#cb93-5" tabindex="-1"></a></span>
<span id="cb93-6"><a href="aplikace3.html#cb93-6" tabindex="-1"></a><span class="co"># jadro a jadrova matice ... Gaussovske s parametrem gamma</span></span>
<span id="cb93-7"><a href="aplikace3.html#cb93-7" tabindex="-1"></a>Gauss.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, gamma) {</span>
<span id="cb93-8"><a href="aplikace3.html#cb93-8" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>gamma <span class="sc">*</span> <span class="fu">norm</span>(<span class="fu">c</span>(x <span class="sc">-</span> y) <span class="sc">|&gt;</span> <span class="fu">t</span>(), <span class="at">type =</span> <span class="st">&#39;F&#39;</span>)))</span>
<span id="cb93-9"><a href="aplikace3.html#cb93-9" tabindex="-1"></a>}</span>
<span id="cb93-10"><a href="aplikace3.html#cb93-10" tabindex="-1"></a></span>
<span id="cb93-11"><a href="aplikace3.html#cb93-11" tabindex="-1"></a>Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, gamma) {</span>
<span id="cb93-12"><a href="aplikace3.html#cb93-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb93-13"><a href="aplikace3.html#cb93-13" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb93-14"><a href="aplikace3.html#cb93-14" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb93-15"><a href="aplikace3.html#cb93-15" tabindex="-1"></a>      K[i, j] <span class="ot">&lt;-</span> <span class="fu">Gauss.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], <span class="at">gamma =</span> gamma)</span>
<span id="cb93-16"><a href="aplikace3.html#cb93-16" tabindex="-1"></a>    }</span>
<span id="cb93-17"><a href="aplikace3.html#cb93-17" tabindex="-1"></a>  }</span>
<span id="cb93-18"><a href="aplikace3.html#cb93-18" tabindex="-1"></a>  <span class="fu">return</span>(K)</span>
<span id="cb93-19"><a href="aplikace3.html#cb93-19" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Spočítejme nyní matici <span class="math inline">\(K_S\)</span> a její vlastní čísla a příslušné vlastní vektory.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="aplikace3.html#cb94-1" tabindex="-1"></a><span class="co"># spocitame matici K</span></span>
<span id="cb94-2"><a href="aplikace3.html#cb94-2" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="fl">0.1</span> <span class="co"># pevna hodnota gamma, optimalni urcime pomoci CV</span></span>
<span id="cb94-3"><a href="aplikace3.html#cb94-3" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb94-4"><a href="aplikace3.html#cb94-4" tabindex="-1"></a></span>
<span id="cb94-5"><a href="aplikace3.html#cb94-5" tabindex="-1"></a><span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb94-6"><a href="aplikace3.html#cb94-6" tabindex="-1"></a>Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb94-7"><a href="aplikace3.html#cb94-7" tabindex="-1"></a>eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb94-8"><a href="aplikace3.html#cb94-8" tabindex="-1"></a>eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span></code></pre></div>
</details>
<p>K výpočtu koeficientů v reprezentaci křivek, tedy výpočtu vektorů <span class="math inline">\(\hat{\boldsymbol \lambda}_l^* = \left( \hat\lambda_{1l}^*, \dots, \hat\lambda_{\hat dl}^*\right)^\top, l = 1, 2, \dots, n\)</span>, potřebujeme ještě koeficienty z SVM.
Narozdíl od klasifikačního problému nyní řešíme problém regrese, neboť se snažíme vyjádřit naše pozorované křivky v nějaké (námi zvolené pomocí jádra <span class="math inline">\(K\)</span>) bázi.
Proto využijeme metodu <em>Support Vector Regression</em>, z níž následně získáme koeficienty <span class="math inline">\(\alpha_{il}\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="aplikace3.html#cb95-1" tabindex="-1"></a><span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb95-2"><a href="aplikace3.html#cb95-2" tabindex="-1"></a>alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb95-3"><a href="aplikace3.html#cb95-3" tabindex="-1"></a>                     <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb95-4"><a href="aplikace3.html#cb95-4" tabindex="-1"></a></span>
<span id="cb95-5"><a href="aplikace3.html#cb95-5" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb95-6"><a href="aplikace3.html#cb95-6" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb95-7"><a href="aplikace3.html#cb95-7" tabindex="-1"></a>  df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb95-8"><a href="aplikace3.html#cb95-8" tabindex="-1"></a>                       <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb95-9"><a href="aplikace3.html#cb95-9" tabindex="-1"></a>  svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb95-10"><a href="aplikace3.html#cb95-10" tabindex="-1"></a>                  <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb95-11"><a href="aplikace3.html#cb95-11" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb95-12"><a href="aplikace3.html#cb95-12" tabindex="-1"></a>                  <span class="at">epsilon =</span> eps,</span>
<span id="cb95-13"><a href="aplikace3.html#cb95-13" tabindex="-1"></a>                  <span class="at">cost =</span> C,</span>
<span id="cb95-14"><a href="aplikace3.html#cb95-14" tabindex="-1"></a>                  <span class="at">gamma =</span> gamma)</span>
<span id="cb95-15"><a href="aplikace3.html#cb95-15" tabindex="-1"></a>  <span class="co"># urceni alpha</span></span>
<span id="cb95-16"><a href="aplikace3.html#cb95-16" tabindex="-1"></a>  alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb95-17"><a href="aplikace3.html#cb95-17" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Nyní již můžeme spočítat reprezentace jednotlivých křivek.
Nejprve zvolme za <span class="math inline">\(\hat d\)</span> celou dimenzi, tedy <span class="math inline">\(\hat d = m ={}\)</span> 101, následně určíme optimální <span class="math inline">\(\hat d\)</span> pomocí cross-validace.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="aplikace3.html#cb96-1" tabindex="-1"></a><span class="co"># d</span></span>
<span id="cb96-2"><a href="aplikace3.html#cb96-2" tabindex="-1"></a>d.RKHS <span class="ot">&lt;-</span> <span class="fu">dim</span>(alpha.RKHS)[<span class="dv">1</span>]</span>
<span id="cb96-3"><a href="aplikace3.html#cb96-3" tabindex="-1"></a></span>
<span id="cb96-4"><a href="aplikace3.html#cb96-4" tabindex="-1"></a><span class="co"># urceni vektoru lambda</span></span>
<span id="cb96-5"><a href="aplikace3.html#cb96-5" tabindex="-1"></a>Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb96-6"><a href="aplikace3.html#cb96-6" tabindex="-1"></a>                      <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb96-7"><a href="aplikace3.html#cb96-7" tabindex="-1"></a>                      <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb96-8"><a href="aplikace3.html#cb96-8" tabindex="-1"></a></span>
<span id="cb96-9"><a href="aplikace3.html#cb96-9" tabindex="-1"></a><span class="co"># vypocet reprezentace</span></span>
<span id="cb96-10"><a href="aplikace3.html#cb96-10" tabindex="-1"></a><span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb96-11"><a href="aplikace3.html#cb96-11" tabindex="-1"></a>  Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb96-12"><a href="aplikace3.html#cb96-12" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Nyní máme v matici <code>Lambda.RKHS</code> uloženy ve sloupcích vektory <span class="math inline">\(\hat{\boldsymbol \lambda}_l^*, l = 1, 2, \dots, n\)</span> pro každou křivku.
Tyto vektory nyní využijeme jakožto reprezentaci daných křivek a klasifikujeme data podle této diskretizace.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="aplikace3.html#cb97-1" tabindex="-1"></a><span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb97-2"><a href="aplikace3.html#cb97-2" tabindex="-1"></a>XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb97-3"><a href="aplikace3.html#cb97-3" tabindex="-1"></a>XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb97-4"><a href="aplikace3.html#cb97-4" tabindex="-1"></a></span>
<span id="cb97-5"><a href="aplikace3.html#cb97-5" tabindex="-1"></a><span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb97-6"><a href="aplikace3.html#cb97-6" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb97-7"><a href="aplikace3.html#cb97-7" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb97-8"><a href="aplikace3.html#cb97-8" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb97-9"><a href="aplikace3.html#cb97-9" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb97-10"><a href="aplikace3.html#cb97-10" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb97-11"><a href="aplikace3.html#cb97-11" tabindex="-1"></a></span>
<span id="cb97-12"><a href="aplikace3.html#cb97-12" tabindex="-1"></a><span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb97-13"><a href="aplikace3.html#cb97-13" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb97-14"><a href="aplikace3.html#cb97-14" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb97-15"><a href="aplikace3.html#cb97-15" tabindex="-1"></a></span>
<span id="cb97-16"><a href="aplikace3.html#cb97-16" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb97-17"><a href="aplikace3.html#cb97-17" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb97-18"><a href="aplikace3.html#cb97-18" tabindex="-1"></a>  </span>
<span id="cb97-19"><a href="aplikace3.html#cb97-19" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb97-20"><a href="aplikace3.html#cb97-20" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb97-21"><a href="aplikace3.html#cb97-21" tabindex="-1"></a>  </span>
<span id="cb97-22"><a href="aplikace3.html#cb97-22" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb97-23"><a href="aplikace3.html#cb97-23" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb97-24"><a href="aplikace3.html#cb97-24" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb97-25"><a href="aplikace3.html#cb97-25" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb97-26"><a href="aplikace3.html#cb97-26" tabindex="-1"></a>                      <span class="at">coef0 =</span> coef0,</span>
<span id="cb97-27"><a href="aplikace3.html#cb97-27" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb97-28"><a href="aplikace3.html#cb97-28" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type)</span>
<span id="cb97-29"><a href="aplikace3.html#cb97-29" tabindex="-1"></a>  </span>
<span id="cb97-30"><a href="aplikace3.html#cb97-30" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb97-31"><a href="aplikace3.html#cb97-31" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb97-32"><a href="aplikace3.html#cb97-32" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb97-33"><a href="aplikace3.html#cb97-33" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb97-34"><a href="aplikace3.html#cb97-34" tabindex="-1"></a>    </span>
<span id="cb97-35"><a href="aplikace3.html#cb97-35" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb97-36"><a href="aplikace3.html#cb97-36" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb97-37"><a href="aplikace3.html#cb97-37" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb97-38"><a href="aplikace3.html#cb97-38" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb97-39"><a href="aplikace3.html#cb97-39" tabindex="-1"></a>  </span>
<span id="cb97-40"><a href="aplikace3.html#cb97-40" tabindex="-1"></a>  <span class="co"># ulozeni vysledku</span></span>
<span id="cb97-41"><a href="aplikace3.html#cb97-41" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb97-42"><a href="aplikace3.html#cb97-42" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-92">Tabulka 12.1: </span>Souhrnné výsledky metody SVM v kombinaci s RKHS na simulovaných datech. <span class="math inline">\(\widehat{Err}_{train}\)</span> značí odhad trénovací chybovosti a <span class="math inline">\(\widehat{Err}_{test}\)</span> testovací chybovosti.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS</td>
<td align="center">0.0133</td>
<td align="center">0.1231</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS</td>
<td align="center">0.0267</td>
<td align="center">0.0308</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS</td>
<td align="center">0.0400</td>
<td align="center">0.0308</td>
</tr>
</tbody>
</table>
<p>Vidíme, že model u všech třech jader velmi dobře klasifikuje trénovací data, zatímco jeho úspěšnost na testovacích datech není pro lineární jádro dobrá.
Proto využijeme cross-validaci, abychom určili optimální hodnoty <span class="math inline">\(\gamma\)</span> a <span class="math inline">\(d\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="aplikace3.html#cb98-1" tabindex="-1"></a><span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb98-2"><a href="aplikace3.html#cb98-2" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb98-3"><a href="aplikace3.html#cb98-3" tabindex="-1"></a><span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb98-4"><a href="aplikace3.html#cb98-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb98-5"><a href="aplikace3.html#cb98-5" tabindex="-1"></a></span>
<span id="cb98-6"><a href="aplikace3.html#cb98-6" tabindex="-1"></a><span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb98-7"><a href="aplikace3.html#cb98-7" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">30</span> <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb98-8"><a href="aplikace3.html#cb98-8" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">15</span>)</span>
<span id="cb98-9"><a href="aplikace3.html#cb98-9" tabindex="-1"></a></span>
<span id="cb98-10"><a href="aplikace3.html#cb98-10" tabindex="-1"></a><span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb98-11"><a href="aplikace3.html#cb98-11" tabindex="-1"></a><span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb98-12"><a href="aplikace3.html#cb98-12" tabindex="-1"></a><span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb98-13"><a href="aplikace3.html#cb98-13" tabindex="-1"></a><span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb98-14"><a href="aplikace3.html#cb98-14" tabindex="-1"></a>dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">gamma =</span> <span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma.cv, <span class="dv">3</span>)),</span>
<span id="cb98-15"><a href="aplikace3.html#cb98-15" tabindex="-1"></a>                  <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb98-16"><a href="aplikace3.html#cb98-16" tabindex="-1"></a>                  <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb98-17"><a href="aplikace3.html#cb98-17" tabindex="-1"></a></span>
<span id="cb98-18"><a href="aplikace3.html#cb98-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb98-19"><a href="aplikace3.html#cb98-19" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb98-20"><a href="aplikace3.html#cb98-20" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb98-21"><a href="aplikace3.html#cb98-21" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb98-22"><a href="aplikace3.html#cb98-22" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb98-23"><a href="aplikace3.html#cb98-23" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb98-24"><a href="aplikace3.html#cb98-24" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="aplikace3.html#cb99-1" tabindex="-1"></a><span class="co"># samotna CV</span></span>
<span id="cb99-2"><a href="aplikace3.html#cb99-2" tabindex="-1"></a><span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb99-3"><a href="aplikace3.html#cb99-3" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb99-4"><a href="aplikace3.html#cb99-4" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb99-5"><a href="aplikace3.html#cb99-5" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb99-6"><a href="aplikace3.html#cb99-6" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb99-7"><a href="aplikace3.html#cb99-7" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb99-8"><a href="aplikace3.html#cb99-8" tabindex="-1"></a>  </span>
<span id="cb99-9"><a href="aplikace3.html#cb99-9" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb99-10"><a href="aplikace3.html#cb99-10" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb99-11"><a href="aplikace3.html#cb99-11" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb99-12"><a href="aplikace3.html#cb99-12" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb99-13"><a href="aplikace3.html#cb99-13" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb99-14"><a href="aplikace3.html#cb99-14" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb99-15"><a href="aplikace3.html#cb99-15" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb99-16"><a href="aplikace3.html#cb99-16" tabindex="-1"></a>                    <span class="at">epsilon =</span> eps,</span>
<span id="cb99-17"><a href="aplikace3.html#cb99-17" tabindex="-1"></a>                    <span class="at">cost =</span> C,</span>
<span id="cb99-18"><a href="aplikace3.html#cb99-18" tabindex="-1"></a>                    <span class="at">gamma =</span> gamma)</span>
<span id="cb99-19"><a href="aplikace3.html#cb99-19" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb99-20"><a href="aplikace3.html#cb99-20" tabindex="-1"></a>  }</span>
<span id="cb99-21"><a href="aplikace3.html#cb99-21" tabindex="-1"></a>  </span>
<span id="cb99-22"><a href="aplikace3.html#cb99-22" tabindex="-1"></a>  <span class="co"># projdeme dimenze</span></span>
<span id="cb99-23"><a href="aplikace3.html#cb99-23" tabindex="-1"></a>  <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb99-24"><a href="aplikace3.html#cb99-24" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb99-25"><a href="aplikace3.html#cb99-25" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb99-26"><a href="aplikace3.html#cb99-26" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb99-27"><a href="aplikace3.html#cb99-27" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb99-28"><a href="aplikace3.html#cb99-28" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb99-29"><a href="aplikace3.html#cb99-29" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb99-30"><a href="aplikace3.html#cb99-30" tabindex="-1"></a>                             alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb99-31"><a href="aplikace3.html#cb99-31" tabindex="-1"></a>    }</span>
<span id="cb99-32"><a href="aplikace3.html#cb99-32" tabindex="-1"></a>    <span class="co"># projdeme folds</span></span>
<span id="cb99-33"><a href="aplikace3.html#cb99-33" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb99-34"><a href="aplikace3.html#cb99-34" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb99-35"><a href="aplikace3.html#cb99-35" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb99-36"><a href="aplikace3.html#cb99-36" tabindex="-1"></a>      <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb99-37"><a href="aplikace3.html#cb99-37" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb99-38"><a href="aplikace3.html#cb99-38" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb99-39"><a href="aplikace3.html#cb99-39" tabindex="-1"></a>      <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb99-40"><a href="aplikace3.html#cb99-40" tabindex="-1"></a>      Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb99-41"><a href="aplikace3.html#cb99-41" tabindex="-1"></a>                                  <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb99-42"><a href="aplikace3.html#cb99-42" tabindex="-1"></a>                                  <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb99-43"><a href="aplikace3.html#cb99-43" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb99-44"><a href="aplikace3.html#cb99-44" tabindex="-1"></a>      <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb99-45"><a href="aplikace3.html#cb99-45" tabindex="-1"></a>      <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb99-46"><a href="aplikace3.html#cb99-46" tabindex="-1"></a>        kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb99-47"><a href="aplikace3.html#cb99-47" tabindex="-1"></a>      </span>
<span id="cb99-48"><a href="aplikace3.html#cb99-48" tabindex="-1"></a>        data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb99-49"><a href="aplikace3.html#cb99-49" tabindex="-1"></a>        data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb99-50"><a href="aplikace3.html#cb99-50" tabindex="-1"></a>        </span>
<span id="cb99-51"><a href="aplikace3.html#cb99-51" tabindex="-1"></a>        data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb99-52"><a href="aplikace3.html#cb99-52" tabindex="-1"></a>        data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb99-53"><a href="aplikace3.html#cb99-53" tabindex="-1"></a>        </span>
<span id="cb99-54"><a href="aplikace3.html#cb99-54" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb99-55"><a href="aplikace3.html#cb99-55" tabindex="-1"></a>        clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb99-56"><a href="aplikace3.html#cb99-56" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb99-57"><a href="aplikace3.html#cb99-57" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-58"><a href="aplikace3.html#cb99-58" tabindex="-1"></a>                            <span class="at">cost =</span> C,</span>
<span id="cb99-59"><a href="aplikace3.html#cb99-59" tabindex="-1"></a>                            <span class="at">coef0 =</span> coef0,</span>
<span id="cb99-60"><a href="aplikace3.html#cb99-60" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb99-61"><a href="aplikace3.html#cb99-61" tabindex="-1"></a>        </span>
<span id="cb99-62"><a href="aplikace3.html#cb99-62" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb99-63"><a href="aplikace3.html#cb99-63" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb99-64"><a href="aplikace3.html#cb99-64" tabindex="-1"></a>        presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb99-65"><a href="aplikace3.html#cb99-65" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb99-66"><a href="aplikace3.html#cb99-66" tabindex="-1"></a>        </span>
<span id="cb99-67"><a href="aplikace3.html#cb99-67" tabindex="-1"></a>        <span class="co"># ulozeni vysledku</span></span>
<span id="cb99-68"><a href="aplikace3.html#cb99-68" tabindex="-1"></a>        Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb99-69"><a href="aplikace3.html#cb99-69" tabindex="-1"></a>      }</span>
<span id="cb99-70"><a href="aplikace3.html#cb99-70" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb99-71"><a href="aplikace3.html#cb99-71" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb99-72"><a href="aplikace3.html#cb99-72" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb99-73"><a href="aplikace3.html#cb99-73" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb99-74"><a href="aplikace3.html#cb99-74" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb99-75"><a href="aplikace3.html#cb99-75" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb99-76"><a href="aplikace3.html#cb99-76" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb99-77"><a href="aplikace3.html#cb99-77" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb99-78"><a href="aplikace3.html#cb99-78" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb99-79"><a href="aplikace3.html#cb99-79" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb99-80"><a href="aplikace3.html#cb99-80" tabindex="-1"></a>    }</span>
<span id="cb99-81"><a href="aplikace3.html#cb99-81" tabindex="-1"></a>  }</span>
<span id="cb99-82"><a href="aplikace3.html#cb99-82" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="aplikace3.html#cb100-1" tabindex="-1"></a><span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb100-2"><a href="aplikace3.html#cb100-2" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb100-3"><a href="aplikace3.html#cb100-3" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb100-4"><a href="aplikace3.html#cb100-4" tabindex="-1"></a>}</span>
<span id="cb100-5"><a href="aplikace3.html#cb100-5" tabindex="-1"></a></span>
<span id="cb100-6"><a href="aplikace3.html#cb100-6" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb100-7"><a href="aplikace3.html#cb100-7" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb100-8"><a href="aplikace3.html#cb100-8" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv))</span>
<span id="cb100-9"><a href="aplikace3.html#cb100-9" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb100-10"><a href="aplikace3.html#cb100-10" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb100-11"><a href="aplikace3.html#cb100-11" tabindex="-1"></a></span>
<span id="cb100-12"><a href="aplikace3.html#cb100-12" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb100-13"><a href="aplikace3.html#cb100-13" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb100-14"><a href="aplikace3.html#cb100-14" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb100-15"><a href="aplikace3.html#cb100-15" tabindex="-1"></a>d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb100-16"><a href="aplikace3.html#cb100-16" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb100-17"><a href="aplikace3.html#cb100-17" tabindex="-1"></a></span>
<span id="cb100-18"><a href="aplikace3.html#cb100-18" tabindex="-1"></a>err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb100-19"><a href="aplikace3.html#cb100-19" tabindex="-1"></a>                     <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb100-20"><a href="aplikace3.html#cb100-20" tabindex="-1"></a>                     <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb100-21"><a href="aplikace3.html#cb100-21" tabindex="-1"></a>df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">gamma =</span> gamma.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb100-22"><a href="aplikace3.html#cb100-22" tabindex="-1"></a>           <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb100-23"><a href="aplikace3.html#cb100-23" tabindex="-1"></a>           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-95">Tabulka 12.2: </span>Souhrnné výsledky cross-validace pro metodu SVM v kombinaci s RKHS na simulovaných datech. <span class="math inline">\(\widehat{Err}_{train}\)</span> značí odhad trénovací chybovosti a <span class="math inline">\(\widehat{Err}_{test}\)</span> testovací chybovosti.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad d\)</span></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad\gamma\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{cross\_validace}\)</span></th>
<th align="left">Model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>linear</td>
<td align="right">11</td>
<td align="right">1.0000</td>
<td align="right">0</td>
<td align="left">linear</td>
</tr>
<tr class="even">
<td>poly</td>
<td align="right">27</td>
<td align="right">1.0000</td>
<td align="right">0</td>
<td align="left">polynomial</td>
</tr>
<tr class="odd">
<td>radial</td>
<td align="right">30</td>
<td align="right">3.7276</td>
<td align="right">0</td>
<td align="left">radial</td>
</tr>
</tbody>
</table>
<p>Vidíme, že nejlépe vychází hodnota parametru <span class="math inline">\(d={}\)</span> 11 a <span class="math inline">\(\gamma={}\)</span> 1 pro lineární jádro s hodnotou chybovosti spočtenou pomocí 10-násobné CV 0, <span class="math inline">\(d={}\)</span> 27 a <span class="math inline">\(\gamma={}\)</span> 1 pro polynomiální jádro s hodnotou chybovosti spočtenou pomocí 10-násobné CV 0 a <span class="math inline">\(d={}\)</span> 30 a <span class="math inline">\(\gamma={}\)</span> 3.7276 pro radiální jádro s hodnotou chybovosti 0.
Pro zajímavost si ještě vykresleme funkci validační chybovosti v závislosti na dimenzi <span class="math inline">\(d\)</span> a hodnotě hyperparametru <span class="math inline">\(\gamma\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="aplikace3.html#cb101-1" tabindex="-1"></a>CV.results.plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> <span class="fu">rep</span>(dimensions <span class="sc">|&gt;</span> <span class="fu">rep</span>(<span class="dv">3</span>), <span class="at">each =</span> <span class="fu">length</span>(gamma.cv)), </span>
<span id="cb101-2"><a href="aplikace3.html#cb101-2" tabindex="-1"></a>                              <span class="at">gamma =</span> <span class="fu">rep</span>(gamma.cv, <span class="fu">length</span>(dimensions)) <span class="sc">|&gt;</span> <span class="fu">rep</span>(<span class="dv">3</span>),</span>
<span id="cb101-3"><a href="aplikace3.html#cb101-3" tabindex="-1"></a>                               <span class="at">CV =</span> <span class="fu">c</span>(<span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb101-4"><a href="aplikace3.html#cb101-4" tabindex="-1"></a>                                      <span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.p), </span>
<span id="cb101-5"><a href="aplikace3.html#cb101-5" tabindex="-1"></a>                                      <span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.r)),</span>
<span id="cb101-6"><a href="aplikace3.html#cb101-6" tabindex="-1"></a>                               <span class="at">Kernel =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>), </span>
<span id="cb101-7"><a href="aplikace3.html#cb101-7" tabindex="-1"></a>                                            <span class="at">each =</span> <span class="fu">length</span>(dimensions) <span class="sc">*</span> </span>
<span id="cb101-8"><a href="aplikace3.html#cb101-8" tabindex="-1"></a>                                              <span class="fu">length</span>(gamma.cv)) <span class="sc">|&gt;</span> <span class="fu">factor</span>())</span>
<span id="cb101-9"><a href="aplikace3.html#cb101-9" tabindex="-1"></a>CV.results.plot <span class="sc">|&gt;</span> </span>
<span id="cb101-10"><a href="aplikace3.html#cb101-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> gamma, <span class="at">z =</span> CV)) <span class="sc">+</span> </span>
<span id="cb101-11"><a href="aplikace3.html#cb101-11" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>() <span class="sc">+</span></span>
<span id="cb101-12"><a href="aplikace3.html#cb101-12" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>) <span class="sc">+</span></span>
<span id="cb101-13"><a href="aplikace3.html#cb101-13" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Kernel) <span class="sc">+</span></span>
<span id="cb101-14"><a href="aplikace3.html#cb101-14" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb101-15"><a href="aplikace3.html#cb101-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(d),</span>
<span id="cb101-16"><a href="aplikace3.html#cb101-16" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(gamma)) <span class="sc">+</span> </span>
<span id="cb101-17"><a href="aplikace3.html#cb101-17" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Spectral&quot;</span>) <span class="sc">+</span> </span>
<span id="cb101-18"><a href="aplikace3.html#cb101-18" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df.RKHS.res, <span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> gamma),</span>
<span id="cb101-19"><a href="aplikace3.html#cb101-19" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">5</span>, <span class="at">pch =</span> <span class="st">&#39;+&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-96"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-96-1.png" alt="Závislost validační chybovosti na volbě hyperparametrů $d$ a $\gamma$, zvlášť pro všechna tři uvažovaná jádra v metodě SVM." width="672" />
<p class="caption">
Obrázek 12.22: Závislost validační chybovosti na volbě hyperparametrů <span class="math inline">\(d\)</span> a <span class="math inline">\(\gamma\)</span>, zvlášť pro všechna tři uvažovaná jádra v metodě SVM.
</p>
</div>
<p>Na grafech výše vidíme, jak se měnila validační chybovost v závislosti na hodnotách hyperparametrů <span class="math inline">\(d\)</span> a <span class="math inline">\(\gamma\)</span>.
Všimněme si zejména, že ve všech třech grafech pro jednotlivá jádra jsou patrné výrazné horizontální útvary.
Z toho můžeme usoudit významné teoretické i praktické zjištění – uvažovaná klasifikační metoda (projekce na RKHS pomocí SVM + klasifikace SVM) je robustní na volbu hyperparametru <span class="math inline">\(d\)</span> (tj. při malé změně v hodnotě tohoto parametru nedojde k výraznému zhoršení validační chybovosti), zatímco při volbě hyperparametru <span class="math inline">\(\gamma\)</span> musíme být velmi obezřetní (i malá změna v jeho hodnotě může vést k velké změně validační chybovosti).
Toto chování je nejlépe patrné u Gaussova jádra.</p>
<p>Jelikož již máme nalezeny optimální hodnoty hyperparametrů, můžeme zkounstruovat finální modely a určit jejich úspěšnost klasifikace na testovacích datech.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="aplikace3.html#cb102-1" tabindex="-1"></a><span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb102-2"><a href="aplikace3.html#cb102-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb102-3"><a href="aplikace3.html#cb102-3" tabindex="-1"></a><span class="co"># pridame i testovaci data</span></span>
<span id="cb102-4"><a href="aplikace3.html#cb102-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="aplikace3.html#cb103-1" tabindex="-1"></a><span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb103-2"><a href="aplikace3.html#cb103-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, </span>
<span id="cb103-3"><a href="aplikace3.html#cb103-3" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, </span>
<span id="cb103-4"><a href="aplikace3.html#cb103-4" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>), </span>
<span id="cb103-5"><a href="aplikace3.html#cb103-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb103-6"><a href="aplikace3.html#cb103-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb103-7"><a href="aplikace3.html#cb103-7" tabindex="-1"></a></span>
<span id="cb103-8"><a href="aplikace3.html#cb103-8" tabindex="-1"></a><span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb103-9"><a href="aplikace3.html#cb103-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb103-10"><a href="aplikace3.html#cb103-10" tabindex="-1"></a>  <span class="co"># spocitame matici K</span></span>
<span id="cb103-11"><a href="aplikace3.html#cb103-11" tabindex="-1"></a>  gamma <span class="ot">&lt;-</span> gamma.opt[kernel_number] <span class="co"># hodnota gamma pomoci CV</span></span>
<span id="cb103-12"><a href="aplikace3.html#cb103-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb103-13"><a href="aplikace3.html#cb103-13" tabindex="-1"></a>  </span>
<span id="cb103-14"><a href="aplikace3.html#cb103-14" tabindex="-1"></a>  <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb103-15"><a href="aplikace3.html#cb103-15" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb103-16"><a href="aplikace3.html#cb103-16" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb103-17"><a href="aplikace3.html#cb103-17" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb103-18"><a href="aplikace3.html#cb103-18" tabindex="-1"></a>  <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb103-19"><a href="aplikace3.html#cb103-19" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb103-20"><a href="aplikace3.html#cb103-20" tabindex="-1"></a>                       <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb103-21"><a href="aplikace3.html#cb103-21" tabindex="-1"></a>  </span>
<span id="cb103-22"><a href="aplikace3.html#cb103-22" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb103-23"><a href="aplikace3.html#cb103-23" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb103-24"><a href="aplikace3.html#cb103-24" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb103-25"><a href="aplikace3.html#cb103-25" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb103-26"><a href="aplikace3.html#cb103-26" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb103-27"><a href="aplikace3.html#cb103-27" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb103-28"><a href="aplikace3.html#cb103-28" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb103-29"><a href="aplikace3.html#cb103-29" tabindex="-1"></a>                    <span class="at">epsilon =</span> eps,</span>
<span id="cb103-30"><a href="aplikace3.html#cb103-30" tabindex="-1"></a>                    <span class="at">cost =</span> C,</span>
<span id="cb103-31"><a href="aplikace3.html#cb103-31" tabindex="-1"></a>                    <span class="at">gamma =</span> gamma)</span>
<span id="cb103-32"><a href="aplikace3.html#cb103-32" tabindex="-1"></a>    <span class="co"># urceni alpha</span></span>
<span id="cb103-33"><a href="aplikace3.html#cb103-33" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb103-34"><a href="aplikace3.html#cb103-34" tabindex="-1"></a>  }</span>
<span id="cb103-35"><a href="aplikace3.html#cb103-35" tabindex="-1"></a>  <span class="co"># d</span></span>
<span id="cb103-36"><a href="aplikace3.html#cb103-36" tabindex="-1"></a>  d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb103-37"><a href="aplikace3.html#cb103-37" tabindex="-1"></a>  </span>
<span id="cb103-38"><a href="aplikace3.html#cb103-38" tabindex="-1"></a>  <span class="co"># urceni vektoru lambda</span></span>
<span id="cb103-39"><a href="aplikace3.html#cb103-39" tabindex="-1"></a>  Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb103-40"><a href="aplikace3.html#cb103-40" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb103-41"><a href="aplikace3.html#cb103-41" tabindex="-1"></a>                        <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb103-42"><a href="aplikace3.html#cb103-42" tabindex="-1"></a>  </span>
<span id="cb103-43"><a href="aplikace3.html#cb103-43" tabindex="-1"></a>  <span class="co"># vypocet reprezentace</span></span>
<span id="cb103-44"><a href="aplikace3.html#cb103-44" tabindex="-1"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb103-45"><a href="aplikace3.html#cb103-45" tabindex="-1"></a>    Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb103-46"><a href="aplikace3.html#cb103-46" tabindex="-1"></a>  }</span>
<span id="cb103-47"><a href="aplikace3.html#cb103-47" tabindex="-1"></a>  </span>
<span id="cb103-48"><a href="aplikace3.html#cb103-48" tabindex="-1"></a>  <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb103-49"><a href="aplikace3.html#cb103-49" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb103-50"><a href="aplikace3.html#cb103-50" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb103-51"><a href="aplikace3.html#cb103-51" tabindex="-1"></a></span>
<span id="cb103-52"><a href="aplikace3.html#cb103-52" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb103-53"><a href="aplikace3.html#cb103-53" tabindex="-1"></a></span>
<span id="cb103-54"><a href="aplikace3.html#cb103-54" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb103-55"><a href="aplikace3.html#cb103-55" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb103-56"><a href="aplikace3.html#cb103-56" tabindex="-1"></a>  </span>
<span id="cb103-57"><a href="aplikace3.html#cb103-57" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb103-58"><a href="aplikace3.html#cb103-58" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb103-59"><a href="aplikace3.html#cb103-59" tabindex="-1"></a>  </span>
<span id="cb103-60"><a href="aplikace3.html#cb103-60" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb103-61"><a href="aplikace3.html#cb103-61" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb103-62"><a href="aplikace3.html#cb103-62" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb103-63"><a href="aplikace3.html#cb103-63" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb103-64"><a href="aplikace3.html#cb103-64" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb103-65"><a href="aplikace3.html#cb103-65" tabindex="-1"></a>                      <span class="at">coef0 =</span> coef0,</span>
<span id="cb103-66"><a href="aplikace3.html#cb103-66" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type)</span>
<span id="cb103-67"><a href="aplikace3.html#cb103-67" tabindex="-1"></a>  </span>
<span id="cb103-68"><a href="aplikace3.html#cb103-68" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb103-69"><a href="aplikace3.html#cb103-69" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb103-70"><a href="aplikace3.html#cb103-70" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb103-71"><a href="aplikace3.html#cb103-71" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb103-72"><a href="aplikace3.html#cb103-72" tabindex="-1"></a>    </span>
<span id="cb103-73"><a href="aplikace3.html#cb103-73" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb103-74"><a href="aplikace3.html#cb103-74" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb103-75"><a href="aplikace3.html#cb103-75" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb103-76"><a href="aplikace3.html#cb103-76" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb103-77"><a href="aplikace3.html#cb103-77" tabindex="-1"></a>  </span>
<span id="cb103-78"><a href="aplikace3.html#cb103-78" tabindex="-1"></a>  <span class="co"># ulozeni vysledku</span></span>
<span id="cb103-79"><a href="aplikace3.html#cb103-79" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb103-80"><a href="aplikace3.html#cb103-80" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-99">Tabulka 12.3: </span>Souhrnné výsledky metody SVM v kombinaci s RKHS na simulovaných datech. <span class="math inline">\(\widehat{Err}_{train}\)</span> značí odhad trénovací chybovosti a <span class="math inline">\(\widehat{Err}_{test}\)</span> testovací chybovosti.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS - radial</td>
<td align="center">0</td>
<td align="center">0.0308</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - radial</td>
<td align="center">0</td>
<td align="center">0.0308</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - radial</td>
<td align="center">0</td>
<td align="center">0.0154</td>
</tr>
</tbody>
</table>
<p>Chybovost metody SVM v kombinaci s projekcí na Reproducing Kernel Hilbert Space je tedy na trénovacích datech rovna 0 % pro lineární jádro, 0 % pro polynomiální jádro a 0 % pro gaussovské jádro.
Na testovacích datech je potom chybovost metody 3.08 % pro lineární jádro, 3.08 % pro polynomiální jádro a 1.54 % pro radiální jádro.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="aplikace3.html#cb104-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="polynomiální-jádro-7" class="section level6 hasAnchor" number="12.3.7.5.3.2">
<h6><span class="header-section-number">12.3.7.5.3.2</span> Polynomiální jádro<a href="aplikace3.html#polynomiální-jádro-7" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="aplikace3.html#cb105-1" tabindex="-1"></a><span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb105-2"><a href="aplikace3.html#cb105-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb105-3"><a href="aplikace3.html#cb105-3" tabindex="-1"></a><span class="co"># pridame i testovaci data</span></span>
<span id="cb105-4"><a href="aplikace3.html#cb105-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb105-5"><a href="aplikace3.html#cb105-5" tabindex="-1"></a></span>
<span id="cb105-6"><a href="aplikace3.html#cb105-6" tabindex="-1"></a><span class="co"># jadro a jadrova matice ... polynomialni s parametrem p</span></span>
<span id="cb105-7"><a href="aplikace3.html#cb105-7" tabindex="-1"></a>Poly.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, p) {</span>
<span id="cb105-8"><a href="aplikace3.html#cb105-8" tabindex="-1"></a>  <span class="fu">return</span>((<span class="dv">1</span> <span class="sc">+</span> x <span class="sc">*</span> y)<span class="sc">^</span>p)</span>
<span id="cb105-9"><a href="aplikace3.html#cb105-9" tabindex="-1"></a>}</span>
<span id="cb105-10"><a href="aplikace3.html#cb105-10" tabindex="-1"></a></span>
<span id="cb105-11"><a href="aplikace3.html#cb105-11" tabindex="-1"></a>Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, p) {</span>
<span id="cb105-12"><a href="aplikace3.html#cb105-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb105-13"><a href="aplikace3.html#cb105-13" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb105-14"><a href="aplikace3.html#cb105-14" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb105-15"><a href="aplikace3.html#cb105-15" tabindex="-1"></a>      K[i, j] <span class="ot">&lt;-</span> <span class="fu">Poly.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], p)</span>
<span id="cb105-16"><a href="aplikace3.html#cb105-16" tabindex="-1"></a>    }</span>
<span id="cb105-17"><a href="aplikace3.html#cb105-17" tabindex="-1"></a>  }</span>
<span id="cb105-18"><a href="aplikace3.html#cb105-18" tabindex="-1"></a>  <span class="fu">return</span>(K)</span>
<span id="cb105-19"><a href="aplikace3.html#cb105-19" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="aplikace3.html#cb106-1" tabindex="-1"></a><span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb106-2"><a href="aplikace3.html#cb106-2" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb106-3"><a href="aplikace3.html#cb106-3" tabindex="-1"></a><span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb106-4"><a href="aplikace3.html#cb106-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb106-5"><a href="aplikace3.html#cb106-5" tabindex="-1"></a></span>
<span id="cb106-6"><a href="aplikace3.html#cb106-6" tabindex="-1"></a><span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb106-7"><a href="aplikace3.html#cb106-7" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">30</span> <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb106-8"><a href="aplikace3.html#cb106-8" tabindex="-1"></a>poly.cv <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb106-9"><a href="aplikace3.html#cb106-9" tabindex="-1"></a></span>
<span id="cb106-10"><a href="aplikace3.html#cb106-10" tabindex="-1"></a><span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb106-11"><a href="aplikace3.html#cb106-11" tabindex="-1"></a><span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb106-12"><a href="aplikace3.html#cb106-12" tabindex="-1"></a><span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb106-13"><a href="aplikace3.html#cb106-13" tabindex="-1"></a><span class="co"># v radcich budou hodnoty pro dane p a vrstvy odpovidaji folds</span></span>
<span id="cb106-14"><a href="aplikace3.html#cb106-14" tabindex="-1"></a>dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, poly.cv),</span>
<span id="cb106-15"><a href="aplikace3.html#cb106-15" tabindex="-1"></a>                  <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb106-16"><a href="aplikace3.html#cb106-16" tabindex="-1"></a>                  <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb106-17"><a href="aplikace3.html#cb106-17" tabindex="-1"></a></span>
<span id="cb106-18"><a href="aplikace3.html#cb106-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb106-19"><a href="aplikace3.html#cb106-19" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb106-20"><a href="aplikace3.html#cb106-20" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb106-21"><a href="aplikace3.html#cb106-21" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb106-22"><a href="aplikace3.html#cb106-22" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb106-23"><a href="aplikace3.html#cb106-23" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb106-24"><a href="aplikace3.html#cb106-24" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="aplikace3.html#cb107-1" tabindex="-1"></a><span class="co"># samotna CV</span></span>
<span id="cb107-2"><a href="aplikace3.html#cb107-2" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> poly.cv) {</span>
<span id="cb107-3"><a href="aplikace3.html#cb107-3" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb107-4"><a href="aplikace3.html#cb107-4" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb107-5"><a href="aplikace3.html#cb107-5" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb107-6"><a href="aplikace3.html#cb107-6" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb107-7"><a href="aplikace3.html#cb107-7" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb107-8"><a href="aplikace3.html#cb107-8" tabindex="-1"></a>  </span>
<span id="cb107-9"><a href="aplikace3.html#cb107-9" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb107-10"><a href="aplikace3.html#cb107-10" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb107-11"><a href="aplikace3.html#cb107-11" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb107-12"><a href="aplikace3.html#cb107-12" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb107-13"><a href="aplikace3.html#cb107-13" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb107-14"><a href="aplikace3.html#cb107-14" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb107-15"><a href="aplikace3.html#cb107-15" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb107-16"><a href="aplikace3.html#cb107-16" tabindex="-1"></a>                    <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb107-17"><a href="aplikace3.html#cb107-17" tabindex="-1"></a>                    <span class="at">cost =</span> C,</span>
<span id="cb107-18"><a href="aplikace3.html#cb107-18" tabindex="-1"></a>                    <span class="at">epsilon =</span> eps,</span>
<span id="cb107-19"><a href="aplikace3.html#cb107-19" tabindex="-1"></a>                    <span class="at">degree =</span> p)</span>
<span id="cb107-20"><a href="aplikace3.html#cb107-20" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb107-21"><a href="aplikace3.html#cb107-21" tabindex="-1"></a>  }</span>
<span id="cb107-22"><a href="aplikace3.html#cb107-22" tabindex="-1"></a>  </span>
<span id="cb107-23"><a href="aplikace3.html#cb107-23" tabindex="-1"></a>  <span class="co"># projdeme dimenze</span></span>
<span id="cb107-24"><a href="aplikace3.html#cb107-24" tabindex="-1"></a>  <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb107-25"><a href="aplikace3.html#cb107-25" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb107-26"><a href="aplikace3.html#cb107-26" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb107-27"><a href="aplikace3.html#cb107-27" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb107-28"><a href="aplikace3.html#cb107-28" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb107-29"><a href="aplikace3.html#cb107-29" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb107-30"><a href="aplikace3.html#cb107-30" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb107-31"><a href="aplikace3.html#cb107-31" tabindex="-1"></a>                             alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb107-32"><a href="aplikace3.html#cb107-32" tabindex="-1"></a>    }</span>
<span id="cb107-33"><a href="aplikace3.html#cb107-33" tabindex="-1"></a>    <span class="co"># projdeme folds</span></span>
<span id="cb107-34"><a href="aplikace3.html#cb107-34" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb107-35"><a href="aplikace3.html#cb107-35" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb107-36"><a href="aplikace3.html#cb107-36" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb107-37"><a href="aplikace3.html#cb107-37" tabindex="-1"></a>      <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb107-38"><a href="aplikace3.html#cb107-38" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb107-39"><a href="aplikace3.html#cb107-39" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb107-40"><a href="aplikace3.html#cb107-40" tabindex="-1"></a>      <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb107-41"><a href="aplikace3.html#cb107-41" tabindex="-1"></a>      Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb107-42"><a href="aplikace3.html#cb107-42" tabindex="-1"></a>                                  <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb107-43"><a href="aplikace3.html#cb107-43" tabindex="-1"></a>                                  <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb107-44"><a href="aplikace3.html#cb107-44" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb107-45"><a href="aplikace3.html#cb107-45" tabindex="-1"></a>      <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb107-46"><a href="aplikace3.html#cb107-46" tabindex="-1"></a>      <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb107-47"><a href="aplikace3.html#cb107-47" tabindex="-1"></a>        kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb107-48"><a href="aplikace3.html#cb107-48" tabindex="-1"></a>      </span>
<span id="cb107-49"><a href="aplikace3.html#cb107-49" tabindex="-1"></a>        data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb107-50"><a href="aplikace3.html#cb107-50" tabindex="-1"></a>        data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb107-51"><a href="aplikace3.html#cb107-51" tabindex="-1"></a>        </span>
<span id="cb107-52"><a href="aplikace3.html#cb107-52" tabindex="-1"></a>        data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb107-53"><a href="aplikace3.html#cb107-53" tabindex="-1"></a>        data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb107-54"><a href="aplikace3.html#cb107-54" tabindex="-1"></a>        </span>
<span id="cb107-55"><a href="aplikace3.html#cb107-55" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb107-56"><a href="aplikace3.html#cb107-56" tabindex="-1"></a>        clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb107-57"><a href="aplikace3.html#cb107-57" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb107-58"><a href="aplikace3.html#cb107-58" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb107-59"><a href="aplikace3.html#cb107-59" tabindex="-1"></a>                            <span class="at">cost =</span> C,                    </span>
<span id="cb107-60"><a href="aplikace3.html#cb107-60" tabindex="-1"></a>                            <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb107-61"><a href="aplikace3.html#cb107-61" tabindex="-1"></a>                            <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb107-62"><a href="aplikace3.html#cb107-62" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb107-63"><a href="aplikace3.html#cb107-63" tabindex="-1"></a>        </span>
<span id="cb107-64"><a href="aplikace3.html#cb107-64" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb107-65"><a href="aplikace3.html#cb107-65" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb107-66"><a href="aplikace3.html#cb107-66" tabindex="-1"></a>        presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb107-67"><a href="aplikace3.html#cb107-67" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb107-68"><a href="aplikace3.html#cb107-68" tabindex="-1"></a>        </span>
<span id="cb107-69"><a href="aplikace3.html#cb107-69" tabindex="-1"></a>        <span class="co"># ulozeni vysledku</span></span>
<span id="cb107-70"><a href="aplikace3.html#cb107-70" tabindex="-1"></a>        Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb107-71"><a href="aplikace3.html#cb107-71" tabindex="-1"></a>      }</span>
<span id="cb107-72"><a href="aplikace3.html#cb107-72" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb107-73"><a href="aplikace3.html#cb107-73" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb107-74"><a href="aplikace3.html#cb107-74" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb107-75"><a href="aplikace3.html#cb107-75" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb107-76"><a href="aplikace3.html#cb107-76" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb107-77"><a href="aplikace3.html#cb107-77" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb107-78"><a href="aplikace3.html#cb107-78" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb107-79"><a href="aplikace3.html#cb107-79" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb107-80"><a href="aplikace3.html#cb107-80" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb107-81"><a href="aplikace3.html#cb107-81" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb107-82"><a href="aplikace3.html#cb107-82" tabindex="-1"></a>    }</span>
<span id="cb107-83"><a href="aplikace3.html#cb107-83" tabindex="-1"></a>  }</span>
<span id="cb107-84"><a href="aplikace3.html#cb107-84" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="aplikace3.html#cb108-1" tabindex="-1"></a><span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb108-2"><a href="aplikace3.html#cb108-2" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb108-3"><a href="aplikace3.html#cb108-3" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb108-4"><a href="aplikace3.html#cb108-4" tabindex="-1"></a>}</span>
<span id="cb108-5"><a href="aplikace3.html#cb108-5" tabindex="-1"></a></span>
<span id="cb108-6"><a href="aplikace3.html#cb108-6" tabindex="-1"></a>poly.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb108-7"><a href="aplikace3.html#cb108-7" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb108-8"><a href="aplikace3.html#cb108-8" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv))</span>
<span id="cb108-9"><a href="aplikace3.html#cb108-9" tabindex="-1"></a>poly.opt[poly.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(poly.cv)</span>
<span id="cb108-10"><a href="aplikace3.html#cb108-10" tabindex="-1"></a>poly.opt <span class="ot">&lt;-</span> poly.cv[poly.opt]</span>
<span id="cb108-11"><a href="aplikace3.html#cb108-11" tabindex="-1"></a></span>
<span id="cb108-12"><a href="aplikace3.html#cb108-12" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb108-13"><a href="aplikace3.html#cb108-13" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb108-14"><a href="aplikace3.html#cb108-14" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb108-15"><a href="aplikace3.html#cb108-15" tabindex="-1"></a>d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb108-16"><a href="aplikace3.html#cb108-16" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb108-17"><a href="aplikace3.html#cb108-17" tabindex="-1"></a></span>
<span id="cb108-18"><a href="aplikace3.html#cb108-18" tabindex="-1"></a>err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb108-19"><a href="aplikace3.html#cb108-19" tabindex="-1"></a>                     <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb108-20"><a href="aplikace3.html#cb108-20" tabindex="-1"></a>                     <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb108-21"><a href="aplikace3.html#cb108-21" tabindex="-1"></a>df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">p =</span> poly.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb108-22"><a href="aplikace3.html#cb108-22" tabindex="-1"></a>           <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb108-23"><a href="aplikace3.html#cb108-23" tabindex="-1"></a>           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-104">Tabulka 12.4: </span>Souhrnné výsledky cross-validace pro metodu SVM v kombinaci s RKHS na simulovaných datech. <span class="math inline">\(\widehat{Err}_{train}\)</span> značí odhad trénovací chybovosti a <span class="math inline">\(\widehat{Err}_{test}\)</span> testovací chybovosti.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad d\)</span></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad p\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{cross\_validace}\)</span></th>
<th align="left">Model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>linear</td>
<td align="right">20</td>
<td align="right">5</td>
<td align="right">0.0474</td>
<td align="left">linear</td>
</tr>
<tr class="even">
<td>poly</td>
<td align="right">10</td>
<td align="right">3</td>
<td align="right">0.0461</td>
<td align="left">polynomial</td>
</tr>
<tr class="odd">
<td>radial</td>
<td align="right">7</td>
<td align="right">5</td>
<td align="right">0.0403</td>
<td align="left">radial</td>
</tr>
</tbody>
</table>
<p>Vidíme, že nejlépe vychází hodnota parametru <span class="math inline">\(d={}\)</span> 20 a <span class="math inline">\(p={}\)</span> 5 pro lineární jádro s hodnotou chybovosti spočtenou pomocí 10-násobné CV 0.0474, <span class="math inline">\(d={}\)</span> 10 a <span class="math inline">\(p={}\)</span> 3 pro polynomiální jádro s hodnotou chybovosti spočtenou pomocí 10-násobné CV 0.0461 a <span class="math inline">\(d={}\)</span> 7 a <span class="math inline">\(p={}\)</span> 5 pro radiální jádro s hodnotou chybovosti 0.0403.</p>
<p>Jelikož již máme nalezeny optimální hodnoty hyperparametrů, můžeme zkounstruovat finální modely a určit jejich úspěšnost klasifikace na testovacích datech.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="aplikace3.html#cb109-1" tabindex="-1"></a><span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb109-2"><a href="aplikace3.html#cb109-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb109-3"><a href="aplikace3.html#cb109-3" tabindex="-1"></a><span class="co"># pridame i testovaci data</span></span>
<span id="cb109-4"><a href="aplikace3.html#cb109-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="aplikace3.html#cb110-1" tabindex="-1"></a><span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb110-2"><a href="aplikace3.html#cb110-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - poly&#39;</span>, </span>
<span id="cb110-3"><a href="aplikace3.html#cb110-3" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - RKHS - poly&#39;</span>, </span>
<span id="cb110-4"><a href="aplikace3.html#cb110-4" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - RKHS - poly&#39;</span>), </span>
<span id="cb110-5"><a href="aplikace3.html#cb110-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb110-6"><a href="aplikace3.html#cb110-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb110-7"><a href="aplikace3.html#cb110-7" tabindex="-1"></a></span>
<span id="cb110-8"><a href="aplikace3.html#cb110-8" tabindex="-1"></a><span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb110-9"><a href="aplikace3.html#cb110-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb110-10"><a href="aplikace3.html#cb110-10" tabindex="-1"></a>  <span class="co"># spocitame matici K</span></span>
<span id="cb110-11"><a href="aplikace3.html#cb110-11" tabindex="-1"></a>  p <span class="ot">&lt;-</span> poly.opt[kernel_number] <span class="co"># hodnota gamma pomoci CV</span></span>
<span id="cb110-12"><a href="aplikace3.html#cb110-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb110-13"><a href="aplikace3.html#cb110-13" tabindex="-1"></a>  </span>
<span id="cb110-14"><a href="aplikace3.html#cb110-14" tabindex="-1"></a>  <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb110-15"><a href="aplikace3.html#cb110-15" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb110-16"><a href="aplikace3.html#cb110-16" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb110-17"><a href="aplikace3.html#cb110-17" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb110-18"><a href="aplikace3.html#cb110-18" tabindex="-1"></a>  <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb110-19"><a href="aplikace3.html#cb110-19" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb110-20"><a href="aplikace3.html#cb110-20" tabindex="-1"></a>                       <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb110-21"><a href="aplikace3.html#cb110-21" tabindex="-1"></a>  </span>
<span id="cb110-22"><a href="aplikace3.html#cb110-22" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb110-23"><a href="aplikace3.html#cb110-23" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb110-24"><a href="aplikace3.html#cb110-24" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb110-25"><a href="aplikace3.html#cb110-25" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb110-26"><a href="aplikace3.html#cb110-26" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb110-27"><a href="aplikace3.html#cb110-27" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb110-28"><a href="aplikace3.html#cb110-28" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb110-29"><a href="aplikace3.html#cb110-29" tabindex="-1"></a>                    <span class="at">epsilon =</span> eps,</span>
<span id="cb110-30"><a href="aplikace3.html#cb110-30" tabindex="-1"></a>                    <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb110-31"><a href="aplikace3.html#cb110-31" tabindex="-1"></a>                    <span class="at">cost =</span> C,</span>
<span id="cb110-32"><a href="aplikace3.html#cb110-32" tabindex="-1"></a>                    <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb110-33"><a href="aplikace3.html#cb110-33" tabindex="-1"></a>                    <span class="at">degree =</span> p)</span>
<span id="cb110-34"><a href="aplikace3.html#cb110-34" tabindex="-1"></a>    <span class="co"># urceni alpha</span></span>
<span id="cb110-35"><a href="aplikace3.html#cb110-35" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb110-36"><a href="aplikace3.html#cb110-36" tabindex="-1"></a>  }</span>
<span id="cb110-37"><a href="aplikace3.html#cb110-37" tabindex="-1"></a>  <span class="co"># d</span></span>
<span id="cb110-38"><a href="aplikace3.html#cb110-38" tabindex="-1"></a>  d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb110-39"><a href="aplikace3.html#cb110-39" tabindex="-1"></a>  </span>
<span id="cb110-40"><a href="aplikace3.html#cb110-40" tabindex="-1"></a>  <span class="co"># urceni vektoru lambda</span></span>
<span id="cb110-41"><a href="aplikace3.html#cb110-41" tabindex="-1"></a>  Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb110-42"><a href="aplikace3.html#cb110-42" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb110-43"><a href="aplikace3.html#cb110-43" tabindex="-1"></a>                        <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb110-44"><a href="aplikace3.html#cb110-44" tabindex="-1"></a>  </span>
<span id="cb110-45"><a href="aplikace3.html#cb110-45" tabindex="-1"></a>  <span class="co"># vypocet reprezentace</span></span>
<span id="cb110-46"><a href="aplikace3.html#cb110-46" tabindex="-1"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb110-47"><a href="aplikace3.html#cb110-47" tabindex="-1"></a>    Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb110-48"><a href="aplikace3.html#cb110-48" tabindex="-1"></a>  }</span>
<span id="cb110-49"><a href="aplikace3.html#cb110-49" tabindex="-1"></a>  </span>
<span id="cb110-50"><a href="aplikace3.html#cb110-50" tabindex="-1"></a>  <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb110-51"><a href="aplikace3.html#cb110-51" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb110-52"><a href="aplikace3.html#cb110-52" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb110-53"><a href="aplikace3.html#cb110-53" tabindex="-1"></a></span>
<span id="cb110-54"><a href="aplikace3.html#cb110-54" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb110-55"><a href="aplikace3.html#cb110-55" tabindex="-1"></a></span>
<span id="cb110-56"><a href="aplikace3.html#cb110-56" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb110-57"><a href="aplikace3.html#cb110-57" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb110-58"><a href="aplikace3.html#cb110-58" tabindex="-1"></a>  </span>
<span id="cb110-59"><a href="aplikace3.html#cb110-59" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb110-60"><a href="aplikace3.html#cb110-60" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb110-61"><a href="aplikace3.html#cb110-61" tabindex="-1"></a>  </span>
<span id="cb110-62"><a href="aplikace3.html#cb110-62" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb110-63"><a href="aplikace3.html#cb110-63" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb110-64"><a href="aplikace3.html#cb110-64" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb110-65"><a href="aplikace3.html#cb110-65" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb110-66"><a href="aplikace3.html#cb110-66" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb110-67"><a href="aplikace3.html#cb110-67" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb110-68"><a href="aplikace3.html#cb110-68" tabindex="-1"></a>                      <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb110-69"><a href="aplikace3.html#cb110-69" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type)</span>
<span id="cb110-70"><a href="aplikace3.html#cb110-70" tabindex="-1"></a>  </span>
<span id="cb110-71"><a href="aplikace3.html#cb110-71" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb110-72"><a href="aplikace3.html#cb110-72" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb110-73"><a href="aplikace3.html#cb110-73" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb110-74"><a href="aplikace3.html#cb110-74" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb110-75"><a href="aplikace3.html#cb110-75" tabindex="-1"></a>    </span>
<span id="cb110-76"><a href="aplikace3.html#cb110-76" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb110-77"><a href="aplikace3.html#cb110-77" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb110-78"><a href="aplikace3.html#cb110-78" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb110-79"><a href="aplikace3.html#cb110-79" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb110-80"><a href="aplikace3.html#cb110-80" tabindex="-1"></a>  </span>
<span id="cb110-81"><a href="aplikace3.html#cb110-81" tabindex="-1"></a>  <span class="co"># ulozeni vysledku</span></span>
<span id="cb110-82"><a href="aplikace3.html#cb110-82" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb110-83"><a href="aplikace3.html#cb110-83" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-107">Tabulka 12.5: </span>Souhrnné výsledky metody SVM v kombinaci s RKHS na simulovaných datech. <span class="math inline">\(\widehat{Err}_{train}\)</span> značí odhad trénovací chybovosti a <span class="math inline">\(\widehat{Err}_{test}\)</span> testovací chybovosti.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS - poly</td>
<td align="center">0.0333</td>
<td align="center">0.0615</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - poly</td>
<td align="center">0.0267</td>
<td align="center">0.1077</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - poly</td>
<td align="center">0.0333</td>
<td align="center">0.1077</td>
</tr>
</tbody>
</table>
<p>Chybovost metody SVM v kombinaci s projekcí na Reproducing Kernel Hilbert Space je tedy na trénovacích datech rovna 3.33 % pro lineární jádro, 2.67 % pro polynomiální jádro a 3.33 % pro gaussovské jádro.
Na testovacích datech je potom chybovost metody 6.15 % pro lineární jádro, 10.77 % pro polynomiální jádro a 10.77 % pro radiální jádro.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="aplikace3.html#cb111-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="lineární-jádro-7" class="section level6 hasAnchor" number="12.3.7.5.3.3">
<h6><span class="header-section-number">12.3.7.5.3.3</span> Lineární jádro<a href="aplikace3.html#lineární-jádro-7" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="aplikace3.html#cb112-1" tabindex="-1"></a><span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb112-2"><a href="aplikace3.html#cb112-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb112-3"><a href="aplikace3.html#cb112-3" tabindex="-1"></a><span class="co"># pridame i testovaci data</span></span>
<span id="cb112-4"><a href="aplikace3.html#cb112-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb112-5"><a href="aplikace3.html#cb112-5" tabindex="-1"></a></span>
<span id="cb112-6"><a href="aplikace3.html#cb112-6" tabindex="-1"></a><span class="co"># jadro a jadrova matice ... polynomialni s parametrem p</span></span>
<span id="cb112-7"><a href="aplikace3.html#cb112-7" tabindex="-1"></a>Linear.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb112-8"><a href="aplikace3.html#cb112-8" tabindex="-1"></a>  <span class="fu">return</span>(x <span class="sc">*</span> y)</span>
<span id="cb112-9"><a href="aplikace3.html#cb112-9" tabindex="-1"></a>}</span>
<span id="cb112-10"><a href="aplikace3.html#cb112-10" tabindex="-1"></a></span>
<span id="cb112-11"><a href="aplikace3.html#cb112-11" tabindex="-1"></a>Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb112-12"><a href="aplikace3.html#cb112-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb112-13"><a href="aplikace3.html#cb112-13" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb112-14"><a href="aplikace3.html#cb112-14" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb112-15"><a href="aplikace3.html#cb112-15" tabindex="-1"></a>      K[i, j] <span class="ot">&lt;-</span> <span class="fu">Linear.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j])</span>
<span id="cb112-16"><a href="aplikace3.html#cb112-16" tabindex="-1"></a>    }</span>
<span id="cb112-17"><a href="aplikace3.html#cb112-17" tabindex="-1"></a>  }</span>
<span id="cb112-18"><a href="aplikace3.html#cb112-18" tabindex="-1"></a>  <span class="fu">return</span>(K)</span>
<span id="cb112-19"><a href="aplikace3.html#cb112-19" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="aplikace3.html#cb113-1" tabindex="-1"></a><span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb113-2"><a href="aplikace3.html#cb113-2" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb113-3"><a href="aplikace3.html#cb113-3" tabindex="-1"></a><span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb113-4"><a href="aplikace3.html#cb113-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb113-5"><a href="aplikace3.html#cb113-5" tabindex="-1"></a></span>
<span id="cb113-6"><a href="aplikace3.html#cb113-6" tabindex="-1"></a><span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb113-7"><a href="aplikace3.html#cb113-7" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">40</span> <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb113-8"><a href="aplikace3.html#cb113-8" tabindex="-1"></a></span>
<span id="cb113-9"><a href="aplikace3.html#cb113-9" tabindex="-1"></a><span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb113-10"><a href="aplikace3.html#cb113-10" tabindex="-1"></a><span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb113-11"><a href="aplikace3.html#cb113-11" tabindex="-1"></a><span class="co"># ve sloupcich budou hodnoty presnosti pro dane d</span></span>
<span id="cb113-12"><a href="aplikace3.html#cb113-12" tabindex="-1"></a><span class="co"># v radcich budou hodnoty pro vrstvy odpovidaji folds</span></span>
<span id="cb113-13"><a href="aplikace3.html#cb113-13" tabindex="-1"></a>dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb113-14"><a href="aplikace3.html#cb113-14" tabindex="-1"></a>                  <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb113-15"><a href="aplikace3.html#cb113-15" tabindex="-1"></a></span>
<span id="cb113-16"><a href="aplikace3.html#cb113-16" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb113-17"><a href="aplikace3.html#cb113-17" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb113-18"><a href="aplikace3.html#cb113-18" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb113-19"><a href="aplikace3.html#cb113-19" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb113-20"><a href="aplikace3.html#cb113-20" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb113-21"><a href="aplikace3.html#cb113-21" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb113-22"><a href="aplikace3.html#cb113-22" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="aplikace3.html#cb114-1" tabindex="-1"></a><span class="co"># samotna CV</span></span>
<span id="cb114-2"><a href="aplikace3.html#cb114-2" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb114-3"><a href="aplikace3.html#cb114-3" tabindex="-1"></a>Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb114-4"><a href="aplikace3.html#cb114-4" tabindex="-1"></a>eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb114-5"><a href="aplikace3.html#cb114-5" tabindex="-1"></a>eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb114-6"><a href="aplikace3.html#cb114-6" tabindex="-1"></a>alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb114-7"><a href="aplikace3.html#cb114-7" tabindex="-1"></a></span>
<span id="cb114-8"><a href="aplikace3.html#cb114-8" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb114-9"><a href="aplikace3.html#cb114-9" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb114-10"><a href="aplikace3.html#cb114-10" tabindex="-1"></a>  df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb114-11"><a href="aplikace3.html#cb114-11" tabindex="-1"></a>                       <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb114-12"><a href="aplikace3.html#cb114-12" tabindex="-1"></a>  svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb114-13"><a href="aplikace3.html#cb114-13" tabindex="-1"></a>                  <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb114-14"><a href="aplikace3.html#cb114-14" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb114-15"><a href="aplikace3.html#cb114-15" tabindex="-1"></a>                  <span class="at">epsilon =</span> eps,                   </span>
<span id="cb114-16"><a href="aplikace3.html#cb114-16" tabindex="-1"></a>                  <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb114-17"><a href="aplikace3.html#cb114-17" tabindex="-1"></a>                  <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb114-18"><a href="aplikace3.html#cb114-18" tabindex="-1"></a>                  <span class="at">cost =</span> C)</span>
<span id="cb114-19"><a href="aplikace3.html#cb114-19" tabindex="-1"></a>  alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb114-20"><a href="aplikace3.html#cb114-20" tabindex="-1"></a>}</span>
<span id="cb114-21"><a href="aplikace3.html#cb114-21" tabindex="-1"></a></span>
<span id="cb114-22"><a href="aplikace3.html#cb114-22" tabindex="-1"></a><span class="co"># projdeme dimenze</span></span>
<span id="cb114-23"><a href="aplikace3.html#cb114-23" tabindex="-1"></a><span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb114-24"><a href="aplikace3.html#cb114-24" tabindex="-1"></a>  Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb114-25"><a href="aplikace3.html#cb114-25" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb114-26"><a href="aplikace3.html#cb114-26" tabindex="-1"></a>                        <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb114-27"><a href="aplikace3.html#cb114-27" tabindex="-1"></a>  <span class="co"># vypocet reprezentace</span></span>
<span id="cb114-28"><a href="aplikace3.html#cb114-28" tabindex="-1"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb114-29"><a href="aplikace3.html#cb114-29" tabindex="-1"></a>    Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb114-30"><a href="aplikace3.html#cb114-30" tabindex="-1"></a>                           alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb114-31"><a href="aplikace3.html#cb114-31" tabindex="-1"></a>  }</span>
<span id="cb114-32"><a href="aplikace3.html#cb114-32" tabindex="-1"></a>  <span class="co"># projdeme folds</span></span>
<span id="cb114-33"><a href="aplikace3.html#cb114-33" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb114-34"><a href="aplikace3.html#cb114-34" tabindex="-1"></a>    <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb114-35"><a href="aplikace3.html#cb114-35" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb114-36"><a href="aplikace3.html#cb114-36" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb114-37"><a href="aplikace3.html#cb114-37" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb114-38"><a href="aplikace3.html#cb114-38" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb114-39"><a href="aplikace3.html#cb114-39" tabindex="-1"></a>    <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb114-40"><a href="aplikace3.html#cb114-40" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb114-41"><a href="aplikace3.html#cb114-41" tabindex="-1"></a>                                <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb114-42"><a href="aplikace3.html#cb114-42" tabindex="-1"></a>                                <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb114-43"><a href="aplikace3.html#cb114-43" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb114-44"><a href="aplikace3.html#cb114-44" tabindex="-1"></a>    <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb114-45"><a href="aplikace3.html#cb114-45" tabindex="-1"></a>    <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb114-46"><a href="aplikace3.html#cb114-46" tabindex="-1"></a>      kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb114-47"><a href="aplikace3.html#cb114-47" tabindex="-1"></a>    </span>
<span id="cb114-48"><a href="aplikace3.html#cb114-48" tabindex="-1"></a>      data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb114-49"><a href="aplikace3.html#cb114-49" tabindex="-1"></a>      data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb114-50"><a href="aplikace3.html#cb114-50" tabindex="-1"></a>      </span>
<span id="cb114-51"><a href="aplikace3.html#cb114-51" tabindex="-1"></a>      data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb114-52"><a href="aplikace3.html#cb114-52" tabindex="-1"></a>      data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb114-53"><a href="aplikace3.html#cb114-53" tabindex="-1"></a>      </span>
<span id="cb114-54"><a href="aplikace3.html#cb114-54" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb114-55"><a href="aplikace3.html#cb114-55" tabindex="-1"></a>      clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb114-56"><a href="aplikace3.html#cb114-56" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb114-57"><a href="aplikace3.html#cb114-57" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb114-58"><a href="aplikace3.html#cb114-58" tabindex="-1"></a>                          <span class="at">kernel =</span> kernel_type,</span>
<span id="cb114-59"><a href="aplikace3.html#cb114-59" tabindex="-1"></a>                          <span class="at">epsilon =</span> eps,                   </span>
<span id="cb114-60"><a href="aplikace3.html#cb114-60" tabindex="-1"></a>                          <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb114-61"><a href="aplikace3.html#cb114-61" tabindex="-1"></a>                          <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb114-62"><a href="aplikace3.html#cb114-62" tabindex="-1"></a>                          <span class="at">cost =</span> C)</span>
<span id="cb114-63"><a href="aplikace3.html#cb114-63" tabindex="-1"></a>      </span>
<span id="cb114-64"><a href="aplikace3.html#cb114-64" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb114-65"><a href="aplikace3.html#cb114-65" tabindex="-1"></a>      predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb114-66"><a href="aplikace3.html#cb114-66" tabindex="-1"></a>      presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb114-67"><a href="aplikace3.html#cb114-67" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb114-68"><a href="aplikace3.html#cb114-68" tabindex="-1"></a>      </span>
<span id="cb114-69"><a href="aplikace3.html#cb114-69" tabindex="-1"></a>      <span class="co"># ulozeni vysledku</span></span>
<span id="cb114-70"><a href="aplikace3.html#cb114-70" tabindex="-1"></a>      Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb114-71"><a href="aplikace3.html#cb114-71" tabindex="-1"></a>    }</span>
<span id="cb114-72"><a href="aplikace3.html#cb114-72" tabindex="-1"></a>    <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb114-73"><a href="aplikace3.html#cb114-73" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb114-74"><a href="aplikace3.html#cb114-74" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb114-75"><a href="aplikace3.html#cb114-75" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.p[d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb114-76"><a href="aplikace3.html#cb114-76" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb114-77"><a href="aplikace3.html#cb114-77" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.r[d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb114-78"><a href="aplikace3.html#cb114-78" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb114-79"><a href="aplikace3.html#cb114-79" tabindex="-1"></a>  }</span>
<span id="cb114-80"><a href="aplikace3.html#cb114-80" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="aplikace3.html#cb115-1" tabindex="-1"></a><span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb115-2"><a href="aplikace3.html#cb115-2" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb115-3"><a href="aplikace3.html#cb115-3" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb115-4"><a href="aplikace3.html#cb115-4" tabindex="-1"></a>}</span>
<span id="cb115-5"><a href="aplikace3.html#cb115-5" tabindex="-1"></a></span>
<span id="cb115-6"><a href="aplikace3.html#cb115-6" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb115-7"><a href="aplikace3.html#cb115-7" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb115-8"><a href="aplikace3.html#cb115-8" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb115-9"><a href="aplikace3.html#cb115-9" tabindex="-1"></a>d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb115-10"><a href="aplikace3.html#cb115-10" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb115-11"><a href="aplikace3.html#cb115-11" tabindex="-1"></a></span>
<span id="cb115-12"><a href="aplikace3.html#cb115-12" tabindex="-1"></a>err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb115-13"><a href="aplikace3.html#cb115-13" tabindex="-1"></a>                     <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb115-14"><a href="aplikace3.html#cb115-14" tabindex="-1"></a>                     <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb115-15"><a href="aplikace3.html#cb115-15" tabindex="-1"></a>df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb115-16"><a href="aplikace3.html#cb115-16" tabindex="-1"></a>           <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb115-17"><a href="aplikace3.html#cb115-17" tabindex="-1"></a>           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-112">Tabulka 12.6: </span>Souhrnné výsledky cross-validace pro metodu SVM v kombinaci s RKHS na simulovaných datech. <span class="math inline">\(\widehat{Err}_{train}\)</span> značí odhad trénovací chybovosti a <span class="math inline">\(\widehat{Err}_{test}\)</span> testovací chybovosti.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad d\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{cross\_validace}\)</span></th>
<th align="left">Model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>linear</td>
<td align="right">15</td>
<td align="right">0.0667</td>
<td align="left">linear</td>
</tr>
<tr class="even">
<td>poly</td>
<td align="right">16</td>
<td align="right">0.0454</td>
<td align="left">polynomial</td>
</tr>
<tr class="odd">
<td>radial</td>
<td align="right">25</td>
<td align="right">0.0526</td>
<td align="left">radial</td>
</tr>
</tbody>
</table>
<p>Vidíme, že nejlépe vychází hodnota parametru <span class="math inline">\(d={}\)</span> 15 pro lineární jádro s hodnotou chybovosti spočtenou pomocí 10-násobné CV 0.0667, <span class="math inline">\(d={}\)</span> 16 pro polynomiální jádro s hodnotou chybovosti spočtenou pomocí 10-násobné CV 0.0454 a <span class="math inline">\(d={}\)</span> 25 pro radiální jádro s hodnotou chybovosti 0.0526.</p>
<p>Jelikož již máme nalezeny optimální hodnoty hyperparametrů, můžeme zkounstruovat finální modely a určit jejich úspěšnost klasifikace na testovacích datech.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="aplikace3.html#cb116-1" tabindex="-1"></a><span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb116-2"><a href="aplikace3.html#cb116-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb116-3"><a href="aplikace3.html#cb116-3" tabindex="-1"></a><span class="co"># pridame i testovaci data</span></span>
<span id="cb116-4"><a href="aplikace3.html#cb116-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="aplikace3.html#cb117-1" tabindex="-1"></a><span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb117-2"><a href="aplikace3.html#cb117-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - linear&#39;</span>, </span>
<span id="cb117-3"><a href="aplikace3.html#cb117-3" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - RKHS - linear&#39;</span>, </span>
<span id="cb117-4"><a href="aplikace3.html#cb117-4" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - RKHS - linear&#39;</span>), </span>
<span id="cb117-5"><a href="aplikace3.html#cb117-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb117-6"><a href="aplikace3.html#cb117-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb117-7"><a href="aplikace3.html#cb117-7" tabindex="-1"></a></span>
<span id="cb117-8"><a href="aplikace3.html#cb117-8" tabindex="-1"></a><span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb117-9"><a href="aplikace3.html#cb117-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb117-10"><a href="aplikace3.html#cb117-10" tabindex="-1"></a>  <span class="co"># spocitame matici K</span></span>
<span id="cb117-11"><a href="aplikace3.html#cb117-11" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb117-12"><a href="aplikace3.html#cb117-12" tabindex="-1"></a>  </span>
<span id="cb117-13"><a href="aplikace3.html#cb117-13" tabindex="-1"></a>  <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb117-14"><a href="aplikace3.html#cb117-14" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb117-15"><a href="aplikace3.html#cb117-15" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb117-16"><a href="aplikace3.html#cb117-16" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb117-17"><a href="aplikace3.html#cb117-17" tabindex="-1"></a>  <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb117-18"><a href="aplikace3.html#cb117-18" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb117-19"><a href="aplikace3.html#cb117-19" tabindex="-1"></a>                       <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb117-20"><a href="aplikace3.html#cb117-20" tabindex="-1"></a>  </span>
<span id="cb117-21"><a href="aplikace3.html#cb117-21" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb117-22"><a href="aplikace3.html#cb117-22" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb117-23"><a href="aplikace3.html#cb117-23" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb117-24"><a href="aplikace3.html#cb117-24" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb117-25"><a href="aplikace3.html#cb117-25" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb117-26"><a href="aplikace3.html#cb117-26" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb117-27"><a href="aplikace3.html#cb117-27" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb117-28"><a href="aplikace3.html#cb117-28" tabindex="-1"></a>                    <span class="at">epsilon =</span> eps,                   </span>
<span id="cb117-29"><a href="aplikace3.html#cb117-29" tabindex="-1"></a>                    <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb117-30"><a href="aplikace3.html#cb117-30" tabindex="-1"></a>                    <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb117-31"><a href="aplikace3.html#cb117-31" tabindex="-1"></a>                    <span class="at">cost =</span> C)</span>
<span id="cb117-32"><a href="aplikace3.html#cb117-32" tabindex="-1"></a>    <span class="co"># urceni alpha</span></span>
<span id="cb117-33"><a href="aplikace3.html#cb117-33" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb117-34"><a href="aplikace3.html#cb117-34" tabindex="-1"></a>  }</span>
<span id="cb117-35"><a href="aplikace3.html#cb117-35" tabindex="-1"></a>  <span class="co"># d</span></span>
<span id="cb117-36"><a href="aplikace3.html#cb117-36" tabindex="-1"></a>  d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb117-37"><a href="aplikace3.html#cb117-37" tabindex="-1"></a>  </span>
<span id="cb117-38"><a href="aplikace3.html#cb117-38" tabindex="-1"></a>  <span class="co"># urceni vektoru lambda</span></span>
<span id="cb117-39"><a href="aplikace3.html#cb117-39" tabindex="-1"></a>  Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb117-40"><a href="aplikace3.html#cb117-40" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb117-41"><a href="aplikace3.html#cb117-41" tabindex="-1"></a>                        <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb117-42"><a href="aplikace3.html#cb117-42" tabindex="-1"></a>  </span>
<span id="cb117-43"><a href="aplikace3.html#cb117-43" tabindex="-1"></a>  <span class="co"># vypocet reprezentace</span></span>
<span id="cb117-44"><a href="aplikace3.html#cb117-44" tabindex="-1"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb117-45"><a href="aplikace3.html#cb117-45" tabindex="-1"></a>    Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb117-46"><a href="aplikace3.html#cb117-46" tabindex="-1"></a>  }</span>
<span id="cb117-47"><a href="aplikace3.html#cb117-47" tabindex="-1"></a>  </span>
<span id="cb117-48"><a href="aplikace3.html#cb117-48" tabindex="-1"></a>  <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb117-49"><a href="aplikace3.html#cb117-49" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb117-50"><a href="aplikace3.html#cb117-50" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb117-51"><a href="aplikace3.html#cb117-51" tabindex="-1"></a></span>
<span id="cb117-52"><a href="aplikace3.html#cb117-52" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb117-53"><a href="aplikace3.html#cb117-53" tabindex="-1"></a></span>
<span id="cb117-54"><a href="aplikace3.html#cb117-54" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb117-55"><a href="aplikace3.html#cb117-55" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb117-56"><a href="aplikace3.html#cb117-56" tabindex="-1"></a>  </span>
<span id="cb117-57"><a href="aplikace3.html#cb117-57" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb117-58"><a href="aplikace3.html#cb117-58" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb117-59"><a href="aplikace3.html#cb117-59" tabindex="-1"></a>  </span>
<span id="cb117-60"><a href="aplikace3.html#cb117-60" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb117-61"><a href="aplikace3.html#cb117-61" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb117-62"><a href="aplikace3.html#cb117-62" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb117-63"><a href="aplikace3.html#cb117-63" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb117-64"><a href="aplikace3.html#cb117-64" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type,</span>
<span id="cb117-65"><a href="aplikace3.html#cb117-65" tabindex="-1"></a>                      <span class="at">epsilon =</span> eps,                   </span>
<span id="cb117-66"><a href="aplikace3.html#cb117-66" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb117-67"><a href="aplikace3.html#cb117-67" tabindex="-1"></a>                      <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb117-68"><a href="aplikace3.html#cb117-68" tabindex="-1"></a>                      <span class="at">cost =</span> C)</span>
<span id="cb117-69"><a href="aplikace3.html#cb117-69" tabindex="-1"></a>  </span>
<span id="cb117-70"><a href="aplikace3.html#cb117-70" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb117-71"><a href="aplikace3.html#cb117-71" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb117-72"><a href="aplikace3.html#cb117-72" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb117-73"><a href="aplikace3.html#cb117-73" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb117-74"><a href="aplikace3.html#cb117-74" tabindex="-1"></a>    </span>
<span id="cb117-75"><a href="aplikace3.html#cb117-75" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb117-76"><a href="aplikace3.html#cb117-76" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb117-77"><a href="aplikace3.html#cb117-77" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb117-78"><a href="aplikace3.html#cb117-78" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb117-79"><a href="aplikace3.html#cb117-79" tabindex="-1"></a>  </span>
<span id="cb117-80"><a href="aplikace3.html#cb117-80" tabindex="-1"></a>  <span class="co"># ulozeni vysledku</span></span>
<span id="cb117-81"><a href="aplikace3.html#cb117-81" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb117-82"><a href="aplikace3.html#cb117-82" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-115">Tabulka 12.7: </span>Souhrnné výsledky metody SVM v kombinaci s RKHS na simulovaných datech. <span class="math inline">\(\widehat{Err}_{train}\)</span> značí odhad trénovací chybovosti a <span class="math inline">\(\widehat{Err}_{test}\)</span> testovací chybovosti.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS - linear</td>
<td align="center">0.0400</td>
<td align="center">0.0923</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - linear</td>
<td align="center">0.0133</td>
<td align="center">0.0308</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - linear</td>
<td align="center">0.0200</td>
<td align="center">0.0308</td>
</tr>
</tbody>
</table>
<p>Chybovost metody SVM v kombinaci s projekcí na Reproducing Kernel Hilbert Space je tedy na trénovacích datech rovna 4 % pro lineární jádro, 1.33 % pro polynomiální jádro a 2 % pro gaussovské jádro.
Na testovacích datech je potom chybovost metody 9.23 % pro lineární jádro, 3.08 % pro polynomiální jádro a 3.08 % pro radiální jádro.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="aplikace3.html#cb118-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
</div>
</div>
</div>
<div id="tabulka-výsledků-13" class="section level2 hasAnchor" number="12.4">
<h2><span class="header-section-number">12.4</span> Tabulka výsledků<a href="aplikace3.html#tabulka-výsledků-13" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Vidíme z tabulky níže, že jednotlivé klasifikační metody mají mezi sebou výrazné rozdíly co do úspěšnosti klasifikace. Zejména klasické metody, jako je KNN, LDA nebo QDA si vedou velmi bídně. Můžeme si všimnout, že všechny metody postavené na funkcionální analýze hlavních komponent nedosahují zdaleka podobných výsledků jako některé jiné metody.</p>
<p>Naopak nyní se vymyká svou dobrou klasifikační schopností metoda RKHS společně s SVM. Poznamenejme, že také klasická SVM s lineárním jádrem si vede velmi obstojně. Obecně je lineární jádro dobrou volbou (jak jsme se ostatně mohli přesvědčit již dříve), neboť pro dostatečně hustou síť bodů dobře aproximuje určitý integrál na uvažovaném intervalu <span class="math inline">\(I\)</span>.</p>
<table>
<caption><span id="tab:unnamed-chunk-117">Tabulka 12.8: </span>Souhrnné výsledky použitých metod na simulovaných datech. <span class="math inline">\(\widehat{Err}_{train}\)</span> značí odhad trénovací chybovosti a <span class="math inline">\(\widehat{Err}_{test}\)</span> testovací chybovosti.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">KNN</td>
<td align="center">0.1467</td>
<td align="center">0.1692</td>
</tr>
<tr class="even">
<td align="left">LDA</td>
<td align="center">0.3200</td>
<td align="center">0.2923</td>
</tr>
<tr class="odd">
<td align="left">QDA</td>
<td align="center">0.3200</td>
<td align="center">0.3077</td>
</tr>
<tr class="even">
<td align="left">LR functional</td>
<td align="center">0.0000</td>
<td align="center">0.0615</td>
</tr>
<tr class="odd">
<td align="left">LR score</td>
<td align="center">0.3067</td>
<td align="center">0.2923</td>
</tr>
<tr class="even">
<td align="left">Tree - diskr.</td>
<td align="center">0.2933</td>
<td align="center">0.3538</td>
</tr>
<tr class="odd">
<td align="left">Tree - score</td>
<td align="center">0.3267</td>
<td align="center">0.3846</td>
</tr>
<tr class="even">
<td align="left">Tree - Bbasis</td>
<td align="center">0.2267</td>
<td align="center">0.2462</td>
</tr>
<tr class="odd">
<td align="left">RForest - diskr</td>
<td align="center">0.0200</td>
<td align="center">0.1231</td>
</tr>
<tr class="even">
<td align="left">RForest - score</td>
<td align="center">0.0467</td>
<td align="center">0.3077</td>
</tr>
<tr class="odd">
<td align="left">RForest - Bbasis</td>
<td align="center">0.0133</td>
<td align="center">0.1231</td>
</tr>
<tr class="even">
<td align="left">SVM linear - diskr</td>
<td align="center">0.0067</td>
<td align="center">0.0769</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - diskr</td>
<td align="center">0.0133</td>
<td align="center">0.0769</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - diskr</td>
<td align="center">0.0133</td>
<td align="center">0.0462</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - PCA</td>
<td align="center">0.3200</td>
<td align="center">0.2923</td>
</tr>
<tr class="even">
<td align="left">SVM poly - PCA</td>
<td align="center">0.3333</td>
<td align="center">0.2769</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - PCA</td>
<td align="center">0.1600</td>
<td align="center">0.3692</td>
</tr>
<tr class="even">
<td align="left">SVM linear - Bbasis</td>
<td align="center">0.0067</td>
<td align="center">0.0615</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - Bbasis</td>
<td align="center">0.0067</td>
<td align="center">0.0923</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - Bbasis</td>
<td align="center">0.0133</td>
<td align="center">0.0615</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - projection</td>
<td align="center">0.0200</td>
<td align="center">0.0615</td>
</tr>
<tr class="even">
<td align="left">SVM poly - projection</td>
<td align="center">0.0267</td>
<td align="center">0.0615</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - projection</td>
<td align="center">0.0933</td>
<td align="center">0.1077</td>
</tr>
<tr class="even">
<td align="left">SVM linear - RKHS - radial</td>
<td align="center">0.0000</td>
<td align="center">0.0308</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - RKHS - radial</td>
<td align="center">0.0000</td>
<td align="center">0.0308</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - RKHS - radial</td>
<td align="center">0.0000</td>
<td align="center">0.0154</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - RKHS - poly</td>
<td align="center">0.0333</td>
<td align="center">0.0615</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - poly</td>
<td align="center">0.0267</td>
<td align="center">0.1077</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - poly</td>
<td align="center">0.0333</td>
<td align="center">0.1077</td>
</tr>
<tr class="even">
<td align="left">SVM linear - RKHS - linear</td>
<td align="center">0.0400</td>
<td align="center">0.0923</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - RKHS - linear</td>
<td align="center">0.0133</td>
<td align="center">0.0308</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - RKHS - linear</td>
<td align="center">0.0200</td>
<td align="center">0.0308</td>
</tr>
</tbody>
</table>
</div>
<div id="klasA3deriv" class="section level2 hasAnchor" number="12.5">
<h2><span class="header-section-number">12.5</span> Klasifikace pomocí druhé derivace<a href="aplikace3.html#klasA3deriv" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Jak jsme již avizovali dříve, pro tato data je vhodné ke klasifikaci uvažovat jejich druhou derivaci. Tu jsme si již spočetli výše, proto už se nyní můžeme pustit rovnou do konstrukce modelů.</p>
<p>Proveďme obdobnou analýzu jako v situaci výše, následně (jelikož data náhodně rozdělujeme na testovací a trénovací část), provedeme simulační studii, pomocí které budeme jednotlivé klasifikační metody schopni lépe a s mnohem větší silou porovnat.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="aplikace3.html#cb119-1" tabindex="-1"></a><span class="co"># rozdeleni na testovaci a trenovaci cast</span></span>
<span id="cb119-2"><a href="aplikace3.html#cb119-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb119-3"><a href="aplikace3.html#cb119-3" tabindex="-1"></a>split <span class="ot">&lt;-</span> <span class="fu">sample.split</span>(XXder<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb119-4"><a href="aplikace3.html#cb119-4" tabindex="-1"></a></span>
<span id="cb119-5"><a href="aplikace3.html#cb119-5" tabindex="-1"></a><span class="co"># vytvoreni vektoru 0 a 1, 0 pro &lt; 20 a 1 pro &gt; 20 </span></span>
<span id="cb119-6"><a href="aplikace3.html#cb119-6" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(labels <span class="sc">==</span> <span class="st">&#39;large&#39;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb119-7"><a href="aplikace3.html#cb119-7" tabindex="-1"></a></span>
<span id="cb119-8"><a href="aplikace3.html#cb119-8" tabindex="-1"></a>X.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXder, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb119-9"><a href="aplikace3.html#cb119-9" tabindex="-1"></a>X.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXder, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb119-10"><a href="aplikace3.html#cb119-10" tabindex="-1"></a></span>
<span id="cb119-11"><a href="aplikace3.html#cb119-11" tabindex="-1"></a>Y.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb119-12"><a href="aplikace3.html#cb119-12" tabindex="-1"></a>Y.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</details>
<p>Ještě se podíváme na zastoupení jednotlivých skupin v testovací a trénovací části dat.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="aplikace3.html#cb120-1" tabindex="-1"></a><span class="co"># absolutni zastoupeni</span></span>
<span id="cb120-2"><a href="aplikace3.html#cb120-2" tabindex="-1"></a><span class="fu">table</span>(Y.train)</span></code></pre></div>
</details>
<pre><code>## Y.train
##  0  1 
## 91 59</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="aplikace3.html#cb122-1" tabindex="-1"></a><span class="fu">table</span>(Y.test)</span></code></pre></div>
</details>
<pre><code>## Y.test
##  0  1 
## 47 18</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="aplikace3.html#cb124-1" tabindex="-1"></a><span class="co"># relativni zastoupeni</span></span>
<span id="cb124-2"><a href="aplikace3.html#cb124-2" tabindex="-1"></a><span class="fu">table</span>(Y.train) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">table</span>(Y.train))</span></code></pre></div>
</details>
<pre><code>## Y.train
##         0         1 
## 0.6066667 0.3933333</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="aplikace3.html#cb126-1" tabindex="-1"></a><span class="fu">table</span>(Y.test) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">table</span>(Y.test))</span></code></pre></div>
</details>
<pre><code>## Y.test
##         0         1 
## 0.7230769 0.2769231</code></pre>
<div id="k-nejbližších-sousedů-12" class="section level3 hasAnchor" number="12.5.1">
<h3><span class="header-section-number">12.5.1</span> <span class="math inline">\(K\)</span> nejbližších sousedů<a href="aplikace3.html#k-nejbližších-sousedů-12" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Začněme neparametrickou klasifikační metodou, a to metodou <span class="math inline">\(K\)</span> nejbližších sousedů.
Nejprve si vytvoříme potřebné objekty tak, abychom s nimi mohli pomocí funkce <code>classif.knn()</code> z knihovny <code>fda.usc</code> dále pracovat.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="aplikace3.html#cb128-1" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb128-2"><a href="aplikace3.html#cb128-2" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.train))</span></code></pre></div>
</details>
<p>Nyní můžeme definovat model a podívat se na jeho úspěšnost klasifikace.
Poslední otázkou však zůstává, jak volit optimální počet sousedů <span class="math inline">\(K\)</span>.
Mohli bychom tento počet volit jako takové <span class="math inline">\(K\)</span>, při kterém nastává minimální chybovost na trénovacích datech.
To by ale mohlo vést k přeučení modelu, proto využijeme cross-validaci.
Vzhledem k výpočetní náročnosti a rozsahu souboru zvolíme <span class="math inline">\(k\)</span>-násobnou CV, my zvolíme například hodnotu <span class="math inline">\(k = {10}\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="aplikace3.html#cb129-1" tabindex="-1"></a><span class="co"># model pro vsechna trenovaci data pro K = 1, 2, ..., sqrt(n_train)</span></span>
<span id="cb129-2"><a href="aplikace3.html#cb129-2" tabindex="-1"></a>neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, </span>
<span id="cb129-3"><a href="aplikace3.html#cb129-3" tabindex="-1"></a>                            <span class="at">fdataobj =</span> x.train, </span>
<span id="cb129-4"><a href="aplikace3.html#cb129-4" tabindex="-1"></a>                            <span class="at">knn =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">round</span>(<span class="fu">sqrt</span>(<span class="fu">length</span>(y.train))))) </span>
<span id="cb129-5"><a href="aplikace3.html#cb129-5" tabindex="-1"></a></span>
<span id="cb129-6"><a href="aplikace3.html#cb129-6" tabindex="-1"></a>neighb.model<span class="sc">$</span>max.prob <span class="co"># maximalni presnost</span></span></code></pre></div>
</details>
<pre><code>## [1] 0.9866667</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="aplikace3.html#cb131-1" tabindex="-1"></a>(K.opt <span class="ot">&lt;-</span> neighb.model<span class="sc">$</span>h.opt) <span class="co"># optimalni hodnota K</span></span></code></pre></div>
</details>
<pre><code>## [1] 3</code></pre>
<p>Proveďme předchozí postup pro trénovací data, která rozdělíme na <span class="math inline">\(k\)</span> částí a tedy zopakujeme tuto část kódu <span class="math inline">\(k\)</span>-krát.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="aplikace3.html#cb133-1" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb133-2"><a href="aplikace3.html#cb133-2" tabindex="-1"></a>neighbours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">ceiling</span>(<span class="fu">sqrt</span>(<span class="fu">length</span>(y.train))))) <span class="co"># pocet sousedu </span></span>
<span id="cb133-3"><a href="aplikace3.html#cb133-3" tabindex="-1"></a></span>
<span id="cb133-4"><a href="aplikace3.html#cb133-4" tabindex="-1"></a><span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb133-5"><a href="aplikace3.html#cb133-5" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb133-6"><a href="aplikace3.html#cb133-6" tabindex="-1"></a></span>
<span id="cb133-7"><a href="aplikace3.html#cb133-7" tabindex="-1"></a><span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb133-8"><a href="aplikace3.html#cb133-8" tabindex="-1"></a><span class="co"># ve sloupcich budou hodnoty presnosti pro danou cast trenovaci mnoziny</span></span>
<span id="cb133-9"><a href="aplikace3.html#cb133-9" tabindex="-1"></a><span class="co"># v radcich budou hodnoty pro danou hodnotu K sousedu</span></span>
<span id="cb133-10"><a href="aplikace3.html#cb133-10" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(neighbours), <span class="at">ncol =</span> k_cv)</span>
<span id="cb133-11"><a href="aplikace3.html#cb133-11" tabindex="-1"></a></span>
<span id="cb133-12"><a href="aplikace3.html#cb133-12" tabindex="-1"></a><span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb133-13"><a href="aplikace3.html#cb133-13" tabindex="-1"></a>  <span class="co"># definujeme danou indexovou mnozinu</span></span>
<span id="cb133-14"><a href="aplikace3.html#cb133-14" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb133-15"><a href="aplikace3.html#cb133-15" tabindex="-1"></a>    </span>
<span id="cb133-16"><a href="aplikace3.html#cb133-16" tabindex="-1"></a>  x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb133-17"><a href="aplikace3.html#cb133-17" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb133-18"><a href="aplikace3.html#cb133-18" tabindex="-1"></a>  y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb133-19"><a href="aplikace3.html#cb133-19" tabindex="-1"></a>    <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb133-20"><a href="aplikace3.html#cb133-20" tabindex="-1"></a>  </span>
<span id="cb133-21"><a href="aplikace3.html#cb133-21" tabindex="-1"></a>  x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb133-22"><a href="aplikace3.html#cb133-22" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb133-23"><a href="aplikace3.html#cb133-23" tabindex="-1"></a>  y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb133-24"><a href="aplikace3.html#cb133-24" tabindex="-1"></a>    <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb133-25"><a href="aplikace3.html#cb133-25" tabindex="-1"></a>  </span>
<span id="cb133-26"><a href="aplikace3.html#cb133-26" tabindex="-1"></a>  <span class="co"># projdeme kazdou cast ... k-krat zopakujeme</span></span>
<span id="cb133-27"><a href="aplikace3.html#cb133-27" tabindex="-1"></a>  <span class="cf">for</span>(neighbour <span class="cf">in</span> neighbours) {</span>
<span id="cb133-28"><a href="aplikace3.html#cb133-28" tabindex="-1"></a>    <span class="co"># model pro konkretni volbu K</span></span>
<span id="cb133-29"><a href="aplikace3.html#cb133-29" tabindex="-1"></a>    neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train.cv, </span>
<span id="cb133-30"><a href="aplikace3.html#cb133-30" tabindex="-1"></a>                              <span class="at">fdataobj =</span> x.train.cv, </span>
<span id="cb133-31"><a href="aplikace3.html#cb133-31" tabindex="-1"></a>                              <span class="at">knn =</span> neighbour) </span>
<span id="cb133-32"><a href="aplikace3.html#cb133-32" tabindex="-1"></a>    <span class="co"># predikce na validacni casti</span></span>
<span id="cb133-33"><a href="aplikace3.html#cb133-33" tabindex="-1"></a>    model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb133-34"><a href="aplikace3.html#cb133-34" tabindex="-1"></a>                                    <span class="at">new.fdataobj =</span> x.test.cv)</span>
<span id="cb133-35"><a href="aplikace3.html#cb133-35" tabindex="-1"></a>    <span class="co"># presnost na validacni casti</span></span>
<span id="cb133-36"><a href="aplikace3.html#cb133-36" tabindex="-1"></a>    presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, model.neighb.predict) <span class="sc">|&gt;</span> </span>
<span id="cb133-37"><a href="aplikace3.html#cb133-37" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb133-38"><a href="aplikace3.html#cb133-38" tabindex="-1"></a>    </span>
<span id="cb133-39"><a href="aplikace3.html#cb133-39" tabindex="-1"></a>    <span class="co"># presnost vlozime na pozici pro dane K a fold</span></span>
<span id="cb133-40"><a href="aplikace3.html#cb133-40" tabindex="-1"></a>    CV.results[neighbour, index] <span class="ot">&lt;-</span> presnost</span>
<span id="cb133-41"><a href="aplikace3.html#cb133-41" tabindex="-1"></a>  }</span>
<span id="cb133-42"><a href="aplikace3.html#cb133-42" tabindex="-1"></a>}</span>
<span id="cb133-43"><a href="aplikace3.html#cb133-43" tabindex="-1"></a></span>
<span id="cb133-44"><a href="aplikace3.html#cb133-44" tabindex="-1"></a><span class="co"># spocitame prumerne presnosti pro jednotliva K pres folds</span></span>
<span id="cb133-45"><a href="aplikace3.html#cb133-45" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb133-46"><a href="aplikace3.html#cb133-46" tabindex="-1"></a>K.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(CV.results)</span>
<span id="cb133-47"><a href="aplikace3.html#cb133-47" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb133-48"><a href="aplikace3.html#cb133-48" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">K =</span> neighbours, <span class="at">CV =</span> CV.results)</span></code></pre></div>
</details>
<p>Vidíme, že nejlépe vychází hodnota parametru <span class="math inline">\(K\)</span> jako 3 s hodnotou chybovosti spočtenou pomocí 10-násobné CV 0.0103.
Pro přehlednost si ještě vykresleme průběh validační chybovosti v závislosti na počtu sousedů <span class="math inline">\(K\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="aplikace3.html#cb134-1" tabindex="-1"></a>CV.results <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> K, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> CV)) <span class="sc">+</span> </span>
<span id="cb134-2"><a href="aplikace3.html#cb134-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span> </span>
<span id="cb134-3"><a href="aplikace3.html#cb134-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb134-4"><a href="aplikace3.html#cb134-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> K.opt, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv), <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb134-5"><a href="aplikace3.html#cb134-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb134-6"><a href="aplikace3.html#cb134-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(K, <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb134-7"><a href="aplikace3.html#cb134-7" tabindex="-1"></a>                        K[optimal] <span class="sc">==</span> .(K.opt))),</span>
<span id="cb134-8"><a href="aplikace3.html#cb134-8" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Validační chybovost&#39;</span>) <span class="sc">+</span> </span>
<span id="cb134-9"><a href="aplikace3.html#cb134-9" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> neighbours)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-123"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-123-1.png" alt="Závislost validační chybovosti na hodnotě $K$, tedy na počtu sousedů." width="672" />
<p class="caption">
Obrázek 12.23: Závislost validační chybovosti na hodnotě <span class="math inline">\(K\)</span>, tedy na počtu sousedů.
</p>
</div>
<p>Nyní známe optimální hodnotu parametru <span class="math inline">\(K\)</span> a tudíž můžeme sestavit finální model.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="aplikace3.html#cb135-1" tabindex="-1"></a>neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, <span class="at">fdataobj =</span> x.train, <span class="at">knn =</span> K.opt)</span>
<span id="cb135-2"><a href="aplikace3.html#cb135-2" tabindex="-1"></a></span>
<span id="cb135-3"><a href="aplikace3.html#cb135-3" tabindex="-1"></a><span class="co"># predikce</span></span>
<span id="cb135-4"><a href="aplikace3.html#cb135-4" tabindex="-1"></a>model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb135-5"><a href="aplikace3.html#cb135-5" tabindex="-1"></a>                                <span class="at">new.fdataobj =</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb135-6"><a href="aplikace3.html#cb135-6" tabindex="-1"></a></span>
<span id="cb135-7"><a href="aplikace3.html#cb135-7" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb135-8"><a href="aplikace3.html#cb135-8" tabindex="-1"></a>presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.test)), model.neighb.predict) <span class="sc">|&gt;</span></span>
<span id="cb135-9"><a href="aplikace3.html#cb135-9" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span></span>
<span id="cb135-10"><a href="aplikace3.html#cb135-10" tabindex="-1"></a>  <span class="fu">diag</span>() <span class="sc">|&gt;</span></span>
<span id="cb135-11"><a href="aplikace3.html#cb135-11" tabindex="-1"></a>  <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Vidíme tedy, že chybovost modelu sestrojeného pomocí metody <span class="math inline">\(K\)</span> nejbližších sousedů s optimální volbou <span class="math inline">\(K_{optimal}\)</span> rovnou 3, kterou jsme určili cross-validací, je na trénovacích datech rovna 0.0133 a na testovacích datech 0.0769.</p>
<p>K porovnání jendotlivých modelů můžeme použít oba typy chybovostí, pro přehlednost si je budeme ukládat do tabulky.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="aplikace3.html#cb136-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;KNN&#39;</span>, </span>
<span id="cb136-2"><a href="aplikace3.html#cb136-2" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> neighb.model<span class="sc">$</span>max.prob,</span>
<span id="cb136-3"><a href="aplikace3.html#cb136-3" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost)</span></code></pre></div>
</details>
</div>
<div id="lineární-diskriminační-analýza-13" class="section level3 hasAnchor" number="12.5.2">
<h3><span class="header-section-number">12.5.2</span> Lineární diskriminační analýza<a href="aplikace3.html#lineární-diskriminační-analýza-13" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Jako druhou metodu pro sestrojení klasifikátoru budeme uvažovat lineární diskriminační analýzu (LDA).
Jelikož tato metoda nelze aplikovat na funkcionální data, musíme je nejprve diskretizovat, což provedeme pomocí funkcionální analýzy hlavních komponent.
Klasifikační algoritmus následně provedeme na skórech prvních <span class="math inline">\(p\)</span> hlavních komponent.
Počet komponent <span class="math inline">\(p\)</span> zvolíme tak, aby prvních <span class="math inline">\(p\)</span> hlavních komponent dohromady vysvětlovalo alespoň 90 % variability v datech.</p>
<p>Proveďme tedy nejprve funkcionální analýzu hlavních komponent a určeme počet <span class="math inline">\(p\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="aplikace3.html#cb137-1" tabindex="-1"></a><span class="co"># analyza hlavnich komponent</span></span>
<span id="cb137-2"><a href="aplikace3.html#cb137-2" tabindex="-1"></a>data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> <span class="dv">10</span>) <span class="co"># nharm - maximalni pocet HK</span></span>
<span id="cb137-3"><a href="aplikace3.html#cb137-3" tabindex="-1"></a>nharm <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">cumsum</span>(data.PCA<span class="sc">$</span>varprop) <span class="sc">&gt;=</span> <span class="fl">0.9</span>)[<span class="dv">1</span>] <span class="co"># urceni p</span></span>
<span id="cb137-4"><a href="aplikace3.html#cb137-4" tabindex="-1"></a><span class="cf">if</span>(nharm <span class="sc">==</span> <span class="dv">1</span>) nharm <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># aby bylo mozne vykreslovat grafy,</span></span>
<span id="cb137-5"><a href="aplikace3.html#cb137-5" tabindex="-1"></a><span class="co"># potrebujeme alespon 2 HK</span></span>
<span id="cb137-6"><a href="aplikace3.html#cb137-6" tabindex="-1"></a></span>
<span id="cb137-7"><a href="aplikace3.html#cb137-7" tabindex="-1"></a>data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> nharm) </span>
<span id="cb137-8"><a href="aplikace3.html#cb137-8" tabindex="-1"></a>data.PCA.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA<span class="sc">$</span>scores) <span class="co"># skore prvnich p HK</span></span>
<span id="cb137-9"><a href="aplikace3.html#cb137-9" tabindex="-1"></a>data.PCA.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train) <span class="co"># prislusnost do trid</span></span></code></pre></div>
</details>
<p>V tomto konkrétním případě jsme za počet hlavních komponent vzali <span class="math inline">\(p=\)</span> 2, které dohromady vysvětlují 93.12 <span class="math inline">\(\%\)</span> variability v datech.
První hlavní komponenta potom vysvětluje 77.7 % a druhá 15.42 <span class="math inline">\(\%\)</span> variability.
Graficky si můžeme zobrazit hodnoty skórů prvních dvou hlavních komponent, barevně odlišených podle příslušnosti do klasifikační třídy.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="aplikace3.html#cb138-1" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb138-2"><a href="aplikace3.html#cb138-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb138-3"><a href="aplikace3.html#cb138-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1. hlavní komponenta (vysvětlená variabilita&#39;</span>, </span>
<span id="cb138-4"><a href="aplikace3.html#cb138-4" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb138-5"><a href="aplikace3.html#cb138-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2. hlavní komponenta (&#39;</span>, </span>
<span id="cb138-6"><a href="aplikace3.html#cb138-6" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb138-7"><a href="aplikace3.html#cb138-7" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Obsah tuku&#39;</span>) <span class="sc">+</span></span>
<span id="cb138-8"><a href="aplikace3.html#cb138-8" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;malý&quot;</span>, <span class="st">&quot;velký&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb138-9"><a href="aplikace3.html#cb138-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-127"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-127-1.png" alt="Hodnoty skórů prvních dvou hlavních komponent pro trénovací data. Barevně jsou odlišeny body podle příslušnosti do klasifikační třídy." width="672" />
<p class="caption">
Obrázek 12.24: Hodnoty skórů prvních dvou hlavních komponent pro trénovací data. Barevně jsou odlišeny body podle příslušnosti do klasifikační třídy.
</p>
</div>
<p>Abychom mohli určit přesnost klasifikace na testovacích datech, potřebujeme spočítat skóre pro první 2 hlavní komponenty pro testovací data.
Tato skóre určíme pomocí vzorce:</p>
<p><span class="math display">\[
\xi_{i, j} = \int \left( X_i(t) - \mu(t)\right) \cdot \rho_j(t)\text dt,
\]</span>
kde <span class="math inline">\(\mu(t)\)</span> je střední hodnota (průměrná funkce) a <span class="math inline">\(\rho_j(t)\)</span> vlastní fukce (funkcionální hlavní komponenty).</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="aplikace3.html#cb139-1" tabindex="-1"></a><span class="co"># vypocet skoru testovacich funkci</span></span>
<span id="cb139-2"><a href="aplikace3.html#cb139-2" tabindex="-1"></a>scores <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> nharm, <span class="at">nrow =</span> <span class="fu">length</span>(Y.test)) <span class="co"># prazdna matice</span></span>
<span id="cb139-3"><a href="aplikace3.html#cb139-3" tabindex="-1"></a></span>
<span id="cb139-4"><a href="aplikace3.html#cb139-4" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(scores)[<span class="dv">1</span>]) {</span>
<span id="cb139-5"><a href="aplikace3.html#cb139-5" tabindex="-1"></a>  xfd <span class="ot">=</span> X.test[k] <span class="sc">-</span> data.PCA<span class="sc">$</span>meanfd[<span class="dv">1</span>] <span class="co"># k-te pozorovani - prumerna funkce</span></span>
<span id="cb139-6"><a href="aplikace3.html#cb139-6" tabindex="-1"></a>  scores[k, ] <span class="ot">=</span> <span class="fu">inprod</span>(xfd, data.PCA<span class="sc">$</span>harmonics) </span>
<span id="cb139-7"><a href="aplikace3.html#cb139-7" tabindex="-1"></a>  <span class="co"># skalarni soucin rezidua a vlastnich funkci rho (funkcionalni hlavni komponenty)</span></span>
<span id="cb139-8"><a href="aplikace3.html#cb139-8" tabindex="-1"></a>}</span>
<span id="cb139-9"><a href="aplikace3.html#cb139-9" tabindex="-1"></a></span>
<span id="cb139-10"><a href="aplikace3.html#cb139-10" tabindex="-1"></a>data.PCA.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(scores)</span>
<span id="cb139-11"><a href="aplikace3.html#cb139-11" tabindex="-1"></a>data.PCA.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb139-12"><a href="aplikace3.html#cb139-12" tabindex="-1"></a><span class="fu">colnames</span>(data.PCA.test) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data.PCA.train) </span></code></pre></div>
</details>
<p>Nyní již můžeme sestrojit klasifikátor na trénovací části dat.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="aplikace3.html#cb140-1" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb140-2"><a href="aplikace3.html#cb140-2" tabindex="-1"></a>clf.LDA <span class="ot">&lt;-</span> <span class="fu">lda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb140-3"><a href="aplikace3.html#cb140-3" tabindex="-1"></a></span>
<span id="cb140-4"><a href="aplikace3.html#cb140-4" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb140-5"><a href="aplikace3.html#cb140-5" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb140-6"><a href="aplikace3.html#cb140-6" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb140-7"><a href="aplikace3.html#cb140-7" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb140-8"><a href="aplikace3.html#cb140-8" tabindex="-1"></a>  </span>
<span id="cb140-9"><a href="aplikace3.html#cb140-9" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb140-10"><a href="aplikace3.html#cb140-10" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb140-11"><a href="aplikace3.html#cb140-11" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb140-12"><a href="aplikace3.html#cb140-12" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Spočítali jsme jednak chybovost klasifikátoru na trénovacích (4 %), tak i na testovacích datech (9.23 %).</p>
<p>Pro grafické znázornění metody můžeme zaznačit dělící hranici do grafu skórů prvních dvou hlavních komponent.
Tuto hranici spočítáme na husté síti bodů a zobrazíme ji pomocí funkce <code>geom_contour()</code>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="aplikace3.html#cb141-1" tabindex="-1"></a><span class="co"># pridame diskriminacni hranici</span></span>
<span id="cb141-2"><a href="aplikace3.html#cb141-2" tabindex="-1"></a>np <span class="ot">&lt;-</span> <span class="dv">1001</span> <span class="co"># pocet bodu site</span></span>
<span id="cb141-3"><a href="aplikace3.html#cb141-3" tabindex="-1"></a><span class="co"># x-ova osa ... 1. HK</span></span>
<span id="cb141-4"><a href="aplikace3.html#cb141-4" tabindex="-1"></a>nd.x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(data.PCA.train<span class="sc">$</span>V1), </span>
<span id="cb141-5"><a href="aplikace3.html#cb141-5" tabindex="-1"></a>            <span class="at">to =</span> <span class="fu">max</span>(data.PCA.train<span class="sc">$</span>V1), <span class="at">length.out =</span> np)</span>
<span id="cb141-6"><a href="aplikace3.html#cb141-6" tabindex="-1"></a><span class="co"># y-ova osa ... 2. HK</span></span>
<span id="cb141-7"><a href="aplikace3.html#cb141-7" tabindex="-1"></a>nd.y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(data.PCA.train<span class="sc">$</span>V2), </span>
<span id="cb141-8"><a href="aplikace3.html#cb141-8" tabindex="-1"></a>            <span class="at">to =</span> <span class="fu">max</span>(data.PCA.train<span class="sc">$</span>V2), <span class="at">length.out =</span> np)</span>
<span id="cb141-9"><a href="aplikace3.html#cb141-9" tabindex="-1"></a><span class="co"># pripad pro 2 HK ... p = 2</span></span>
<span id="cb141-10"><a href="aplikace3.html#cb141-10" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y)</span>
<span id="cb141-11"><a href="aplikace3.html#cb141-11" tabindex="-1"></a><span class="co"># pokud p = 3</span></span>
<span id="cb141-12"><a href="aplikace3.html#cb141-12" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(data.PCA.train)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">4</span>) {</span>
<span id="cb141-13"><a href="aplikace3.html#cb141-13" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y, <span class="at">V3 =</span> data.PCA.train<span class="sc">$</span>V3[<span class="dv">1</span>])}</span>
<span id="cb141-14"><a href="aplikace3.html#cb141-14" tabindex="-1"></a><span class="co"># pokud p = 4</span></span>
<span id="cb141-15"><a href="aplikace3.html#cb141-15" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(data.PCA.train)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">5</span>) {</span>
<span id="cb141-16"><a href="aplikace3.html#cb141-16" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y, <span class="at">V3 =</span> data.PCA.train<span class="sc">$</span>V3[<span class="dv">1</span>],</span>
<span id="cb141-17"><a href="aplikace3.html#cb141-17" tabindex="-1"></a>                    <span class="at">V4 =</span> data.PCA.train<span class="sc">$</span>V4[<span class="dv">1</span>])}</span>
<span id="cb141-18"><a href="aplikace3.html#cb141-18" tabindex="-1"></a><span class="co"># pokud p = 5</span></span>
<span id="cb141-19"><a href="aplikace3.html#cb141-19" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(data.PCA.train)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">6</span>) {</span>
<span id="cb141-20"><a href="aplikace3.html#cb141-20" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y, <span class="at">V3 =</span> data.PCA.train<span class="sc">$</span>V3[<span class="dv">1</span>],</span>
<span id="cb141-21"><a href="aplikace3.html#cb141-21" tabindex="-1"></a>                    <span class="at">V4 =</span> data.PCA.train<span class="sc">$</span>V4[<span class="dv">1</span>], <span class="at">V5 =</span> data.PCA.train<span class="sc">$</span>V5[<span class="dv">1</span>])}</span>
<span id="cb141-22"><a href="aplikace3.html#cb141-22" tabindex="-1"></a></span>
<span id="cb141-23"><a href="aplikace3.html#cb141-23" tabindex="-1"></a><span class="co"># pridame Y = 0, 1</span></span>
<span id="cb141-24"><a href="aplikace3.html#cb141-24" tabindex="-1"></a>nd <span class="ot">&lt;-</span> nd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">prd =</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> nd)<span class="sc">$</span>class))</span>
<span id="cb141-25"><a href="aplikace3.html#cb141-25" tabindex="-1"></a></span>
<span id="cb141-26"><a href="aplikace3.html#cb141-26" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb141-27"><a href="aplikace3.html#cb141-27" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb141-28"><a href="aplikace3.html#cb141-28" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1. hlavní komponenta (vysvětlená variabilita&#39;</span>, </span>
<span id="cb141-29"><a href="aplikace3.html#cb141-29" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb141-30"><a href="aplikace3.html#cb141-30" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2. hlavní komponenta (&#39;</span>, </span>
<span id="cb141-31"><a href="aplikace3.html#cb141-31" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb141-32"><a href="aplikace3.html#cb141-32" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Obsah tuku&#39;</span>) <span class="sc">+</span></span>
<span id="cb141-33"><a href="aplikace3.html#cb141-33" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;malý&quot;</span>, <span class="st">&quot;velký&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb141-34"><a href="aplikace3.html#cb141-34" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb141-35"><a href="aplikace3.html#cb141-35" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-130"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-130-1.png" alt="Skóre prvních dvou hlavních komponent, barevně odlišené podle klasifikační třídy. Černě je vyznačena dělící hranice (přímka v rovině prvních dvou hlavních komponent) mezi třídami sestrojená pomocí LDA." width="672" />
<p class="caption">
Obrázek 12.25: Skóre prvních dvou hlavních komponent, barevně odlišené podle klasifikační třídy. Černě je vyznačena dělící hranice (přímka v rovině prvních dvou hlavních komponent) mezi třídami sestrojená pomocí LDA.
</p>
</div>
<p>Vidíme, že dělící hranicí je přímka, lineární funkce v prostoru 2D, což jsme ostatně od LDA čekali.
Nakonec přidáme chybovosti do souhrnné tabulky.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="aplikace3.html#cb142-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LDA&#39;</span>, </span>
<span id="cb142-2"><a href="aplikace3.html#cb142-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb142-3"><a href="aplikace3.html#cb142-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb142-4"><a href="aplikace3.html#cb142-4" tabindex="-1"></a></span>
<span id="cb142-5"><a href="aplikace3.html#cb142-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="kvadratická-diskriminační-analýza-12" class="section level3 hasAnchor" number="12.5.3">
<h3><span class="header-section-number">12.5.3</span> Kvadratická diskriminační analýza<a href="aplikace3.html#kvadratická-diskriminační-analýza-12" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Jako další sestrojme klasifikátor pomocí kvadratické diskriminační analýzy (QDA).
Jedná se o analogický případ jako LDA s tím rozdílem, že nyní připouštíme pro každou ze tříd rozdílnou kovarianční matici normálního rozdělení, ze kterého pocházejí příslušné skóry.
Tento vypuštěný předpoklad o rovnosti kovariančních matic vede ke kvadratické hranici mezi třídami.</p>
<p>V <code>R</code> se provede QDA analogicky jako LDA v předchozí části, tedy opět bychom pomocí funkcionální analýzy hlavních komponent spočítali skóre pro trénovací i testovací funkce, sestrojili klasifikátor na skórech prvních <span class="math inline">\(p\)</span> hlavních komponent a pomocí něj predikovali příslušnost testovacích křivek do třídy <span class="math inline">\(Y^* \in \{0, 1\}\)</span>.</p>
<p>Funkcionální PCA provádět nemusíme, využijeme výsledků z části LDA.</p>
<p>Můžeme tedy rovnou přistoupit k sestrojení klasifikátoru, což provedeme pomocí funkce <code>qda()</code>.
Následně spočítáme přesnost klasifikátoru na testovacích a trénovacích datech.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="aplikace3.html#cb143-1" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb143-2"><a href="aplikace3.html#cb143-2" tabindex="-1"></a>clf.QDA <span class="ot">&lt;-</span> <span class="fu">qda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb143-3"><a href="aplikace3.html#cb143-3" tabindex="-1"></a></span>
<span id="cb143-4"><a href="aplikace3.html#cb143-4" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb143-5"><a href="aplikace3.html#cb143-5" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb143-6"><a href="aplikace3.html#cb143-6" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb143-7"><a href="aplikace3.html#cb143-7" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb143-8"><a href="aplikace3.html#cb143-8" tabindex="-1"></a>  </span>
<span id="cb143-9"><a href="aplikace3.html#cb143-9" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb143-10"><a href="aplikace3.html#cb143-10" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb143-11"><a href="aplikace3.html#cb143-11" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb143-12"><a href="aplikace3.html#cb143-12" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Spočítali jsme tedy jednak chybovost klasifikátoru na trénovacích (0.67 %), tak i na testovacích datech (1.54 %).</p>
<p>Pro grafické znázornění metody můžeme zaznačit dělící hranici do grafu skórů prvních dvou hlavních komponent.
Tuto hranici spočítáme na husté síti bodů a zobrazíme ji pomocí funkce <code>geom_contour()</code> stejně jako v případě LDA.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="aplikace3.html#cb144-1" tabindex="-1"></a>nd <span class="ot">&lt;-</span> nd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">prd =</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> nd)<span class="sc">$</span>class))</span>
<span id="cb144-2"><a href="aplikace3.html#cb144-2" tabindex="-1"></a></span>
<span id="cb144-3"><a href="aplikace3.html#cb144-3" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb144-4"><a href="aplikace3.html#cb144-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb144-5"><a href="aplikace3.html#cb144-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1. hlavní komponenta (vysvětlená variabilita&#39;</span>, </span>
<span id="cb144-6"><a href="aplikace3.html#cb144-6" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb144-7"><a href="aplikace3.html#cb144-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2. hlavní komponenta (&#39;</span>, </span>
<span id="cb144-8"><a href="aplikace3.html#cb144-8" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb144-9"><a href="aplikace3.html#cb144-9" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Obsah tuku&#39;</span>) <span class="sc">+</span></span>
<span id="cb144-10"><a href="aplikace3.html#cb144-10" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;malý&quot;</span>, <span class="st">&quot;velký&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb144-11"><a href="aplikace3.html#cb144-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb144-12"><a href="aplikace3.html#cb144-12" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-136"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-136-1.png" alt="Skóre prvních dvou hlavních komponent, barevně odlišené podle třídy. Černě je vyznačena dělící hranice (parabola v rovině prvních dvou hlavních komponent) mezi třídami sestrojená pomocí QDA." width="672" />
<p class="caption">
Obrázek 12.26: Skóre prvních dvou hlavních komponent, barevně odlišené podle třídy. Černě je vyznačena dělící hranice (parabola v rovině prvních dvou hlavních komponent) mezi třídami sestrojená pomocí QDA.
</p>
</div>
<p>Všimněme si, že dělící hranicí mezi klasifikačními třídami je nyní parabola, avšak se jen (alespoň opticky) velmi málo liší od přímky.</p>
<p>Nakonec ještě doplníme chybovosti do souhrnné tabulky.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="aplikace3.html#cb145-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;QDA&#39;</span>, </span>
<span id="cb145-2"><a href="aplikace3.html#cb145-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb145-3"><a href="aplikace3.html#cb145-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb145-4"><a href="aplikace3.html#cb145-4" tabindex="-1"></a></span>
<span id="cb145-5"><a href="aplikace3.html#cb145-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="logistická-regrese-11" class="section level3 hasAnchor" number="12.5.4">
<h3><span class="header-section-number">12.5.4</span> Logistická regrese<a href="aplikace3.html#logistická-regrese-11" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Logistickou regresi můžeme provést dvěma způsoby.
Jednak použít funkcionální obdobu klasické logistické regrese, druhak klasickou mnohorozměrnou logistickou regresi, kterou provedeme na skórech prvních <span class="math inline">\(p\)</span> hlavních komponent.</p>
<div id="funkcionální-logistická-regrese-10" class="section level4 hasAnchor" number="12.5.4.1">
<h4><span class="header-section-number">12.5.4.1</span> Funkcionální logistická regrese<a href="aplikace3.html#funkcionální-logistická-regrese-10" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Analogicky jako v případě konečné dimenze vstupních dat uvažujeme logistický model ve tvaru:</p>
<p><span class="math display">\[
g\left(\mathbb E [Y|X = x]\right) = \eta (x) = g(\pi(x)) = \alpha + \int \beta(t)\cdot x(t) \text d t,
\]</span>
kde <span class="math inline">\(\eta(x)\)</span> je lineární prediktor nabývající hodnot z intervalu <span class="math inline">\((-\infty, \infty)\)</span>, <span class="math inline">\(g(\cdot)\)</span> je <em>linková funkce</em>, v případě logistické regrese se jedná o logitovou funkci <span class="math inline">\(g: (0,1) \rightarrow \mathbb R,\ g(p) = \ln\frac{p}{1-p}\)</span> a <span class="math inline">\(\pi(x)\)</span> podmíněná pravděpodobnost</p>
<p><span class="math display">\[
\pi(x) = \text{Pr}(Y = 1 | X = x) = g^{-1}(\eta(x)) = \frac{\text e^{\alpha + \int \beta(t)\cdot x(t) \text d t}}{1 + \text e^{\alpha + \int \beta(t)\cdot x(t) \text d t}},
\]</span></p>
<p>přičemž <span class="math inline">\(\alpha\)</span> je konstanta a <span class="math inline">\(\beta(t) \in L^2[a, b]\)</span> je parametrická funkce.
Naším cílem je odhadnout tuto parametrickou funkci.</p>
<p>Pro funkcionální logistickou regresi použijeme funkci <code>fregre.glm()</code> z balíčku <code>fda.usc</code>.
Nejprve si vytvoříme vhodné objekty pro konstrukci klasifikátoru.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="aplikace3.html#cb146-1" tabindex="-1"></a><span class="co"># vytvorime vhodne objekty</span></span>
<span id="cb146-2"><a href="aplikace3.html#cb146-2" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb146-3"><a href="aplikace3.html#cb146-3" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Y.train) </span>
<span id="cb146-4"><a href="aplikace3.html#cb146-4" tabindex="-1"></a></span>
<span id="cb146-5"><a href="aplikace3.html#cb146-5" tabindex="-1"></a><span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb146-6"><a href="aplikace3.html#cb146-6" tabindex="-1"></a>tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb146-7"><a href="aplikace3.html#cb146-7" tabindex="-1"></a></span>
<span id="cb146-8"><a href="aplikace3.html#cb146-8" tabindex="-1"></a>dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb146-9"><a href="aplikace3.html#cb146-9" tabindex="-1"></a><span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb146-10"><a href="aplikace3.html#cb146-10" tabindex="-1"></a></span>
<span id="cb146-11"><a href="aplikace3.html#cb146-11" tabindex="-1"></a>nbasis.x <span class="ot">&lt;-</span> <span class="dv">7</span></span>
<span id="cb146-12"><a href="aplikace3.html#cb146-12" tabindex="-1"></a></span>
<span id="cb146-13"><a href="aplikace3.html#cb146-13" tabindex="-1"></a><span class="co"># B-spline baze </span></span>
<span id="cb146-14"><a href="aplikace3.html#cb146-14" tabindex="-1"></a>basis1 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> nbasis.x)</span></code></pre></div>
</details>
<p>Abychom mohli odhadnout parametrickou funkci <span class="math inline">\(\beta(t)\)</span>, potřebujeme ji vyjádřit v nějaké bazické reprezentaci, v našem případě B-splinové bázi.
K tomu však potřebujeme najít vhodný počet bázových funkcí.
To bychom mohli určit na základě chybovosti na trénovacích datech, avšak tato data budou upřenostňovat výběr velkého počtu bází a bude docházet k přeučení modelu.</p>
<p>Ilustrujme si to na následujícím případě.
Pro každý z počtu bází <span class="math inline">\(n_{basis} \in \{4, 5, \dots, 30\}\)</span> natrénujeme model na trénovacích datech, určíme na nich chybovost a také spočítáme chybovost na testovacích datech.
Připomeňme, že k výběru vhodného počtu bází nemůžeme využít stejná data jako pro odhad testovací chybovosti, neboť bychom tuto chybovost podcenili.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="aplikace3.html#cb147-1" tabindex="-1"></a>n.basis.max <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb147-2"><a href="aplikace3.html#cb147-2" tabindex="-1"></a>n.basis <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span>n.basis.max</span>
<span id="cb147-3"><a href="aplikace3.html#cb147-3" tabindex="-1"></a>pred.baz <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(n.basis), <span class="at">ncol =</span> <span class="dv">2</span>, </span>
<span id="cb147-4"><a href="aplikace3.html#cb147-4" tabindex="-1"></a>                   <span class="at">dimnames =</span> <span class="fu">list</span>(n.basis, <span class="fu">c</span>(<span class="st">&#39;Err.train&#39;</span>, <span class="st">&#39;Err.test&#39;</span>)))</span>
<span id="cb147-5"><a href="aplikace3.html#cb147-5" tabindex="-1"></a></span>
<span id="cb147-6"><a href="aplikace3.html#cb147-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> n.basis) {</span>
<span id="cb147-7"><a href="aplikace3.html#cb147-7" tabindex="-1"></a>  <span class="co"># baze pro bety</span></span>
<span id="cb147-8"><a href="aplikace3.html#cb147-8" tabindex="-1"></a>  basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> i)</span>
<span id="cb147-9"><a href="aplikace3.html#cb147-9" tabindex="-1"></a>  <span class="co"># vztah</span></span>
<span id="cb147-10"><a href="aplikace3.html#cb147-10" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb147-11"><a href="aplikace3.html#cb147-11" tabindex="-1"></a>  <span class="co"># baze pro x a bety</span></span>
<span id="cb147-12"><a href="aplikace3.html#cb147-12" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) <span class="co"># vyhlazene data</span></span>
<span id="cb147-13"><a href="aplikace3.html#cb147-13" tabindex="-1"></a>  basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb147-14"><a href="aplikace3.html#cb147-14" tabindex="-1"></a>  <span class="co"># vstupni data do modelu</span></span>
<span id="cb147-15"><a href="aplikace3.html#cb147-15" tabindex="-1"></a>  ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb147-16"><a href="aplikace3.html#cb147-16" tabindex="-1"></a>  <span class="co"># binomicky model ... model logisticke regrese</span></span>
<span id="cb147-17"><a href="aplikace3.html#cb147-17" tabindex="-1"></a>  model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb147-18"><a href="aplikace3.html#cb147-18" tabindex="-1"></a>                          <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb147-19"><a href="aplikace3.html#cb147-19" tabindex="-1"></a>  </span>
<span id="cb147-20"><a href="aplikace3.html#cb147-20" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb147-21"><a href="aplikace3.html#cb147-21" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> ldata)</span>
<span id="cb147-22"><a href="aplikace3.html#cb147-22" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb147-23"><a href="aplikace3.html#cb147-23" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb147-24"><a href="aplikace3.html#cb147-24" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb147-25"><a href="aplikace3.html#cb147-25" tabindex="-1"></a>    </span>
<span id="cb147-26"><a href="aplikace3.html#cb147-26" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb147-27"><a href="aplikace3.html#cb147-27" tabindex="-1"></a>  newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(Y.test), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb147-28"><a href="aplikace3.html#cb147-28" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb147-29"><a href="aplikace3.html#cb147-29" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb147-30"><a href="aplikace3.html#cb147-30" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb147-31"><a href="aplikace3.html#cb147-31" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb147-32"><a href="aplikace3.html#cb147-32" tabindex="-1"></a>  </span>
<span id="cb147-33"><a href="aplikace3.html#cb147-33" tabindex="-1"></a>  <span class="co"># vlozime do matice</span></span>
<span id="cb147-34"><a href="aplikace3.html#cb147-34" tabindex="-1"></a>  pred.baz[<span class="fu">as.character</span>(i), ] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb147-35"><a href="aplikace3.html#cb147-35" tabindex="-1"></a>} </span>
<span id="cb147-36"><a href="aplikace3.html#cb147-36" tabindex="-1"></a></span>
<span id="cb147-37"><a href="aplikace3.html#cb147-37" tabindex="-1"></a>pred.baz <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred.baz)</span>
<span id="cb147-38"><a href="aplikace3.html#cb147-38" tabindex="-1"></a>pred.baz<span class="sc">$</span>n.basis <span class="ot">&lt;-</span> n.basis</span></code></pre></div>
</details>
<p>Znázorněme si průběh obou typů chybovostí v grafu v závislosti na počtu bazických funkcí.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="aplikace3.html#cb148-1" tabindex="-1"></a>n.basis.beta.opt <span class="ot">&lt;-</span> pred.baz<span class="sc">$</span>n.basis[<span class="fu">which.min</span>(pred.baz<span class="sc">$</span>Err.test)]</span>
<span id="cb148-2"><a href="aplikace3.html#cb148-2" tabindex="-1"></a></span>
<span id="cb148-3"><a href="aplikace3.html#cb148-3" tabindex="-1"></a>pred.baz <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> Err.test)) <span class="sc">+</span> </span>
<span id="cb148-4"><a href="aplikace3.html#cb148-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb148-5"><a href="aplikace3.html#cb148-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> Err.train), <span class="at">colour =</span> <span class="st">&#39;deepskyblue3&#39;</span>, </span>
<span id="cb148-6"><a href="aplikace3.html#cb148-6" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb148-7"><a href="aplikace3.html#cb148-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb148-8"><a href="aplikace3.html#cb148-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> Err.train), <span class="at">colour =</span> <span class="st">&#39;deepskyblue3&#39;</span>, </span>
<span id="cb148-9"><a href="aplikace3.html#cb148-9" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb148-10"><a href="aplikace3.html#cb148-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis.beta.opt, <span class="at">y =</span> <span class="fu">min</span>(pred.baz<span class="sc">$</span>Err.test)),</span>
<span id="cb148-11"><a href="aplikace3.html#cb148-11" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb148-12"><a href="aplikace3.html#cb148-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb148-13"><a href="aplikace3.html#cb148-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(n[basis], <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb148-14"><a href="aplikace3.html#cb148-14" tabindex="-1"></a>                        n[optimal] <span class="sc">==</span> .(n.basis.beta.opt))),</span>
<span id="cb148-15"><a href="aplikace3.html#cb148-15" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">&#39;Chybovost&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-140"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-140-1.png" alt="Závislost testovací a trénovací chybovosti na počtu bázových funkcí pro $\beta$. Červeným bodem je znázorněn optimální počet $n_{optimal}$ zvolený jako minimum testovací chybovosti, černou čarou je vykreslena testovací a modrou přerušovanou čarou je vykreslen průběh trénovací chybovosti." width="672" />
<p class="caption">
Obrázek 12.27: Závislost testovací a trénovací chybovosti na počtu bázových funkcí pro <span class="math inline">\(\beta\)</span>. Červeným bodem je znázorněn optimální počet <span class="math inline">\(n_{optimal}\)</span> zvolený jako minimum testovací chybovosti, černou čarou je vykreslena testovací a modrou přerušovanou čarou je vykreslen průběh trénovací chybovosti.
</p>
</div>
<p>Vidíme, že s rostoucím počtem bází pro <span class="math inline">\(\beta(t)\)</span> má trénovací chybovost (modrá čára) tendenci klesat a tedy bychom na jejím základě volili velké hodnoty <span class="math inline">\(n_{basis}\)</span>.
Naopak optimální volbou na základě testovací chybovosti je <span class="math inline">\(n\)</span> rovno 5, tedy výrazně menší hodnota než 30.
Naopak s rostoucím <span class="math inline">\(n\)</span> roste testovací chyvost, což ukazuje na přeučení modelu.</p>
<p>Z výše uvedených důvodů pro určení optimálního počtu bazických funkcí pro <span class="math inline">\(\beta(t)\)</span> využijeme 10-ti násobnou cross-validaci.
Jako maximální počet uvažovaných bazických funkcí bereme 25, neboť jak jsme viděli výše, nad touto hodnotou dochází již k přeučení modelu.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="aplikace3.html#cb149-1" tabindex="-1"></a><span class="do">### 10-fold cross-validation</span></span>
<span id="cb149-2"><a href="aplikace3.html#cb149-2" tabindex="-1"></a>n.basis.max <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb149-3"><a href="aplikace3.html#cb149-3" tabindex="-1"></a>n.basis <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span>n.basis.max</span>
<span id="cb149-4"><a href="aplikace3.html#cb149-4" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb149-5"><a href="aplikace3.html#cb149-5" tabindex="-1"></a><span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb149-6"><a href="aplikace3.html#cb149-6" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb149-7"><a href="aplikace3.html#cb149-7" tabindex="-1"></a><span class="do">## prvky, ktere se behem cyklu nemeni</span></span>
<span id="cb149-8"><a href="aplikace3.html#cb149-8" tabindex="-1"></a><span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb149-9"><a href="aplikace3.html#cb149-9" tabindex="-1"></a>tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb149-10"><a href="aplikace3.html#cb149-10" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(tt)</span>
<span id="cb149-11"><a href="aplikace3.html#cb149-11" tabindex="-1"></a><span class="co"># B-spline baze </span></span>
<span id="cb149-12"><a href="aplikace3.html#cb149-12" tabindex="-1"></a>basis1 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> nbasis.x)</span>
<span id="cb149-13"><a href="aplikace3.html#cb149-13" tabindex="-1"></a><span class="co"># vztah</span></span>
<span id="cb149-14"><a href="aplikace3.html#cb149-14" tabindex="-1"></a>f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb149-15"><a href="aplikace3.html#cb149-15" tabindex="-1"></a><span class="co"># baze pro x</span></span>
<span id="cb149-16"><a href="aplikace3.html#cb149-16" tabindex="-1"></a>basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1)</span>
<span id="cb149-17"><a href="aplikace3.html#cb149-17" tabindex="-1"></a><span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb149-18"><a href="aplikace3.html#cb149-18" tabindex="-1"></a><span class="co"># ve sloupcich budou hodnoty presnosti pro danou cast trenovaci mnoziny</span></span>
<span id="cb149-19"><a href="aplikace3.html#cb149-19" tabindex="-1"></a><span class="co"># v radcich budou hodnoty pro dany pocet bazi</span></span>
<span id="cb149-20"><a href="aplikace3.html#cb149-20" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(n.basis), <span class="at">ncol =</span> k_cv, </span>
<span id="cb149-21"><a href="aplikace3.html#cb149-21" tabindex="-1"></a>                     <span class="at">dimnames =</span> <span class="fu">list</span>(n.basis, <span class="dv">1</span><span class="sc">:</span>k_cv))</span></code></pre></div>
</details>
<p>Nyní již máme vše připravené pro spočítání chybovosti na každé z deseti podmnožin trénovací množiny.
Následně určíme průměr a jako optimální <span class="math inline">\(n\)</span> vezmeme argument minima validační chybovosti.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="aplikace3.html#cb150-1" tabindex="-1"></a><span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb150-2"><a href="aplikace3.html#cb150-2" tabindex="-1"></a>  <span class="co"># definujeme danou indexovou mnozinu</span></span>
<span id="cb150-3"><a href="aplikace3.html#cb150-3" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb150-4"><a href="aplikace3.html#cb150-4" tabindex="-1"></a>    </span>
<span id="cb150-5"><a href="aplikace3.html#cb150-5" tabindex="-1"></a>  x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb150-6"><a href="aplikace3.html#cb150-6" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb150-7"><a href="aplikace3.html#cb150-7" tabindex="-1"></a>  y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb150-8"><a href="aplikace3.html#cb150-8" tabindex="-1"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb150-9"><a href="aplikace3.html#cb150-9" tabindex="-1"></a>  </span>
<span id="cb150-10"><a href="aplikace3.html#cb150-10" tabindex="-1"></a>  x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb150-11"><a href="aplikace3.html#cb150-11" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb150-12"><a href="aplikace3.html#cb150-12" tabindex="-1"></a>  y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb150-13"><a href="aplikace3.html#cb150-13" tabindex="-1"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb150-14"><a href="aplikace3.html#cb150-14" tabindex="-1"></a>  </span>
<span id="cb150-15"><a href="aplikace3.html#cb150-15" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train.cv) </span>
<span id="cb150-16"><a href="aplikace3.html#cb150-16" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb150-17"><a href="aplikace3.html#cb150-17" tabindex="-1"></a>  </span>
<span id="cb150-18"><a href="aplikace3.html#cb150-18" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> n.basis) {</span>
<span id="cb150-19"><a href="aplikace3.html#cb150-19" tabindex="-1"></a>    <span class="co"># baze pro bety</span></span>
<span id="cb150-20"><a href="aplikace3.html#cb150-20" tabindex="-1"></a>    basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, <span class="at">nbasis =</span> i)</span>
<span id="cb150-21"><a href="aplikace3.html#cb150-21" tabindex="-1"></a>    </span>
<span id="cb150-22"><a href="aplikace3.html#cb150-22" tabindex="-1"></a>    basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb150-23"><a href="aplikace3.html#cb150-23" tabindex="-1"></a>    <span class="co"># vstupni data do modelu</span></span>
<span id="cb150-24"><a href="aplikace3.html#cb150-24" tabindex="-1"></a>    ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train.cv)</span>
<span id="cb150-25"><a href="aplikace3.html#cb150-25" tabindex="-1"></a>    <span class="co"># binomicky model ... model logisticke regrese</span></span>
<span id="cb150-26"><a href="aplikace3.html#cb150-26" tabindex="-1"></a>    model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb150-27"><a href="aplikace3.html#cb150-27" tabindex="-1"></a>                            <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb150-28"><a href="aplikace3.html#cb150-28" tabindex="-1"></a>    </span>
<span id="cb150-29"><a href="aplikace3.html#cb150-29" tabindex="-1"></a>    <span class="co"># presnost na validacni casti </span></span>
<span id="cb150-30"><a href="aplikace3.html#cb150-30" tabindex="-1"></a>    newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(y.test.cv), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb150-31"><a href="aplikace3.html#cb150-31" tabindex="-1"></a>    predictions.valid <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb150-32"><a href="aplikace3.html#cb150-32" tabindex="-1"></a>    predictions.valid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.valid <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb150-33"><a href="aplikace3.html#cb150-33" tabindex="-1"></a>    presnost.valid <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, predictions.valid<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb150-34"><a href="aplikace3.html#cb150-34" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb150-35"><a href="aplikace3.html#cb150-35" tabindex="-1"></a>    </span>
<span id="cb150-36"><a href="aplikace3.html#cb150-36" tabindex="-1"></a>    <span class="co"># vlozime do matice</span></span>
<span id="cb150-37"><a href="aplikace3.html#cb150-37" tabindex="-1"></a>    CV.results[<span class="fu">as.character</span>(i), <span class="fu">as.character</span>(index)] <span class="ot">&lt;-</span> presnost.valid</span>
<span id="cb150-38"><a href="aplikace3.html#cb150-38" tabindex="-1"></a>  } </span>
<span id="cb150-39"><a href="aplikace3.html#cb150-39" tabindex="-1"></a>}</span>
<span id="cb150-40"><a href="aplikace3.html#cb150-40" tabindex="-1"></a></span>
<span id="cb150-41"><a href="aplikace3.html#cb150-41" tabindex="-1"></a><span class="co"># spocitame prumerne presnosti pro jednotliva n pres folds</span></span>
<span id="cb150-42"><a href="aplikace3.html#cb150-42" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb150-43"><a href="aplikace3.html#cb150-43" tabindex="-1"></a>n.basis.opt <span class="ot">&lt;-</span> n.basis[<span class="fu">which.max</span>(CV.results)]</span>
<span id="cb150-44"><a href="aplikace3.html#cb150-44" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span></code></pre></div>
</details>
<p>Vykresleme si ještě průběh validační chybovosti i se zvýrazněnou optimální hodnotou <span class="math inline">\(n_{optimal}\)</span> rovnou 7 s validační chybovostí 0.0574.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="aplikace3.html#cb151-1" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n.basis =</span> n.basis, <span class="at">CV =</span> CV.results)</span>
<span id="cb151-2"><a href="aplikace3.html#cb151-2" tabindex="-1"></a>CV.results <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> CV)) <span class="sc">+</span> </span>
<span id="cb151-3"><a href="aplikace3.html#cb151-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span> </span>
<span id="cb151-4"><a href="aplikace3.html#cb151-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb151-5"><a href="aplikace3.html#cb151-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis.opt, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv), <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb151-6"><a href="aplikace3.html#cb151-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb151-7"><a href="aplikace3.html#cb151-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(n[basis], <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb151-8"><a href="aplikace3.html#cb151-8" tabindex="-1"></a>                        n[optimal] <span class="sc">==</span> .(n.basis.opt))),</span>
<span id="cb151-9"><a href="aplikace3.html#cb151-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Validační chybovost&#39;</span>) <span class="sc">+</span> </span>
<span id="cb151-10"><a href="aplikace3.html#cb151-10" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> n.basis) <span class="sc">+</span> </span>
<span id="cb151-11"><a href="aplikace3.html#cb151-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-143"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-143-1.png" alt="Závislost validační chybovosti na hodnotě $n_{basis}$, tedy na počtu bází." width="672" />
<p class="caption">
Obrázek 12.28: Závislost validační chybovosti na hodnotě <span class="math inline">\(n_{basis}\)</span>, tedy na počtu bází.
</p>
</div>
<p>Nyní již tedy můžeme definovat finální model pomocí funkcionální logistické regrese, přičemž bázi pro <span class="math inline">\(\beta(t)\)</span> volíme B-splinovou bázi s 7 bázemi.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="aplikace3.html#cb152-1" tabindex="-1"></a><span class="co"># optimalni model</span></span>
<span id="cb152-2"><a href="aplikace3.html#cb152-2" tabindex="-1"></a>basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> n.basis.opt)</span>
<span id="cb152-3"><a href="aplikace3.html#cb152-3" tabindex="-1"></a>f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb152-4"><a href="aplikace3.html#cb152-4" tabindex="-1"></a><span class="co"># baze pro x a bety</span></span>
<span id="cb152-5"><a href="aplikace3.html#cb152-5" tabindex="-1"></a>basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb152-6"><a href="aplikace3.html#cb152-6" tabindex="-1"></a>basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb152-7"><a href="aplikace3.html#cb152-7" tabindex="-1"></a><span class="co"># vstupni data do modelu</span></span>
<span id="cb152-8"><a href="aplikace3.html#cb152-8" tabindex="-1"></a>dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb152-9"><a href="aplikace3.html#cb152-9" tabindex="-1"></a><span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb152-10"><a href="aplikace3.html#cb152-10" tabindex="-1"></a>ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb152-11"><a href="aplikace3.html#cb152-11" tabindex="-1"></a><span class="co"># binomicky model ... model logisticke regrese</span></span>
<span id="cb152-12"><a href="aplikace3.html#cb152-12" tabindex="-1"></a>model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb152-13"><a href="aplikace3.html#cb152-13" tabindex="-1"></a>                        <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b,</span>
<span id="cb152-14"><a href="aplikace3.html#cb152-14" tabindex="-1"></a>                        <span class="at">maxit =</span> <span class="dv">1000</span>, <span class="at">epsilon =</span> <span class="fl">1e-2</span>)</span>
<span id="cb152-15"><a href="aplikace3.html#cb152-15" tabindex="-1"></a></span>
<span id="cb152-16"><a href="aplikace3.html#cb152-16" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb152-17"><a href="aplikace3.html#cb152-17" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> ldata)</span>
<span id="cb152-18"><a href="aplikace3.html#cb152-18" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb152-19"><a href="aplikace3.html#cb152-19" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb152-20"><a href="aplikace3.html#cb152-20" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb152-21"><a href="aplikace3.html#cb152-21" tabindex="-1"></a>  </span>
<span id="cb152-22"><a href="aplikace3.html#cb152-22" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb152-23"><a href="aplikace3.html#cb152-23" tabindex="-1"></a>newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(Y.test), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb152-24"><a href="aplikace3.html#cb152-24" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb152-25"><a href="aplikace3.html#cb152-25" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb152-26"><a href="aplikace3.html#cb152-26" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb152-27"><a href="aplikace3.html#cb152-27" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Spočítali jsme trénovací chybovost (rovna 0 %) i testovací chybovost (rovna 7.69 %).
Pro lepší představu si ještě můžeme vykreslit hodnoty odhadnutých pravděpodobností příslušnosti do klasifikační třídy <span class="math inline">\(Y = 1\)</span> na trénovacích datech v závislosti na hodnotách lineárního prediktoru.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="aplikace3.html#cb153-1" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb153-2"><a href="aplikace3.html#cb153-2" tabindex="-1"></a>  <span class="at">linear.predictor =</span> model.glm<span class="sc">$</span>linear.predictors,</span>
<span id="cb153-3"><a href="aplikace3.html#cb153-3" tabindex="-1"></a>  <span class="at">response =</span> model.glm<span class="sc">$</span>fitted.values,</span>
<span id="cb153-4"><a href="aplikace3.html#cb153-4" tabindex="-1"></a>  <span class="at">Y =</span> <span class="fu">factor</span>(y.train)</span>
<span id="cb153-5"><a href="aplikace3.html#cb153-5" tabindex="-1"></a>) <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> linear.predictor, <span class="at">y =</span> response, <span class="at">colour =</span> Y)) <span class="sc">+</span> </span>
<span id="cb153-6"><a href="aplikace3.html#cb153-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb153-7"><a href="aplikace3.html#cb153-7" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;malý&quot;</span>, <span class="st">&quot;velký&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb153-8"><a href="aplikace3.html#cb153-8" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> <span class="dv">0</span>, <span class="at">intercept =</span> <span class="fl">0.5</span>), <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb153-9"><a href="aplikace3.html#cb153-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb153-10"><a href="aplikace3.html#cb153-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Lineární prediktor&#39;</span>,</span>
<span id="cb153-11"><a href="aplikace3.html#cb153-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Odhadnuté pravděpodobnosti Pr(Y = 1|X = x)&#39;</span>,</span>
<span id="cb153-12"><a href="aplikace3.html#cb153-12" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Obsah tuku&#39;</span>) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-145"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-145-1.png" alt="Závislost odhadnutých pravděpodobností na hodnotách lineárního prediktoru. Barevně jsou odlišeny body podle příslušnosti do klasifikační třídy." width="672" />
<p class="caption">
Obrázek 12.29: Závislost odhadnutých pravděpodobností na hodnotách lineárního prediktoru. Barevně jsou odlišeny body podle příslušnosti do klasifikační třídy.
</p>
</div>
<p>Můžeme si ještě pro informaci zobrazit průběh odhadnuté parametrické funkce <span class="math inline">\(\beta(t)\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="aplikace3.html#cb154-1" tabindex="-1"></a>t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(t), <span class="fu">max</span>(t), <span class="at">length =</span> <span class="dv">1001</span>)</span>
<span id="cb154-2"><a href="aplikace3.html#cb154-2" tabindex="-1"></a>beta.seq <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">evalarg =</span> t.seq, <span class="at">fdobj =</span> model.glm<span class="sc">$</span>beta.l<span class="sc">$</span>x)</span>
<span id="cb154-3"><a href="aplikace3.html#cb154-3" tabindex="-1"></a></span>
<span id="cb154-4"><a href="aplikace3.html#cb154-4" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">t =</span> t.seq, <span class="at">beta =</span> beta.seq) <span class="sc">|&gt;</span> </span>
<span id="cb154-5"><a href="aplikace3.html#cb154-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(t, beta)) <span class="sc">+</span> </span>
<span id="cb154-6"><a href="aplikace3.html#cb154-6" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> <span class="dv">0</span>, <span class="at">intercept =</span> <span class="dv">0</span>), <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, </span>
<span id="cb154-7"><a href="aplikace3.html#cb154-7" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span></span>
<span id="cb154-8"><a href="aplikace3.html#cb154-8" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb154-9"><a href="aplikace3.html#cb154-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb154-10"><a href="aplikace3.html#cb154-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb154-11"><a href="aplikace3.html#cb154-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(beta)(t))) <span class="sc">+</span> </span>
<span id="cb154-12"><a href="aplikace3.html#cb154-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb154-13"><a href="aplikace3.html#cb154-13" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-146"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-146-1.png" alt="Průběh odhadu parametrické funkce $\beta(t), t \in [850, 1050]$." width="672" />
<p class="caption">
Obrázek 12.30: Průběh odhadu parametrické funkce <span class="math inline">\(\beta(t), t \in [850, 1050]\)</span>.
</p>
</div>
<p>Vidíme, že hodnoty funkce <span class="math inline">\(\hat\beta(t)\)</span> se drží kolem nuly pro časy <span class="math inline">\(t\)</span> z prostředka a začátku intervalu <span class="math inline">\([850, 1050]\)</span>, zatímco pro pozdějsí časy jsou hodnoty vyšší.
To implikuje rozdílnost funkcí z klasifikačních tříd na začátku a konci intervalu, zatímco uprostřed intervalu jsou funkce velmi podobné.</p>
<p>Výsledky opět přidáme do souhrnné tabulky.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="aplikace3.html#cb155-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR functional&#39;</span>, </span>
<span id="cb155-2"><a href="aplikace3.html#cb155-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb155-3"><a href="aplikace3.html#cb155-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb155-4"><a href="aplikace3.html#cb155-4" tabindex="-1"></a></span>
<span id="cb155-5"><a href="aplikace3.html#cb155-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="logistická-regrese-s-analýzou-hlavních-komponent-8" class="section level4 hasAnchor" number="12.5.4.2">
<h4><span class="header-section-number">12.5.4.2</span> Logistická regrese s analýzou hlavních komponent<a href="aplikace3.html#logistická-regrese-s-analýzou-hlavních-komponent-8" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Abychom mohli sesrojit tento klasifikátor, potřebujeme provést funkcionální analýzu hlavních komponent, určit vhodný počet komponent a spočítat hodnoty skórů pro testovací data.
To jsme již provedli v části u lineární diskriminační analýzy, proto využijeme tyto výsledky v následující části.</p>
<p>Můžeme tedy rovnou sestrojit model logistické regrese pomocí funkce <code>glm(, family = binomial)</code>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="aplikace3.html#cb156-1" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb156-2"><a href="aplikace3.html#cb156-2" tabindex="-1"></a>clf.LR <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span>  ., <span class="at">data =</span> data.PCA.train, <span class="at">family =</span> binomial)</span></code></pre></div>
</details>
<pre><code>## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="aplikace3.html#cb158-1" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb158-2"><a href="aplikace3.html#cb158-2" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.train, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb158-3"><a href="aplikace3.html#cb158-3" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb158-4"><a href="aplikace3.html#cb158-4" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb158-5"><a href="aplikace3.html#cb158-5" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb158-6"><a href="aplikace3.html#cb158-6" tabindex="-1"></a>  </span>
<span id="cb158-7"><a href="aplikace3.html#cb158-7" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb158-8"><a href="aplikace3.html#cb158-8" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.test, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb158-9"><a href="aplikace3.html#cb158-9" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb158-10"><a href="aplikace3.html#cb158-10" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb158-11"><a href="aplikace3.html#cb158-11" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Spočítali jsme tedy chybovost klasifikátoru na trénovacích (0.67 %) i na testovacích datech (4.62 %).</p>
<p>Pro grafické znázornění metody můžeme zaznačit dělící hranici do grafu skórů prvních dvou hlavních komponent.
Tuto hranici spočítáme na husté síti bodů a zobrazíme ji pomocí funkce <code>geom_contour()</code> stejně jako v případě LDA i QDA.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="aplikace3.html#cb159-1" tabindex="-1"></a>nd <span class="ot">&lt;-</span> nd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">prd =</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> nd,</span>
<span id="cb159-2"><a href="aplikace3.html#cb159-2" tabindex="-1"></a>                                            <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)))</span>
<span id="cb159-3"><a href="aplikace3.html#cb159-3" tabindex="-1"></a>nd<span class="sc">$</span>prd <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(nd<span class="sc">$</span>prd <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb159-4"><a href="aplikace3.html#cb159-4" tabindex="-1"></a></span>
<span id="cb159-5"><a href="aplikace3.html#cb159-5" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb159-6"><a href="aplikace3.html#cb159-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb159-7"><a href="aplikace3.html#cb159-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1. hlavní komponenta (vysvětlená variabilita&#39;</span>, </span>
<span id="cb159-8"><a href="aplikace3.html#cb159-8" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb159-9"><a href="aplikace3.html#cb159-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2. hlavní komponenta (&#39;</span>, </span>
<span id="cb159-10"><a href="aplikace3.html#cb159-10" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb159-11"><a href="aplikace3.html#cb159-11" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Obsah tuku&#39;</span>) <span class="sc">+</span></span>
<span id="cb159-12"><a href="aplikace3.html#cb159-12" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;malý&quot;</span>, <span class="st">&quot;velký&quot;</span>)) <span class="sc">+</span></span>
<span id="cb159-13"><a href="aplikace3.html#cb159-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb159-14"><a href="aplikace3.html#cb159-14" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-152"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-152-1.png" alt="Skóre prvních dvou hlavních komponent, barevně odlišené podle příslušnosti do klasifikační třídy. Černě je vyznačena dělící hranice (přímka v rovině prvních dvou hlavních komponent) mezi třídami sestrojená pomocí logistické regrese." width="672" />
<p class="caption">
Obrázek 12.31: Skóre prvních dvou hlavních komponent, barevně odlišené podle příslušnosti do klasifikační třídy. Černě je vyznačena dělící hranice (přímka v rovině prvních dvou hlavních komponent) mezi třídami sestrojená pomocí logistické regrese.
</p>
</div>
<p>Všimněme si, že dělící hranicí mezi klasifikačními třídami je nyní přímka jako v případě LDA.</p>
<p>Nakonec ještě doplníme chybovosti do souhrnné tabulky.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="aplikace3.html#cb160-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR score&#39;</span>, </span>
<span id="cb160-2"><a href="aplikace3.html#cb160-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb160-3"><a href="aplikace3.html#cb160-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb160-4"><a href="aplikace3.html#cb160-4" tabindex="-1"></a></span>
<span id="cb160-5"><a href="aplikace3.html#cb160-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
<div id="rozhodovací-stromy-9" class="section level3 hasAnchor" number="12.5.5">
<h3><span class="header-section-number">12.5.5</span> Rozhodovací stromy<a href="aplikace3.html#rozhodovací-stromy-9" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>V této části se podíváme na velmi odlišný přístup k sestrojení klasifikátoru, než byly například LDA či logistická regrese.
Rozhodovací stromy jsou velmi oblíbeným nástrojem ke klasifikaci, avšak jako v případě některých předchozích metod nejsou přímo určeny pro funkcionální data.
Existují však postupy, jak funkcionální objekty převést na mnohorozměrné a následně na ně aplikovat algoritmus rozhodovacích stromů.
Můžeme uvažovat následující postupy:</p>
<ul>
<li><p>algoritmus sestrojený na bázových koeficientech,</p></li>
<li><p>využití skórů hlavních komponent,</p></li>
<li><p>použít diskretizaci intervalu a vyhodnotit funkci jen na nějaké konečné síti bodů.</p></li>
</ul>
<p>My se nejprve zaměříme na diskretizaci intervalu a následně porovnáme výsledky se zbylými dvěma přístupy k sestrojení rozhodovacího stromu.</p>
<div id="diskretizace-intervalu-23" class="section level4 hasAnchor" number="12.5.5.1">
<h4><span class="header-section-number">12.5.5.1</span> Diskretizace intervalu<a href="aplikace3.html#diskretizace-intervalu-23" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Nejprve si musíme definovat body z intervalu <span class="math inline">\(I = [850, 1050]\)</span>, ve kterých funkce vyhodnotíme.
Následně vytvoříme objekt, ve kterém budou řádky představovat jednotlivé (diskretizované) funkce a sloupce časy.
Nakonec připojíme sloupec <span class="math inline">\(Y\)</span> s informací o příslušnosti do klasifikační třídy a totéž zopakujeme i pro testovací data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="aplikace3.html#cb161-1" tabindex="-1"></a><span class="co"># posloupnost bodu, ve kterych funkce vyhodnotime</span></span>
<span id="cb161-2"><a href="aplikace3.html#cb161-2" tabindex="-1"></a>t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(t), <span class="fu">max</span>(t), <span class="at">length =</span> <span class="dv">101</span>)</span>
<span id="cb161-3"><a href="aplikace3.html#cb161-3" tabindex="-1"></a>   </span>
<span id="cb161-4"><a href="aplikace3.html#cb161-4" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb161-5"><a href="aplikace3.html#cb161-5" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) <span class="co"># transpozice kvuli funkcim v radku</span></span>
<span id="cb161-6"><a href="aplikace3.html#cb161-6" tabindex="-1"></a>grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb161-7"><a href="aplikace3.html#cb161-7" tabindex="-1"></a></span>
<span id="cb161-8"><a href="aplikace3.html#cb161-8" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb161-9"><a href="aplikace3.html#cb161-9" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb161-10"><a href="aplikace3.html#cb161-10" tabindex="-1"></a>grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span></code></pre></div>
</details>
<p>Nyní mážeme sestrojit rozhodovací strom, ve kterém budou jakožto prediktory vystupovat všechny časy z vektoru <code>t.seq</code>.
Tato klasifikační není náchylná na multikolinearitu, tudíž se jí nemusíme zabývat.
Jako metriku zvolíme přesnost.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="aplikace3.html#cb162-1" tabindex="-1"></a><span class="co"># sestrojeni modelu</span></span>
<span id="cb162-2"><a href="aplikace3.html#cb162-2" tabindex="-1"></a>clf.tree <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb162-3"><a href="aplikace3.html#cb162-3" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb162-4"><a href="aplikace3.html#cb162-4" tabindex="-1"></a>                 <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb162-5"><a href="aplikace3.html#cb162-5" tabindex="-1"></a>                 <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb162-6"><a href="aplikace3.html#cb162-6" tabindex="-1"></a></span>
<span id="cb162-7"><a href="aplikace3.html#cb162-7" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb162-8"><a href="aplikace3.html#cb162-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data)</span>
<span id="cb162-9"><a href="aplikace3.html#cb162-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb162-10"><a href="aplikace3.html#cb162-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb162-11"><a href="aplikace3.html#cb162-11" tabindex="-1"></a>  </span>
<span id="cb162-12"><a href="aplikace3.html#cb162-12" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb162-13"><a href="aplikace3.html#cb162-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb162-14"><a href="aplikace3.html#cb162-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb162-15"><a href="aplikace3.html#cb162-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Chybovost klasifikátoru na testovacích datech je tedy 1.54 % a na trénovacích datech 0.67 %.</p>
<p>Graficky si rozhodovací strom můžeme vykreslit pomocí funkce <code>fancyRpartPlot()</code>.
Nastavíme barvy uzlů tak, aby reflektovaly předchozí barevné odlišení.
Jedná se o neprořezaný strom.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="aplikace3.html#cb163-1" tabindex="-1"></a><span class="fu">colnames</span>(grid.data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&#39;time:&#39;</span>, t.seq), <span class="st">&#39;Y&#39;</span>)</span>
<span id="cb163-2"><a href="aplikace3.html#cb163-2" tabindex="-1"></a><span class="fu">fancyRpartPlot</span>(<span class="fu">rpart</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, <span class="at">method =</span> <span class="st">&quot;class&quot;</span>),</span>
<span id="cb163-3"><a href="aplikace3.html#cb163-3" tabindex="-1"></a>               <span class="at">sub =</span> <span class="st">&#39;&#39;</span>, <span class="at">palettes =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>)) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-156"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-156-1.png" alt="Grafické znázornění neprořezaného rozhodovacího stromu. Modrými odstíny jsou vykresleny uzly příslušející klasifikační třídě 1 a červenými odstíny třídě 0." width="672" />
<p class="caption">
Obrázek 12.32: Grafické znázornění neprořezaného rozhodovacího stromu. Modrými odstíny jsou vykresleny uzly příslušející klasifikační třídě 1 a červenými odstíny třídě 0.
</p>
</div>
<p>Můžeme si také vykreslit již prořezaný finální rozhodovací strom.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="aplikace3.html#cb164-1" tabindex="-1"></a>rpart.plot<span class="sc">::</span><span class="fu">rpart.plot</span>(clf.tree<span class="sc">$</span>finalModel, <span class="co"># finalni model ... prorezany strom</span></span>
<span id="cb164-2"><a href="aplikace3.html#cb164-2" tabindex="-1"></a>                       <span class="at">extra =</span> <span class="dv">104</span>, <span class="co"># zobrazeni pozadovanych informaci</span></span>
<span id="cb164-3"><a href="aplikace3.html#cb164-3" tabindex="-1"></a>                       <span class="at">box.palette =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>),</span>
<span id="cb164-4"><a href="aplikace3.html#cb164-4" tabindex="-1"></a>                       <span class="at">branch.lty =</span> <span class="dv">3</span>, <span class="co"># dotted branch lines</span></span>
<span id="cb164-5"><a href="aplikace3.html#cb164-5" tabindex="-1"></a>                       <span class="at">shadow.col =</span> <span class="dv">0</span>, <span class="co"># shadows under the node boxes</span></span>
<span id="cb164-6"><a href="aplikace3.html#cb164-6" tabindex="-1"></a>                       <span class="at">nn =</span> <span class="cn">FALSE</span>, </span>
<span id="cb164-7"><a href="aplikace3.html#cb164-7" tabindex="-1"></a>                       <span class="at">under =</span> <span class="cn">FALSE</span>, </span>
<span id="cb164-8"><a href="aplikace3.html#cb164-8" tabindex="-1"></a>                       <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-157"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-157-1.png" alt="Finální prořezaný rozhodovací strom." width="672" />
<p class="caption">
Obrázek 12.33: Finální prořezaný rozhodovací strom.
</p>
</div>
<p>Nakonec opět přidejme trénovací a testovací chybovost do souhrnné tabulky.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="aplikace3.html#cb165-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree - diskr.&#39;</span>, </span>
<span id="cb165-2"><a href="aplikace3.html#cb165-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb165-3"><a href="aplikace3.html#cb165-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb165-4"><a href="aplikace3.html#cb165-4" tabindex="-1"></a></span>
<span id="cb165-5"><a href="aplikace3.html#cb165-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="skóre-hlavních-komponent-23" class="section level4 hasAnchor" number="12.5.5.2">
<h4><span class="header-section-number">12.5.5.2</span> Skóre hlavních komponent<a href="aplikace3.html#skóre-hlavních-komponent-23" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Další možností pro sestrojení rozhodovacího stromu je použít skóre hlavních komponent.
Jelikož jsme již skóre počítali pro předchozí klasifikační metody, využijeme těchto poznatků a sestrojíme rozhodovací strom na skórech prvních 2 hlavních komponent.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="aplikace3.html#cb166-1" tabindex="-1"></a><span class="co"># sestrojeni modelu</span></span>
<span id="cb166-2"><a href="aplikace3.html#cb166-2" tabindex="-1"></a>clf.tree.PCA <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb166-3"><a href="aplikace3.html#cb166-3" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb166-4"><a href="aplikace3.html#cb166-4" tabindex="-1"></a>                 <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb166-5"><a href="aplikace3.html#cb166-5" tabindex="-1"></a>                 <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb166-6"><a href="aplikace3.html#cb166-6" tabindex="-1"></a></span>
<span id="cb166-7"><a href="aplikace3.html#cb166-7" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb166-8"><a href="aplikace3.html#cb166-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb166-9"><a href="aplikace3.html#cb166-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb166-10"><a href="aplikace3.html#cb166-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb166-11"><a href="aplikace3.html#cb166-11" tabindex="-1"></a>  </span>
<span id="cb166-12"><a href="aplikace3.html#cb166-12" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb166-13"><a href="aplikace3.html#cb166-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb166-14"><a href="aplikace3.html#cb166-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb166-15"><a href="aplikace3.html#cb166-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Chybovost rozhodovacího stromu na testovacích datech je tedy 6.15 % a na trénovacích datech 0.67 %.</p>
<p>Graficky si rozhodovací strom sestrojený na skórech hlavních komponent můžeme vykreslit pomocí funkce <code>fancyRpartPlot()</code>.
Nastavíme barvy uzlů tak, aby reflektovaly předchozí barevné odlišení.
Jedná se o neprořezaný strom.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="aplikace3.html#cb167-1" tabindex="-1"></a><span class="fu">fancyRpartPlot</span>(<span class="fu">rpart</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, <span class="at">method =</span> <span class="st">&quot;class&quot;</span>),</span>
<span id="cb167-2"><a href="aplikace3.html#cb167-2" tabindex="-1"></a>               <span class="at">sub =</span> <span class="st">&#39;&#39;</span>, <span class="at">palettes =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>)) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-160"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-160-1.png" alt="Grafické znázornění neprořezaného rozhodovacího stromu sestrojeného na skórech hlavních komponent. Modrými odstíny jsou vykresleny uzly příslušející klasifikační třídě 1 a červenými odstíny třídě 0." width="672" />
<p class="caption">
Obrázek 12.34: Grafické znázornění neprořezaného rozhodovacího stromu sestrojeného na skórech hlavních komponent. Modrými odstíny jsou vykresleny uzly příslušející klasifikační třídě 1 a červenými odstíny třídě 0.
</p>
</div>
<p>Můžeme si také vykreslit již prořezaný finální rozhodovací strom.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="aplikace3.html#cb168-1" tabindex="-1"></a>rpart.plot<span class="sc">::</span><span class="fu">rpart.plot</span>(clf.tree.PCA<span class="sc">$</span>finalModel, <span class="co"># finalni model </span></span>
<span id="cb168-2"><a href="aplikace3.html#cb168-2" tabindex="-1"></a>                       <span class="at">extra =</span> <span class="dv">104</span>, <span class="co"># zobrazeni pozadovanych informaci</span></span>
<span id="cb168-3"><a href="aplikace3.html#cb168-3" tabindex="-1"></a>                       <span class="at">box.palette =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>),</span>
<span id="cb168-4"><a href="aplikace3.html#cb168-4" tabindex="-1"></a>                       <span class="at">branch.lty =</span> <span class="dv">3</span>, <span class="co"># dotted branch lines</span></span>
<span id="cb168-5"><a href="aplikace3.html#cb168-5" tabindex="-1"></a>                       <span class="at">shadow.col =</span> <span class="dv">0</span>, <span class="co"># shadows under the node boxes</span></span>
<span id="cb168-6"><a href="aplikace3.html#cb168-6" tabindex="-1"></a>                       <span class="at">nn =</span> <span class="cn">FALSE</span>, <span class="at">under =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-161"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-161-1.png" alt="Finální prořezaný rozhodovací strom." width="672" />
<p class="caption">
Obrázek 12.35: Finální prořezaný rozhodovací strom.
</p>
</div>
<p>Nakonec opět přidejme trénovací a testovací chybovost do souhrnné tabulky.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="aplikace3.html#cb169-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree - score&#39;</span>, </span>
<span id="cb169-2"><a href="aplikace3.html#cb169-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb169-3"><a href="aplikace3.html#cb169-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb169-4"><a href="aplikace3.html#cb169-4" tabindex="-1"></a></span>
<span id="cb169-5"><a href="aplikace3.html#cb169-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="bázové-koeficienty-23" class="section level4 hasAnchor" number="12.5.5.3">
<h4><span class="header-section-number">12.5.5.3</span> Bázové koeficienty<a href="aplikace3.html#bázové-koeficienty-23" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Poslední možností, kterou využijeme pro sestrojení rozhodovacího stromu, je použití koeficientů ve vyjádření funkcí v B-splinové bázi.</p>
<p>Nejprve si definujme potřebné datové soubory s koeficienty.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="aplikace3.html#cb170-1" tabindex="-1"></a><span class="co"># trenovaci dataset</span></span>
<span id="cb170-2"><a href="aplikace3.html#cb170-2" tabindex="-1"></a>data.Bbasis.train <span class="ot">&lt;-</span> <span class="fu">t</span>(X.train<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb170-3"><a href="aplikace3.html#cb170-3" tabindex="-1"></a>data.Bbasis.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb170-4"><a href="aplikace3.html#cb170-4" tabindex="-1"></a></span>
<span id="cb170-5"><a href="aplikace3.html#cb170-5" tabindex="-1"></a><span class="co"># testovaci dataset</span></span>
<span id="cb170-6"><a href="aplikace3.html#cb170-6" tabindex="-1"></a>data.Bbasis.test <span class="ot">&lt;-</span> <span class="fu">t</span>(X.test<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb170-7"><a href="aplikace3.html#cb170-7" tabindex="-1"></a>data.Bbasis.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span></code></pre></div>
</details>
<p>Nyní již můžeme sestrojit klasifikátor.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="aplikace3.html#cb171-1" tabindex="-1"></a><span class="co"># sestrojeni modelu</span></span>
<span id="cb171-2"><a href="aplikace3.html#cb171-2" tabindex="-1"></a>clf.tree.Bbasis <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb171-3"><a href="aplikace3.html#cb171-3" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb171-4"><a href="aplikace3.html#cb171-4" tabindex="-1"></a>                 <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb171-5"><a href="aplikace3.html#cb171-5" tabindex="-1"></a>                 <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb171-6"><a href="aplikace3.html#cb171-6" tabindex="-1"></a></span>
<span id="cb171-7"><a href="aplikace3.html#cb171-7" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb171-8"><a href="aplikace3.html#cb171-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb171-9"><a href="aplikace3.html#cb171-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb171-10"><a href="aplikace3.html#cb171-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb171-11"><a href="aplikace3.html#cb171-11" tabindex="-1"></a>  </span>
<span id="cb171-12"><a href="aplikace3.html#cb171-12" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb171-13"><a href="aplikace3.html#cb171-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb171-14"><a href="aplikace3.html#cb171-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb171-15"><a href="aplikace3.html#cb171-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Chybovost rozhodovacího stromu na trénovacích datech je tedy 0.67 % a na testovacích datech 1.54 %.</p>
<p>Graficky si rozhodovací strom sestrojený na koeficientech B-splinového vyjádření můžeme vykreslit pomocí funkce <code>fancyRpartPlot()</code>.
Nastavíme barvy uzlů tak, aby reflektovaly předchozí barevné odlišení.
Jedná se o neprořezaný strom.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="aplikace3.html#cb172-1" tabindex="-1"></a><span class="fu">fancyRpartPlot</span>(<span class="fu">rpart</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, <span class="at">method =</span> <span class="st">&quot;class&quot;</span>),</span>
<span id="cb172-2"><a href="aplikace3.html#cb172-2" tabindex="-1"></a>               <span class="at">sub =</span> <span class="st">&#39;&#39;</span>, <span class="at">palettes =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>)) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-165"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-165-1.png" alt="Grafické znázornění neprořezaného rozhodovacího stromu sestrojeného na bázových koeficientech. Modrými odstíny jsou vykresleny uzly příslušející klasifikační třídě 1 a červenými odstíny třídě 0." width="672" />
<p class="caption">
Obrázek 12.36: Grafické znázornění neprořezaného rozhodovacího stromu sestrojeného na bázových koeficientech. Modrými odstíny jsou vykresleny uzly příslušející klasifikační třídě 1 a červenými odstíny třídě 0.
</p>
</div>
<p>Můžeme si také vykreslit již prořezaný finální rozhodovací strom.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="aplikace3.html#cb173-1" tabindex="-1"></a>rpart.plot<span class="sc">::</span><span class="fu">rpart.plot</span>(clf.tree.Bbasis<span class="sc">$</span>finalModel, <span class="co"># finalni model </span></span>
<span id="cb173-2"><a href="aplikace3.html#cb173-2" tabindex="-1"></a>                       <span class="at">extra =</span> <span class="dv">104</span>, <span class="co"># zobrazeni pozadovanych informaci</span></span>
<span id="cb173-3"><a href="aplikace3.html#cb173-3" tabindex="-1"></a>                       <span class="at">box.palette =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>),</span>
<span id="cb173-4"><a href="aplikace3.html#cb173-4" tabindex="-1"></a>                       <span class="at">branch.lty =</span> <span class="dv">3</span>, <span class="co"># dotted branch lines</span></span>
<span id="cb173-5"><a href="aplikace3.html#cb173-5" tabindex="-1"></a>                       <span class="at">shadow.col =</span> <span class="dv">0</span>, <span class="co"># shadows under the node boxes</span></span>
<span id="cb173-6"><a href="aplikace3.html#cb173-6" tabindex="-1"></a>                       <span class="at">nn =</span> <span class="cn">FALSE</span>, <span class="at">under =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-166"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-166-1.png" alt="Finální prořezaný rozhodovací strom." width="672" />
<p class="caption">
Obrázek 12.37: Finální prořezaný rozhodovací strom.
</p>
</div>
<p>Nakonec opět přidejme trénovací a testovací chybovost do souhrnné tabulky.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="aplikace3.html#cb174-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree - Bbasis&#39;</span>, </span>
<span id="cb174-2"><a href="aplikace3.html#cb174-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb174-3"><a href="aplikace3.html#cb174-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb174-4"><a href="aplikace3.html#cb174-4" tabindex="-1"></a></span>
<span id="cb174-5"><a href="aplikace3.html#cb174-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
<div id="náhodné-lesy-9" class="section level3 hasAnchor" number="12.5.6">
<h3><span class="header-section-number">12.5.6</span> Náhodné lesy<a href="aplikace3.html#náhodné-lesy-9" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Klasifikátor sestrojený pomocí metody náhodných lesů spočívá v sestrojení několika jednotlivých rozhodovacích stromů, které se následně zkombinují a vytvoří společný klasifikátor (společným “hlasováním”).</p>
<p>Tak jako v případě rozhodovacích stromů máme několik možností na to, jaká data (konečně-rozměrná) použijeme pro sestrojení modelu.
Budeme opět uvažovat výše diskutované tři přístupy.
Datové soubory s příslušnými veličinami pro všechny tři přístupy již máme připravené z minulé sekce, proto můžeme přímo sestrojit dané modely, spočítat charakteristiky daného klasifikátoru a přidat výsledky do souhrnné tabulky.</p>
<div id="diskretizace-intervalu-24" class="section level4 hasAnchor" number="12.5.6.1">
<h4><span class="header-section-number">12.5.6.1</span> Diskretizace intervalu<a href="aplikace3.html#diskretizace-intervalu-24" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>V prvním případě využíváme vyhodnocení funkcí na dané síti bodů intervalu <span class="math inline">\(I = [850, 1050]\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="aplikace3.html#cb175-1" tabindex="-1"></a><span class="co"># sestrojeni modelu</span></span>
<span id="cb175-2"><a href="aplikace3.html#cb175-2" tabindex="-1"></a>clf.RF <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb175-3"><a href="aplikace3.html#cb175-3" tabindex="-1"></a>                       <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb175-4"><a href="aplikace3.html#cb175-4" tabindex="-1"></a>                       <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb175-5"><a href="aplikace3.html#cb175-5" tabindex="-1"></a>                       <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb175-6"><a href="aplikace3.html#cb175-6" tabindex="-1"></a></span>
<span id="cb175-7"><a href="aplikace3.html#cb175-7" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb175-8"><a href="aplikace3.html#cb175-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data)</span>
<span id="cb175-9"><a href="aplikace3.html#cb175-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb175-10"><a href="aplikace3.html#cb175-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb175-11"><a href="aplikace3.html#cb175-11" tabindex="-1"></a>  </span>
<span id="cb175-12"><a href="aplikace3.html#cb175-12" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb175-13"><a href="aplikace3.html#cb175-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb175-14"><a href="aplikace3.html#cb175-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb175-15"><a href="aplikace3.html#cb175-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Chybovost náhodného lesu na trénovacích datech je tedy 0 % a na testovacích datech 4.62 %.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="aplikace3.html#cb176-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RForest - diskr&#39;</span>, </span>
<span id="cb176-2"><a href="aplikace3.html#cb176-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb176-3"><a href="aplikace3.html#cb176-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb176-4"><a href="aplikace3.html#cb176-4" tabindex="-1"></a></span>
<span id="cb176-5"><a href="aplikace3.html#cb176-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="skóre-hlavních-komponent-24" class="section level4 hasAnchor" number="12.5.6.2">
<h4><span class="header-section-number">12.5.6.2</span> Skóre hlavních komponent<a href="aplikace3.html#skóre-hlavních-komponent-24" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>V tomto případě využijeme skóre prvních <span class="math inline">\(p =\)</span> 2 hlavních komponent.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="aplikace3.html#cb177-1" tabindex="-1"></a><span class="co"># sestrojeni modelu</span></span>
<span id="cb177-2"><a href="aplikace3.html#cb177-2" tabindex="-1"></a>clf.RF.PCA <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb177-3"><a href="aplikace3.html#cb177-3" tabindex="-1"></a>                           <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb177-4"><a href="aplikace3.html#cb177-4" tabindex="-1"></a>                           <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb177-5"><a href="aplikace3.html#cb177-5" tabindex="-1"></a>                           <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb177-6"><a href="aplikace3.html#cb177-6" tabindex="-1"></a></span>
<span id="cb177-7"><a href="aplikace3.html#cb177-7" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb177-8"><a href="aplikace3.html#cb177-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb177-9"><a href="aplikace3.html#cb177-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb177-10"><a href="aplikace3.html#cb177-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb177-11"><a href="aplikace3.html#cb177-11" tabindex="-1"></a>  </span>
<span id="cb177-12"><a href="aplikace3.html#cb177-12" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb177-13"><a href="aplikace3.html#cb177-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb177-14"><a href="aplikace3.html#cb177-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb177-15"><a href="aplikace3.html#cb177-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Chybovost náhodného lesu na trénovacích datech je tedy 0.67 % a na testovacích datech 4.62 %.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="aplikace3.html#cb178-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RForest - score&#39;</span>, </span>
<span id="cb178-2"><a href="aplikace3.html#cb178-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb178-3"><a href="aplikace3.html#cb178-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb178-4"><a href="aplikace3.html#cb178-4" tabindex="-1"></a></span>
<span id="cb178-5"><a href="aplikace3.html#cb178-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="bázové-koeficienty-24" class="section level4 hasAnchor" number="12.5.6.3">
<h4><span class="header-section-number">12.5.6.3</span> Bázové koeficienty<a href="aplikace3.html#bázové-koeficienty-24" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Nakonec použijeme vyjádření funkcí pomocí B-splinové báze.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="aplikace3.html#cb179-1" tabindex="-1"></a><span class="co"># sestrojeni modelu</span></span>
<span id="cb179-2"><a href="aplikace3.html#cb179-2" tabindex="-1"></a>clf.RF.Bbasis <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb179-3"><a href="aplikace3.html#cb179-3" tabindex="-1"></a>                              <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb179-4"><a href="aplikace3.html#cb179-4" tabindex="-1"></a>                              <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb179-5"><a href="aplikace3.html#cb179-5" tabindex="-1"></a>                              <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb179-6"><a href="aplikace3.html#cb179-6" tabindex="-1"></a></span>
<span id="cb179-7"><a href="aplikace3.html#cb179-7" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb179-8"><a href="aplikace3.html#cb179-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb179-9"><a href="aplikace3.html#cb179-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb179-10"><a href="aplikace3.html#cb179-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb179-11"><a href="aplikace3.html#cb179-11" tabindex="-1"></a>  </span>
<span id="cb179-12"><a href="aplikace3.html#cb179-12" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb179-13"><a href="aplikace3.html#cb179-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb179-14"><a href="aplikace3.html#cb179-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb179-15"><a href="aplikace3.html#cb179-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Chybovost tohoto klasifikátoru na trénovacích datech je 0 % a na testovacích datech 3.08 %.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="aplikace3.html#cb180-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RForest - Bbasis&#39;</span>, </span>
<span id="cb180-2"><a href="aplikace3.html#cb180-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb180-3"><a href="aplikace3.html#cb180-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb180-4"><a href="aplikace3.html#cb180-4" tabindex="-1"></a></span>
<span id="cb180-5"><a href="aplikace3.html#cb180-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
<div id="support-vector-machines-14" class="section level3 hasAnchor" number="12.5.7">
<h3><span class="header-section-number">12.5.7</span> Support Vector Machines<a href="aplikace3.html#support-vector-machines-14" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Nyní se podívejme na klasifikaci našich křivek pomocí metody podpůrných vektorů (ang. Support Vector Machines, SVM).
Výhodou této klasifikační metody je její výpočetní nenáročnost, neboť pro definici hraniční křivky mezi třídami využívá pouze několik (často málo) pozorování.</p>
<p>Hlavní výhodou SVM je použití tzv.
<em>jádrového triku</em> (kernel trick), pomocí kterého nahradíme obyčejný skalární součin jiným skalárním součinem transformovaných dat, aniž bychom tuto transformaci museli přímo definovat.
Tím dostaneme obecně nelineární dělící hranici mezi klasifikačními třídami.
<em>Jádro</em> (jádrová funkce, ang. kernel, kernel function) <span class="math inline">\(K\)</span> je taková funkce, která splňuje</p>
<p><span class="math display">\[
K(x_i, x_j) = \langle \phi(x_i), \phi(x_j) \rangle_{\mathcal H},
\]</span>
kde <span class="math inline">\(\phi\)</span> je nějaká (neznámá) transformace (ang. feature map), <span class="math inline">\(\mathcal H\)</span> je Hilbertův prostor a <span class="math inline">\(\langle \cdot, \cdot \rangle_{\mathcal H}\)</span> je nějaký skalární součin na tomto Hilbertově prostoru.</p>
<p>Nejčastěji se v praxi volí tři typy jádrových funkcí:</p>
<ul>
<li>lineární jádro – <span class="math inline">\(K(x_i, x_j) = \langle x_i, x_j \rangle\)</span>,</li>
<li>polynomiální jádro – <span class="math inline">\(K(x_i, x_j) = \big(\alpha_0 + \gamma \langle x_i, x_j \rangle \big)^d\)</span>,</li>
<li>radiální (gaussovské) jádro – <span class="math inline">\(\displaystyle{K(x_i, x_j) = \text e^{-\gamma \|x_i - x_j \|^2}}\)</span>.</li>
</ul>
<p>U všech výše zmíněných jader musíme zvolit konstantu <span class="math inline">\(C &gt; 0\)</span>, která udává míru penalizace za překročení dělící hranice mezi třídami (ang. inverse regularization parameter).
S rostoucí hodnotou <span class="math inline">\(C\)</span> bude metoda více penalizovat špatně klasifikovaná data a méně tvar hranice, naopak pro malé hodnoty <span class="math inline">\(C\)</span> metoda nedává takový význam špatně klasifikovaným datům, ale zaměřuje se více na penalizaci tvaru hranice.
Tato konstanta <span class="math inline">\(C\)</span> se defaultně volí rovna 1, můžeme ji určit i přímo například pomocí cross-validace.</p>
<p>Využitím cross-validace můžeme také určit optimální hodnoty ostatních hyperparametrů, které nyní závisí na naší volbě jádrové funkce.
V případě lineárního jádra nevolíme žádný další parametr kromě konstanty <span class="math inline">\(C\)</span>, u polynomiálního a radiálního jádra musíme určit hodnoty hyperparametrů <span class="math inline">\(\alpha_0, \gamma \text{ a } d\)</span>, jejichž defaultní hodnoty v <code>R</code> jsou postupně <span class="math inline">\(\alpha_0^{default} = 0, \gamma^{default} = \frac{1}{dim(\texttt{data})} \text{ a } d^{default} = 3\)</span>.</p>
<p>V případě funkcionálních dat máme několik možností, jak použít metodu SVM.
Nejjednodušší variantou je použít tuto klasifikační metodu přímo na diskretizovanou funkci (sekce <a href="aplikace3.html#diskrA3b">12.5.7.1</a>).
Další možností je opět využít skóre hlavních komponent a klasifikovat křivky pomocí jejich reprezentace <a href="aplikace3.html#PCA-SVMA3b">12.5.7.2</a>.
Další přímočarou variantou je využít vyjádření křivek pomocí B-splinové báze a klasifikovat křivky na základě koeficientů jejich vyjádření v této bázi (sekce <a href="aplikace3.html#basis-SVMA3b">12.5.7.3</a>).</p>
<p>Složitější úvahou můžeme dospět k několika dalším možnostem, které využívají funkcionální podstatu dat.
Jednak můžeme místo klasifikace původní křivky využít její derivaci (případně druhou derivaci, třetí, …), druhak můžeme využít projekce funkcí na podprostor generovaný, např. B-splinovými, funkcemi (sekce <a href="aplikace3.html#projection-SVMA3b">12.5.7.4</a>). Poslední metoda, kterou použijeme pro klasifikaci funkcionálních dat, spočívá v kombinaci projekce na určitý podprostor generovaný funkcemi (Reproducing Kernel Hilbert Space, RKHS) a klasifikace příslušné reprezentace. Tato metoda využívá kromě klasického SVM i SVM pro regresi, více uvádíme v sekci RKHS + SVM <a href="aplikace3.html#RKHS-SVMA3b">12.5.7.5</a>.</p>
<div id="diskrA3b" class="section level4 hasAnchor" number="12.5.7.1">
<h4><span class="header-section-number">12.5.7.1</span> Diskretizace intervalu<a href="aplikace3.html#diskrA3b" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Začněme nejprve aplikací metody podpůrných vektorů přímo na diskretizovaná data (vyhodnocení funkce na dané síti bodů na intervalu <span class="math inline">\(I = [850, 1050]\)</span>), přičemž budeme uvažovat všech tři výše zmíněné jádrové funkce.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="aplikace3.html#cb181-1" tabindex="-1"></a><span class="co"># set norm equal to one</span></span>
<span id="cb181-2"><a href="aplikace3.html#cb181-2" tabindex="-1"></a>norms <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb181-3"><a href="aplikace3.html#cb181-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XXder<span class="sc">$</span>coefs)[<span class="dv">2</span>]) {</span>
<span id="cb181-4"><a href="aplikace3.html#cb181-4" tabindex="-1"></a>  norms <span class="ot">&lt;-</span> <span class="fu">c</span>(norms, <span class="fu">as.numeric</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">norm.fd</span>(XXder[i])))</span>
<span id="cb181-5"><a href="aplikace3.html#cb181-5" tabindex="-1"></a>  }</span>
<span id="cb181-6"><a href="aplikace3.html#cb181-6" tabindex="-1"></a>XXfd_norm_der <span class="ot">&lt;-</span> XXder </span>
<span id="cb181-7"><a href="aplikace3.html#cb181-7" tabindex="-1"></a>XXfd_norm_der<span class="sc">$</span>coefs <span class="ot">&lt;-</span> XXfd_norm_der<span class="sc">$</span>coefs <span class="sc">*</span> <span class="fu">matrix</span>(norms, </span>
<span id="cb181-8"><a href="aplikace3.html#cb181-8" tabindex="-1"></a>                                            <span class="at">ncol =</span> <span class="fu">dim</span>(XXder<span class="sc">$</span>coefs)[<span class="dv">2</span>],</span>
<span id="cb181-9"><a href="aplikace3.html#cb181-9" tabindex="-1"></a>                                            <span class="at">nrow =</span> <span class="fu">dim</span>(XXder<span class="sc">$</span>coefs)[<span class="dv">1</span>],</span>
<span id="cb181-10"><a href="aplikace3.html#cb181-10" tabindex="-1"></a>                                            <span class="at">byrow =</span> T)</span>
<span id="cb181-11"><a href="aplikace3.html#cb181-11" tabindex="-1"></a></span>
<span id="cb181-12"><a href="aplikace3.html#cb181-12" tabindex="-1"></a><span class="co"># rozdeleni na testovaci a trenovaci cast</span></span>
<span id="cb181-13"><a href="aplikace3.html#cb181-13" tabindex="-1"></a>X.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm_der, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb181-14"><a href="aplikace3.html#cb181-14" tabindex="-1"></a>X.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm_der, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb181-15"><a href="aplikace3.html#cb181-15" tabindex="-1"></a></span>
<span id="cb181-16"><a href="aplikace3.html#cb181-16" tabindex="-1"></a>Y.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb181-17"><a href="aplikace3.html#cb181-17" tabindex="-1"></a>Y.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb181-18"><a href="aplikace3.html#cb181-18" tabindex="-1"></a></span>
<span id="cb181-19"><a href="aplikace3.html#cb181-19" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb181-20"><a href="aplikace3.html#cb181-20" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) </span>
<span id="cb181-21"><a href="aplikace3.html#cb181-21" tabindex="-1"></a>grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb181-22"><a href="aplikace3.html#cb181-22" tabindex="-1"></a></span>
<span id="cb181-23"><a href="aplikace3.html#cb181-23" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb181-24"><a href="aplikace3.html#cb181-24" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb181-25"><a href="aplikace3.html#cb181-25" tabindex="-1"></a>grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span></code></pre></div>
</details>
<p>Nyní se pokusme, na rozdíl od postupu v předchozích kapitolách, hyperparametry klasifikátorů odhadnout z dat pomocí 10-násobné cross-validace. Vzhledem k tomu, že každé jádro má ve své definici jiné hyperparametry, budeme ke každé jádrové funkci přistupovat zvlášť. Nicméně hyperparametr <span class="math inline">\(C\)</span> vystupuje u všech jádrových funkcí, přičemž ale připouštíme, že se může jeho optimální hodnota mezi jádry lišit.</p>
<p>U všech třech jader projdeme hodnoty hyperparametru <span class="math inline">\(C\)</span> v intervalu <span class="math inline">\([10^{-3}, 10^{3}]\)</span>, přičemž u jádra polynomiálního zafixujeme hyperparametr <span class="math inline">\(p\)</span> na hodnotě 3, neboť pro jiné celočíselné hodnoty metoda nedává zdaleka tak dobré výsledky. Naopak pro radiální jádro využijeme k volbě optimální hodnoty hyperparametru <span class="math inline">\(\gamma\)</span> opět 10-násobnou CV, přičemž uvažujeme hodnoty v intervalu <span class="math inline">\([10^{-3}, 10^{2}]\)</span>. Zvolíme <code>coef0</code> <span class="math inline">\(= 1\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="aplikace3.html#cb182-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb182-2"><a href="aplikace3.html#cb182-2" tabindex="-1"></a></span>
<span id="cb182-3"><a href="aplikace3.html#cb182-3" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co">#  k-fold CV</span></span>
<span id="cb182-4"><a href="aplikace3.html#cb182-4" tabindex="-1"></a></span>
<span id="cb182-5"><a href="aplikace3.html#cb182-5" tabindex="-1"></a><span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb182-6"><a href="aplikace3.html#cb182-6" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb182-7"><a href="aplikace3.html#cb182-7" tabindex="-1"></a></span>
<span id="cb182-8"><a href="aplikace3.html#cb182-8" tabindex="-1"></a><span class="co"># ktere hodnoty gamma chceme uvazovat</span></span>
<span id="cb182-9"><a href="aplikace3.html#cb182-9" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">15</span>)</span>
<span id="cb182-10"><a href="aplikace3.html#cb182-10" tabindex="-1"></a>C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">20</span>)</span>
<span id="cb182-11"><a href="aplikace3.html#cb182-11" tabindex="-1"></a>p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb182-12"><a href="aplikace3.html#cb182-12" tabindex="-1"></a>coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb182-13"><a href="aplikace3.html#cb182-13" tabindex="-1"></a></span>
<span id="cb182-14"><a href="aplikace3.html#cb182-14" tabindex="-1"></a><span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb182-15"><a href="aplikace3.html#cb182-15" tabindex="-1"></a><span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb182-16"><a href="aplikace3.html#cb182-16" tabindex="-1"></a><span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb182-17"><a href="aplikace3.html#cb182-17" tabindex="-1"></a><span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb182-18"><a href="aplikace3.html#cb182-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb182-19"><a href="aplikace3.html#cb182-19" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb182-20"><a href="aplikace3.html#cb182-20" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb182-21"><a href="aplikace3.html#cb182-21" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb182-22"><a href="aplikace3.html#cb182-22" tabindex="-1"></a>)</span>
<span id="cb182-23"><a href="aplikace3.html#cb182-23" tabindex="-1"></a></span>
<span id="cb182-24"><a href="aplikace3.html#cb182-24" tabindex="-1"></a><span class="co"># nejprve projdeme hodnoty C</span></span>
<span id="cb182-25"><a href="aplikace3.html#cb182-25" tabindex="-1"></a><span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb182-26"><a href="aplikace3.html#cb182-26" tabindex="-1"></a>  <span class="co"># projdeme jednotlive folds</span></span>
<span id="cb182-27"><a href="aplikace3.html#cb182-27" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb182-28"><a href="aplikace3.html#cb182-28" tabindex="-1"></a>    <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb182-29"><a href="aplikace3.html#cb182-29" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb182-30"><a href="aplikace3.html#cb182-30" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb182-31"><a href="aplikace3.html#cb182-31" tabindex="-1"></a>    </span>
<span id="cb182-32"><a href="aplikace3.html#cb182-32" tabindex="-1"></a>    data.grid.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(grid.data[cv_sample, ])</span>
<span id="cb182-33"><a href="aplikace3.html#cb182-33" tabindex="-1"></a>    data.grid.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(grid.data[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb182-34"><a href="aplikace3.html#cb182-34" tabindex="-1"></a>    </span>
<span id="cb182-35"><a href="aplikace3.html#cb182-35" tabindex="-1"></a>    <span class="do">## LINEARNI JADRO</span></span>
<span id="cb182-36"><a href="aplikace3.html#cb182-36" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb182-37"><a href="aplikace3.html#cb182-37" tabindex="-1"></a>    clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb182-38"><a href="aplikace3.html#cb182-38" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb182-39"><a href="aplikace3.html#cb182-39" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb182-40"><a href="aplikace3.html#cb182-40" tabindex="-1"></a>                     <span class="at">cost =</span> C,</span>
<span id="cb182-41"><a href="aplikace3.html#cb182-41" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb182-42"><a href="aplikace3.html#cb182-42" tabindex="-1"></a>    </span>
<span id="cb182-43"><a href="aplikace3.html#cb182-43" tabindex="-1"></a>    <span class="co"># presnost na validacnich datech</span></span>
<span id="cb182-44"><a href="aplikace3.html#cb182-44" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb182-45"><a href="aplikace3.html#cb182-45" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb182-46"><a href="aplikace3.html#cb182-46" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb182-47"><a href="aplikace3.html#cb182-47" tabindex="-1"></a>    </span>
<span id="cb182-48"><a href="aplikace3.html#cb182-48" tabindex="-1"></a>    <span class="co"># presnosti vlozime na pozice pro dane C a fold</span></span>
<span id="cb182-49"><a href="aplikace3.html#cb182-49" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb182-50"><a href="aplikace3.html#cb182-50" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb182-51"><a href="aplikace3.html#cb182-51" tabindex="-1"></a>    </span>
<span id="cb182-52"><a href="aplikace3.html#cb182-52" tabindex="-1"></a>    <span class="do">## POLYNOMIALNI JADRO</span></span>
<span id="cb182-53"><a href="aplikace3.html#cb182-53" tabindex="-1"></a>    <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb182-54"><a href="aplikace3.html#cb182-54" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb182-55"><a href="aplikace3.html#cb182-55" tabindex="-1"></a>      clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb182-56"><a href="aplikace3.html#cb182-56" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb182-57"><a href="aplikace3.html#cb182-57" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb182-58"><a href="aplikace3.html#cb182-58" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb182-59"><a href="aplikace3.html#cb182-59" tabindex="-1"></a>                       <span class="at">coef0 =</span> coef0,</span>
<span id="cb182-60"><a href="aplikace3.html#cb182-60" tabindex="-1"></a>                       <span class="at">degree =</span> p,</span>
<span id="cb182-61"><a href="aplikace3.html#cb182-61" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb182-62"><a href="aplikace3.html#cb182-62" tabindex="-1"></a>      </span>
<span id="cb182-63"><a href="aplikace3.html#cb182-63" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb182-64"><a href="aplikace3.html#cb182-64" tabindex="-1"></a>      predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb182-65"><a href="aplikace3.html#cb182-65" tabindex="-1"></a>      presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb182-66"><a href="aplikace3.html#cb182-66" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb182-67"><a href="aplikace3.html#cb182-67" tabindex="-1"></a>      </span>
<span id="cb182-68"><a href="aplikace3.html#cb182-68" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C, p a fold</span></span>
<span id="cb182-69"><a href="aplikace3.html#cb182-69" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb182-70"><a href="aplikace3.html#cb182-70" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb182-71"><a href="aplikace3.html#cb182-71" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb182-72"><a href="aplikace3.html#cb182-72" tabindex="-1"></a>    }</span>
<span id="cb182-73"><a href="aplikace3.html#cb182-73" tabindex="-1"></a>        </span>
<span id="cb182-74"><a href="aplikace3.html#cb182-74" tabindex="-1"></a>    <span class="do">## RADIALNI JADRO</span></span>
<span id="cb182-75"><a href="aplikace3.html#cb182-75" tabindex="-1"></a>    <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb182-76"><a href="aplikace3.html#cb182-76" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb182-77"><a href="aplikace3.html#cb182-77" tabindex="-1"></a>      clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb182-78"><a href="aplikace3.html#cb182-78" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb182-79"><a href="aplikace3.html#cb182-79" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb182-80"><a href="aplikace3.html#cb182-80" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb182-81"><a href="aplikace3.html#cb182-81" tabindex="-1"></a>                       <span class="at">gamma =</span> gamma,</span>
<span id="cb182-82"><a href="aplikace3.html#cb182-82" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb182-83"><a href="aplikace3.html#cb182-83" tabindex="-1"></a>      </span>
<span id="cb182-84"><a href="aplikace3.html#cb182-84" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb182-85"><a href="aplikace3.html#cb182-85" tabindex="-1"></a>      predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb182-86"><a href="aplikace3.html#cb182-86" tabindex="-1"></a>      presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb182-87"><a href="aplikace3.html#cb182-87" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb182-88"><a href="aplikace3.html#cb182-88" tabindex="-1"></a>      </span>
<span id="cb182-89"><a href="aplikace3.html#cb182-89" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C, gamma a fold</span></span>
<span id="cb182-90"><a href="aplikace3.html#cb182-90" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb182-91"><a href="aplikace3.html#cb182-91" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb182-92"><a href="aplikace3.html#cb182-92" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb182-93"><a href="aplikace3.html#cb182-93" tabindex="-1"></a>    }</span>
<span id="cb182-94"><a href="aplikace3.html#cb182-94" tabindex="-1"></a>  }</span>
<span id="cb182-95"><a href="aplikace3.html#cb182-95" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Nyní zprůměrujeme výsledky 10-násobné CV tak, abychom pro jednu hodnotu hyperparametru (případně jednu kombinaci hodnot) měli jeden odhad validační chybovosti. Přitom určíme i optimální hodnoty jednotlivých hyperparametrů.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="aplikace3.html#cb183-1" tabindex="-1"></a><span class="co"># spocitame prumerne presnosti pro jednotliva C pres folds</span></span>
<span id="cb183-2"><a href="aplikace3.html#cb183-2" tabindex="-1"></a><span class="do">## Linearni jadro</span></span>
<span id="cb183-3"><a href="aplikace3.html#cb183-3" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb183-4"><a href="aplikace3.html#cb183-4" tabindex="-1"></a><span class="do">## Polynomialni jadro</span></span>
<span id="cb183-5"><a href="aplikace3.html#cb183-5" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb183-6"><a href="aplikace3.html#cb183-6" tabindex="-1"></a><span class="do">## Radialni jadro</span></span>
<span id="cb183-7"><a href="aplikace3.html#cb183-7" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb183-8"><a href="aplikace3.html#cb183-8" tabindex="-1"></a></span>
<span id="cb183-9"><a href="aplikace3.html#cb183-9" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb183-10"><a href="aplikace3.html#cb183-10" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb183-11"><a href="aplikace3.html#cb183-11" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb183-12"><a href="aplikace3.html#cb183-12" tabindex="-1"></a>C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb183-13"><a href="aplikace3.html#cb183-13" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb183-14"><a href="aplikace3.html#cb183-14" tabindex="-1"></a></span>
<span id="cb183-15"><a href="aplikace3.html#cb183-15" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb183-16"><a href="aplikace3.html#cb183-16" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb183-17"><a href="aplikace3.html#cb183-17" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb183-18"><a href="aplikace3.html#cb183-18" tabindex="-1"></a></span>
<span id="cb183-19"><a href="aplikace3.html#cb183-19" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb183-20"><a href="aplikace3.html#cb183-20" tabindex="-1"></a>p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb183-21"><a href="aplikace3.html#cb183-21" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb183-22"><a href="aplikace3.html#cb183-22" tabindex="-1"></a></span>
<span id="cb183-23"><a href="aplikace3.html#cb183-23" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb183-24"><a href="aplikace3.html#cb183-24" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb183-25"><a href="aplikace3.html#cb183-25" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span></code></pre></div>
</details>
<p>Podívejme se, jak dopadly optimální hodnoty. Pro <em>lineární jádro</em> máme optimální hodnotu <span class="math inline">\(C\)</span> rovnu 0.001, pro <em>polynomiální jádro</em> je <span class="math inline">\(C\)</span> rovno 0.0785 a pro <em>radiální jádro</em> máme dvě optimální hodnoty, pro <span class="math inline">\(C\)</span> je optimální hodnota 0.336 a pro <span class="math inline">\(\gamma\)</span> je to 0.0052. Validační chybovosti jsou postupně 0.0066667 pro lineární, 0.0066667 pro polynomiální a 0.0066667 pro radiální jádro.</p>
<p>Konečně můžeme sestrojit finální klasifikátory na celých trénovacích datech s hodnotami hyperparametrů určenými pomocí 10-násobné CV. Určíme také chybovosti na testovacích a také na trénovacích datech.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="aplikace3.html#cb184-1" tabindex="-1"></a><span class="co"># sestrojeni modelu</span></span>
<span id="cb184-2"><a href="aplikace3.html#cb184-2" tabindex="-1"></a>clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb184-3"><a href="aplikace3.html#cb184-3" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb184-4"><a href="aplikace3.html#cb184-4" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb184-5"><a href="aplikace3.html#cb184-5" tabindex="-1"></a>                 <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb184-6"><a href="aplikace3.html#cb184-6" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb184-7"><a href="aplikace3.html#cb184-7" tabindex="-1"></a></span>
<span id="cb184-8"><a href="aplikace3.html#cb184-8" tabindex="-1"></a>clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb184-9"><a href="aplikace3.html#cb184-9" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb184-10"><a href="aplikace3.html#cb184-10" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb184-11"><a href="aplikace3.html#cb184-11" tabindex="-1"></a>                 <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb184-12"><a href="aplikace3.html#cb184-12" tabindex="-1"></a>                 <span class="at">degree =</span> p.opt,</span>
<span id="cb184-13"><a href="aplikace3.html#cb184-13" tabindex="-1"></a>                 <span class="at">coef0 =</span> coef0,</span>
<span id="cb184-14"><a href="aplikace3.html#cb184-14" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb184-15"><a href="aplikace3.html#cb184-15" tabindex="-1"></a></span>
<span id="cb184-16"><a href="aplikace3.html#cb184-16" tabindex="-1"></a>clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb184-17"><a href="aplikace3.html#cb184-17" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb184-18"><a href="aplikace3.html#cb184-18" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>, </span>
<span id="cb184-19"><a href="aplikace3.html#cb184-19" tabindex="-1"></a>                 <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb184-20"><a href="aplikace3.html#cb184-20" tabindex="-1"></a>                 <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb184-21"><a href="aplikace3.html#cb184-21" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb184-22"><a href="aplikace3.html#cb184-22" tabindex="-1"></a></span>
<span id="cb184-23"><a href="aplikace3.html#cb184-23" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb184-24"><a href="aplikace3.html#cb184-24" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data)</span>
<span id="cb184-25"><a href="aplikace3.html#cb184-25" tabindex="-1"></a>presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb184-26"><a href="aplikace3.html#cb184-26" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb184-27"><a href="aplikace3.html#cb184-27" tabindex="-1"></a></span>
<span id="cb184-28"><a href="aplikace3.html#cb184-28" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data)</span>
<span id="cb184-29"><a href="aplikace3.html#cb184-29" tabindex="-1"></a>presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb184-30"><a href="aplikace3.html#cb184-30" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb184-31"><a href="aplikace3.html#cb184-31" tabindex="-1"></a></span>
<span id="cb184-32"><a href="aplikace3.html#cb184-32" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data)</span>
<span id="cb184-33"><a href="aplikace3.html#cb184-33" tabindex="-1"></a>presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb184-34"><a href="aplikace3.html#cb184-34" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb184-35"><a href="aplikace3.html#cb184-35" tabindex="-1"></a></span>
<span id="cb184-36"><a href="aplikace3.html#cb184-36" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb184-37"><a href="aplikace3.html#cb184-37" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb184-38"><a href="aplikace3.html#cb184-38" tabindex="-1"></a>presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb184-39"><a href="aplikace3.html#cb184-39" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb184-40"><a href="aplikace3.html#cb184-40" tabindex="-1"></a></span>
<span id="cb184-41"><a href="aplikace3.html#cb184-41" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb184-42"><a href="aplikace3.html#cb184-42" tabindex="-1"></a>presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb184-43"><a href="aplikace3.html#cb184-43" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb184-44"><a href="aplikace3.html#cb184-44" tabindex="-1"></a></span>
<span id="cb184-45"><a href="aplikace3.html#cb184-45" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb184-46"><a href="aplikace3.html#cb184-46" tabindex="-1"></a>presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb184-47"><a href="aplikace3.html#cb184-47" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Chybovost metody SVM na trénovacích datech je tedy 0.6667 % pro lineární jádro, 0.6667 % pro polynomiální jádro a 0.6667 % pro gaussovské jádro.
Na testovacích datech je potom chybovost metody 1.5385 % pro lineární jádro, 6.1538 % pro polynomiální jádro a 1.5385 % pro radiální jádro.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="aplikace3.html#cb185-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - diskr&#39;</span>, </span>
<span id="cb185-2"><a href="aplikace3.html#cb185-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - diskr&#39;</span>, </span>
<span id="cb185-3"><a href="aplikace3.html#cb185-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - diskr&#39;</span>), </span>
<span id="cb185-4"><a href="aplikace3.html#cb185-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb185-5"><a href="aplikace3.html#cb185-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb185-6"><a href="aplikace3.html#cb185-6" tabindex="-1"></a></span>
<span id="cb185-7"><a href="aplikace3.html#cb185-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="PCA-SVMA3b" class="section level4 hasAnchor" number="12.5.7.2">
<h4><span class="header-section-number">12.5.7.2</span> Skóre hlavních komponent<a href="aplikace3.html#PCA-SVMA3b" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>V tomto případě využijeme skóre prvních <span class="math inline">\(p =\)</span> 2 hlavních komponent.</p>
<p>Nyní se pokusme, na rozdíl od postupu v předchozích kapitolách, hyperparametry klasifikátorů odhadnout z dat pomocí 10-násobné cross-validace. Vzhledem k tomu, že každé jádro má ve své definici jiné hyperparametry, budeme ke každé jádrové funkci přistupovat zvlášť. Nicméně hyperparametr <span class="math inline">\(C\)</span> vystupuje u všech jádrových funkcí, přičemž ale připouštíme, že se může jeho optimální hodnota mezi jádry lišit.</p>
<p>U všech třech jader projdeme hodnoty hyperparametru <span class="math inline">\(C\)</span> v intervalu <span class="math inline">\([10^{-3}, 10^{3}]\)</span>, přičemž u jádra polynomiálního zafixujeme hyperparametr <span class="math inline">\(p\)</span> na hodnotě 3, neboť pro jiné celočíselné hodnoty metoda nedává zdaleka tak dobré výsledky. Naopak pro radiální jádro využijeme k volbě optimální hodnoty hyperparametru <span class="math inline">\(\gamma\)</span> opět 10-násobnou CV, přičemž uvažujeme hodnoty v intervalu <span class="math inline">\([10^{-3}, 10^{2}]\)</span>. Zvolíme <code>coef0</code> <span class="math inline">\(= 1\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="aplikace3.html#cb186-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb186-2"><a href="aplikace3.html#cb186-2" tabindex="-1"></a></span>
<span id="cb186-3"><a href="aplikace3.html#cb186-3" tabindex="-1"></a><span class="co"># ktere hodnoty gamma chceme uvazovat</span></span>
<span id="cb186-4"><a href="aplikace3.html#cb186-4" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">15</span>)</span>
<span id="cb186-5"><a href="aplikace3.html#cb186-5" tabindex="-1"></a>C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">20</span>)</span>
<span id="cb186-6"><a href="aplikace3.html#cb186-6" tabindex="-1"></a>p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb186-7"><a href="aplikace3.html#cb186-7" tabindex="-1"></a>coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb186-8"><a href="aplikace3.html#cb186-8" tabindex="-1"></a></span>
<span id="cb186-9"><a href="aplikace3.html#cb186-9" tabindex="-1"></a><span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb186-10"><a href="aplikace3.html#cb186-10" tabindex="-1"></a><span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb186-11"><a href="aplikace3.html#cb186-11" tabindex="-1"></a><span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb186-12"><a href="aplikace3.html#cb186-12" tabindex="-1"></a><span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb186-13"><a href="aplikace3.html#cb186-13" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb186-14"><a href="aplikace3.html#cb186-14" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb186-15"><a href="aplikace3.html#cb186-15" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb186-16"><a href="aplikace3.html#cb186-16" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb186-17"><a href="aplikace3.html#cb186-17" tabindex="-1"></a>)</span>
<span id="cb186-18"><a href="aplikace3.html#cb186-18" tabindex="-1"></a></span>
<span id="cb186-19"><a href="aplikace3.html#cb186-19" tabindex="-1"></a><span class="co"># nejprve projdeme hodnoty C</span></span>
<span id="cb186-20"><a href="aplikace3.html#cb186-20" tabindex="-1"></a><span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb186-21"><a href="aplikace3.html#cb186-21" tabindex="-1"></a>  <span class="co"># projdeme jednotlive folds</span></span>
<span id="cb186-22"><a href="aplikace3.html#cb186-22" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb186-23"><a href="aplikace3.html#cb186-23" tabindex="-1"></a>    <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb186-24"><a href="aplikace3.html#cb186-24" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb186-25"><a href="aplikace3.html#cb186-25" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.PCA.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb186-26"><a href="aplikace3.html#cb186-26" tabindex="-1"></a>    </span>
<span id="cb186-27"><a href="aplikace3.html#cb186-27" tabindex="-1"></a>    data.PCA.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA.train[cv_sample, ])</span>
<span id="cb186-28"><a href="aplikace3.html#cb186-28" tabindex="-1"></a>    data.PCA.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb186-29"><a href="aplikace3.html#cb186-29" tabindex="-1"></a>    </span>
<span id="cb186-30"><a href="aplikace3.html#cb186-30" tabindex="-1"></a>    <span class="do">## LINEARNI JADRO</span></span>
<span id="cb186-31"><a href="aplikace3.html#cb186-31" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb186-32"><a href="aplikace3.html#cb186-32" tabindex="-1"></a>    clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb186-33"><a href="aplikace3.html#cb186-33" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb186-34"><a href="aplikace3.html#cb186-34" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb186-35"><a href="aplikace3.html#cb186-35" tabindex="-1"></a>                     <span class="at">cost =</span> C,</span>
<span id="cb186-36"><a href="aplikace3.html#cb186-36" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb186-37"><a href="aplikace3.html#cb186-37" tabindex="-1"></a>    </span>
<span id="cb186-38"><a href="aplikace3.html#cb186-38" tabindex="-1"></a>    <span class="co"># presnost na validacnich datech</span></span>
<span id="cb186-39"><a href="aplikace3.html#cb186-39" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb186-40"><a href="aplikace3.html#cb186-40" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb186-41"><a href="aplikace3.html#cb186-41" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb186-42"><a href="aplikace3.html#cb186-42" tabindex="-1"></a>    </span>
<span id="cb186-43"><a href="aplikace3.html#cb186-43" tabindex="-1"></a>    <span class="co"># presnosti vlozime na pozice pro dane C a fold</span></span>
<span id="cb186-44"><a href="aplikace3.html#cb186-44" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb186-45"><a href="aplikace3.html#cb186-45" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb186-46"><a href="aplikace3.html#cb186-46" tabindex="-1"></a>    </span>
<span id="cb186-47"><a href="aplikace3.html#cb186-47" tabindex="-1"></a>    <span class="do">## POLYNOMIALNI JADRO</span></span>
<span id="cb186-48"><a href="aplikace3.html#cb186-48" tabindex="-1"></a>    <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb186-49"><a href="aplikace3.html#cb186-49" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb186-50"><a href="aplikace3.html#cb186-50" tabindex="-1"></a>      clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb186-51"><a href="aplikace3.html#cb186-51" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb186-52"><a href="aplikace3.html#cb186-52" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb186-53"><a href="aplikace3.html#cb186-53" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb186-54"><a href="aplikace3.html#cb186-54" tabindex="-1"></a>                       <span class="at">coef0 =</span> coef0,</span>
<span id="cb186-55"><a href="aplikace3.html#cb186-55" tabindex="-1"></a>                       <span class="at">degree =</span> p,</span>
<span id="cb186-56"><a href="aplikace3.html#cb186-56" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb186-57"><a href="aplikace3.html#cb186-57" tabindex="-1"></a>      </span>
<span id="cb186-58"><a href="aplikace3.html#cb186-58" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb186-59"><a href="aplikace3.html#cb186-59" tabindex="-1"></a>      predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb186-60"><a href="aplikace3.html#cb186-60" tabindex="-1"></a>      presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb186-61"><a href="aplikace3.html#cb186-61" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb186-62"><a href="aplikace3.html#cb186-62" tabindex="-1"></a>      </span>
<span id="cb186-63"><a href="aplikace3.html#cb186-63" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C, p a fold</span></span>
<span id="cb186-64"><a href="aplikace3.html#cb186-64" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb186-65"><a href="aplikace3.html#cb186-65" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb186-66"><a href="aplikace3.html#cb186-66" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb186-67"><a href="aplikace3.html#cb186-67" tabindex="-1"></a>    }</span>
<span id="cb186-68"><a href="aplikace3.html#cb186-68" tabindex="-1"></a>        </span>
<span id="cb186-69"><a href="aplikace3.html#cb186-69" tabindex="-1"></a>    <span class="do">## RADIALNI JADRO</span></span>
<span id="cb186-70"><a href="aplikace3.html#cb186-70" tabindex="-1"></a>    <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb186-71"><a href="aplikace3.html#cb186-71" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb186-72"><a href="aplikace3.html#cb186-72" tabindex="-1"></a>      clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb186-73"><a href="aplikace3.html#cb186-73" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb186-74"><a href="aplikace3.html#cb186-74" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb186-75"><a href="aplikace3.html#cb186-75" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb186-76"><a href="aplikace3.html#cb186-76" tabindex="-1"></a>                       <span class="at">gamma =</span> gamma,</span>
<span id="cb186-77"><a href="aplikace3.html#cb186-77" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb186-78"><a href="aplikace3.html#cb186-78" tabindex="-1"></a>      </span>
<span id="cb186-79"><a href="aplikace3.html#cb186-79" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb186-80"><a href="aplikace3.html#cb186-80" tabindex="-1"></a>      predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb186-81"><a href="aplikace3.html#cb186-81" tabindex="-1"></a>      presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb186-82"><a href="aplikace3.html#cb186-82" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb186-83"><a href="aplikace3.html#cb186-83" tabindex="-1"></a>      </span>
<span id="cb186-84"><a href="aplikace3.html#cb186-84" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C, gamma a fold</span></span>
<span id="cb186-85"><a href="aplikace3.html#cb186-85" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb186-86"><a href="aplikace3.html#cb186-86" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb186-87"><a href="aplikace3.html#cb186-87" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb186-88"><a href="aplikace3.html#cb186-88" tabindex="-1"></a>    }</span>
<span id="cb186-89"><a href="aplikace3.html#cb186-89" tabindex="-1"></a>  }</span>
<span id="cb186-90"><a href="aplikace3.html#cb186-90" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Nyní zprůměrujeme výsledky 10-násobné CV tak, abychom pro jednu hodnotu hyperparametru (případně jednu kombinaci hodnot) měli jeden odhad validační chybovosti. Přitom určíme i optimální hodnoty jednotlivých hyperparametrů.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="aplikace3.html#cb187-1" tabindex="-1"></a><span class="co"># spocitame prumerne presnosti pro jednotliva C pres folds</span></span>
<span id="cb187-2"><a href="aplikace3.html#cb187-2" tabindex="-1"></a><span class="do">## Linearni jadro</span></span>
<span id="cb187-3"><a href="aplikace3.html#cb187-3" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb187-4"><a href="aplikace3.html#cb187-4" tabindex="-1"></a><span class="do">## Polynomialni jadro</span></span>
<span id="cb187-5"><a href="aplikace3.html#cb187-5" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb187-6"><a href="aplikace3.html#cb187-6" tabindex="-1"></a><span class="do">## Radialni jadro</span></span>
<span id="cb187-7"><a href="aplikace3.html#cb187-7" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb187-8"><a href="aplikace3.html#cb187-8" tabindex="-1"></a></span>
<span id="cb187-9"><a href="aplikace3.html#cb187-9" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb187-10"><a href="aplikace3.html#cb187-10" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb187-11"><a href="aplikace3.html#cb187-11" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb187-12"><a href="aplikace3.html#cb187-12" tabindex="-1"></a>C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb187-13"><a href="aplikace3.html#cb187-13" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb187-14"><a href="aplikace3.html#cb187-14" tabindex="-1"></a></span>
<span id="cb187-15"><a href="aplikace3.html#cb187-15" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb187-16"><a href="aplikace3.html#cb187-16" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb187-17"><a href="aplikace3.html#cb187-17" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb187-18"><a href="aplikace3.html#cb187-18" tabindex="-1"></a></span>
<span id="cb187-19"><a href="aplikace3.html#cb187-19" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb187-20"><a href="aplikace3.html#cb187-20" tabindex="-1"></a>p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb187-21"><a href="aplikace3.html#cb187-21" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb187-22"><a href="aplikace3.html#cb187-22" tabindex="-1"></a></span>
<span id="cb187-23"><a href="aplikace3.html#cb187-23" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb187-24"><a href="aplikace3.html#cb187-24" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb187-25"><a href="aplikace3.html#cb187-25" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span></code></pre></div>
</details>
<p>Podívejme se, jak dopadly optimální hodnoty. Pro <em>lineární jádro</em> máme optimální hodnotu <span class="math inline">\(C\)</span> rovnu 2.9764, pro <em>polynomiální jádro</em> je <span class="math inline">\(C\)</span> rovno 0.6952 a pro <em>radiální jádro</em> máme dvě optimální hodnoty, pro <span class="math inline">\(C\)</span> je optimální hodnota 1000 a pro <span class="math inline">\(\gamma\)</span> je to 1.6379. Validační chybovosti jsou postupně 0.0066667 pro lineární, 0.0066667 pro polynomiální a 0.0066667 pro radiální jádro.</p>
<p>Konečně můžeme sestrojit finální klasifikátory na celých trénovacích datech s hodnotami hyperparametrů určenými pomocí 10-násobné CV. Určíme také chybovosti na testovacích a také na trénovacích datech.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="aplikace3.html#cb188-1" tabindex="-1"></a><span class="co"># sestrojeni modelu</span></span>
<span id="cb188-2"><a href="aplikace3.html#cb188-2" tabindex="-1"></a>clf.SVM.l.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb188-3"><a href="aplikace3.html#cb188-3" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb188-4"><a href="aplikace3.html#cb188-4" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb188-5"><a href="aplikace3.html#cb188-5" tabindex="-1"></a>                     <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb188-6"><a href="aplikace3.html#cb188-6" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb188-7"><a href="aplikace3.html#cb188-7" tabindex="-1"></a></span>
<span id="cb188-8"><a href="aplikace3.html#cb188-8" tabindex="-1"></a>clf.SVM.p.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb188-9"><a href="aplikace3.html#cb188-9" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb188-10"><a href="aplikace3.html#cb188-10" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb188-11"><a href="aplikace3.html#cb188-11" tabindex="-1"></a>                     <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb188-12"><a href="aplikace3.html#cb188-12" tabindex="-1"></a>                     <span class="at">degree =</span> p.opt,</span>
<span id="cb188-13"><a href="aplikace3.html#cb188-13" tabindex="-1"></a>                     <span class="at">coef0 =</span> coef0,</span>
<span id="cb188-14"><a href="aplikace3.html#cb188-14" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb188-15"><a href="aplikace3.html#cb188-15" tabindex="-1"></a></span>
<span id="cb188-16"><a href="aplikace3.html#cb188-16" tabindex="-1"></a>clf.SVM.r.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb188-17"><a href="aplikace3.html#cb188-17" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb188-18"><a href="aplikace3.html#cb188-18" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb188-19"><a href="aplikace3.html#cb188-19" tabindex="-1"></a>                     <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb188-20"><a href="aplikace3.html#cb188-20" tabindex="-1"></a>                     <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb188-21"><a href="aplikace3.html#cb188-21" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb188-22"><a href="aplikace3.html#cb188-22" tabindex="-1"></a></span>
<span id="cb188-23"><a href="aplikace3.html#cb188-23" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb188-24"><a href="aplikace3.html#cb188-24" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb188-25"><a href="aplikace3.html#cb188-25" tabindex="-1"></a>presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb188-26"><a href="aplikace3.html#cb188-26" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb188-27"><a href="aplikace3.html#cb188-27" tabindex="-1"></a></span>
<span id="cb188-28"><a href="aplikace3.html#cb188-28" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb188-29"><a href="aplikace3.html#cb188-29" tabindex="-1"></a>presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb188-30"><a href="aplikace3.html#cb188-30" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb188-31"><a href="aplikace3.html#cb188-31" tabindex="-1"></a></span>
<span id="cb188-32"><a href="aplikace3.html#cb188-32" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb188-33"><a href="aplikace3.html#cb188-33" tabindex="-1"></a>presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb188-34"><a href="aplikace3.html#cb188-34" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb188-35"><a href="aplikace3.html#cb188-35" tabindex="-1"></a>  </span>
<span id="cb188-36"><a href="aplikace3.html#cb188-36" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb188-37"><a href="aplikace3.html#cb188-37" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb188-38"><a href="aplikace3.html#cb188-38" tabindex="-1"></a>presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb188-39"><a href="aplikace3.html#cb188-39" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb188-40"><a href="aplikace3.html#cb188-40" tabindex="-1"></a></span>
<span id="cb188-41"><a href="aplikace3.html#cb188-41" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb188-42"><a href="aplikace3.html#cb188-42" tabindex="-1"></a>presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb188-43"><a href="aplikace3.html#cb188-43" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb188-44"><a href="aplikace3.html#cb188-44" tabindex="-1"></a></span>
<span id="cb188-45"><a href="aplikace3.html#cb188-45" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb188-46"><a href="aplikace3.html#cb188-46" tabindex="-1"></a>presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb188-47"><a href="aplikace3.html#cb188-47" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Chybovost metody SVM aplikované na skóre hlavních komponent na trénovacích datech je tedy 0.67 % pro lineární jádro, 0.67 % pro polynomiální jádro a 0.67 % pro gaussovské jádro.
Na testovacích datech je potom chybovost metody 4.6154 % pro lineární jádro, 1.5385 % pro polynomiální jádro a 3.0769 % pro radiální jádro.</p>
<p>Pro grafické znázornění metody můžeme zaznačit dělící hranici do grafu skórů prvních dvou hlavních komponent.
Tuto hranici spočítáme na husté síti bodů a zobrazíme ji pomocí funkce <code>geom_contour()</code> stejně jako v předchozích případech, kdy jsme také vykreslovali klasifikační hranici.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="aplikace3.html#cb189-1" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">rbind</span>(nd, nd, nd) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb189-2"><a href="aplikace3.html#cb189-2" tabindex="-1"></a>   <span class="at">prd =</span> <span class="fu">c</span>(<span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)),</span>
<span id="cb189-3"><a href="aplikace3.html#cb189-3" tabindex="-1"></a>           <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)),</span>
<span id="cb189-4"><a href="aplikace3.html#cb189-4" tabindex="-1"></a>           <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>))),</span>
<span id="cb189-5"><a href="aplikace3.html#cb189-5" tabindex="-1"></a>   <span class="at">kernel =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;lineární&#39;</span>, <span class="st">&#39;polynomiální&#39;</span>, <span class="st">&#39;radiální&#39;</span>),</span>
<span id="cb189-6"><a href="aplikace3.html#cb189-6" tabindex="-1"></a>                <span class="at">each =</span> <span class="fu">length</span>(<span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.l.PCA, </span>
<span id="cb189-7"><a href="aplikace3.html#cb189-7" tabindex="-1"></a>                                                 <span class="at">newdata =</span> nd,</span>
<span id="cb189-8"><a href="aplikace3.html#cb189-8" tabindex="-1"></a>                                                 <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)))) <span class="sc">|&gt;</span></span>
<span id="cb189-9"><a href="aplikace3.html#cb189-9" tabindex="-1"></a>     <span class="fu">as.factor</span>())</span>
<span id="cb189-10"><a href="aplikace3.html#cb189-10" tabindex="-1"></a></span>
<span id="cb189-11"><a href="aplikace3.html#cb189-11" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb189-12"><a href="aplikace3.html#cb189-12" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb189-13"><a href="aplikace3.html#cb189-13" tabindex="-1"></a> <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1. hlavní komponenta (vysvětlená variabilita&#39;</span>, </span>
<span id="cb189-14"><a href="aplikace3.html#cb189-14" tabindex="-1"></a>                <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb189-15"><a href="aplikace3.html#cb189-15" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2. hlavní komponenta (&#39;</span>, </span>
<span id="cb189-16"><a href="aplikace3.html#cb189-16" tabindex="-1"></a>                <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb189-17"><a href="aplikace3.html#cb189-17" tabindex="-1"></a>      <span class="at">colour =</span> <span class="st">&#39;Obsah tuku&#39;</span>, </span>
<span id="cb189-18"><a href="aplikace3.html#cb189-18" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="st">&#39;Jádro&#39;</span>) <span class="sc">+</span></span>
<span id="cb189-19"><a href="aplikace3.html#cb189-19" tabindex="-1"></a> <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;malý&quot;</span>, <span class="st">&quot;velký&quot;</span>)) <span class="sc">+</span></span>
<span id="cb189-20"><a href="aplikace3.html#cb189-20" tabindex="-1"></a> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb189-21"><a href="aplikace3.html#cb189-21" tabindex="-1"></a> <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd, <span class="at">linetype =</span> kernel), </span>
<span id="cb189-22"><a href="aplikace3.html#cb189-22" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-183"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-183-1.png" alt="Skóre prvních dvou hlavních komponent, barevně odlišené podle příslušnosti do klasifikační třídy. Černě je vyznačena dělící hranice (přímka, resp. křivky v rovině prvních dvou hlavních komponent) mezi třídami sestrojená pomocí metody SVM." width="672" />
<p class="caption">
Obrázek 12.38: Skóre prvních dvou hlavních komponent, barevně odlišené podle příslušnosti do klasifikační třídy. Černě je vyznačena dělící hranice (přímka, resp. křivky v rovině prvních dvou hlavních komponent) mezi třídami sestrojená pomocí metody SVM.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="aplikace3.html#cb190-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - PCA&#39;</span>, </span>
<span id="cb190-2"><a href="aplikace3.html#cb190-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - PCA&#39;</span>, </span>
<span id="cb190-3"><a href="aplikace3.html#cb190-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - PCA&#39;</span>), </span>
<span id="cb190-4"><a href="aplikace3.html#cb190-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb190-5"><a href="aplikace3.html#cb190-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb190-6"><a href="aplikace3.html#cb190-6" tabindex="-1"></a></span>
<span id="cb190-7"><a href="aplikace3.html#cb190-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="basis-SVMA3b" class="section level4 hasAnchor" number="12.5.7.3">
<h4><span class="header-section-number">12.5.7.3</span> Bázové koeficienty<a href="aplikace3.html#basis-SVMA3b" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Nakonec použijeme vyjádření funkcí pomocí B-splinové báze.
U všech třech jader projdeme hodnoty hyperparametru <span class="math inline">\(C\)</span> v intervalu <span class="math inline">\([10^{-3}, 10^{3}]\)</span>, přičemž u jádra polynomiálního zafixujeme hyperparametr <span class="math inline">\(p\)</span> na hodnotě 3, neboť pro jiné celočíselné hodnoty metoda nedává zdaleka tak dobré výsledky. Naopak pro radiální jádro využijeme k volbě optimální hodnoty hyperparametru <span class="math inline">\(\gamma\)</span> opět 10-násobnou CV, přičemž uvažujeme hodnoty v intervalu <span class="math inline">\([10^{-3}, 10^{2}]\)</span>. Zvolíme <code>coef0</code> <span class="math inline">\(= 1\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="aplikace3.html#cb191-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb191-2"><a href="aplikace3.html#cb191-2" tabindex="-1"></a></span>
<span id="cb191-3"><a href="aplikace3.html#cb191-3" tabindex="-1"></a><span class="co"># ktere hodnoty gamma chceme uvazovat</span></span>
<span id="cb191-4"><a href="aplikace3.html#cb191-4" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">15</span>)</span>
<span id="cb191-5"><a href="aplikace3.html#cb191-5" tabindex="-1"></a>C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">20</span>)</span>
<span id="cb191-6"><a href="aplikace3.html#cb191-6" tabindex="-1"></a>p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb191-7"><a href="aplikace3.html#cb191-7" tabindex="-1"></a>coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb191-8"><a href="aplikace3.html#cb191-8" tabindex="-1"></a></span>
<span id="cb191-9"><a href="aplikace3.html#cb191-9" tabindex="-1"></a><span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb191-10"><a href="aplikace3.html#cb191-10" tabindex="-1"></a><span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb191-11"><a href="aplikace3.html#cb191-11" tabindex="-1"></a><span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb191-12"><a href="aplikace3.html#cb191-12" tabindex="-1"></a><span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb191-13"><a href="aplikace3.html#cb191-13" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb191-14"><a href="aplikace3.html#cb191-14" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb191-15"><a href="aplikace3.html#cb191-15" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb191-16"><a href="aplikace3.html#cb191-16" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb191-17"><a href="aplikace3.html#cb191-17" tabindex="-1"></a>)</span>
<span id="cb191-18"><a href="aplikace3.html#cb191-18" tabindex="-1"></a></span>
<span id="cb191-19"><a href="aplikace3.html#cb191-19" tabindex="-1"></a><span class="co"># nejprve projdeme hodnoty C</span></span>
<span id="cb191-20"><a href="aplikace3.html#cb191-20" tabindex="-1"></a><span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb191-21"><a href="aplikace3.html#cb191-21" tabindex="-1"></a>  <span class="co"># projdeme jednotlive folds</span></span>
<span id="cb191-22"><a href="aplikace3.html#cb191-22" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb191-23"><a href="aplikace3.html#cb191-23" tabindex="-1"></a>    <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb191-24"><a href="aplikace3.html#cb191-24" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb191-25"><a href="aplikace3.html#cb191-25" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb191-26"><a href="aplikace3.html#cb191-26" tabindex="-1"></a>    </span>
<span id="cb191-27"><a href="aplikace3.html#cb191-27" tabindex="-1"></a>    data.Bbasis.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.Bbasis.train[cv_sample, ])</span>
<span id="cb191-28"><a href="aplikace3.html#cb191-28" tabindex="-1"></a>    data.Bbasis.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.Bbasis.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb191-29"><a href="aplikace3.html#cb191-29" tabindex="-1"></a>    </span>
<span id="cb191-30"><a href="aplikace3.html#cb191-30" tabindex="-1"></a>    <span class="do">## LINEARNI JADRO</span></span>
<span id="cb191-31"><a href="aplikace3.html#cb191-31" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb191-32"><a href="aplikace3.html#cb191-32" tabindex="-1"></a>    clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb191-33"><a href="aplikace3.html#cb191-33" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb191-34"><a href="aplikace3.html#cb191-34" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb191-35"><a href="aplikace3.html#cb191-35" tabindex="-1"></a>                     <span class="at">cost =</span> C,</span>
<span id="cb191-36"><a href="aplikace3.html#cb191-36" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb191-37"><a href="aplikace3.html#cb191-37" tabindex="-1"></a>    </span>
<span id="cb191-38"><a href="aplikace3.html#cb191-38" tabindex="-1"></a>    <span class="co"># presnost na validacnich datech</span></span>
<span id="cb191-39"><a href="aplikace3.html#cb191-39" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb191-40"><a href="aplikace3.html#cb191-40" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb191-41"><a href="aplikace3.html#cb191-41" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb191-42"><a href="aplikace3.html#cb191-42" tabindex="-1"></a>    </span>
<span id="cb191-43"><a href="aplikace3.html#cb191-43" tabindex="-1"></a>    <span class="co"># presnosti vlozime na pozice pro dane C a fold</span></span>
<span id="cb191-44"><a href="aplikace3.html#cb191-44" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb191-45"><a href="aplikace3.html#cb191-45" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb191-46"><a href="aplikace3.html#cb191-46" tabindex="-1"></a>    </span>
<span id="cb191-47"><a href="aplikace3.html#cb191-47" tabindex="-1"></a>    <span class="do">## POLYNOMIALNI JADRO</span></span>
<span id="cb191-48"><a href="aplikace3.html#cb191-48" tabindex="-1"></a>    <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb191-49"><a href="aplikace3.html#cb191-49" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb191-50"><a href="aplikace3.html#cb191-50" tabindex="-1"></a>      clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb191-51"><a href="aplikace3.html#cb191-51" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb191-52"><a href="aplikace3.html#cb191-52" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb191-53"><a href="aplikace3.html#cb191-53" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb191-54"><a href="aplikace3.html#cb191-54" tabindex="-1"></a>                       <span class="at">coef0 =</span> coef0,</span>
<span id="cb191-55"><a href="aplikace3.html#cb191-55" tabindex="-1"></a>                       <span class="at">degree =</span> p,</span>
<span id="cb191-56"><a href="aplikace3.html#cb191-56" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb191-57"><a href="aplikace3.html#cb191-57" tabindex="-1"></a>      </span>
<span id="cb191-58"><a href="aplikace3.html#cb191-58" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb191-59"><a href="aplikace3.html#cb191-59" tabindex="-1"></a>      predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, </span>
<span id="cb191-60"><a href="aplikace3.html#cb191-60" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb191-61"><a href="aplikace3.html#cb191-61" tabindex="-1"></a>      presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb191-62"><a href="aplikace3.html#cb191-62" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb191-63"><a href="aplikace3.html#cb191-63" tabindex="-1"></a>      </span>
<span id="cb191-64"><a href="aplikace3.html#cb191-64" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C, p a fold</span></span>
<span id="cb191-65"><a href="aplikace3.html#cb191-65" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb191-66"><a href="aplikace3.html#cb191-66" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb191-67"><a href="aplikace3.html#cb191-67" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb191-68"><a href="aplikace3.html#cb191-68" tabindex="-1"></a>    }</span>
<span id="cb191-69"><a href="aplikace3.html#cb191-69" tabindex="-1"></a>        </span>
<span id="cb191-70"><a href="aplikace3.html#cb191-70" tabindex="-1"></a>    <span class="do">## RADIALNI JADRO</span></span>
<span id="cb191-71"><a href="aplikace3.html#cb191-71" tabindex="-1"></a>    <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb191-72"><a href="aplikace3.html#cb191-72" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb191-73"><a href="aplikace3.html#cb191-73" tabindex="-1"></a>      clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb191-74"><a href="aplikace3.html#cb191-74" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb191-75"><a href="aplikace3.html#cb191-75" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb191-76"><a href="aplikace3.html#cb191-76" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb191-77"><a href="aplikace3.html#cb191-77" tabindex="-1"></a>                       <span class="at">gamma =</span> gamma,</span>
<span id="cb191-78"><a href="aplikace3.html#cb191-78" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb191-79"><a href="aplikace3.html#cb191-79" tabindex="-1"></a>      </span>
<span id="cb191-80"><a href="aplikace3.html#cb191-80" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb191-81"><a href="aplikace3.html#cb191-81" tabindex="-1"></a>      predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, </span>
<span id="cb191-82"><a href="aplikace3.html#cb191-82" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb191-83"><a href="aplikace3.html#cb191-83" tabindex="-1"></a>      presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb191-84"><a href="aplikace3.html#cb191-84" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb191-85"><a href="aplikace3.html#cb191-85" tabindex="-1"></a>      </span>
<span id="cb191-86"><a href="aplikace3.html#cb191-86" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C, gamma a fold</span></span>
<span id="cb191-87"><a href="aplikace3.html#cb191-87" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb191-88"><a href="aplikace3.html#cb191-88" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb191-89"><a href="aplikace3.html#cb191-89" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb191-90"><a href="aplikace3.html#cb191-90" tabindex="-1"></a>    }</span>
<span id="cb191-91"><a href="aplikace3.html#cb191-91" tabindex="-1"></a>  }</span>
<span id="cb191-92"><a href="aplikace3.html#cb191-92" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Nyní zprůměrujeme výsledky 10-násobné CV tak, abychom pro jednu hodnotu hyperparametru (případně jednu kombinaci hodnot) měli jeden odhad validační chybovosti. Přitom určíme i optimální hodnoty jednotlivých hyperparametrů.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="aplikace3.html#cb192-1" tabindex="-1"></a><span class="co"># spocitame prumerne presnosti pro jednotliva C pres folds</span></span>
<span id="cb192-2"><a href="aplikace3.html#cb192-2" tabindex="-1"></a><span class="do">## Linearni jadro</span></span>
<span id="cb192-3"><a href="aplikace3.html#cb192-3" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb192-4"><a href="aplikace3.html#cb192-4" tabindex="-1"></a><span class="do">## Polynomialni jadro</span></span>
<span id="cb192-5"><a href="aplikace3.html#cb192-5" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb192-6"><a href="aplikace3.html#cb192-6" tabindex="-1"></a><span class="do">## Radialni jadro</span></span>
<span id="cb192-7"><a href="aplikace3.html#cb192-7" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb192-8"><a href="aplikace3.html#cb192-8" tabindex="-1"></a></span>
<span id="cb192-9"><a href="aplikace3.html#cb192-9" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb192-10"><a href="aplikace3.html#cb192-10" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb192-11"><a href="aplikace3.html#cb192-11" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb192-12"><a href="aplikace3.html#cb192-12" tabindex="-1"></a>C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb192-13"><a href="aplikace3.html#cb192-13" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb192-14"><a href="aplikace3.html#cb192-14" tabindex="-1"></a></span>
<span id="cb192-15"><a href="aplikace3.html#cb192-15" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb192-16"><a href="aplikace3.html#cb192-16" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb192-17"><a href="aplikace3.html#cb192-17" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb192-18"><a href="aplikace3.html#cb192-18" tabindex="-1"></a></span>
<span id="cb192-19"><a href="aplikace3.html#cb192-19" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb192-20"><a href="aplikace3.html#cb192-20" tabindex="-1"></a>p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb192-21"><a href="aplikace3.html#cb192-21" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb192-22"><a href="aplikace3.html#cb192-22" tabindex="-1"></a></span>
<span id="cb192-23"><a href="aplikace3.html#cb192-23" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb192-24"><a href="aplikace3.html#cb192-24" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb192-25"><a href="aplikace3.html#cb192-25" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span></code></pre></div>
</details>
<p>Podívejme se, jak dopadly optimální hodnoty. Pro <em>lineární jádro</em> máme optimální hodnotu <span class="math inline">\(C\)</span> rovnu 0.0089, pro <em>polynomiální jádro</em> je <span class="math inline">\(C\)</span> rovno 0.1624 a pro <em>radiální jádro</em> máme dvě optimální hodnoty, pro <span class="math inline">\(C\)</span> je optimální hodnota 2.9764 a pro <span class="math inline">\(\gamma\)</span> je to 0.0118. Validační chybovosti jsou postupně 0.0066667 pro lineární, 0.0066667 pro polynomiální a 0.0066667 pro radiální jádro.</p>
<p>Konečně můžeme sestrojit finální klasifikátory na celých trénovacích datech s hodnotami hyperparametrů určenými pomocí 10-násobné CV. Určíme také chybovosti na testovacích a také na trénovacích datech.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="aplikace3.html#cb193-1" tabindex="-1"></a><span class="co"># sestrojeni modelu</span></span>
<span id="cb193-2"><a href="aplikace3.html#cb193-2" tabindex="-1"></a>clf.SVM.l.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb193-3"><a href="aplikace3.html#cb193-3" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb193-4"><a href="aplikace3.html#cb193-4" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb193-5"><a href="aplikace3.html#cb193-5" tabindex="-1"></a>                        <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb193-6"><a href="aplikace3.html#cb193-6" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb193-7"><a href="aplikace3.html#cb193-7" tabindex="-1"></a></span>
<span id="cb193-8"><a href="aplikace3.html#cb193-8" tabindex="-1"></a>clf.SVM.p.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb193-9"><a href="aplikace3.html#cb193-9" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb193-10"><a href="aplikace3.html#cb193-10" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb193-11"><a href="aplikace3.html#cb193-11" tabindex="-1"></a>                        <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb193-12"><a href="aplikace3.html#cb193-12" tabindex="-1"></a>                        <span class="at">degree =</span> p.opt,</span>
<span id="cb193-13"><a href="aplikace3.html#cb193-13" tabindex="-1"></a>                        <span class="at">coef0 =</span> coef0,</span>
<span id="cb193-14"><a href="aplikace3.html#cb193-14" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb193-15"><a href="aplikace3.html#cb193-15" tabindex="-1"></a></span>
<span id="cb193-16"><a href="aplikace3.html#cb193-16" tabindex="-1"></a>clf.SVM.r.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb193-17"><a href="aplikace3.html#cb193-17" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb193-18"><a href="aplikace3.html#cb193-18" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb193-19"><a href="aplikace3.html#cb193-19" tabindex="-1"></a>                        <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb193-20"><a href="aplikace3.html#cb193-20" tabindex="-1"></a>                        <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb193-21"><a href="aplikace3.html#cb193-21" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb193-22"><a href="aplikace3.html#cb193-22" tabindex="-1"></a></span>
<span id="cb193-23"><a href="aplikace3.html#cb193-23" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb193-24"><a href="aplikace3.html#cb193-24" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb193-25"><a href="aplikace3.html#cb193-25" tabindex="-1"></a>presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb193-26"><a href="aplikace3.html#cb193-26" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb193-27"><a href="aplikace3.html#cb193-27" tabindex="-1"></a></span>
<span id="cb193-28"><a href="aplikace3.html#cb193-28" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb193-29"><a href="aplikace3.html#cb193-29" tabindex="-1"></a>presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb193-30"><a href="aplikace3.html#cb193-30" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb193-31"><a href="aplikace3.html#cb193-31" tabindex="-1"></a></span>
<span id="cb193-32"><a href="aplikace3.html#cb193-32" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb193-33"><a href="aplikace3.html#cb193-33" tabindex="-1"></a>presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb193-34"><a href="aplikace3.html#cb193-34" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb193-35"><a href="aplikace3.html#cb193-35" tabindex="-1"></a>  </span>
<span id="cb193-36"><a href="aplikace3.html#cb193-36" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb193-37"><a href="aplikace3.html#cb193-37" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb193-38"><a href="aplikace3.html#cb193-38" tabindex="-1"></a>presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb193-39"><a href="aplikace3.html#cb193-39" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb193-40"><a href="aplikace3.html#cb193-40" tabindex="-1"></a></span>
<span id="cb193-41"><a href="aplikace3.html#cb193-41" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb193-42"><a href="aplikace3.html#cb193-42" tabindex="-1"></a>presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb193-43"><a href="aplikace3.html#cb193-43" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb193-44"><a href="aplikace3.html#cb193-44" tabindex="-1"></a></span>
<span id="cb193-45"><a href="aplikace3.html#cb193-45" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb193-46"><a href="aplikace3.html#cb193-46" tabindex="-1"></a>presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb193-47"><a href="aplikace3.html#cb193-47" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Chybovost metody SVM aplikované na bázové koeficienty na trénovacích datech je tedy 0.67 % pro lineární jádro, 0.67 % pro polynomiální jádro a 0.67 % pro gaussovské jádro.
Na testovacích datech je potom chybovost metody 7.6923 % pro lineární jádro, 7.6923 % pro polynomiální jádro a 9.2308 % pro radiální jádro.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="aplikace3.html#cb194-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - Bbasis&#39;</span>, </span>
<span id="cb194-2"><a href="aplikace3.html#cb194-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - Bbasis&#39;</span>, </span>
<span id="cb194-3"><a href="aplikace3.html#cb194-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - Bbasis&#39;</span>), </span>
<span id="cb194-4"><a href="aplikace3.html#cb194-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb194-5"><a href="aplikace3.html#cb194-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb194-6"><a href="aplikace3.html#cb194-6" tabindex="-1"></a></span>
<span id="cb194-7"><a href="aplikace3.html#cb194-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="projection-SVMA3b" class="section level4 hasAnchor" number="12.5.7.4">
<h4><span class="header-section-number">12.5.7.4</span> Projekce na B-splinovou bázi<a href="aplikace3.html#projection-SVMA3b" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Další možností, jak použít klasickou metodu SVM pro funkcionální data, je projektovat původní data na nějaký <span class="math inline">\(d\)</span>-dimenzionální podprostor našeho Hilbertova prostoru <span class="math inline">\(\mathcal H\)</span>, označme jej <span class="math inline">\(V_d\)</span>.
Předpokládejme, že tento podprostor <span class="math inline">\(V_d\)</span> má ortonormální bázi <span class="math inline">\(\{\Psi_j\}_{j = 1, \dots, d}\)</span>.
Definujeme transformaci <span class="math inline">\(P_{V_d}\)</span> jakožto ortogonální projekci na podprostor <span class="math inline">\(V_d\)</span>, tedy můžeme psát</p>
<p><span class="math display">\[
P_{V_d} (x) = \sum_{j = 1}^d \langle x, \Psi_j \rangle \Psi_j.
\]</span></p>
<p>Nyní můžeme pro klasifikaci použít koeficienty z ortogonální projekce, tedy aplikujeme standardní SVM na vektory <span class="math inline">\(\left( \langle x, \Psi_1 \rangle, \dots, \langle x, \Psi_d \rangle\right)^\top\)</span>.
Využitím této transformace jsme tedy definovali nové, tzv.
adaptované jádro, které je složené z ortogonální projekce <span class="math inline">\(P_{V_d}\)</span> a jádrové funkce standardní metody podpůrných vektorů.
Máme tedy (adaptované) jádro <span class="math inline">\(Q(x_i, x_j) = K(P_{V_d}(x_i), P_{V_d}(x_j))\)</span>.
Jde tedy o metodu redukce dimenze, kterou můžeme nazvat <em>filtrace</em>.</p>
<p>Pro samotnou projekci použijeme v <code>R</code> funkci <code>project.basis()</code> z knihovny <code>fda</code>.
Na jejím vstupu bude matice původních diskrétních (nevyhlazených) dat, hodnoty, ve kterých měříme hodnoty v matici původních dat a bázový objekt, na který chceme data projektovat.
My zvolíme projekci na B-splinovou bázi, protože využití Fourierovy báze není pro naše neperiodická data vhodné.</p>
<p>Dimenzi <span class="math inline">\(d\)</span> volíme buď z nějaké předchozí expertní znalosti, nebo pomocí cross-validace.
V našem případě určíme optimální dimenzi podprostoru <span class="math inline">\(V_d\)</span> pomocí <span class="math inline">\(k\)</span>-násobné cross-validace (volíme <span class="math inline">\(k \ll n\)</span> kvůli výpočetní náročnosti metody, často se volí <span class="math inline">\(k = 5\)</span> nebo <span class="math inline">\(k = 10\)</span>).
Požadujeme B-spliny řádu 4, pro počet bázových funkcí potom platí vztah</p>
<p><span class="math display">\[
n_{basis} = n_{breaks} + n_{order} - 2,
\]</span></p>
<p>kde <span class="math inline">\(n_{breaks}\)</span> je počet uzlů a <span class="math inline">\(n_{order} = 4\)</span>.
V <code>R</code> však hodnota <span class="math inline">\(n_{basis}\)</span> musí být alespoň <span class="math inline">\(n_{order} = 4\)</span> a pro velké hodnoty <span class="math inline">\(n_{basis}\)</span> již dochází k přefitování modelu, tudíž volíme za maximální <span class="math inline">\(n_{basis}\)</span> menší číslo, řekněme 20.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="aplikace3.html#cb195-1" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb195-2"><a href="aplikace3.html#cb195-2" tabindex="-1"></a></span>
<span id="cb195-3"><a href="aplikace3.html#cb195-3" tabindex="-1"></a><span class="co"># hodnoty pro B-splinovou bazi</span></span>
<span id="cb195-4"><a href="aplikace3.html#cb195-4" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb195-5"><a href="aplikace3.html#cb195-5" tabindex="-1"></a>norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb195-6"><a href="aplikace3.html#cb195-6" tabindex="-1"></a>n_basis_min <span class="ot">&lt;-</span> norder</span>
<span id="cb195-7"><a href="aplikace3.html#cb195-7" tabindex="-1"></a>n_basis_max <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb195-8"><a href="aplikace3.html#cb195-8" tabindex="-1"></a></span>
<span id="cb195-9"><a href="aplikace3.html#cb195-9" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> n_basis_min<span class="sc">:</span>n_basis_max <span class="co"># vsechny dimenze, ktere chceme vyzkouset</span></span>
<span id="cb195-10"><a href="aplikace3.html#cb195-10" tabindex="-1"></a></span>
<span id="cb195-11"><a href="aplikace3.html#cb195-11" tabindex="-1"></a><span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb195-12"><a href="aplikace3.html#cb195-12" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb195-13"><a href="aplikace3.html#cb195-13" tabindex="-1"></a></span>
<span id="cb195-14"><a href="aplikace3.html#cb195-14" tabindex="-1"></a><span class="co"># list se tremi slozkami ... maticemi pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb195-15"><a href="aplikace3.html#cb195-15" tabindex="-1"></a><span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb195-16"><a href="aplikace3.html#cb195-16" tabindex="-1"></a><span class="co"># ve sloupcich budou hodnoty presnosti pro danou cast trenovaci mnoziny</span></span>
<span id="cb195-17"><a href="aplikace3.html#cb195-17" tabindex="-1"></a><span class="co"># v radcich budou hodnoty pro danou hodnotu dimenze</span></span>
<span id="cb195-18"><a href="aplikace3.html#cb195-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">SVM.l =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb195-19"><a href="aplikace3.html#cb195-19" tabindex="-1"></a>                   <span class="at">SVM.p =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb195-20"><a href="aplikace3.html#cb195-20" tabindex="-1"></a>                   <span class="at">SVM.r =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv))</span>
<span id="cb195-21"><a href="aplikace3.html#cb195-21" tabindex="-1"></a></span>
<span id="cb195-22"><a href="aplikace3.html#cb195-22" tabindex="-1"></a><span class="cf">for</span> (d <span class="cf">in</span> dimensions) {</span>
<span id="cb195-23"><a href="aplikace3.html#cb195-23" tabindex="-1"></a>  <span class="co"># bazovy objekt</span></span>
<span id="cb195-24"><a href="aplikace3.html#cb195-24" tabindex="-1"></a>  bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb195-25"><a href="aplikace3.html#cb195-25" tabindex="-1"></a>                                 <span class="at">nbasis =</span> d)</span>
<span id="cb195-26"><a href="aplikace3.html#cb195-26" tabindex="-1"></a>  </span>
<span id="cb195-27"><a href="aplikace3.html#cb195-27" tabindex="-1"></a>  <span class="co"># projekce diskretnich dat na B-splinovou bazi o dimenzi d</span></span>
<span id="cb195-28"><a href="aplikace3.html#cb195-28" tabindex="-1"></a>  Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="co"># matice diskretnich dat</span></span>
<span id="cb195-29"><a href="aplikace3.html#cb195-29" tabindex="-1"></a>                              <span class="at">argvals =</span> t, <span class="co"># vektor argumentu</span></span>
<span id="cb195-30"><a href="aplikace3.html#cb195-30" tabindex="-1"></a>                              <span class="at">basisobj =</span> bbasis) <span class="co"># bazovy objekt</span></span>
<span id="cb195-31"><a href="aplikace3.html#cb195-31" tabindex="-1"></a>  </span>
<span id="cb195-32"><a href="aplikace3.html#cb195-32" tabindex="-1"></a>  <span class="co"># rozdeleni na trenovaci a testovaci data v ramci CV</span></span>
<span id="cb195-33"><a href="aplikace3.html#cb195-33" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb195-34"><a href="aplikace3.html#cb195-34" tabindex="-1"></a>  </span>
<span id="cb195-35"><a href="aplikace3.html#cb195-35" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb195-36"><a href="aplikace3.html#cb195-36" tabindex="-1"></a>    <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb195-37"><a href="aplikace3.html#cb195-37" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb195-38"><a href="aplikace3.html#cb195-38" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XX.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb195-39"><a href="aplikace3.html#cb195-39" tabindex="-1"></a>    </span>
<span id="cb195-40"><a href="aplikace3.html#cb195-40" tabindex="-1"></a>    data.projection.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[cv_sample, ])</span>
<span id="cb195-41"><a href="aplikace3.html#cb195-41" tabindex="-1"></a>    data.projection.train.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[cv_sample])</span>
<span id="cb195-42"><a href="aplikace3.html#cb195-42" tabindex="-1"></a>    </span>
<span id="cb195-43"><a href="aplikace3.html#cb195-43" tabindex="-1"></a>    data.projection.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb195-44"><a href="aplikace3.html#cb195-44" tabindex="-1"></a>    Y.test.cv <span class="ot">&lt;-</span> Y.train[<span class="sc">!</span>cv_sample]</span>
<span id="cb195-45"><a href="aplikace3.html#cb195-45" tabindex="-1"></a>    data.projection.test.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test.cv)</span>
<span id="cb195-46"><a href="aplikace3.html#cb195-46" tabindex="-1"></a>  </span>
<span id="cb195-47"><a href="aplikace3.html#cb195-47" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb195-48"><a href="aplikace3.html#cb195-48" tabindex="-1"></a>    clf.SVM.l.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb195-49"><a href="aplikace3.html#cb195-49" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb195-50"><a href="aplikace3.html#cb195-50" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb195-51"><a href="aplikace3.html#cb195-51" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb195-52"><a href="aplikace3.html#cb195-52" tabindex="-1"></a>    </span>
<span id="cb195-53"><a href="aplikace3.html#cb195-53" tabindex="-1"></a>    clf.SVM.p.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb195-54"><a href="aplikace3.html#cb195-54" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb195-55"><a href="aplikace3.html#cb195-55" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb195-56"><a href="aplikace3.html#cb195-56" tabindex="-1"></a>                            <span class="at">coef0 =</span> coef0,</span>
<span id="cb195-57"><a href="aplikace3.html#cb195-57" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb195-58"><a href="aplikace3.html#cb195-58" tabindex="-1"></a>    </span>
<span id="cb195-59"><a href="aplikace3.html#cb195-59" tabindex="-1"></a>    clf.SVM.r.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb195-60"><a href="aplikace3.html#cb195-60" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb195-61"><a href="aplikace3.html#cb195-61" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb195-62"><a href="aplikace3.html#cb195-62" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb195-63"><a href="aplikace3.html#cb195-63" tabindex="-1"></a>      </span>
<span id="cb195-64"><a href="aplikace3.html#cb195-64" tabindex="-1"></a>    <span class="co"># presnost na validacnich datech</span></span>
<span id="cb195-65"><a href="aplikace3.html#cb195-65" tabindex="-1"></a>    <span class="do">## linear kernel</span></span>
<span id="cb195-66"><a href="aplikace3.html#cb195-66" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.projection,</span>
<span id="cb195-67"><a href="aplikace3.html#cb195-67" tabindex="-1"></a>                                  <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb195-68"><a href="aplikace3.html#cb195-68" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb195-69"><a href="aplikace3.html#cb195-69" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb195-70"><a href="aplikace3.html#cb195-70" tabindex="-1"></a>    <span class="do">## polynomial kernel</span></span>
<span id="cb195-71"><a href="aplikace3.html#cb195-71" tabindex="-1"></a>    predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.projection, </span>
<span id="cb195-72"><a href="aplikace3.html#cb195-72" tabindex="-1"></a>                                  <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb195-73"><a href="aplikace3.html#cb195-73" tabindex="-1"></a>    presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb195-74"><a href="aplikace3.html#cb195-74" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb195-75"><a href="aplikace3.html#cb195-75" tabindex="-1"></a>    <span class="do">## radial kernel</span></span>
<span id="cb195-76"><a href="aplikace3.html#cb195-76" tabindex="-1"></a>    predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.projection,</span>
<span id="cb195-77"><a href="aplikace3.html#cb195-77" tabindex="-1"></a>                                  <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb195-78"><a href="aplikace3.html#cb195-78" tabindex="-1"></a>    presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb195-79"><a href="aplikace3.html#cb195-79" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb195-80"><a href="aplikace3.html#cb195-80" tabindex="-1"></a>    </span>
<span id="cb195-81"><a href="aplikace3.html#cb195-81" tabindex="-1"></a>    <span class="co"># presnosti vlozime na pozice pro dane d a fold</span></span>
<span id="cb195-82"><a href="aplikace3.html#cb195-82" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb195-83"><a href="aplikace3.html#cb195-83" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.p[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb195-84"><a href="aplikace3.html#cb195-84" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.r[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb195-85"><a href="aplikace3.html#cb195-85" tabindex="-1"></a>  }</span>
<span id="cb195-86"><a href="aplikace3.html#cb195-86" tabindex="-1"></a>}</span>
<span id="cb195-87"><a href="aplikace3.html#cb195-87" tabindex="-1"></a>  </span>
<span id="cb195-88"><a href="aplikace3.html#cb195-88" tabindex="-1"></a><span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb195-89"><a href="aplikace3.html#cb195-89" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb195-90"><a href="aplikace3.html#cb195-90" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb195-91"><a href="aplikace3.html#cb195-91" tabindex="-1"></a>}</span>
<span id="cb195-92"><a href="aplikace3.html#cb195-92" tabindex="-1"></a></span>
<span id="cb195-93"><a href="aplikace3.html#cb195-93" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb195-94"><a href="aplikace3.html#cb195-94" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb195-95"><a href="aplikace3.html#cb195-95" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb195-96"><a href="aplikace3.html#cb195-96" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb195-97"><a href="aplikace3.html#cb195-97" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb195-98"><a href="aplikace3.html#cb195-98" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb195-99"><a href="aplikace3.html#cb195-99" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">d_opt =</span> d.opt, <span class="at">ERR =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv,</span>
<span id="cb195-100"><a href="aplikace3.html#cb195-100" tabindex="-1"></a>           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<pre><code>##        d_opt        ERR
## linear     9 0.01958333
## poly       7 0.03297619
## radial     6 0.14125000</code></pre>
<p>Vidíme, že nejlépe vychází hodnota parametru <span class="math inline">\(d\)</span> jako 9 pro lineární jádro s hodnotou chybovosti spočtenou pomocí 10-násobné CV 0.0196, 7 pro polynomiální jádro s hodnotou chybovosti spočtenou pomocí 10-násobné CV 0.033 a 6 pro radiální jádro s hodnotou chybovosti 0.1412.
Pro přehlednost si ještě vykresleme průběh validačních chybovostí v závislosti na dimenzi <span class="math inline">\(d\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="aplikace3.html#cb197-1" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> dimensions <span class="sc">|&gt;</span> <span class="fu">rep</span>(<span class="dv">3</span>), </span>
<span id="cb197-2"><a href="aplikace3.html#cb197-2" tabindex="-1"></a>                         <span class="at">CV =</span> <span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.l, </span>
<span id="cb197-3"><a href="aplikace3.html#cb197-3" tabindex="-1"></a>                                CV.results<span class="sc">$</span>SVM.p, </span>
<span id="cb197-4"><a href="aplikace3.html#cb197-4" tabindex="-1"></a>                                CV.results<span class="sc">$</span>SVM.r),</span>
<span id="cb197-5"><a href="aplikace3.html#cb197-5" tabindex="-1"></a>                         <span class="at">Kernel =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;lineární&#39;</span>, <span class="st">&#39;polynomiální&#39;</span>, <span class="st">&#39;radiální&#39;</span>), </span>
<span id="cb197-6"><a href="aplikace3.html#cb197-6" tabindex="-1"></a>                                      <span class="at">each =</span> <span class="fu">length</span>(dimensions)) <span class="sc">|&gt;</span> <span class="fu">factor</span>())</span>
<span id="cb197-7"><a href="aplikace3.html#cb197-7" tabindex="-1"></a>CV.results <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> CV, <span class="at">colour =</span> Kernel)) <span class="sc">+</span> </span>
<span id="cb197-8"><a href="aplikace3.html#cb197-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb197-9"><a href="aplikace3.html#cb197-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb197-10"><a href="aplikace3.html#cb197-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(d.opt,</span>
<span id="cb197-11"><a href="aplikace3.html#cb197-11" tabindex="-1"></a>                               presnost.opt.cv),</span>
<span id="cb197-12"><a href="aplikace3.html#cb197-12" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> d.opt, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb197-13"><a href="aplikace3.html#cb197-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb197-14"><a href="aplikace3.html#cb197-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(d)),</span>
<span id="cb197-15"><a href="aplikace3.html#cb197-15" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Validační chybovost&#39;</span>,</span>
<span id="cb197-16"><a href="aplikace3.html#cb197-16" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Jádro&#39;</span>) <span class="sc">+</span> </span>
<span id="cb197-17"><a href="aplikace3.html#cb197-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span> </span>
<span id="cb197-18"><a href="aplikace3.html#cb197-18" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> dimensions)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-190"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-190-1.png" alt="Závislost validační chybovosti na dimenzi podprostoru $V_d$, zvlášť pro všechna tři uvažovaná jádra v metodě SVM. Černými body jsou vyznačeny optimální hodnoty dimenze $V_d$ pro jednotlivé jádrové funkce." width="672" />
<p class="caption">
Obrázek 12.39: Závislost validační chybovosti na dimenzi podprostoru <span class="math inline">\(V_d\)</span>, zvlášť pro všechna tři uvažovaná jádra v metodě SVM. Černými body jsou vyznačeny optimální hodnoty dimenze <span class="math inline">\(V_d\)</span> pro jednotlivé jádrové funkce.
</p>
</div>
<p>Nyní již můžeme natrénovat jednotlivé klasifikátory na všech trénovacích datech a podívat se na jejich úspěšnost na testovacích datech.
Pro každou jádrovou funkci volíme dimenzi podprostoru, na který projektujeme, podle výsledků cross-validace.</p>
<p>V proměnné <code>Projection</code> máme uloženou matici koeficientů ortogonální projekce, tedy</p>
<p><span class="math display">\[
\texttt{Projection} = \begin{pmatrix}
\langle x_1, \Psi_1 \rangle &amp; \langle x_2, \Psi_1 \rangle &amp; \cdots &amp; \langle x_n, \Psi_1 \rangle\\
\langle x_1, \Psi_2 \rangle &amp; \langle x_2, \Psi_2 \rangle &amp; \cdots &amp; \langle x_n, \Psi_2 \rangle\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\langle x_1, \Psi_d \rangle &amp; \langle x_2, \Psi_d \rangle &amp; \dots &amp; \langle x_n, \Psi_d \rangle
\end{pmatrix}_{d \times n}.
\]</span></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="aplikace3.html#cb198-1" tabindex="-1"></a><span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb198-2"><a href="aplikace3.html#cb198-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - projection&#39;</span>, </span>
<span id="cb198-3"><a href="aplikace3.html#cb198-3" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb198-4"><a href="aplikace3.html#cb198-4" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - projection&#39;</span>), </span>
<span id="cb198-5"><a href="aplikace3.html#cb198-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb198-6"><a href="aplikace3.html#cb198-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb198-7"><a href="aplikace3.html#cb198-7" tabindex="-1"></a></span>
<span id="cb198-8"><a href="aplikace3.html#cb198-8" tabindex="-1"></a><span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb198-9"><a href="aplikace3.html#cb198-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb198-10"><a href="aplikace3.html#cb198-10" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb198-11"><a href="aplikace3.html#cb198-11" tabindex="-1"></a>  <span class="co"># bazovy objekt</span></span>
<span id="cb198-12"><a href="aplikace3.html#cb198-12" tabindex="-1"></a>  bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb198-13"><a href="aplikace3.html#cb198-13" tabindex="-1"></a>                                 <span class="at">nbasis =</span> d.opt[kernel_number])</span>
<span id="cb198-14"><a href="aplikace3.html#cb198-14" tabindex="-1"></a>  </span>
<span id="cb198-15"><a href="aplikace3.html#cb198-15" tabindex="-1"></a>  <span class="co"># projekce diskretnich dat na B-splinovou bazi</span></span>
<span id="cb198-16"><a href="aplikace3.html#cb198-16" tabindex="-1"></a>  Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="co"># matice diskretnich dat</span></span>
<span id="cb198-17"><a href="aplikace3.html#cb198-17" tabindex="-1"></a>                              <span class="at">argvals =</span> t, <span class="co"># vektor argumentu</span></span>
<span id="cb198-18"><a href="aplikace3.html#cb198-18" tabindex="-1"></a>                              <span class="at">basisobj =</span> bbasis) <span class="co"># bazovy objekt</span></span>
<span id="cb198-19"><a href="aplikace3.html#cb198-19" tabindex="-1"></a>  </span>
<span id="cb198-20"><a href="aplikace3.html#cb198-20" tabindex="-1"></a>  <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb198-21"><a href="aplikace3.html#cb198-21" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb198-22"><a href="aplikace3.html#cb198-22" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb198-23"><a href="aplikace3.html#cb198-23" tabindex="-1"></a>  </span>
<span id="cb198-24"><a href="aplikace3.html#cb198-24" tabindex="-1"></a>  data.projection.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train)</span>
<span id="cb198-25"><a href="aplikace3.html#cb198-25" tabindex="-1"></a>  data.projection.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb198-26"><a href="aplikace3.html#cb198-26" tabindex="-1"></a>  </span>
<span id="cb198-27"><a href="aplikace3.html#cb198-27" tabindex="-1"></a>  data.projection.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.test)</span>
<span id="cb198-28"><a href="aplikace3.html#cb198-28" tabindex="-1"></a>  data.projection.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb198-29"><a href="aplikace3.html#cb198-29" tabindex="-1"></a>  </span>
<span id="cb198-30"><a href="aplikace3.html#cb198-30" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb198-31"><a href="aplikace3.html#cb198-31" tabindex="-1"></a>  clf.SVM.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train,</span>
<span id="cb198-32"><a href="aplikace3.html#cb198-32" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb198-33"><a href="aplikace3.html#cb198-33" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb198-34"><a href="aplikace3.html#cb198-34" tabindex="-1"></a>                            <span class="at">coef0 =</span> coef0,</span>
<span id="cb198-35"><a href="aplikace3.html#cb198-35" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb198-36"><a href="aplikace3.html#cb198-36" tabindex="-1"></a>  </span>
<span id="cb198-37"><a href="aplikace3.html#cb198-37" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb198-38"><a href="aplikace3.html#cb198-38" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.train)</span>
<span id="cb198-39"><a href="aplikace3.html#cb198-39" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb198-40"><a href="aplikace3.html#cb198-40" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb198-41"><a href="aplikace3.html#cb198-41" tabindex="-1"></a>    </span>
<span id="cb198-42"><a href="aplikace3.html#cb198-42" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb198-43"><a href="aplikace3.html#cb198-43" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.test)</span>
<span id="cb198-44"><a href="aplikace3.html#cb198-44" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb198-45"><a href="aplikace3.html#cb198-45" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb198-46"><a href="aplikace3.html#cb198-46" tabindex="-1"></a>  </span>
<span id="cb198-47"><a href="aplikace3.html#cb198-47" tabindex="-1"></a>  <span class="co"># ulozeni vysledku</span></span>
<span id="cb198-48"><a href="aplikace3.html#cb198-48" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb198-49"><a href="aplikace3.html#cb198-49" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Chybovost metody SVM aplikované na bázové koeficienty na trénovacích datech je tedy 2 % pro lineární jádro, 2.67 % pro polynomiální jádro a 9.33 % pro gaussovské jádro.
Na testovacích datech je potom chybovost metody 6.15 % pro lineární jádro, 6.15 % pro polynomiální jádro a 10.77 % pro radiální jádro.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="aplikace3.html#cb199-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="RKHS-SVMA3b" class="section level4 hasAnchor" number="12.5.7.5">
<h4><span class="header-section-number">12.5.7.5</span> RKHS + SVM<a href="aplikace3.html#RKHS-SVMA3b" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>V této sekci se podíváme na další možnost, jak využít metodu podpůrných vektorů pro klasifikaci funkcionálních dat.
V tomto případě půjde opět o již nám známý princip, kdy nejprve funkcionální data vyjádříme jakožto nějaké konečně-rozměrné objekty a na tyto objekty následně aplikujeme klasickou metodu SVM.</p>
<p>Z poslední části Tvrzení <a href="aplikace3.html#thm:MaG">12.3</a> vyplývá, jak máme spočítat v praxi reprezentace křivek.
Budeme pracovat s diskretizovanými daty po vyhlazení křivek.
Nejprve si definujeme jádro pro prostor RKHS.
Využijeme Gaussovské jádro s parametrem <span class="math inline">\(\gamma\)</span>.
Hodnota tohoto hyperparametru výrazně ovlivňuje chování a tedy i úspěšnost metody, proto jeho volbě musíme věnovat zvláštní pozornost (volíme pomocí cross-validace).</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="aplikace3.html#cb200-1" tabindex="-1"></a><span class="co"># hodnoty hypermarametru stejne jako v minule casti</span></span>
<span id="cb200-2"><a href="aplikace3.html#cb200-2" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb200-3"><a href="aplikace3.html#cb200-3" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="dv">1</span> </span></code></pre></div>
</details>
<div id="gaussovké-jádro-10" class="section level6 hasAnchor" number="12.5.7.5.0.1">
<h6><span class="header-section-number">12.5.7.5.0.1</span> Gaussovké jádro<a href="aplikace3.html#gaussovké-jádro-10" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="aplikace3.html#cb201-1" tabindex="-1"></a><span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb201-2"><a href="aplikace3.html#cb201-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb201-3"><a href="aplikace3.html#cb201-3" tabindex="-1"></a><span class="co"># pridame i testovaci data</span></span>
<span id="cb201-4"><a href="aplikace3.html#cb201-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb201-5"><a href="aplikace3.html#cb201-5" tabindex="-1"></a></span>
<span id="cb201-6"><a href="aplikace3.html#cb201-6" tabindex="-1"></a><span class="co"># jadro a jadrova matice ... Gaussovske s parametrem gamma</span></span>
<span id="cb201-7"><a href="aplikace3.html#cb201-7" tabindex="-1"></a>Gauss.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, gamma) {</span>
<span id="cb201-8"><a href="aplikace3.html#cb201-8" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>gamma <span class="sc">*</span> <span class="fu">norm</span>(<span class="fu">c</span>(x <span class="sc">-</span> y) <span class="sc">|&gt;</span> <span class="fu">t</span>(), <span class="at">type =</span> <span class="st">&#39;F&#39;</span>)))</span>
<span id="cb201-9"><a href="aplikace3.html#cb201-9" tabindex="-1"></a>}</span>
<span id="cb201-10"><a href="aplikace3.html#cb201-10" tabindex="-1"></a></span>
<span id="cb201-11"><a href="aplikace3.html#cb201-11" tabindex="-1"></a>Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, gamma) {</span>
<span id="cb201-12"><a href="aplikace3.html#cb201-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb201-13"><a href="aplikace3.html#cb201-13" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb201-14"><a href="aplikace3.html#cb201-14" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb201-15"><a href="aplikace3.html#cb201-15" tabindex="-1"></a>      K[i, j] <span class="ot">&lt;-</span> <span class="fu">Gauss.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], <span class="at">gamma =</span> gamma)</span>
<span id="cb201-16"><a href="aplikace3.html#cb201-16" tabindex="-1"></a>    }</span>
<span id="cb201-17"><a href="aplikace3.html#cb201-17" tabindex="-1"></a>  }</span>
<span id="cb201-18"><a href="aplikace3.html#cb201-18" tabindex="-1"></a>  <span class="fu">return</span>(K)</span>
<span id="cb201-19"><a href="aplikace3.html#cb201-19" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Spočítejme nyní matici <span class="math inline">\(K_S\)</span> a její vlastní čísla a příslušné vlastní vektory.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="aplikace3.html#cb202-1" tabindex="-1"></a><span class="co"># spocitame matici K</span></span>
<span id="cb202-2"><a href="aplikace3.html#cb202-2" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="fl">0.1</span> <span class="co"># pevna hodnota gamma, optimalni urcime pomoci CV</span></span>
<span id="cb202-3"><a href="aplikace3.html#cb202-3" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb202-4"><a href="aplikace3.html#cb202-4" tabindex="-1"></a></span>
<span id="cb202-5"><a href="aplikace3.html#cb202-5" tabindex="-1"></a><span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb202-6"><a href="aplikace3.html#cb202-6" tabindex="-1"></a>Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb202-7"><a href="aplikace3.html#cb202-7" tabindex="-1"></a>eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb202-8"><a href="aplikace3.html#cb202-8" tabindex="-1"></a>eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span></code></pre></div>
</details>
<p>K výpočtu koeficientů v reprezentaci křivek, tedy výpočtu vektorů <span class="math inline">\(\hat{\boldsymbol \lambda}_l^* = \left( \hat\lambda_{1l}^*, \dots, \hat\lambda_{\hat dl}^*\right)^\top, l = 1, 2, \dots, n\)</span>, potřebujeme ještě koeficienty z SVM.
Narozdíl od klasifikačního problému nyní řešíme problém regrese, neboť se snažíme vyjádřit naše pozorované křivky v nějaké (námi zvolené pomocí jádra <span class="math inline">\(K\)</span>) bázi.
Proto využijeme metodu <em>Support Vector Regression</em>, z níž následně získáme koeficienty <span class="math inline">\(\alpha_{il}\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="aplikace3.html#cb203-1" tabindex="-1"></a><span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb203-2"><a href="aplikace3.html#cb203-2" tabindex="-1"></a>alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb203-3"><a href="aplikace3.html#cb203-3" tabindex="-1"></a>                     <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb203-4"><a href="aplikace3.html#cb203-4" tabindex="-1"></a></span>
<span id="cb203-5"><a href="aplikace3.html#cb203-5" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb203-6"><a href="aplikace3.html#cb203-6" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb203-7"><a href="aplikace3.html#cb203-7" tabindex="-1"></a>  df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb203-8"><a href="aplikace3.html#cb203-8" tabindex="-1"></a>                       <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb203-9"><a href="aplikace3.html#cb203-9" tabindex="-1"></a>  svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb203-10"><a href="aplikace3.html#cb203-10" tabindex="-1"></a>                  <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb203-11"><a href="aplikace3.html#cb203-11" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb203-12"><a href="aplikace3.html#cb203-12" tabindex="-1"></a>                  <span class="at">epsilon =</span> eps,</span>
<span id="cb203-13"><a href="aplikace3.html#cb203-13" tabindex="-1"></a>                  <span class="at">cost =</span> C,</span>
<span id="cb203-14"><a href="aplikace3.html#cb203-14" tabindex="-1"></a>                  <span class="at">gamma =</span> gamma)</span>
<span id="cb203-15"><a href="aplikace3.html#cb203-15" tabindex="-1"></a>  <span class="co"># urceni alpha</span></span>
<span id="cb203-16"><a href="aplikace3.html#cb203-16" tabindex="-1"></a>  alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb203-17"><a href="aplikace3.html#cb203-17" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Nyní již můžeme spočítat reprezentace jednotlivých křivek.
Nejprve zvolme za <span class="math inline">\(\hat d\)</span> celou dimenzi, tedy <span class="math inline">\(\hat d = m ={}\)</span> 101, následně určíme optimální <span class="math inline">\(\hat d\)</span> pomocí cross-validace.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="aplikace3.html#cb204-1" tabindex="-1"></a><span class="co"># d</span></span>
<span id="cb204-2"><a href="aplikace3.html#cb204-2" tabindex="-1"></a>d.RKHS <span class="ot">&lt;-</span> <span class="fu">dim</span>(alpha.RKHS)[<span class="dv">1</span>]</span>
<span id="cb204-3"><a href="aplikace3.html#cb204-3" tabindex="-1"></a></span>
<span id="cb204-4"><a href="aplikace3.html#cb204-4" tabindex="-1"></a><span class="co"># urceni vektoru lambda</span></span>
<span id="cb204-5"><a href="aplikace3.html#cb204-5" tabindex="-1"></a>Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb204-6"><a href="aplikace3.html#cb204-6" tabindex="-1"></a>                      <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb204-7"><a href="aplikace3.html#cb204-7" tabindex="-1"></a>                      <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb204-8"><a href="aplikace3.html#cb204-8" tabindex="-1"></a></span>
<span id="cb204-9"><a href="aplikace3.html#cb204-9" tabindex="-1"></a><span class="co"># vypocet reprezentace</span></span>
<span id="cb204-10"><a href="aplikace3.html#cb204-10" tabindex="-1"></a><span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb204-11"><a href="aplikace3.html#cb204-11" tabindex="-1"></a>  Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb204-12"><a href="aplikace3.html#cb204-12" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Nyní máme v matici <code>Lambda.RKHS</code> uloženy ve sloupcích vektory <span class="math inline">\(\hat{\boldsymbol \lambda}_l^*, l = 1, 2, \dots, n\)</span> pro každou křivku.
Tyto vektory nyní využijeme jakožto reprezentaci daných křivek a klasifikujeme data podle této diskretizace.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="aplikace3.html#cb205-1" tabindex="-1"></a><span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb205-2"><a href="aplikace3.html#cb205-2" tabindex="-1"></a>XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb205-3"><a href="aplikace3.html#cb205-3" tabindex="-1"></a>XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb205-4"><a href="aplikace3.html#cb205-4" tabindex="-1"></a></span>
<span id="cb205-5"><a href="aplikace3.html#cb205-5" tabindex="-1"></a><span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb205-6"><a href="aplikace3.html#cb205-6" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb205-7"><a href="aplikace3.html#cb205-7" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb205-8"><a href="aplikace3.html#cb205-8" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb205-9"><a href="aplikace3.html#cb205-9" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb205-10"><a href="aplikace3.html#cb205-10" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb205-11"><a href="aplikace3.html#cb205-11" tabindex="-1"></a></span>
<span id="cb205-12"><a href="aplikace3.html#cb205-12" tabindex="-1"></a><span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb205-13"><a href="aplikace3.html#cb205-13" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb205-14"><a href="aplikace3.html#cb205-14" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb205-15"><a href="aplikace3.html#cb205-15" tabindex="-1"></a></span>
<span id="cb205-16"><a href="aplikace3.html#cb205-16" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb205-17"><a href="aplikace3.html#cb205-17" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb205-18"><a href="aplikace3.html#cb205-18" tabindex="-1"></a>  </span>
<span id="cb205-19"><a href="aplikace3.html#cb205-19" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb205-20"><a href="aplikace3.html#cb205-20" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb205-21"><a href="aplikace3.html#cb205-21" tabindex="-1"></a>  </span>
<span id="cb205-22"><a href="aplikace3.html#cb205-22" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb205-23"><a href="aplikace3.html#cb205-23" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb205-24"><a href="aplikace3.html#cb205-24" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb205-25"><a href="aplikace3.html#cb205-25" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb205-26"><a href="aplikace3.html#cb205-26" tabindex="-1"></a>                      <span class="at">coef0 =</span> coef0,</span>
<span id="cb205-27"><a href="aplikace3.html#cb205-27" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb205-28"><a href="aplikace3.html#cb205-28" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type)</span>
<span id="cb205-29"><a href="aplikace3.html#cb205-29" tabindex="-1"></a>  </span>
<span id="cb205-30"><a href="aplikace3.html#cb205-30" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb205-31"><a href="aplikace3.html#cb205-31" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb205-32"><a href="aplikace3.html#cb205-32" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb205-33"><a href="aplikace3.html#cb205-33" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb205-34"><a href="aplikace3.html#cb205-34" tabindex="-1"></a>    </span>
<span id="cb205-35"><a href="aplikace3.html#cb205-35" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb205-36"><a href="aplikace3.html#cb205-36" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb205-37"><a href="aplikace3.html#cb205-37" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb205-38"><a href="aplikace3.html#cb205-38" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb205-39"><a href="aplikace3.html#cb205-39" tabindex="-1"></a>  </span>
<span id="cb205-40"><a href="aplikace3.html#cb205-40" tabindex="-1"></a>  <span class="co"># ulozeni vysledku</span></span>
<span id="cb205-41"><a href="aplikace3.html#cb205-41" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb205-42"><a href="aplikace3.html#cb205-42" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-199">Tabulka 12.9: </span>Souhrnné výsledky metody SVM v kombinaci s RKHS na simulovaných datech. <span class="math inline">\(\widehat{Err}_{train}\)</span> značí odhad trénovací chybovosti a <span class="math inline">\(\widehat{Err}_{test}\)</span> testovací chybovosti.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p>Vidíme, že model u všech třech jader velmi dobře klasifikuje trénovací data, zatímco jeho úspěšnost na testovacích datech není vůbec dobrá.
Je zřejmé, že došlo k overfittingu, proto využijeme cross-validaci, abychom určili optimální hodnoty <span class="math inline">\(\gamma\)</span> a <span class="math inline">\(d\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="aplikace3.html#cb206-1" tabindex="-1"></a><span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb206-2"><a href="aplikace3.html#cb206-2" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb206-3"><a href="aplikace3.html#cb206-3" tabindex="-1"></a><span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb206-4"><a href="aplikace3.html#cb206-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb206-5"><a href="aplikace3.html#cb206-5" tabindex="-1"></a></span>
<span id="cb206-6"><a href="aplikace3.html#cb206-6" tabindex="-1"></a><span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb206-7"><a href="aplikace3.html#cb206-7" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">30</span> <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb206-8"><a href="aplikace3.html#cb206-8" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">15</span>)</span>
<span id="cb206-9"><a href="aplikace3.html#cb206-9" tabindex="-1"></a></span>
<span id="cb206-10"><a href="aplikace3.html#cb206-10" tabindex="-1"></a><span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb206-11"><a href="aplikace3.html#cb206-11" tabindex="-1"></a><span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb206-12"><a href="aplikace3.html#cb206-12" tabindex="-1"></a><span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb206-13"><a href="aplikace3.html#cb206-13" tabindex="-1"></a><span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb206-14"><a href="aplikace3.html#cb206-14" tabindex="-1"></a>dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">gamma =</span> <span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma.cv, <span class="dv">3</span>)),</span>
<span id="cb206-15"><a href="aplikace3.html#cb206-15" tabindex="-1"></a>                  <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb206-16"><a href="aplikace3.html#cb206-16" tabindex="-1"></a>                  <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb206-17"><a href="aplikace3.html#cb206-17" tabindex="-1"></a></span>
<span id="cb206-18"><a href="aplikace3.html#cb206-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb206-19"><a href="aplikace3.html#cb206-19" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb206-20"><a href="aplikace3.html#cb206-20" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb206-21"><a href="aplikace3.html#cb206-21" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb206-22"><a href="aplikace3.html#cb206-22" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb206-23"><a href="aplikace3.html#cb206-23" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb206-24"><a href="aplikace3.html#cb206-24" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="aplikace3.html#cb207-1" tabindex="-1"></a><span class="co"># samotna CV</span></span>
<span id="cb207-2"><a href="aplikace3.html#cb207-2" tabindex="-1"></a><span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb207-3"><a href="aplikace3.html#cb207-3" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb207-4"><a href="aplikace3.html#cb207-4" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb207-5"><a href="aplikace3.html#cb207-5" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb207-6"><a href="aplikace3.html#cb207-6" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb207-7"><a href="aplikace3.html#cb207-7" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb207-8"><a href="aplikace3.html#cb207-8" tabindex="-1"></a>  </span>
<span id="cb207-9"><a href="aplikace3.html#cb207-9" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb207-10"><a href="aplikace3.html#cb207-10" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb207-11"><a href="aplikace3.html#cb207-11" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb207-12"><a href="aplikace3.html#cb207-12" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb207-13"><a href="aplikace3.html#cb207-13" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb207-14"><a href="aplikace3.html#cb207-14" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb207-15"><a href="aplikace3.html#cb207-15" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb207-16"><a href="aplikace3.html#cb207-16" tabindex="-1"></a>                    <span class="at">epsilon =</span> eps,</span>
<span id="cb207-17"><a href="aplikace3.html#cb207-17" tabindex="-1"></a>                    <span class="at">cost =</span> C,</span>
<span id="cb207-18"><a href="aplikace3.html#cb207-18" tabindex="-1"></a>                    <span class="at">gamma =</span> gamma)</span>
<span id="cb207-19"><a href="aplikace3.html#cb207-19" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb207-20"><a href="aplikace3.html#cb207-20" tabindex="-1"></a>  }</span>
<span id="cb207-21"><a href="aplikace3.html#cb207-21" tabindex="-1"></a>  </span>
<span id="cb207-22"><a href="aplikace3.html#cb207-22" tabindex="-1"></a>  <span class="co"># projdeme dimenze</span></span>
<span id="cb207-23"><a href="aplikace3.html#cb207-23" tabindex="-1"></a>  <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb207-24"><a href="aplikace3.html#cb207-24" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb207-25"><a href="aplikace3.html#cb207-25" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb207-26"><a href="aplikace3.html#cb207-26" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb207-27"><a href="aplikace3.html#cb207-27" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb207-28"><a href="aplikace3.html#cb207-28" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb207-29"><a href="aplikace3.html#cb207-29" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb207-30"><a href="aplikace3.html#cb207-30" tabindex="-1"></a>                             alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb207-31"><a href="aplikace3.html#cb207-31" tabindex="-1"></a>    }</span>
<span id="cb207-32"><a href="aplikace3.html#cb207-32" tabindex="-1"></a>    <span class="co"># projdeme folds</span></span>
<span id="cb207-33"><a href="aplikace3.html#cb207-33" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb207-34"><a href="aplikace3.html#cb207-34" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb207-35"><a href="aplikace3.html#cb207-35" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb207-36"><a href="aplikace3.html#cb207-36" tabindex="-1"></a>      <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb207-37"><a href="aplikace3.html#cb207-37" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb207-38"><a href="aplikace3.html#cb207-38" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb207-39"><a href="aplikace3.html#cb207-39" tabindex="-1"></a>      <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb207-40"><a href="aplikace3.html#cb207-40" tabindex="-1"></a>      Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb207-41"><a href="aplikace3.html#cb207-41" tabindex="-1"></a>                                  <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb207-42"><a href="aplikace3.html#cb207-42" tabindex="-1"></a>                                  <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb207-43"><a href="aplikace3.html#cb207-43" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb207-44"><a href="aplikace3.html#cb207-44" tabindex="-1"></a>      <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb207-45"><a href="aplikace3.html#cb207-45" tabindex="-1"></a>      <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb207-46"><a href="aplikace3.html#cb207-46" tabindex="-1"></a>        kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb207-47"><a href="aplikace3.html#cb207-47" tabindex="-1"></a>      </span>
<span id="cb207-48"><a href="aplikace3.html#cb207-48" tabindex="-1"></a>        data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb207-49"><a href="aplikace3.html#cb207-49" tabindex="-1"></a>        data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb207-50"><a href="aplikace3.html#cb207-50" tabindex="-1"></a>        </span>
<span id="cb207-51"><a href="aplikace3.html#cb207-51" tabindex="-1"></a>        data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb207-52"><a href="aplikace3.html#cb207-52" tabindex="-1"></a>        data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb207-53"><a href="aplikace3.html#cb207-53" tabindex="-1"></a>        </span>
<span id="cb207-54"><a href="aplikace3.html#cb207-54" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb207-55"><a href="aplikace3.html#cb207-55" tabindex="-1"></a>        clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb207-56"><a href="aplikace3.html#cb207-56" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb207-57"><a href="aplikace3.html#cb207-57" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb207-58"><a href="aplikace3.html#cb207-58" tabindex="-1"></a>                            <span class="at">cost =</span> C,</span>
<span id="cb207-59"><a href="aplikace3.html#cb207-59" tabindex="-1"></a>                            <span class="at">coef0 =</span> coef0,</span>
<span id="cb207-60"><a href="aplikace3.html#cb207-60" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb207-61"><a href="aplikace3.html#cb207-61" tabindex="-1"></a>        </span>
<span id="cb207-62"><a href="aplikace3.html#cb207-62" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb207-63"><a href="aplikace3.html#cb207-63" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb207-64"><a href="aplikace3.html#cb207-64" tabindex="-1"></a>        presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb207-65"><a href="aplikace3.html#cb207-65" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb207-66"><a href="aplikace3.html#cb207-66" tabindex="-1"></a>        </span>
<span id="cb207-67"><a href="aplikace3.html#cb207-67" tabindex="-1"></a>        <span class="co"># ulozeni vysledku</span></span>
<span id="cb207-68"><a href="aplikace3.html#cb207-68" tabindex="-1"></a>        Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb207-69"><a href="aplikace3.html#cb207-69" tabindex="-1"></a>      }</span>
<span id="cb207-70"><a href="aplikace3.html#cb207-70" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb207-71"><a href="aplikace3.html#cb207-71" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb207-72"><a href="aplikace3.html#cb207-72" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb207-73"><a href="aplikace3.html#cb207-73" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb207-74"><a href="aplikace3.html#cb207-74" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb207-75"><a href="aplikace3.html#cb207-75" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb207-76"><a href="aplikace3.html#cb207-76" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb207-77"><a href="aplikace3.html#cb207-77" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb207-78"><a href="aplikace3.html#cb207-78" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb207-79"><a href="aplikace3.html#cb207-79" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb207-80"><a href="aplikace3.html#cb207-80" tabindex="-1"></a>    }</span>
<span id="cb207-81"><a href="aplikace3.html#cb207-81" tabindex="-1"></a>  }</span>
<span id="cb207-82"><a href="aplikace3.html#cb207-82" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="aplikace3.html#cb208-1" tabindex="-1"></a><span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb208-2"><a href="aplikace3.html#cb208-2" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb208-3"><a href="aplikace3.html#cb208-3" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb208-4"><a href="aplikace3.html#cb208-4" tabindex="-1"></a>}</span>
<span id="cb208-5"><a href="aplikace3.html#cb208-5" tabindex="-1"></a></span>
<span id="cb208-6"><a href="aplikace3.html#cb208-6" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb208-7"><a href="aplikace3.html#cb208-7" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb208-8"><a href="aplikace3.html#cb208-8" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv))</span>
<span id="cb208-9"><a href="aplikace3.html#cb208-9" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb208-10"><a href="aplikace3.html#cb208-10" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb208-11"><a href="aplikace3.html#cb208-11" tabindex="-1"></a></span>
<span id="cb208-12"><a href="aplikace3.html#cb208-12" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb208-13"><a href="aplikace3.html#cb208-13" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb208-14"><a href="aplikace3.html#cb208-14" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb208-15"><a href="aplikace3.html#cb208-15" tabindex="-1"></a>d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb208-16"><a href="aplikace3.html#cb208-16" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb208-17"><a href="aplikace3.html#cb208-17" tabindex="-1"></a></span>
<span id="cb208-18"><a href="aplikace3.html#cb208-18" tabindex="-1"></a>err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb208-19"><a href="aplikace3.html#cb208-19" tabindex="-1"></a>                     <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb208-20"><a href="aplikace3.html#cb208-20" tabindex="-1"></a>                     <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb208-21"><a href="aplikace3.html#cb208-21" tabindex="-1"></a>df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">gamma =</span> gamma.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb208-22"><a href="aplikace3.html#cb208-22" tabindex="-1"></a>           <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb208-23"><a href="aplikace3.html#cb208-23" tabindex="-1"></a>           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-202">Tabulka 12.10: </span>Souhrnné výsledky cross-validace pro metodu SVM v kombinaci s RKHS na simulovaných datech. <span class="math inline">\(\widehat{Err}_{train}\)</span> značí odhad trénovací chybovosti a <span class="math inline">\(\widehat{Err}_{test}\)</span> testovací chybovosti.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad d\)</span></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad\gamma\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{cross\_validace}\)</span></th>
<th align="left">Model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>linear</td>
<td align="right">12</td>
<td align="right">1.0000</td>
<td align="right">0</td>
<td align="left">linear</td>
</tr>
<tr class="even">
<td>poly</td>
<td align="right">18</td>
<td align="right">1.0000</td>
<td align="right">0</td>
<td align="left">polynomial</td>
</tr>
<tr class="odd">
<td>radial</td>
<td align="right">17</td>
<td align="right">1.9307</td>
<td align="right">0</td>
<td align="left">radial</td>
</tr>
</tbody>
</table>
<p>Vidíme, že nejlépe vychází hodnota parametru <span class="math inline">\(d={}\)</span> 12 a <span class="math inline">\(\gamma={}\)</span> 1 pro lineární jádro s hodnotou chybovosti spočtenou pomocí 10-násobné CV 0, <span class="math inline">\(d={}\)</span> 18 a <span class="math inline">\(\gamma={}\)</span> 1 pro polynomiální jádro s hodnotou chybovosti spočtenou pomocí 10-násobné CV 0 a <span class="math inline">\(d={}\)</span> 17 a <span class="math inline">\(\gamma={}\)</span> 1.9307 pro radiální jádro s hodnotou chybovosti 0.
Pro zajímavost si ještě vykresleme funkci validační chybovosti v závislosti na dimenzi <span class="math inline">\(d\)</span> a hodnotě hyperparametru <span class="math inline">\(\gamma\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="aplikace3.html#cb209-1" tabindex="-1"></a>CV.results.plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> <span class="fu">rep</span>(dimensions <span class="sc">|&gt;</span> <span class="fu">rep</span>(<span class="dv">3</span>), <span class="at">each =</span> <span class="fu">length</span>(gamma.cv)), </span>
<span id="cb209-2"><a href="aplikace3.html#cb209-2" tabindex="-1"></a>                              <span class="at">gamma =</span> <span class="fu">rep</span>(gamma.cv, <span class="fu">length</span>(dimensions)) <span class="sc">|&gt;</span> <span class="fu">rep</span>(<span class="dv">3</span>),</span>
<span id="cb209-3"><a href="aplikace3.html#cb209-3" tabindex="-1"></a>                               <span class="at">CV =</span> <span class="fu">c</span>(<span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb209-4"><a href="aplikace3.html#cb209-4" tabindex="-1"></a>                                      <span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.p), </span>
<span id="cb209-5"><a href="aplikace3.html#cb209-5" tabindex="-1"></a>                                      <span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.r)),</span>
<span id="cb209-6"><a href="aplikace3.html#cb209-6" tabindex="-1"></a>                               <span class="at">Kernel =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>), </span>
<span id="cb209-7"><a href="aplikace3.html#cb209-7" tabindex="-1"></a>                                            <span class="at">each =</span> <span class="fu">length</span>(dimensions) <span class="sc">*</span> </span>
<span id="cb209-8"><a href="aplikace3.html#cb209-8" tabindex="-1"></a>                                              <span class="fu">length</span>(gamma.cv)) <span class="sc">|&gt;</span> <span class="fu">factor</span>())</span>
<span id="cb209-9"><a href="aplikace3.html#cb209-9" tabindex="-1"></a>CV.results.plot <span class="sc">|&gt;</span> </span>
<span id="cb209-10"><a href="aplikace3.html#cb209-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> gamma, <span class="at">z =</span> CV)) <span class="sc">+</span> </span>
<span id="cb209-11"><a href="aplikace3.html#cb209-11" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>() <span class="sc">+</span></span>
<span id="cb209-12"><a href="aplikace3.html#cb209-12" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>) <span class="sc">+</span></span>
<span id="cb209-13"><a href="aplikace3.html#cb209-13" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Kernel) <span class="sc">+</span></span>
<span id="cb209-14"><a href="aplikace3.html#cb209-14" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb209-15"><a href="aplikace3.html#cb209-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(d),</span>
<span id="cb209-16"><a href="aplikace3.html#cb209-16" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(gamma)) <span class="sc">+</span> </span>
<span id="cb209-17"><a href="aplikace3.html#cb209-17" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Spectral&quot;</span>) <span class="sc">+</span> </span>
<span id="cb209-18"><a href="aplikace3.html#cb209-18" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df.RKHS.res, <span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> gamma),</span>
<span id="cb209-19"><a href="aplikace3.html#cb209-19" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">5</span>, <span class="at">pch =</span> <span class="st">&#39;+&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-203"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-203-1.png" alt="Závislost validační chybovosti na volbě hyperparametrů $d$ a $\gamma$, zvlášť pro všechna tři uvažovaná jádra v metodě SVM." width="672" />
<p class="caption">
Obrázek 12.40: Závislost validační chybovosti na volbě hyperparametrů <span class="math inline">\(d\)</span> a <span class="math inline">\(\gamma\)</span>, zvlášť pro všechna tři uvažovaná jádra v metodě SVM.
</p>
</div>
<p>Jelikož již máme nalezeny optimální hodnoty hyperparametrů, můžeme zkounstruovat finální modely a určit jejich úspěšnost klasifikace na testovacích datech.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="aplikace3.html#cb210-1" tabindex="-1"></a><span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb210-2"><a href="aplikace3.html#cb210-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb210-3"><a href="aplikace3.html#cb210-3" tabindex="-1"></a><span class="co"># pridame i testovaci data</span></span>
<span id="cb210-4"><a href="aplikace3.html#cb210-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="aplikace3.html#cb211-1" tabindex="-1"></a><span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb211-2"><a href="aplikace3.html#cb211-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, </span>
<span id="cb211-3"><a href="aplikace3.html#cb211-3" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, </span>
<span id="cb211-4"><a href="aplikace3.html#cb211-4" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>), </span>
<span id="cb211-5"><a href="aplikace3.html#cb211-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb211-6"><a href="aplikace3.html#cb211-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb211-7"><a href="aplikace3.html#cb211-7" tabindex="-1"></a></span>
<span id="cb211-8"><a href="aplikace3.html#cb211-8" tabindex="-1"></a><span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb211-9"><a href="aplikace3.html#cb211-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb211-10"><a href="aplikace3.html#cb211-10" tabindex="-1"></a>  <span class="co"># spocitame matici K</span></span>
<span id="cb211-11"><a href="aplikace3.html#cb211-11" tabindex="-1"></a>  gamma <span class="ot">&lt;-</span> gamma.opt[kernel_number] <span class="co"># hodnota gamma pomoci CV</span></span>
<span id="cb211-12"><a href="aplikace3.html#cb211-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb211-13"><a href="aplikace3.html#cb211-13" tabindex="-1"></a>  </span>
<span id="cb211-14"><a href="aplikace3.html#cb211-14" tabindex="-1"></a>  <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb211-15"><a href="aplikace3.html#cb211-15" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb211-16"><a href="aplikace3.html#cb211-16" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb211-17"><a href="aplikace3.html#cb211-17" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb211-18"><a href="aplikace3.html#cb211-18" tabindex="-1"></a>  <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb211-19"><a href="aplikace3.html#cb211-19" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb211-20"><a href="aplikace3.html#cb211-20" tabindex="-1"></a>                       <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb211-21"><a href="aplikace3.html#cb211-21" tabindex="-1"></a>  </span>
<span id="cb211-22"><a href="aplikace3.html#cb211-22" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb211-23"><a href="aplikace3.html#cb211-23" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb211-24"><a href="aplikace3.html#cb211-24" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb211-25"><a href="aplikace3.html#cb211-25" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb211-26"><a href="aplikace3.html#cb211-26" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb211-27"><a href="aplikace3.html#cb211-27" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb211-28"><a href="aplikace3.html#cb211-28" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb211-29"><a href="aplikace3.html#cb211-29" tabindex="-1"></a>                    <span class="at">epsilon =</span> eps,</span>
<span id="cb211-30"><a href="aplikace3.html#cb211-30" tabindex="-1"></a>                    <span class="at">cost =</span> C,</span>
<span id="cb211-31"><a href="aplikace3.html#cb211-31" tabindex="-1"></a>                    <span class="at">gamma =</span> gamma)</span>
<span id="cb211-32"><a href="aplikace3.html#cb211-32" tabindex="-1"></a>    <span class="co"># urceni alpha</span></span>
<span id="cb211-33"><a href="aplikace3.html#cb211-33" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb211-34"><a href="aplikace3.html#cb211-34" tabindex="-1"></a>  }</span>
<span id="cb211-35"><a href="aplikace3.html#cb211-35" tabindex="-1"></a>  <span class="co"># d</span></span>
<span id="cb211-36"><a href="aplikace3.html#cb211-36" tabindex="-1"></a>  d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb211-37"><a href="aplikace3.html#cb211-37" tabindex="-1"></a>  </span>
<span id="cb211-38"><a href="aplikace3.html#cb211-38" tabindex="-1"></a>  <span class="co"># urceni vektoru lambda</span></span>
<span id="cb211-39"><a href="aplikace3.html#cb211-39" tabindex="-1"></a>  Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb211-40"><a href="aplikace3.html#cb211-40" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb211-41"><a href="aplikace3.html#cb211-41" tabindex="-1"></a>                        <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb211-42"><a href="aplikace3.html#cb211-42" tabindex="-1"></a>  </span>
<span id="cb211-43"><a href="aplikace3.html#cb211-43" tabindex="-1"></a>  <span class="co"># vypocet reprezentace</span></span>
<span id="cb211-44"><a href="aplikace3.html#cb211-44" tabindex="-1"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb211-45"><a href="aplikace3.html#cb211-45" tabindex="-1"></a>    Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb211-46"><a href="aplikace3.html#cb211-46" tabindex="-1"></a>  }</span>
<span id="cb211-47"><a href="aplikace3.html#cb211-47" tabindex="-1"></a>  </span>
<span id="cb211-48"><a href="aplikace3.html#cb211-48" tabindex="-1"></a>  <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb211-49"><a href="aplikace3.html#cb211-49" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb211-50"><a href="aplikace3.html#cb211-50" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb211-51"><a href="aplikace3.html#cb211-51" tabindex="-1"></a></span>
<span id="cb211-52"><a href="aplikace3.html#cb211-52" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb211-53"><a href="aplikace3.html#cb211-53" tabindex="-1"></a></span>
<span id="cb211-54"><a href="aplikace3.html#cb211-54" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb211-55"><a href="aplikace3.html#cb211-55" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb211-56"><a href="aplikace3.html#cb211-56" tabindex="-1"></a>  </span>
<span id="cb211-57"><a href="aplikace3.html#cb211-57" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb211-58"><a href="aplikace3.html#cb211-58" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb211-59"><a href="aplikace3.html#cb211-59" tabindex="-1"></a>  </span>
<span id="cb211-60"><a href="aplikace3.html#cb211-60" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb211-61"><a href="aplikace3.html#cb211-61" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb211-62"><a href="aplikace3.html#cb211-62" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb211-63"><a href="aplikace3.html#cb211-63" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb211-64"><a href="aplikace3.html#cb211-64" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb211-65"><a href="aplikace3.html#cb211-65" tabindex="-1"></a>                      <span class="at">coef0 =</span> coef0,</span>
<span id="cb211-66"><a href="aplikace3.html#cb211-66" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type)</span>
<span id="cb211-67"><a href="aplikace3.html#cb211-67" tabindex="-1"></a>  </span>
<span id="cb211-68"><a href="aplikace3.html#cb211-68" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb211-69"><a href="aplikace3.html#cb211-69" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb211-70"><a href="aplikace3.html#cb211-70" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb211-71"><a href="aplikace3.html#cb211-71" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb211-72"><a href="aplikace3.html#cb211-72" tabindex="-1"></a>    </span>
<span id="cb211-73"><a href="aplikace3.html#cb211-73" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb211-74"><a href="aplikace3.html#cb211-74" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb211-75"><a href="aplikace3.html#cb211-75" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb211-76"><a href="aplikace3.html#cb211-76" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb211-77"><a href="aplikace3.html#cb211-77" tabindex="-1"></a>  </span>
<span id="cb211-78"><a href="aplikace3.html#cb211-78" tabindex="-1"></a>  <span class="co"># ulozeni vysledku</span></span>
<span id="cb211-79"><a href="aplikace3.html#cb211-79" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb211-80"><a href="aplikace3.html#cb211-80" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-206">Tabulka 12.11: </span>Souhrnné výsledky metody SVM v kombinaci s RKHS na simulovaných datech. <span class="math inline">\(\widehat{Err}_{train}\)</span> značí odhad trénovací chybovosti a <span class="math inline">\(\widehat{Err}_{test}\)</span> testovací chybovosti.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS - radial</td>
<td align="center">0</td>
<td align="center">0.0308</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - radial</td>
<td align="center">0</td>
<td align="center">0.0769</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - radial</td>
<td align="center">0</td>
<td align="center">0.0308</td>
</tr>
</tbody>
</table>
<p>Chybovost metody SVM v kombinaci s projekcí na Reproducing Kernel Hilbert Space je tedy na trénovacích datech rovna 0 % pro lineární jádro, 0 % pro polynomiální jádro a 0 % pro gaussovské jádro.
Na testovacích datech je potom chybovost metody 3.08 % pro lineární jádro, 7.69 % pro polynomiální jádro a 3.08 % pro radiální jádro.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="aplikace3.html#cb212-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="polynomiální-jádro-8" class="section level6 hasAnchor" number="12.5.7.5.0.2">
<h6><span class="header-section-number">12.5.7.5.0.2</span> Polynomiální jádro<a href="aplikace3.html#polynomiální-jádro-8" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="aplikace3.html#cb213-1" tabindex="-1"></a><span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb213-2"><a href="aplikace3.html#cb213-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb213-3"><a href="aplikace3.html#cb213-3" tabindex="-1"></a><span class="co"># pridame i testovaci data</span></span>
<span id="cb213-4"><a href="aplikace3.html#cb213-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb213-5"><a href="aplikace3.html#cb213-5" tabindex="-1"></a></span>
<span id="cb213-6"><a href="aplikace3.html#cb213-6" tabindex="-1"></a><span class="co"># jadro a jadrova matice ... polynomialni s parametrem p</span></span>
<span id="cb213-7"><a href="aplikace3.html#cb213-7" tabindex="-1"></a>Poly.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, p) {</span>
<span id="cb213-8"><a href="aplikace3.html#cb213-8" tabindex="-1"></a>  <span class="fu">return</span>((<span class="dv">1</span> <span class="sc">+</span> x <span class="sc">*</span> y)<span class="sc">^</span>p)</span>
<span id="cb213-9"><a href="aplikace3.html#cb213-9" tabindex="-1"></a>}</span>
<span id="cb213-10"><a href="aplikace3.html#cb213-10" tabindex="-1"></a></span>
<span id="cb213-11"><a href="aplikace3.html#cb213-11" tabindex="-1"></a>Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, p) {</span>
<span id="cb213-12"><a href="aplikace3.html#cb213-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb213-13"><a href="aplikace3.html#cb213-13" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb213-14"><a href="aplikace3.html#cb213-14" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb213-15"><a href="aplikace3.html#cb213-15" tabindex="-1"></a>      K[i, j] <span class="ot">&lt;-</span> <span class="fu">Poly.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], p)</span>
<span id="cb213-16"><a href="aplikace3.html#cb213-16" tabindex="-1"></a>    }</span>
<span id="cb213-17"><a href="aplikace3.html#cb213-17" tabindex="-1"></a>  }</span>
<span id="cb213-18"><a href="aplikace3.html#cb213-18" tabindex="-1"></a>  <span class="fu">return</span>(K)</span>
<span id="cb213-19"><a href="aplikace3.html#cb213-19" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="aplikace3.html#cb214-1" tabindex="-1"></a><span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb214-2"><a href="aplikace3.html#cb214-2" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb214-3"><a href="aplikace3.html#cb214-3" tabindex="-1"></a><span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb214-4"><a href="aplikace3.html#cb214-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb214-5"><a href="aplikace3.html#cb214-5" tabindex="-1"></a></span>
<span id="cb214-6"><a href="aplikace3.html#cb214-6" tabindex="-1"></a><span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb214-7"><a href="aplikace3.html#cb214-7" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">30</span> <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb214-8"><a href="aplikace3.html#cb214-8" tabindex="-1"></a>poly.cv <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb214-9"><a href="aplikace3.html#cb214-9" tabindex="-1"></a></span>
<span id="cb214-10"><a href="aplikace3.html#cb214-10" tabindex="-1"></a><span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb214-11"><a href="aplikace3.html#cb214-11" tabindex="-1"></a><span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb214-12"><a href="aplikace3.html#cb214-12" tabindex="-1"></a><span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb214-13"><a href="aplikace3.html#cb214-13" tabindex="-1"></a><span class="co"># v radcich budou hodnoty pro dane p a vrstvy odpovidaji folds</span></span>
<span id="cb214-14"><a href="aplikace3.html#cb214-14" tabindex="-1"></a>dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, poly.cv),</span>
<span id="cb214-15"><a href="aplikace3.html#cb214-15" tabindex="-1"></a>                  <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb214-16"><a href="aplikace3.html#cb214-16" tabindex="-1"></a>                  <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb214-17"><a href="aplikace3.html#cb214-17" tabindex="-1"></a></span>
<span id="cb214-18"><a href="aplikace3.html#cb214-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb214-19"><a href="aplikace3.html#cb214-19" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb214-20"><a href="aplikace3.html#cb214-20" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb214-21"><a href="aplikace3.html#cb214-21" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb214-22"><a href="aplikace3.html#cb214-22" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb214-23"><a href="aplikace3.html#cb214-23" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb214-24"><a href="aplikace3.html#cb214-24" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="aplikace3.html#cb215-1" tabindex="-1"></a><span class="co"># samotna CV</span></span>
<span id="cb215-2"><a href="aplikace3.html#cb215-2" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> poly.cv) {</span>
<span id="cb215-3"><a href="aplikace3.html#cb215-3" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb215-4"><a href="aplikace3.html#cb215-4" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb215-5"><a href="aplikace3.html#cb215-5" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb215-6"><a href="aplikace3.html#cb215-6" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb215-7"><a href="aplikace3.html#cb215-7" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb215-8"><a href="aplikace3.html#cb215-8" tabindex="-1"></a>  </span>
<span id="cb215-9"><a href="aplikace3.html#cb215-9" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb215-10"><a href="aplikace3.html#cb215-10" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb215-11"><a href="aplikace3.html#cb215-11" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb215-12"><a href="aplikace3.html#cb215-12" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb215-13"><a href="aplikace3.html#cb215-13" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb215-14"><a href="aplikace3.html#cb215-14" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb215-15"><a href="aplikace3.html#cb215-15" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb215-16"><a href="aplikace3.html#cb215-16" tabindex="-1"></a>                    <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb215-17"><a href="aplikace3.html#cb215-17" tabindex="-1"></a>                    <span class="at">cost =</span> C,</span>
<span id="cb215-18"><a href="aplikace3.html#cb215-18" tabindex="-1"></a>                    <span class="at">epsilon =</span> eps,</span>
<span id="cb215-19"><a href="aplikace3.html#cb215-19" tabindex="-1"></a>                    <span class="at">degree =</span> p)</span>
<span id="cb215-20"><a href="aplikace3.html#cb215-20" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb215-21"><a href="aplikace3.html#cb215-21" tabindex="-1"></a>  }</span>
<span id="cb215-22"><a href="aplikace3.html#cb215-22" tabindex="-1"></a>  </span>
<span id="cb215-23"><a href="aplikace3.html#cb215-23" tabindex="-1"></a>  <span class="co"># projdeme dimenze</span></span>
<span id="cb215-24"><a href="aplikace3.html#cb215-24" tabindex="-1"></a>  <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb215-25"><a href="aplikace3.html#cb215-25" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb215-26"><a href="aplikace3.html#cb215-26" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb215-27"><a href="aplikace3.html#cb215-27" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb215-28"><a href="aplikace3.html#cb215-28" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb215-29"><a href="aplikace3.html#cb215-29" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb215-30"><a href="aplikace3.html#cb215-30" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb215-31"><a href="aplikace3.html#cb215-31" tabindex="-1"></a>                             alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb215-32"><a href="aplikace3.html#cb215-32" tabindex="-1"></a>    }</span>
<span id="cb215-33"><a href="aplikace3.html#cb215-33" tabindex="-1"></a>    <span class="co"># projdeme folds</span></span>
<span id="cb215-34"><a href="aplikace3.html#cb215-34" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb215-35"><a href="aplikace3.html#cb215-35" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb215-36"><a href="aplikace3.html#cb215-36" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb215-37"><a href="aplikace3.html#cb215-37" tabindex="-1"></a>      <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb215-38"><a href="aplikace3.html#cb215-38" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb215-39"><a href="aplikace3.html#cb215-39" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb215-40"><a href="aplikace3.html#cb215-40" tabindex="-1"></a>      <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb215-41"><a href="aplikace3.html#cb215-41" tabindex="-1"></a>      Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb215-42"><a href="aplikace3.html#cb215-42" tabindex="-1"></a>                                  <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb215-43"><a href="aplikace3.html#cb215-43" tabindex="-1"></a>                                  <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb215-44"><a href="aplikace3.html#cb215-44" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb215-45"><a href="aplikace3.html#cb215-45" tabindex="-1"></a>      <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb215-46"><a href="aplikace3.html#cb215-46" tabindex="-1"></a>      <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb215-47"><a href="aplikace3.html#cb215-47" tabindex="-1"></a>        kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb215-48"><a href="aplikace3.html#cb215-48" tabindex="-1"></a>      </span>
<span id="cb215-49"><a href="aplikace3.html#cb215-49" tabindex="-1"></a>        data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb215-50"><a href="aplikace3.html#cb215-50" tabindex="-1"></a>        data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb215-51"><a href="aplikace3.html#cb215-51" tabindex="-1"></a>        </span>
<span id="cb215-52"><a href="aplikace3.html#cb215-52" tabindex="-1"></a>        data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb215-53"><a href="aplikace3.html#cb215-53" tabindex="-1"></a>        data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb215-54"><a href="aplikace3.html#cb215-54" tabindex="-1"></a>        </span>
<span id="cb215-55"><a href="aplikace3.html#cb215-55" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb215-56"><a href="aplikace3.html#cb215-56" tabindex="-1"></a>        clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb215-57"><a href="aplikace3.html#cb215-57" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb215-58"><a href="aplikace3.html#cb215-58" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb215-59"><a href="aplikace3.html#cb215-59" tabindex="-1"></a>                            <span class="at">cost =</span> C,                    </span>
<span id="cb215-60"><a href="aplikace3.html#cb215-60" tabindex="-1"></a>                            <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb215-61"><a href="aplikace3.html#cb215-61" tabindex="-1"></a>                            <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb215-62"><a href="aplikace3.html#cb215-62" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb215-63"><a href="aplikace3.html#cb215-63" tabindex="-1"></a>        </span>
<span id="cb215-64"><a href="aplikace3.html#cb215-64" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb215-65"><a href="aplikace3.html#cb215-65" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb215-66"><a href="aplikace3.html#cb215-66" tabindex="-1"></a>        presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb215-67"><a href="aplikace3.html#cb215-67" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb215-68"><a href="aplikace3.html#cb215-68" tabindex="-1"></a>        </span>
<span id="cb215-69"><a href="aplikace3.html#cb215-69" tabindex="-1"></a>        <span class="co"># ulozeni vysledku</span></span>
<span id="cb215-70"><a href="aplikace3.html#cb215-70" tabindex="-1"></a>        Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb215-71"><a href="aplikace3.html#cb215-71" tabindex="-1"></a>      }</span>
<span id="cb215-72"><a href="aplikace3.html#cb215-72" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb215-73"><a href="aplikace3.html#cb215-73" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb215-74"><a href="aplikace3.html#cb215-74" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb215-75"><a href="aplikace3.html#cb215-75" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb215-76"><a href="aplikace3.html#cb215-76" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb215-77"><a href="aplikace3.html#cb215-77" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb215-78"><a href="aplikace3.html#cb215-78" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb215-79"><a href="aplikace3.html#cb215-79" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb215-80"><a href="aplikace3.html#cb215-80" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb215-81"><a href="aplikace3.html#cb215-81" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb215-82"><a href="aplikace3.html#cb215-82" tabindex="-1"></a>    }</span>
<span id="cb215-83"><a href="aplikace3.html#cb215-83" tabindex="-1"></a>  }</span>
<span id="cb215-84"><a href="aplikace3.html#cb215-84" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="aplikace3.html#cb216-1" tabindex="-1"></a><span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb216-2"><a href="aplikace3.html#cb216-2" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb216-3"><a href="aplikace3.html#cb216-3" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb216-4"><a href="aplikace3.html#cb216-4" tabindex="-1"></a>}</span>
<span id="cb216-5"><a href="aplikace3.html#cb216-5" tabindex="-1"></a></span>
<span id="cb216-6"><a href="aplikace3.html#cb216-6" tabindex="-1"></a>poly.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb216-7"><a href="aplikace3.html#cb216-7" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb216-8"><a href="aplikace3.html#cb216-8" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv))</span>
<span id="cb216-9"><a href="aplikace3.html#cb216-9" tabindex="-1"></a>poly.opt[poly.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(poly.cv)</span>
<span id="cb216-10"><a href="aplikace3.html#cb216-10" tabindex="-1"></a>poly.opt <span class="ot">&lt;-</span> poly.cv[poly.opt]</span>
<span id="cb216-11"><a href="aplikace3.html#cb216-11" tabindex="-1"></a></span>
<span id="cb216-12"><a href="aplikace3.html#cb216-12" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb216-13"><a href="aplikace3.html#cb216-13" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb216-14"><a href="aplikace3.html#cb216-14" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb216-15"><a href="aplikace3.html#cb216-15" tabindex="-1"></a>d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb216-16"><a href="aplikace3.html#cb216-16" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb216-17"><a href="aplikace3.html#cb216-17" tabindex="-1"></a></span>
<span id="cb216-18"><a href="aplikace3.html#cb216-18" tabindex="-1"></a>err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb216-19"><a href="aplikace3.html#cb216-19" tabindex="-1"></a>                     <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb216-20"><a href="aplikace3.html#cb216-20" tabindex="-1"></a>                     <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb216-21"><a href="aplikace3.html#cb216-21" tabindex="-1"></a>df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">p =</span> poly.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb216-22"><a href="aplikace3.html#cb216-22" tabindex="-1"></a>           <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb216-23"><a href="aplikace3.html#cb216-23" tabindex="-1"></a>           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-211">Tabulka 12.12: </span>Souhrnné výsledky cross-validace pro metodu SVM v kombinaci s RKHS na simulovaných datech. <span class="math inline">\(\widehat{Err}_{train}\)</span> značí odhad trénovací chybovosti a <span class="math inline">\(\widehat{Err}_{test}\)</span> testovací chybovosti.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad d\)</span></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad p\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{cross\_validace}\)</span></th>
<th align="left">Model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>linear</td>
<td align="right">30</td>
<td align="right">3</td>
<td align="right">0.0077</td>
<td align="left">linear</td>
</tr>
<tr class="even">
<td>poly</td>
<td align="right">17</td>
<td align="right">2</td>
<td align="right">0.0077</td>
<td align="left">polynomial</td>
</tr>
<tr class="odd">
<td>radial</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">0.0254</td>
<td align="left">radial</td>
</tr>
</tbody>
</table>
<p>Vidíme, že nejlépe vychází hodnota parametru <span class="math inline">\(d={}\)</span> 30 a <span class="math inline">\(p={}\)</span> 3 pro lineární jádro s hodnotou chybovosti spočtenou pomocí 10-násobné CV 0.0077, <span class="math inline">\(d={}\)</span> 17 a <span class="math inline">\(p={}\)</span> 2 pro polynomiální jádro s hodnotou chybovosti spočtenou pomocí 10-násobné CV 0.0077 a <span class="math inline">\(d={}\)</span> 3 a <span class="math inline">\(p={}\)</span> 4 pro radiální jádro s hodnotou chybovosti 0.0254.</p>
<p>Jelikož již máme nalezeny optimální hodnoty hyperparametrů, můžeme zkounstruovat finální modely a určit jejich úspěšnost klasifikace na testovacích datech.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="aplikace3.html#cb217-1" tabindex="-1"></a><span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb217-2"><a href="aplikace3.html#cb217-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb217-3"><a href="aplikace3.html#cb217-3" tabindex="-1"></a><span class="co"># pridame i testovaci data</span></span>
<span id="cb217-4"><a href="aplikace3.html#cb217-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="aplikace3.html#cb218-1" tabindex="-1"></a><span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb218-2"><a href="aplikace3.html#cb218-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - poly&#39;</span>, </span>
<span id="cb218-3"><a href="aplikace3.html#cb218-3" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - RKHS - poly&#39;</span>, </span>
<span id="cb218-4"><a href="aplikace3.html#cb218-4" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - RKHS - poly&#39;</span>), </span>
<span id="cb218-5"><a href="aplikace3.html#cb218-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb218-6"><a href="aplikace3.html#cb218-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb218-7"><a href="aplikace3.html#cb218-7" tabindex="-1"></a></span>
<span id="cb218-8"><a href="aplikace3.html#cb218-8" tabindex="-1"></a><span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb218-9"><a href="aplikace3.html#cb218-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb218-10"><a href="aplikace3.html#cb218-10" tabindex="-1"></a>  <span class="co"># spocitame matici K</span></span>
<span id="cb218-11"><a href="aplikace3.html#cb218-11" tabindex="-1"></a>  p <span class="ot">&lt;-</span> poly.opt[kernel_number] <span class="co"># hodnota gamma pomoci CV</span></span>
<span id="cb218-12"><a href="aplikace3.html#cb218-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb218-13"><a href="aplikace3.html#cb218-13" tabindex="-1"></a>  </span>
<span id="cb218-14"><a href="aplikace3.html#cb218-14" tabindex="-1"></a>  <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb218-15"><a href="aplikace3.html#cb218-15" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb218-16"><a href="aplikace3.html#cb218-16" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb218-17"><a href="aplikace3.html#cb218-17" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb218-18"><a href="aplikace3.html#cb218-18" tabindex="-1"></a>  <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb218-19"><a href="aplikace3.html#cb218-19" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb218-20"><a href="aplikace3.html#cb218-20" tabindex="-1"></a>                       <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb218-21"><a href="aplikace3.html#cb218-21" tabindex="-1"></a>  </span>
<span id="cb218-22"><a href="aplikace3.html#cb218-22" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb218-23"><a href="aplikace3.html#cb218-23" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb218-24"><a href="aplikace3.html#cb218-24" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb218-25"><a href="aplikace3.html#cb218-25" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb218-26"><a href="aplikace3.html#cb218-26" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb218-27"><a href="aplikace3.html#cb218-27" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb218-28"><a href="aplikace3.html#cb218-28" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb218-29"><a href="aplikace3.html#cb218-29" tabindex="-1"></a>                    <span class="at">epsilon =</span> eps,</span>
<span id="cb218-30"><a href="aplikace3.html#cb218-30" tabindex="-1"></a>                    <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb218-31"><a href="aplikace3.html#cb218-31" tabindex="-1"></a>                    <span class="at">cost =</span> C,</span>
<span id="cb218-32"><a href="aplikace3.html#cb218-32" tabindex="-1"></a>                    <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb218-33"><a href="aplikace3.html#cb218-33" tabindex="-1"></a>                    <span class="at">degree =</span> p)</span>
<span id="cb218-34"><a href="aplikace3.html#cb218-34" tabindex="-1"></a>    <span class="co"># urceni alpha</span></span>
<span id="cb218-35"><a href="aplikace3.html#cb218-35" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb218-36"><a href="aplikace3.html#cb218-36" tabindex="-1"></a>  }</span>
<span id="cb218-37"><a href="aplikace3.html#cb218-37" tabindex="-1"></a>  <span class="co"># d</span></span>
<span id="cb218-38"><a href="aplikace3.html#cb218-38" tabindex="-1"></a>  d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb218-39"><a href="aplikace3.html#cb218-39" tabindex="-1"></a>  </span>
<span id="cb218-40"><a href="aplikace3.html#cb218-40" tabindex="-1"></a>  <span class="co"># urceni vektoru lambda</span></span>
<span id="cb218-41"><a href="aplikace3.html#cb218-41" tabindex="-1"></a>  Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb218-42"><a href="aplikace3.html#cb218-42" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb218-43"><a href="aplikace3.html#cb218-43" tabindex="-1"></a>                        <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb218-44"><a href="aplikace3.html#cb218-44" tabindex="-1"></a>  </span>
<span id="cb218-45"><a href="aplikace3.html#cb218-45" tabindex="-1"></a>  <span class="co"># vypocet reprezentace</span></span>
<span id="cb218-46"><a href="aplikace3.html#cb218-46" tabindex="-1"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb218-47"><a href="aplikace3.html#cb218-47" tabindex="-1"></a>    Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb218-48"><a href="aplikace3.html#cb218-48" tabindex="-1"></a>  }</span>
<span id="cb218-49"><a href="aplikace3.html#cb218-49" tabindex="-1"></a>  </span>
<span id="cb218-50"><a href="aplikace3.html#cb218-50" tabindex="-1"></a>  <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb218-51"><a href="aplikace3.html#cb218-51" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb218-52"><a href="aplikace3.html#cb218-52" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb218-53"><a href="aplikace3.html#cb218-53" tabindex="-1"></a></span>
<span id="cb218-54"><a href="aplikace3.html#cb218-54" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb218-55"><a href="aplikace3.html#cb218-55" tabindex="-1"></a></span>
<span id="cb218-56"><a href="aplikace3.html#cb218-56" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb218-57"><a href="aplikace3.html#cb218-57" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb218-58"><a href="aplikace3.html#cb218-58" tabindex="-1"></a>  </span>
<span id="cb218-59"><a href="aplikace3.html#cb218-59" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb218-60"><a href="aplikace3.html#cb218-60" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb218-61"><a href="aplikace3.html#cb218-61" tabindex="-1"></a>  </span>
<span id="cb218-62"><a href="aplikace3.html#cb218-62" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb218-63"><a href="aplikace3.html#cb218-63" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb218-64"><a href="aplikace3.html#cb218-64" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb218-65"><a href="aplikace3.html#cb218-65" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb218-66"><a href="aplikace3.html#cb218-66" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb218-67"><a href="aplikace3.html#cb218-67" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb218-68"><a href="aplikace3.html#cb218-68" tabindex="-1"></a>                      <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb218-69"><a href="aplikace3.html#cb218-69" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type)</span>
<span id="cb218-70"><a href="aplikace3.html#cb218-70" tabindex="-1"></a>  </span>
<span id="cb218-71"><a href="aplikace3.html#cb218-71" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb218-72"><a href="aplikace3.html#cb218-72" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb218-73"><a href="aplikace3.html#cb218-73" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb218-74"><a href="aplikace3.html#cb218-74" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb218-75"><a href="aplikace3.html#cb218-75" tabindex="-1"></a>    </span>
<span id="cb218-76"><a href="aplikace3.html#cb218-76" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb218-77"><a href="aplikace3.html#cb218-77" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb218-78"><a href="aplikace3.html#cb218-78" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb218-79"><a href="aplikace3.html#cb218-79" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb218-80"><a href="aplikace3.html#cb218-80" tabindex="-1"></a>  </span>
<span id="cb218-81"><a href="aplikace3.html#cb218-81" tabindex="-1"></a>  <span class="co"># ulozeni vysledku</span></span>
<span id="cb218-82"><a href="aplikace3.html#cb218-82" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb218-83"><a href="aplikace3.html#cb218-83" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-214">Tabulka 12.13: </span>Souhrnné výsledky metody SVM v kombinaci s RKHS na simulovaných datech. <span class="math inline">\(\widehat{Err}_{train}\)</span> značí odhad trénovací chybovosti a <span class="math inline">\(\widehat{Err}_{test}\)</span> testovací chybovosti.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS - poly</td>
<td align="center">0.00</td>
<td align="center">0.0308</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - poly</td>
<td align="center">0.00</td>
<td align="center">0.0154</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - poly</td>
<td align="center">0.02</td>
<td align="center">0.0308</td>
</tr>
</tbody>
</table>
<p>Chybovost metody SVM v kombinaci s projekcí na Reproducing Kernel Hilbert Space je tedy na trénovacích datech rovna 0 % pro lineární jádro, 0 % pro polynomiální jádro a 2 % pro gaussovské jádro.
Na testovacích datech je potom chybovost metody 3.08 % pro lineární jádro, 1.54 % pro polynomiální jádro a 3.08 % pro radiální jádro.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="aplikace3.html#cb219-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="lineární-jádro-8" class="section level6 hasAnchor" number="12.5.7.5.0.3">
<h6><span class="header-section-number">12.5.7.5.0.3</span> Lineární jádro<a href="aplikace3.html#lineární-jádro-8" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="aplikace3.html#cb220-1" tabindex="-1"></a><span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb220-2"><a href="aplikace3.html#cb220-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb220-3"><a href="aplikace3.html#cb220-3" tabindex="-1"></a><span class="co"># pridame i testovaci data</span></span>
<span id="cb220-4"><a href="aplikace3.html#cb220-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb220-5"><a href="aplikace3.html#cb220-5" tabindex="-1"></a></span>
<span id="cb220-6"><a href="aplikace3.html#cb220-6" tabindex="-1"></a><span class="co"># jadro a jadrova matice ... polynomialni s parametrem p</span></span>
<span id="cb220-7"><a href="aplikace3.html#cb220-7" tabindex="-1"></a>Linear.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb220-8"><a href="aplikace3.html#cb220-8" tabindex="-1"></a>  <span class="fu">return</span>(x <span class="sc">*</span> y)</span>
<span id="cb220-9"><a href="aplikace3.html#cb220-9" tabindex="-1"></a>}</span>
<span id="cb220-10"><a href="aplikace3.html#cb220-10" tabindex="-1"></a></span>
<span id="cb220-11"><a href="aplikace3.html#cb220-11" tabindex="-1"></a>Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb220-12"><a href="aplikace3.html#cb220-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb220-13"><a href="aplikace3.html#cb220-13" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb220-14"><a href="aplikace3.html#cb220-14" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb220-15"><a href="aplikace3.html#cb220-15" tabindex="-1"></a>      K[i, j] <span class="ot">&lt;-</span> <span class="fu">Linear.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j])</span>
<span id="cb220-16"><a href="aplikace3.html#cb220-16" tabindex="-1"></a>    }</span>
<span id="cb220-17"><a href="aplikace3.html#cb220-17" tabindex="-1"></a>  }</span>
<span id="cb220-18"><a href="aplikace3.html#cb220-18" tabindex="-1"></a>  <span class="fu">return</span>(K)</span>
<span id="cb220-19"><a href="aplikace3.html#cb220-19" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="aplikace3.html#cb221-1" tabindex="-1"></a><span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb221-2"><a href="aplikace3.html#cb221-2" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb221-3"><a href="aplikace3.html#cb221-3" tabindex="-1"></a><span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb221-4"><a href="aplikace3.html#cb221-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb221-5"><a href="aplikace3.html#cb221-5" tabindex="-1"></a></span>
<span id="cb221-6"><a href="aplikace3.html#cb221-6" tabindex="-1"></a><span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb221-7"><a href="aplikace3.html#cb221-7" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">40</span> <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb221-8"><a href="aplikace3.html#cb221-8" tabindex="-1"></a></span>
<span id="cb221-9"><a href="aplikace3.html#cb221-9" tabindex="-1"></a><span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb221-10"><a href="aplikace3.html#cb221-10" tabindex="-1"></a><span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb221-11"><a href="aplikace3.html#cb221-11" tabindex="-1"></a><span class="co"># ve sloupcich budou hodnoty presnosti pro dane d</span></span>
<span id="cb221-12"><a href="aplikace3.html#cb221-12" tabindex="-1"></a><span class="co"># v radcich budou hodnoty pro vrstvy odpovidaji folds</span></span>
<span id="cb221-13"><a href="aplikace3.html#cb221-13" tabindex="-1"></a>dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb221-14"><a href="aplikace3.html#cb221-14" tabindex="-1"></a>                  <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb221-15"><a href="aplikace3.html#cb221-15" tabindex="-1"></a></span>
<span id="cb221-16"><a href="aplikace3.html#cb221-16" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb221-17"><a href="aplikace3.html#cb221-17" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb221-18"><a href="aplikace3.html#cb221-18" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb221-19"><a href="aplikace3.html#cb221-19" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb221-20"><a href="aplikace3.html#cb221-20" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb221-21"><a href="aplikace3.html#cb221-21" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb221-22"><a href="aplikace3.html#cb221-22" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="aplikace3.html#cb222-1" tabindex="-1"></a><span class="co"># samotna CV</span></span>
<span id="cb222-2"><a href="aplikace3.html#cb222-2" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb222-3"><a href="aplikace3.html#cb222-3" tabindex="-1"></a>Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb222-4"><a href="aplikace3.html#cb222-4" tabindex="-1"></a>eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb222-5"><a href="aplikace3.html#cb222-5" tabindex="-1"></a>eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb222-6"><a href="aplikace3.html#cb222-6" tabindex="-1"></a>alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb222-7"><a href="aplikace3.html#cb222-7" tabindex="-1"></a></span>
<span id="cb222-8"><a href="aplikace3.html#cb222-8" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb222-9"><a href="aplikace3.html#cb222-9" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb222-10"><a href="aplikace3.html#cb222-10" tabindex="-1"></a>  df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb222-11"><a href="aplikace3.html#cb222-11" tabindex="-1"></a>                       <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb222-12"><a href="aplikace3.html#cb222-12" tabindex="-1"></a>  svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb222-13"><a href="aplikace3.html#cb222-13" tabindex="-1"></a>                  <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb222-14"><a href="aplikace3.html#cb222-14" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb222-15"><a href="aplikace3.html#cb222-15" tabindex="-1"></a>                  <span class="at">epsilon =</span> eps,                   </span>
<span id="cb222-16"><a href="aplikace3.html#cb222-16" tabindex="-1"></a>                  <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb222-17"><a href="aplikace3.html#cb222-17" tabindex="-1"></a>                  <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb222-18"><a href="aplikace3.html#cb222-18" tabindex="-1"></a>                  <span class="at">cost =</span> C)</span>
<span id="cb222-19"><a href="aplikace3.html#cb222-19" tabindex="-1"></a>  alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb222-20"><a href="aplikace3.html#cb222-20" tabindex="-1"></a>}</span>
<span id="cb222-21"><a href="aplikace3.html#cb222-21" tabindex="-1"></a></span>
<span id="cb222-22"><a href="aplikace3.html#cb222-22" tabindex="-1"></a><span class="co"># projdeme dimenze</span></span>
<span id="cb222-23"><a href="aplikace3.html#cb222-23" tabindex="-1"></a><span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb222-24"><a href="aplikace3.html#cb222-24" tabindex="-1"></a>  Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb222-25"><a href="aplikace3.html#cb222-25" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb222-26"><a href="aplikace3.html#cb222-26" tabindex="-1"></a>                        <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb222-27"><a href="aplikace3.html#cb222-27" tabindex="-1"></a>  <span class="co"># vypocet reprezentace</span></span>
<span id="cb222-28"><a href="aplikace3.html#cb222-28" tabindex="-1"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb222-29"><a href="aplikace3.html#cb222-29" tabindex="-1"></a>    Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb222-30"><a href="aplikace3.html#cb222-30" tabindex="-1"></a>                           alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb222-31"><a href="aplikace3.html#cb222-31" tabindex="-1"></a>  }</span>
<span id="cb222-32"><a href="aplikace3.html#cb222-32" tabindex="-1"></a>  <span class="co"># projdeme folds</span></span>
<span id="cb222-33"><a href="aplikace3.html#cb222-33" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb222-34"><a href="aplikace3.html#cb222-34" tabindex="-1"></a>    <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb222-35"><a href="aplikace3.html#cb222-35" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb222-36"><a href="aplikace3.html#cb222-36" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb222-37"><a href="aplikace3.html#cb222-37" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb222-38"><a href="aplikace3.html#cb222-38" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb222-39"><a href="aplikace3.html#cb222-39" tabindex="-1"></a>    <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb222-40"><a href="aplikace3.html#cb222-40" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb222-41"><a href="aplikace3.html#cb222-41" tabindex="-1"></a>                                <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb222-42"><a href="aplikace3.html#cb222-42" tabindex="-1"></a>                                <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb222-43"><a href="aplikace3.html#cb222-43" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb222-44"><a href="aplikace3.html#cb222-44" tabindex="-1"></a>    <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb222-45"><a href="aplikace3.html#cb222-45" tabindex="-1"></a>    <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb222-46"><a href="aplikace3.html#cb222-46" tabindex="-1"></a>      kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb222-47"><a href="aplikace3.html#cb222-47" tabindex="-1"></a>    </span>
<span id="cb222-48"><a href="aplikace3.html#cb222-48" tabindex="-1"></a>      data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb222-49"><a href="aplikace3.html#cb222-49" tabindex="-1"></a>      data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb222-50"><a href="aplikace3.html#cb222-50" tabindex="-1"></a>      </span>
<span id="cb222-51"><a href="aplikace3.html#cb222-51" tabindex="-1"></a>      data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb222-52"><a href="aplikace3.html#cb222-52" tabindex="-1"></a>      data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb222-53"><a href="aplikace3.html#cb222-53" tabindex="-1"></a>      </span>
<span id="cb222-54"><a href="aplikace3.html#cb222-54" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb222-55"><a href="aplikace3.html#cb222-55" tabindex="-1"></a>      clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb222-56"><a href="aplikace3.html#cb222-56" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb222-57"><a href="aplikace3.html#cb222-57" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb222-58"><a href="aplikace3.html#cb222-58" tabindex="-1"></a>                          <span class="at">kernel =</span> kernel_type,</span>
<span id="cb222-59"><a href="aplikace3.html#cb222-59" tabindex="-1"></a>                          <span class="at">epsilon =</span> eps,                   </span>
<span id="cb222-60"><a href="aplikace3.html#cb222-60" tabindex="-1"></a>                          <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb222-61"><a href="aplikace3.html#cb222-61" tabindex="-1"></a>                          <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb222-62"><a href="aplikace3.html#cb222-62" tabindex="-1"></a>                          <span class="at">cost =</span> C)</span>
<span id="cb222-63"><a href="aplikace3.html#cb222-63" tabindex="-1"></a>      </span>
<span id="cb222-64"><a href="aplikace3.html#cb222-64" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb222-65"><a href="aplikace3.html#cb222-65" tabindex="-1"></a>      predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb222-66"><a href="aplikace3.html#cb222-66" tabindex="-1"></a>      presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb222-67"><a href="aplikace3.html#cb222-67" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb222-68"><a href="aplikace3.html#cb222-68" tabindex="-1"></a>      </span>
<span id="cb222-69"><a href="aplikace3.html#cb222-69" tabindex="-1"></a>      <span class="co"># ulozeni vysledku</span></span>
<span id="cb222-70"><a href="aplikace3.html#cb222-70" tabindex="-1"></a>      Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb222-71"><a href="aplikace3.html#cb222-71" tabindex="-1"></a>    }</span>
<span id="cb222-72"><a href="aplikace3.html#cb222-72" tabindex="-1"></a>    <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb222-73"><a href="aplikace3.html#cb222-73" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb222-74"><a href="aplikace3.html#cb222-74" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb222-75"><a href="aplikace3.html#cb222-75" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.p[d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb222-76"><a href="aplikace3.html#cb222-76" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb222-77"><a href="aplikace3.html#cb222-77" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.r[d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb222-78"><a href="aplikace3.html#cb222-78" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb222-79"><a href="aplikace3.html#cb222-79" tabindex="-1"></a>  }</span>
<span id="cb222-80"><a href="aplikace3.html#cb222-80" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="aplikace3.html#cb223-1" tabindex="-1"></a><span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb223-2"><a href="aplikace3.html#cb223-2" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb223-3"><a href="aplikace3.html#cb223-3" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb223-4"><a href="aplikace3.html#cb223-4" tabindex="-1"></a>}</span>
<span id="cb223-5"><a href="aplikace3.html#cb223-5" tabindex="-1"></a></span>
<span id="cb223-6"><a href="aplikace3.html#cb223-6" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb223-7"><a href="aplikace3.html#cb223-7" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb223-8"><a href="aplikace3.html#cb223-8" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb223-9"><a href="aplikace3.html#cb223-9" tabindex="-1"></a>d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb223-10"><a href="aplikace3.html#cb223-10" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb223-11"><a href="aplikace3.html#cb223-11" tabindex="-1"></a></span>
<span id="cb223-12"><a href="aplikace3.html#cb223-12" tabindex="-1"></a>err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb223-13"><a href="aplikace3.html#cb223-13" tabindex="-1"></a>                     <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb223-14"><a href="aplikace3.html#cb223-14" tabindex="-1"></a>                     <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb223-15"><a href="aplikace3.html#cb223-15" tabindex="-1"></a>df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb223-16"><a href="aplikace3.html#cb223-16" tabindex="-1"></a>           <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb223-17"><a href="aplikace3.html#cb223-17" tabindex="-1"></a>           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-219">Tabulka 12.14: </span>Souhrnné výsledky cross-validace pro metodu SVM v kombinaci s RKHS na simulovaných datech. <span class="math inline">\(\widehat{Err}_{train}\)</span> značí odhad trénovací chybovosti a <span class="math inline">\(\widehat{Err}_{test}\)</span> testovací chybovosti.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad d\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{cross\_validace}\)</span></th>
<th align="left">Model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>linear</td>
<td align="right">31</td>
<td align="right">0.0267</td>
<td align="left">linear</td>
</tr>
<tr class="even">
<td>poly</td>
<td align="right">21</td>
<td align="right">0.0267</td>
<td align="left">polynomial</td>
</tr>
<tr class="odd">
<td>radial</td>
<td align="right">6</td>
<td align="right">0.0592</td>
<td align="left">radial</td>
</tr>
</tbody>
</table>
<p>Vidíme, že nejlépe vychází hodnota parametru <span class="math inline">\(d={}\)</span> 31 pro lineární jádro s hodnotou chybovosti spočtenou pomocí 10-násobné CV 0.0267, <span class="math inline">\(d={}\)</span> 21 pro polynomiální jádro s hodnotou chybovosti spočtenou pomocí 10-násobné CV 0.0267 a <span class="math inline">\(d={}\)</span> 6 pro radiální jádro s hodnotou chybovosti 0.0592.</p>
<p>Jelikož již máme nalezeny optimální hodnoty hyperparametrů, můžeme zkounstruovat finální modely a určit jejich úspěšnost klasifikace na testovacích datech.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="aplikace3.html#cb224-1" tabindex="-1"></a><span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb224-2"><a href="aplikace3.html#cb224-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb224-3"><a href="aplikace3.html#cb224-3" tabindex="-1"></a><span class="co"># pridame i testovaci data</span></span>
<span id="cb224-4"><a href="aplikace3.html#cb224-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="aplikace3.html#cb225-1" tabindex="-1"></a><span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb225-2"><a href="aplikace3.html#cb225-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - linear&#39;</span>, </span>
<span id="cb225-3"><a href="aplikace3.html#cb225-3" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - RKHS - linear&#39;</span>, </span>
<span id="cb225-4"><a href="aplikace3.html#cb225-4" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - RKHS - linear&#39;</span>), </span>
<span id="cb225-5"><a href="aplikace3.html#cb225-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb225-6"><a href="aplikace3.html#cb225-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb225-7"><a href="aplikace3.html#cb225-7" tabindex="-1"></a></span>
<span id="cb225-8"><a href="aplikace3.html#cb225-8" tabindex="-1"></a><span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb225-9"><a href="aplikace3.html#cb225-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb225-10"><a href="aplikace3.html#cb225-10" tabindex="-1"></a>  <span class="co"># spocitame matici K</span></span>
<span id="cb225-11"><a href="aplikace3.html#cb225-11" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb225-12"><a href="aplikace3.html#cb225-12" tabindex="-1"></a>  </span>
<span id="cb225-13"><a href="aplikace3.html#cb225-13" tabindex="-1"></a>  <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb225-14"><a href="aplikace3.html#cb225-14" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb225-15"><a href="aplikace3.html#cb225-15" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb225-16"><a href="aplikace3.html#cb225-16" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb225-17"><a href="aplikace3.html#cb225-17" tabindex="-1"></a>  <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb225-18"><a href="aplikace3.html#cb225-18" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb225-19"><a href="aplikace3.html#cb225-19" tabindex="-1"></a>                       <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb225-20"><a href="aplikace3.html#cb225-20" tabindex="-1"></a>  </span>
<span id="cb225-21"><a href="aplikace3.html#cb225-21" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb225-22"><a href="aplikace3.html#cb225-22" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb225-23"><a href="aplikace3.html#cb225-23" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb225-24"><a href="aplikace3.html#cb225-24" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb225-25"><a href="aplikace3.html#cb225-25" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb225-26"><a href="aplikace3.html#cb225-26" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb225-27"><a href="aplikace3.html#cb225-27" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb225-28"><a href="aplikace3.html#cb225-28" tabindex="-1"></a>                    <span class="at">epsilon =</span> eps,                   </span>
<span id="cb225-29"><a href="aplikace3.html#cb225-29" tabindex="-1"></a>                    <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb225-30"><a href="aplikace3.html#cb225-30" tabindex="-1"></a>                    <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb225-31"><a href="aplikace3.html#cb225-31" tabindex="-1"></a>                    <span class="at">cost =</span> C)</span>
<span id="cb225-32"><a href="aplikace3.html#cb225-32" tabindex="-1"></a>    <span class="co"># urceni alpha</span></span>
<span id="cb225-33"><a href="aplikace3.html#cb225-33" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb225-34"><a href="aplikace3.html#cb225-34" tabindex="-1"></a>  }</span>
<span id="cb225-35"><a href="aplikace3.html#cb225-35" tabindex="-1"></a>  <span class="co"># d</span></span>
<span id="cb225-36"><a href="aplikace3.html#cb225-36" tabindex="-1"></a>  d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb225-37"><a href="aplikace3.html#cb225-37" tabindex="-1"></a>  </span>
<span id="cb225-38"><a href="aplikace3.html#cb225-38" tabindex="-1"></a>  <span class="co"># urceni vektoru lambda</span></span>
<span id="cb225-39"><a href="aplikace3.html#cb225-39" tabindex="-1"></a>  Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb225-40"><a href="aplikace3.html#cb225-40" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb225-41"><a href="aplikace3.html#cb225-41" tabindex="-1"></a>                        <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb225-42"><a href="aplikace3.html#cb225-42" tabindex="-1"></a>  </span>
<span id="cb225-43"><a href="aplikace3.html#cb225-43" tabindex="-1"></a>  <span class="co"># vypocet reprezentace</span></span>
<span id="cb225-44"><a href="aplikace3.html#cb225-44" tabindex="-1"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb225-45"><a href="aplikace3.html#cb225-45" tabindex="-1"></a>    Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb225-46"><a href="aplikace3.html#cb225-46" tabindex="-1"></a>  }</span>
<span id="cb225-47"><a href="aplikace3.html#cb225-47" tabindex="-1"></a>  </span>
<span id="cb225-48"><a href="aplikace3.html#cb225-48" tabindex="-1"></a>  <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb225-49"><a href="aplikace3.html#cb225-49" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb225-50"><a href="aplikace3.html#cb225-50" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb225-51"><a href="aplikace3.html#cb225-51" tabindex="-1"></a></span>
<span id="cb225-52"><a href="aplikace3.html#cb225-52" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb225-53"><a href="aplikace3.html#cb225-53" tabindex="-1"></a></span>
<span id="cb225-54"><a href="aplikace3.html#cb225-54" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb225-55"><a href="aplikace3.html#cb225-55" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb225-56"><a href="aplikace3.html#cb225-56" tabindex="-1"></a>  </span>
<span id="cb225-57"><a href="aplikace3.html#cb225-57" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb225-58"><a href="aplikace3.html#cb225-58" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb225-59"><a href="aplikace3.html#cb225-59" tabindex="-1"></a>  </span>
<span id="cb225-60"><a href="aplikace3.html#cb225-60" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb225-61"><a href="aplikace3.html#cb225-61" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb225-62"><a href="aplikace3.html#cb225-62" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb225-63"><a href="aplikace3.html#cb225-63" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb225-64"><a href="aplikace3.html#cb225-64" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type,</span>
<span id="cb225-65"><a href="aplikace3.html#cb225-65" tabindex="-1"></a>                      <span class="at">epsilon =</span> eps,                   </span>
<span id="cb225-66"><a href="aplikace3.html#cb225-66" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb225-67"><a href="aplikace3.html#cb225-67" tabindex="-1"></a>                      <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb225-68"><a href="aplikace3.html#cb225-68" tabindex="-1"></a>                      <span class="at">cost =</span> C)</span>
<span id="cb225-69"><a href="aplikace3.html#cb225-69" tabindex="-1"></a>  </span>
<span id="cb225-70"><a href="aplikace3.html#cb225-70" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb225-71"><a href="aplikace3.html#cb225-71" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb225-72"><a href="aplikace3.html#cb225-72" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb225-73"><a href="aplikace3.html#cb225-73" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb225-74"><a href="aplikace3.html#cb225-74" tabindex="-1"></a>    </span>
<span id="cb225-75"><a href="aplikace3.html#cb225-75" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb225-76"><a href="aplikace3.html#cb225-76" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb225-77"><a href="aplikace3.html#cb225-77" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb225-78"><a href="aplikace3.html#cb225-78" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb225-79"><a href="aplikace3.html#cb225-79" tabindex="-1"></a>  </span>
<span id="cb225-80"><a href="aplikace3.html#cb225-80" tabindex="-1"></a>  <span class="co"># ulozeni vysledku</span></span>
<span id="cb225-81"><a href="aplikace3.html#cb225-81" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb225-82"><a href="aplikace3.html#cb225-82" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-222">Tabulka 12.15: </span>Souhrnné výsledky metody SVM v kombinaci s RKHS na simulovaných datech. <span class="math inline">\(\widehat{Err}_{train}\)</span> značí odhad trénovací chybovosti a <span class="math inline">\(\widehat{Err}_{test}\)</span> testovací chybovosti.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS - linear</td>
<td align="center">0.00</td>
<td align="center">0.0462</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - linear</td>
<td align="center">0.00</td>
<td align="center">0.0308</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - linear</td>
<td align="center">0.02</td>
<td align="center">0.1231</td>
</tr>
</tbody>
</table>
<p>Chybovost metody SVM v kombinaci s projekcí na Reproducing Kernel Hilbert Space je tedy na trénovacích datech rovna 0 % pro lineární jádro, 0 % pro polynomiální jádro a 2 % pro gaussovské jádro.
Na testovacích datech je potom chybovost metody 4.62 % pro lineární jádro, 3.08 % pro polynomiální jádro a 12.31 % pro radiální jádro.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="aplikace3.html#cb226-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
</div>
</div>
<div id="tabulka-výsledků-14" class="section level2 hasAnchor" number="12.6">
<h2><span class="header-section-number">12.6</span> Tabulka výsledků<a href="aplikace3.html#tabulka-výsledků-14" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Z tabulky níže si všimněme zejména dvou podstatných věcí. Tou první je, že metody klasifikují data podstatně lépe než v situaci původních nederivovaných dat. U některých metod je zlepšení i v řádech desítek procent. Druhou podstatnou věcí je fakt, že nyní není takový výrazný rozdíl mezi výsledky jednotlivých metod.</p>
<table>
<caption><span id="tab:unnamed-chunk-224">Tabulka 12.16: </span>Souhrnné výsledky použitých metod na simulovaných datech. <span class="math inline">\(\widehat{Err}_{train}\)</span> značí odhad trénovací chybovosti a <span class="math inline">\(\widehat{Err}_{test}\)</span> testovací chybovosti.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">KNN</td>
<td align="center">0.0133</td>
<td align="center">0.0769</td>
</tr>
<tr class="even">
<td align="left">LDA</td>
<td align="center">0.0400</td>
<td align="center">0.0923</td>
</tr>
<tr class="odd">
<td align="left">QDA</td>
<td align="center">0.0067</td>
<td align="center">0.0154</td>
</tr>
<tr class="even">
<td align="left">LR functional</td>
<td align="center">0.0000</td>
<td align="center">0.0769</td>
</tr>
<tr class="odd">
<td align="left">LR score</td>
<td align="center">0.0067</td>
<td align="center">0.0462</td>
</tr>
<tr class="even">
<td align="left">Tree - diskr.</td>
<td align="center">0.0067</td>
<td align="center">0.0154</td>
</tr>
<tr class="odd">
<td align="left">Tree - score</td>
<td align="center">0.0067</td>
<td align="center">0.0615</td>
</tr>
<tr class="even">
<td align="left">Tree - Bbasis</td>
<td align="center">0.0067</td>
<td align="center">0.0154</td>
</tr>
<tr class="odd">
<td align="left">RForest - diskr</td>
<td align="center">0.0000</td>
<td align="center">0.0462</td>
</tr>
<tr class="even">
<td align="left">RForest - score</td>
<td align="center">0.0067</td>
<td align="center">0.0462</td>
</tr>
<tr class="odd">
<td align="left">RForest - Bbasis</td>
<td align="center">0.0000</td>
<td align="center">0.0308</td>
</tr>
<tr class="even">
<td align="left">SVM linear - diskr</td>
<td align="center">0.0067</td>
<td align="center">0.0154</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - diskr</td>
<td align="center">0.0067</td>
<td align="center">0.0615</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - diskr</td>
<td align="center">0.0067</td>
<td align="center">0.0154</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - PCA</td>
<td align="center">0.0067</td>
<td align="center">0.0462</td>
</tr>
<tr class="even">
<td align="left">SVM poly - PCA</td>
<td align="center">0.0067</td>
<td align="center">0.0154</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - PCA</td>
<td align="center">0.0067</td>
<td align="center">0.0308</td>
</tr>
<tr class="even">
<td align="left">SVM linear - Bbasis</td>
<td align="center">0.0067</td>
<td align="center">0.0769</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - Bbasis</td>
<td align="center">0.0067</td>
<td align="center">0.0769</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - Bbasis</td>
<td align="center">0.0067</td>
<td align="center">0.0923</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - projection</td>
<td align="center">0.0200</td>
<td align="center">0.0615</td>
</tr>
<tr class="even">
<td align="left">SVM poly - projection</td>
<td align="center">0.0267</td>
<td align="center">0.0615</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - projection</td>
<td align="center">0.0933</td>
<td align="center">0.1077</td>
</tr>
<tr class="even">
<td align="left">SVM linear - RKHS - radial</td>
<td align="center">0.0000</td>
<td align="center">0.0308</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - RKHS - radial</td>
<td align="center">0.0000</td>
<td align="center">0.0769</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - RKHS - radial</td>
<td align="center">0.0000</td>
<td align="center">0.0308</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - RKHS - poly</td>
<td align="center">0.0000</td>
<td align="center">0.0308</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - poly</td>
<td align="center">0.0000</td>
<td align="center">0.0154</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - poly</td>
<td align="center">0.0200</td>
<td align="center">0.0308</td>
</tr>
<tr class="even">
<td align="left">SVM linear - RKHS - linear</td>
<td align="center">0.0000</td>
<td align="center">0.0462</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - RKHS - linear</td>
<td align="center">0.0000</td>
<td align="center">0.0308</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - RKHS - linear</td>
<td align="center">0.0200</td>
<td align="center">0.1231</td>
</tr>
</tbody>
</table>
</div>
<div id="simstudyA3" class="section level2 hasAnchor" number="12.7">
<h2><span class="header-section-number">12.7</span> Simulační studie<a href="aplikace3.html#simstudyA3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>V celé předchozí části jsme se zabývali souborem funkcí ze dvou klasifikačních tříd, který jsme následně náhodně rozdělili na testovací a trénovací část.
Poté jsme jednotlivé klasifikátory získané pomocí uvažovaných metod ohodnotili na základě testovací a trénovací chybovosti.</p>
<p>Jelikož se rozdělení dat na dvě části mohou při každém zopakování výrazně lišit, budou se i chybovosti jednotlivých klasifikačních algoritmů výrazně lišit.
Proto dělat jakékoli závěry o metodách a porovnávat je mezi sebou může být na základě jednoho vygenerovaného trénovacího datového souboru velmi zavádějící.</p>
<p>Z tohoto důvodu se v této části zaměříme na opakování celého předchozího postupu pro různá rozdělení.
Výsledky si budeme ukládat do tabulky a nakonec spočítáme průměrné charakteristiky modelů přes jednotlivá opakování.
Aby byly naše závěry dostatečně obecné, zvolíme počet opakování <span class="math inline">\(n_{sim} = 100\)</span>.</p>
<div id="simulace-pro-nederivovaná-data" class="section level3 hasAnchor" number="12.7.1">
<h3><span class="header-section-number">12.7.1</span> Simulace pro nederivovaná data<a href="aplikace3.html#simulace-pro-nederivovaná-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Nejprve se podívejme na simulaci původních, tedy nederivovaných, dat.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="aplikace3.html#cb227-1" tabindex="-1"></a><span class="co"># nastaveni generatoru pseudonahodnych cisel</span></span>
<span id="cb227-2"><a href="aplikace3.html#cb227-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb227-3"><a href="aplikace3.html#cb227-3" tabindex="-1"></a></span>
<span id="cb227-4"><a href="aplikace3.html#cb227-4" tabindex="-1"></a><span class="co"># pocet simulaci</span></span>
<span id="cb227-5"><a href="aplikace3.html#cb227-5" tabindex="-1"></a>n.sim <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb227-6"><a href="aplikace3.html#cb227-6" tabindex="-1"></a></span>
<span id="cb227-7"><a href="aplikace3.html#cb227-7" tabindex="-1"></a><span class="do">## list, do ktereho budeme ukladat hodnoty chybovosti</span></span>
<span id="cb227-8"><a href="aplikace3.html#cb227-8" tabindex="-1"></a><span class="co"># ve sloupcich budou metody</span></span>
<span id="cb227-9"><a href="aplikace3.html#cb227-9" tabindex="-1"></a><span class="co"># v radcich budou jednotliva opakovani</span></span>
<span id="cb227-10"><a href="aplikace3.html#cb227-10" tabindex="-1"></a><span class="co"># list ma dve polozky ... train a test</span></span>
<span id="cb227-11"><a href="aplikace3.html#cb227-11" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;KNN&#39;</span>, <span class="st">&#39;LDA&#39;</span>, <span class="st">&#39;QDA&#39;</span>, <span class="st">&#39;LR_functional&#39;</span>, <span class="st">&#39;LR_score&#39;</span>, <span class="st">&#39;Tree_discr&#39;</span>,</span>
<span id="cb227-12"><a href="aplikace3.html#cb227-12" tabindex="-1"></a>             <span class="st">&#39;Tree_score&#39;</span>, <span class="st">&#39;Tree_Bbasis&#39;</span>, <span class="st">&#39;RF_discr&#39;</span>, <span class="st">&#39;RF_score&#39;</span>, <span class="st">&#39;RF_Bbasis&#39;</span>, </span>
<span id="cb227-13"><a href="aplikace3.html#cb227-13" tabindex="-1"></a>             <span class="st">&#39;SVM linear - diskr&#39;</span>, <span class="st">&#39;SVM poly - diskr&#39;</span>, <span class="st">&#39;SVM rbf - diskr&#39;</span>, </span>
<span id="cb227-14"><a href="aplikace3.html#cb227-14" tabindex="-1"></a>             <span class="st">&#39;SVM linear - PCA&#39;</span>, <span class="st">&#39;SVM poly - PCA&#39;</span>, <span class="st">&#39;SVM rbf - PCA&#39;</span>, </span>
<span id="cb227-15"><a href="aplikace3.html#cb227-15" tabindex="-1"></a>             <span class="st">&#39;SVM linear - Bbasis&#39;</span>, <span class="st">&#39;SVM poly - Bbasis&#39;</span>, <span class="st">&#39;SVM rbf - Bbasis&#39;</span>,</span>
<span id="cb227-16"><a href="aplikace3.html#cb227-16" tabindex="-1"></a>             <span class="st">&#39;SVM linear - projection&#39;</span>, <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb227-17"><a href="aplikace3.html#cb227-17" tabindex="-1"></a>             <span class="st">&#39;SVM rbf - projection&#39;</span>, <span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, </span>
<span id="cb227-18"><a href="aplikace3.html#cb227-18" tabindex="-1"></a>             <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>, </span>
<span id="cb227-19"><a href="aplikace3.html#cb227-19" tabindex="-1"></a>             <span class="st">&#39;SVM linear - RKHS - poly&#39;</span>, <span class="st">&#39;SVM poly - RKHS - poly&#39;</span>, </span>
<span id="cb227-20"><a href="aplikace3.html#cb227-20" tabindex="-1"></a>             <span class="st">&#39;SVM rbf - RKHS - poly&#39;</span>, <span class="st">&#39;SVM linear - RKHS - linear&#39;</span>, </span>
<span id="cb227-21"><a href="aplikace3.html#cb227-21" tabindex="-1"></a>             <span class="st">&#39;SVM poly - RKHS - linear&#39;</span>, <span class="st">&#39;SVM rbf - RKHS - linear&#39;</span>)</span>
<span id="cb227-22"><a href="aplikace3.html#cb227-22" tabindex="-1"></a></span>
<span id="cb227-23"><a href="aplikace3.html#cb227-23" tabindex="-1"></a>SIMULACE <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">train =</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(methods), </span>
<span id="cb227-24"><a href="aplikace3.html#cb227-24" tabindex="-1"></a>                                             <span class="at">nrow =</span> n.sim,</span>
<span id="cb227-25"><a href="aplikace3.html#cb227-25" tabindex="-1"></a>                                             <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n.sim, methods))), </span>
<span id="cb227-26"><a href="aplikace3.html#cb227-26" tabindex="-1"></a>                 <span class="at">test =</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(methods), </span>
<span id="cb227-27"><a href="aplikace3.html#cb227-27" tabindex="-1"></a>                                             <span class="at">nrow =</span> n.sim,</span>
<span id="cb227-28"><a href="aplikace3.html#cb227-28" tabindex="-1"></a>                                             <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n.sim, methods))))</span>
<span id="cb227-29"><a href="aplikace3.html#cb227-29" tabindex="-1"></a></span>
<span id="cb227-30"><a href="aplikace3.html#cb227-30" tabindex="-1"></a><span class="co"># objekt na ulozeni optimalnich hodnot hyperparametru, ktere se urcuji pomoci CV</span></span>
<span id="cb227-31"><a href="aplikace3.html#cb227-31" tabindex="-1"></a>CV_RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">KNN_K =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n.sim), </span>
<span id="cb227-32"><a href="aplikace3.html#cb227-32" tabindex="-1"></a>                         <span class="at">nharm =</span> <span class="cn">NA</span>, </span>
<span id="cb227-33"><a href="aplikace3.html#cb227-33" tabindex="-1"></a>                         <span class="at">LR_func_n_basis =</span> <span class="cn">NA</span>,</span>
<span id="cb227-34"><a href="aplikace3.html#cb227-34" tabindex="-1"></a>                         <span class="at">SVM_d_Linear =</span> <span class="cn">NA</span>,</span>
<span id="cb227-35"><a href="aplikace3.html#cb227-35" tabindex="-1"></a>                         <span class="at">SVM_d_Poly =</span> <span class="cn">NA</span>,</span>
<span id="cb227-36"><a href="aplikace3.html#cb227-36" tabindex="-1"></a>                         <span class="at">SVM_d_Radial =</span> <span class="cn">NA</span>, </span>
<span id="cb227-37"><a href="aplikace3.html#cb227-37" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_gamma1 =</span> <span class="cn">NA</span>,</span>
<span id="cb227-38"><a href="aplikace3.html#cb227-38" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_gamma2 =</span> <span class="cn">NA</span>,</span>
<span id="cb227-39"><a href="aplikace3.html#cb227-39" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_gamma3 =</span> <span class="cn">NA</span>,</span>
<span id="cb227-40"><a href="aplikace3.html#cb227-40" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_d1 =</span> <span class="cn">NA</span>,</span>
<span id="cb227-41"><a href="aplikace3.html#cb227-41" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_d2 =</span> <span class="cn">NA</span>,</span>
<span id="cb227-42"><a href="aplikace3.html#cb227-42" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_d3 =</span> <span class="cn">NA</span>,</span>
<span id="cb227-43"><a href="aplikace3.html#cb227-43" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_p1 =</span> <span class="cn">NA</span>,</span>
<span id="cb227-44"><a href="aplikace3.html#cb227-44" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_p2 =</span> <span class="cn">NA</span>,</span>
<span id="cb227-45"><a href="aplikace3.html#cb227-45" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_p3 =</span> <span class="cn">NA</span>,</span>
<span id="cb227-46"><a href="aplikace3.html#cb227-46" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_d1 =</span> <span class="cn">NA</span>,</span>
<span id="cb227-47"><a href="aplikace3.html#cb227-47" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_d2 =</span> <span class="cn">NA</span>,</span>
<span id="cb227-48"><a href="aplikace3.html#cb227-48" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_d3 =</span> <span class="cn">NA</span>,</span>
<span id="cb227-49"><a href="aplikace3.html#cb227-49" tabindex="-1"></a>                         <span class="at">SVM_RKHS_linear_d1 =</span> <span class="cn">NA</span>,</span>
<span id="cb227-50"><a href="aplikace3.html#cb227-50" tabindex="-1"></a>                         <span class="at">SVM_RKHS_linear_d2 =</span> <span class="cn">NA</span>,</span>
<span id="cb227-51"><a href="aplikace3.html#cb227-51" tabindex="-1"></a>                         <span class="at">SVM_RKHS_linear_d3 =</span> <span class="cn">NA</span>)</span></code></pre></div>
</details>
<p>Nyní zopakujeme celou předchozí část 100-krát a hodnoty chybovostí si budeme ukládat to listu <code>SIMULACE</code>.
Do datové tabulky <code>CV_RESULTS</code> si potom budeme ukládat hodnoty optimálních hyperparametrů – pro metodu <span class="math inline">\(K\)</span> nejbližších sousedů a pro SVM hodnotu dimenze <span class="math inline">\(d\)</span> v případě projekce na B-splinovou bázi. Také uložíme všechny hodnoty hyperparametrů pro metodu SVM + RKHS.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="aplikace3.html#cb228-1" tabindex="-1"></a><span class="co"># nastaveni generatoru pseudonahodnych cisel</span></span>
<span id="cb228-2"><a href="aplikace3.html#cb228-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb228-3"><a href="aplikace3.html#cb228-3" tabindex="-1"></a></span>
<span id="cb228-4"><a href="aplikace3.html#cb228-4" tabindex="-1"></a><span class="do">## SIMULACE</span></span>
<span id="cb228-5"><a href="aplikace3.html#cb228-5" tabindex="-1"></a></span>
<span id="cb228-6"><a href="aplikace3.html#cb228-6" tabindex="-1"></a><span class="cf">for</span>(sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.sim) {</span>
<span id="cb228-7"><a href="aplikace3.html#cb228-7" tabindex="-1"></a>  <span class="co"># rozdeleni na testovaci a trenovaci cast</span></span>
<span id="cb228-8"><a href="aplikace3.html#cb228-8" tabindex="-1"></a>  split <span class="ot">&lt;-</span> <span class="fu">sample.split</span>(XXfd<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb228-9"><a href="aplikace3.html#cb228-9" tabindex="-1"></a>  </span>
<span id="cb228-10"><a href="aplikace3.html#cb228-10" tabindex="-1"></a>  <span class="co"># vytvoreni vektoru 0 a 1, 0 pro &lt; 20 a 1 pro &gt; 20 </span></span>
<span id="cb228-11"><a href="aplikace3.html#cb228-11" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(labels <span class="sc">==</span> <span class="st">&#39;large&#39;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb228-12"><a href="aplikace3.html#cb228-12" tabindex="-1"></a>  </span>
<span id="cb228-13"><a href="aplikace3.html#cb228-13" tabindex="-1"></a>  X.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb228-14"><a href="aplikace3.html#cb228-14" tabindex="-1"></a>  X.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb228-15"><a href="aplikace3.html#cb228-15" tabindex="-1"></a>  </span>
<span id="cb228-16"><a href="aplikace3.html#cb228-16" tabindex="-1"></a>  Y.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb228-17"><a href="aplikace3.html#cb228-17" tabindex="-1"></a>  Y.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb228-18"><a href="aplikace3.html#cb228-18" tabindex="-1"></a>  </span>
<span id="cb228-19"><a href="aplikace3.html#cb228-19" tabindex="-1"></a>  x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb228-20"><a href="aplikace3.html#cb228-20" tabindex="-1"></a>  y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.train))</span>
<span id="cb228-21"><a href="aplikace3.html#cb228-21" tabindex="-1"></a>  </span>
<span id="cb228-22"><a href="aplikace3.html#cb228-22" tabindex="-1"></a>  <span class="do">## 1) K nejbližších sousedů</span></span>
<span id="cb228-23"><a href="aplikace3.html#cb228-23" tabindex="-1"></a>  </span>
<span id="cb228-24"><a href="aplikace3.html#cb228-24" tabindex="-1"></a>  k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb228-25"><a href="aplikace3.html#cb228-25" tabindex="-1"></a>  neighbours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="co"># pocet sousedu </span></span>
<span id="cb228-26"><a href="aplikace3.html#cb228-26" tabindex="-1"></a>  </span>
<span id="cb228-27"><a href="aplikace3.html#cb228-27" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb228-28"><a href="aplikace3.html#cb228-28" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb228-29"><a href="aplikace3.html#cb228-29" tabindex="-1"></a>  </span>
<span id="cb228-30"><a href="aplikace3.html#cb228-30" tabindex="-1"></a>  <span class="co"># kontrola, ze mame opravdu k = k_cv</span></span>
<span id="cb228-31"><a href="aplikace3.html#cb228-31" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">length</span>(folds) <span class="sc">!=</span> k_cv) {</span>
<span id="cb228-32"><a href="aplikace3.html#cb228-32" tabindex="-1"></a>    folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb228-33"><a href="aplikace3.html#cb228-33" tabindex="-1"></a>  }</span>
<span id="cb228-34"><a href="aplikace3.html#cb228-34" tabindex="-1"></a>  </span>
<span id="cb228-35"><a href="aplikace3.html#cb228-35" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(neighbours), <span class="at">ncol =</span> k_cv)</span>
<span id="cb228-36"><a href="aplikace3.html#cb228-36" tabindex="-1"></a>  </span>
<span id="cb228-37"><a href="aplikace3.html#cb228-37" tabindex="-1"></a>  <span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb228-38"><a href="aplikace3.html#cb228-38" tabindex="-1"></a>    <span class="co"># definujeme danou indexovou mnozinu</span></span>
<span id="cb228-39"><a href="aplikace3.html#cb228-39" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb228-40"><a href="aplikace3.html#cb228-40" tabindex="-1"></a>      </span>
<span id="cb228-41"><a href="aplikace3.html#cb228-41" tabindex="-1"></a>    x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb228-42"><a href="aplikace3.html#cb228-42" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb228-43"><a href="aplikace3.html#cb228-43" tabindex="-1"></a>    y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb228-44"><a href="aplikace3.html#cb228-44" tabindex="-1"></a>      <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb228-45"><a href="aplikace3.html#cb228-45" tabindex="-1"></a>    </span>
<span id="cb228-46"><a href="aplikace3.html#cb228-46" tabindex="-1"></a>    x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb228-47"><a href="aplikace3.html#cb228-47" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb228-48"><a href="aplikace3.html#cb228-48" tabindex="-1"></a>    y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb228-49"><a href="aplikace3.html#cb228-49" tabindex="-1"></a>      <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb228-50"><a href="aplikace3.html#cb228-50" tabindex="-1"></a>    </span>
<span id="cb228-51"><a href="aplikace3.html#cb228-51" tabindex="-1"></a>    <span class="co"># projdeme kazdou cast ... k-krat zopakujeme</span></span>
<span id="cb228-52"><a href="aplikace3.html#cb228-52" tabindex="-1"></a>    <span class="cf">for</span>(neighbour <span class="cf">in</span> neighbours) {</span>
<span id="cb228-53"><a href="aplikace3.html#cb228-53" tabindex="-1"></a>      <span class="co"># model pro konkretni volbu K</span></span>
<span id="cb228-54"><a href="aplikace3.html#cb228-54" tabindex="-1"></a>      neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train.cv, </span>
<span id="cb228-55"><a href="aplikace3.html#cb228-55" tabindex="-1"></a>                                <span class="at">fdataobj =</span> x.train.cv, </span>
<span id="cb228-56"><a href="aplikace3.html#cb228-56" tabindex="-1"></a>                                <span class="at">knn =</span> neighbour) </span>
<span id="cb228-57"><a href="aplikace3.html#cb228-57" tabindex="-1"></a>      <span class="co"># predikce na validacni casti</span></span>
<span id="cb228-58"><a href="aplikace3.html#cb228-58" tabindex="-1"></a>      model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb228-59"><a href="aplikace3.html#cb228-59" tabindex="-1"></a>                                      <span class="at">new.fdataobj =</span> x.test.cv)</span>
<span id="cb228-60"><a href="aplikace3.html#cb228-60" tabindex="-1"></a>      <span class="co"># presnost na validacni casti</span></span>
<span id="cb228-61"><a href="aplikace3.html#cb228-61" tabindex="-1"></a>      presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, model.neighb.predict) <span class="sc">|&gt;</span> </span>
<span id="cb228-62"><a href="aplikace3.html#cb228-62" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-63"><a href="aplikace3.html#cb228-63" tabindex="-1"></a>      </span>
<span id="cb228-64"><a href="aplikace3.html#cb228-64" tabindex="-1"></a>      <span class="co"># presnost vlozime na pozici pro dane K a fold</span></span>
<span id="cb228-65"><a href="aplikace3.html#cb228-65" tabindex="-1"></a>      CV.results[neighbour, index] <span class="ot">&lt;-</span> presnost</span>
<span id="cb228-66"><a href="aplikace3.html#cb228-66" tabindex="-1"></a>    }</span>
<span id="cb228-67"><a href="aplikace3.html#cb228-67" tabindex="-1"></a>  }</span>
<span id="cb228-68"><a href="aplikace3.html#cb228-68" tabindex="-1"></a>  </span>
<span id="cb228-69"><a href="aplikace3.html#cb228-69" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva K pres folds</span></span>
<span id="cb228-70"><a href="aplikace3.html#cb228-70" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb228-71"><a href="aplikace3.html#cb228-71" tabindex="-1"></a>  K.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(CV.results)</span>
<span id="cb228-72"><a href="aplikace3.html#cb228-72" tabindex="-1"></a>  CV_RESULTS<span class="sc">$</span>KNN_K[sim] <span class="ot">&lt;-</span> K.opt</span>
<span id="cb228-73"><a href="aplikace3.html#cb228-73" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb228-74"><a href="aplikace3.html#cb228-74" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">K =</span> neighbours, <span class="at">CV =</span> CV.results)</span>
<span id="cb228-75"><a href="aplikace3.html#cb228-75" tabindex="-1"></a>  </span>
<span id="cb228-76"><a href="aplikace3.html#cb228-76" tabindex="-1"></a>  neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, <span class="at">fdataobj =</span> x.train, <span class="at">knn =</span> K.opt)</span>
<span id="cb228-77"><a href="aplikace3.html#cb228-77" tabindex="-1"></a>  </span>
<span id="cb228-78"><a href="aplikace3.html#cb228-78" tabindex="-1"></a>  <span class="co"># predikce</span></span>
<span id="cb228-79"><a href="aplikace3.html#cb228-79" tabindex="-1"></a>  model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb228-80"><a href="aplikace3.html#cb228-80" tabindex="-1"></a>                                  <span class="at">new.fdataobj =</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb228-81"><a href="aplikace3.html#cb228-81" tabindex="-1"></a>  </span>
<span id="cb228-82"><a href="aplikace3.html#cb228-82" tabindex="-1"></a>  presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.test)), model.neighb.predict) <span class="sc">|&gt;</span></span>
<span id="cb228-83"><a href="aplikace3.html#cb228-83" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span></span>
<span id="cb228-84"><a href="aplikace3.html#cb228-84" tabindex="-1"></a>    <span class="fu">diag</span>() <span class="sc">|&gt;</span></span>
<span id="cb228-85"><a href="aplikace3.html#cb228-85" tabindex="-1"></a>    <span class="fu">sum</span>()</span>
<span id="cb228-86"><a href="aplikace3.html#cb228-86" tabindex="-1"></a>  </span>
<span id="cb228-87"><a href="aplikace3.html#cb228-87" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;KNN&#39;</span>, </span>
<span id="cb228-88"><a href="aplikace3.html#cb228-88" tabindex="-1"></a>                        <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> neighb.model<span class="sc">$</span>max.prob,</span>
<span id="cb228-89"><a href="aplikace3.html#cb228-89" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost)</span>
<span id="cb228-90"><a href="aplikace3.html#cb228-90" tabindex="-1"></a>  </span>
<span id="cb228-91"><a href="aplikace3.html#cb228-91" tabindex="-1"></a>  <span class="do">## 2) Lineární diskriminační analýza</span></span>
<span id="cb228-92"><a href="aplikace3.html#cb228-92" tabindex="-1"></a>  </span>
<span id="cb228-93"><a href="aplikace3.html#cb228-93" tabindex="-1"></a>  <span class="co"># analyza hlavnich komponent</span></span>
<span id="cb228-94"><a href="aplikace3.html#cb228-94" tabindex="-1"></a>  data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> <span class="dv">10</span>) <span class="co"># nharm - maximalni pocet HK</span></span>
<span id="cb228-95"><a href="aplikace3.html#cb228-95" tabindex="-1"></a>  nharm <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">cumsum</span>(data.PCA<span class="sc">$</span>varprop) <span class="sc">&gt;=</span> <span class="fl">0.9</span>)[<span class="dv">1</span>] <span class="co"># urceni p</span></span>
<span id="cb228-96"><a href="aplikace3.html#cb228-96" tabindex="-1"></a>  CV_RESULTS<span class="sc">$</span>nharm[sim] <span class="ot">&lt;-</span> nharm</span>
<span id="cb228-97"><a href="aplikace3.html#cb228-97" tabindex="-1"></a>  <span class="cf">if</span>(nharm <span class="sc">==</span> <span class="dv">1</span>) nharm <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb228-98"><a href="aplikace3.html#cb228-98" tabindex="-1"></a>  </span>
<span id="cb228-99"><a href="aplikace3.html#cb228-99" tabindex="-1"></a>  data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> nharm) </span>
<span id="cb228-100"><a href="aplikace3.html#cb228-100" tabindex="-1"></a>  data.PCA.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA<span class="sc">$</span>scores) <span class="co"># skore prvnich p HK</span></span>
<span id="cb228-101"><a href="aplikace3.html#cb228-101" tabindex="-1"></a>  data.PCA.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train) <span class="co"># prislusnost do trid</span></span>
<span id="cb228-102"><a href="aplikace3.html#cb228-102" tabindex="-1"></a>  </span>
<span id="cb228-103"><a href="aplikace3.html#cb228-103" tabindex="-1"></a>  <span class="co"># vypocet skoru testovacich funkci</span></span>
<span id="cb228-104"><a href="aplikace3.html#cb228-104" tabindex="-1"></a>  scores <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> nharm, <span class="at">nrow =</span> <span class="fu">length</span>(Y.test)) <span class="co"># prazdna matice </span></span>
<span id="cb228-105"><a href="aplikace3.html#cb228-105" tabindex="-1"></a>  </span>
<span id="cb228-106"><a href="aplikace3.html#cb228-106" tabindex="-1"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(scores)[<span class="dv">1</span>]) {</span>
<span id="cb228-107"><a href="aplikace3.html#cb228-107" tabindex="-1"></a>    xfd <span class="ot">=</span> X.test[k] <span class="sc">-</span> data.PCA<span class="sc">$</span>meanfd[<span class="dv">1</span>] <span class="co"># k-te pozorovani - prumerna funkce</span></span>
<span id="cb228-108"><a href="aplikace3.html#cb228-108" tabindex="-1"></a>    scores[k, ] <span class="ot">=</span> <span class="fu">inprod</span>(xfd, data.PCA<span class="sc">$</span>harmonics) </span>
<span id="cb228-109"><a href="aplikace3.html#cb228-109" tabindex="-1"></a>    <span class="co"># skalarni soucin rezidua a vlastnich funkci rho (funkcionalni hlavni komponenty)</span></span>
<span id="cb228-110"><a href="aplikace3.html#cb228-110" tabindex="-1"></a>  }</span>
<span id="cb228-111"><a href="aplikace3.html#cb228-111" tabindex="-1"></a>  </span>
<span id="cb228-112"><a href="aplikace3.html#cb228-112" tabindex="-1"></a>  data.PCA.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(scores)</span>
<span id="cb228-113"><a href="aplikace3.html#cb228-113" tabindex="-1"></a>  data.PCA.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb228-114"><a href="aplikace3.html#cb228-114" tabindex="-1"></a>  <span class="fu">colnames</span>(data.PCA.test) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data.PCA.train) </span>
<span id="cb228-115"><a href="aplikace3.html#cb228-115" tabindex="-1"></a>  </span>
<span id="cb228-116"><a href="aplikace3.html#cb228-116" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb228-117"><a href="aplikace3.html#cb228-117" tabindex="-1"></a>  clf.LDA <span class="ot">&lt;-</span> <span class="fu">lda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb228-118"><a href="aplikace3.html#cb228-118" tabindex="-1"></a>  </span>
<span id="cb228-119"><a href="aplikace3.html#cb228-119" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb228-120"><a href="aplikace3.html#cb228-120" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb228-121"><a href="aplikace3.html#cb228-121" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb228-122"><a href="aplikace3.html#cb228-122" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-123"><a href="aplikace3.html#cb228-123" tabindex="-1"></a>    </span>
<span id="cb228-124"><a href="aplikace3.html#cb228-124" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb228-125"><a href="aplikace3.html#cb228-125" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb228-126"><a href="aplikace3.html#cb228-126" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb228-127"><a href="aplikace3.html#cb228-127" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-128"><a href="aplikace3.html#cb228-128" tabindex="-1"></a>  </span>
<span id="cb228-129"><a href="aplikace3.html#cb228-129" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LDA&#39;</span>, </span>
<span id="cb228-130"><a href="aplikace3.html#cb228-130" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb228-131"><a href="aplikace3.html#cb228-131" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb228-132"><a href="aplikace3.html#cb228-132" tabindex="-1"></a>  </span>
<span id="cb228-133"><a href="aplikace3.html#cb228-133" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb228-134"><a href="aplikace3.html#cb228-134" tabindex="-1"></a>  </span>
<span id="cb228-135"><a href="aplikace3.html#cb228-135" tabindex="-1"></a>  <span class="do">## 3) Kvadratická diskriminační analýza</span></span>
<span id="cb228-136"><a href="aplikace3.html#cb228-136" tabindex="-1"></a>  </span>
<span id="cb228-137"><a href="aplikace3.html#cb228-137" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb228-138"><a href="aplikace3.html#cb228-138" tabindex="-1"></a>  clf.QDA <span class="ot">&lt;-</span> <span class="fu">qda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb228-139"><a href="aplikace3.html#cb228-139" tabindex="-1"></a>  </span>
<span id="cb228-140"><a href="aplikace3.html#cb228-140" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb228-141"><a href="aplikace3.html#cb228-141" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb228-142"><a href="aplikace3.html#cb228-142" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb228-143"><a href="aplikace3.html#cb228-143" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-144"><a href="aplikace3.html#cb228-144" tabindex="-1"></a>    </span>
<span id="cb228-145"><a href="aplikace3.html#cb228-145" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb228-146"><a href="aplikace3.html#cb228-146" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb228-147"><a href="aplikace3.html#cb228-147" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb228-148"><a href="aplikace3.html#cb228-148" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-149"><a href="aplikace3.html#cb228-149" tabindex="-1"></a>  </span>
<span id="cb228-150"><a href="aplikace3.html#cb228-150" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;QDA&#39;</span>, </span>
<span id="cb228-151"><a href="aplikace3.html#cb228-151" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb228-152"><a href="aplikace3.html#cb228-152" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb228-153"><a href="aplikace3.html#cb228-153" tabindex="-1"></a>  </span>
<span id="cb228-154"><a href="aplikace3.html#cb228-154" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb228-155"><a href="aplikace3.html#cb228-155" tabindex="-1"></a>  </span>
<span id="cb228-156"><a href="aplikace3.html#cb228-156" tabindex="-1"></a>  <span class="do">## 4) Logistická regrese</span></span>
<span id="cb228-157"><a href="aplikace3.html#cb228-157" tabindex="-1"></a>  <span class="do">### 4.1) Funkcionální logistická regrese</span></span>
<span id="cb228-158"><a href="aplikace3.html#cb228-158" tabindex="-1"></a>  </span>
<span id="cb228-159"><a href="aplikace3.html#cb228-159" tabindex="-1"></a>  <span class="co"># vytvorime vhodne objekty</span></span>
<span id="cb228-160"><a href="aplikace3.html#cb228-160" tabindex="-1"></a>  x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb228-161"><a href="aplikace3.html#cb228-161" tabindex="-1"></a>  y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Y.train)</span>
<span id="cb228-162"><a href="aplikace3.html#cb228-162" tabindex="-1"></a>  </span>
<span id="cb228-163"><a href="aplikace3.html#cb228-163" tabindex="-1"></a>  <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb228-164"><a href="aplikace3.html#cb228-164" tabindex="-1"></a>  tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb228-165"><a href="aplikace3.html#cb228-165" tabindex="-1"></a>  </span>
<span id="cb228-166"><a href="aplikace3.html#cb228-166" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb228-167"><a href="aplikace3.html#cb228-167" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb228-168"><a href="aplikace3.html#cb228-168" tabindex="-1"></a>  <span class="co"># B-spline baze </span></span>
<span id="cb228-169"><a href="aplikace3.html#cb228-169" tabindex="-1"></a>  nbasis.x <span class="ot">&lt;-</span> <span class="dv">7</span></span>
<span id="cb228-170"><a href="aplikace3.html#cb228-170" tabindex="-1"></a>  basis1 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), </span>
<span id="cb228-171"><a href="aplikace3.html#cb228-171" tabindex="-1"></a>                                 <span class="at">nbasis =</span> nbasis.x)</span>
<span id="cb228-172"><a href="aplikace3.html#cb228-172" tabindex="-1"></a>  </span>
<span id="cb228-173"><a href="aplikace3.html#cb228-173" tabindex="-1"></a>  <span class="do">### 10-fold cross-validation</span></span>
<span id="cb228-174"><a href="aplikace3.html#cb228-174" tabindex="-1"></a>  n.basis.max <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb228-175"><a href="aplikace3.html#cb228-175" tabindex="-1"></a>  n.basis <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span>n.basis.max</span>
<span id="cb228-176"><a href="aplikace3.html#cb228-176" tabindex="-1"></a>  k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb228-177"><a href="aplikace3.html#cb228-177" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb228-178"><a href="aplikace3.html#cb228-178" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb228-179"><a href="aplikace3.html#cb228-179" tabindex="-1"></a>  <span class="co"># kontrola, ze mame opravdu k = k_cv</span></span>
<span id="cb228-180"><a href="aplikace3.html#cb228-180" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">length</span>(folds) <span class="sc">!=</span> k_cv) {</span>
<span id="cb228-181"><a href="aplikace3.html#cb228-181" tabindex="-1"></a>    folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb228-182"><a href="aplikace3.html#cb228-182" tabindex="-1"></a>  }</span>
<span id="cb228-183"><a href="aplikace3.html#cb228-183" tabindex="-1"></a>  <span class="do">## prvky, ktere se behem cyklu nemeni</span></span>
<span id="cb228-184"><a href="aplikace3.html#cb228-184" tabindex="-1"></a>  <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb228-185"><a href="aplikace3.html#cb228-185" tabindex="-1"></a>  tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb228-186"><a href="aplikace3.html#cb228-186" tabindex="-1"></a>  rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(tt)</span>
<span id="cb228-187"><a href="aplikace3.html#cb228-187" tabindex="-1"></a>  <span class="co"># vztah</span></span>
<span id="cb228-188"><a href="aplikace3.html#cb228-188" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb228-189"><a href="aplikace3.html#cb228-189" tabindex="-1"></a>  <span class="co"># baze pro x</span></span>
<span id="cb228-190"><a href="aplikace3.html#cb228-190" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1)</span>
<span id="cb228-191"><a href="aplikace3.html#cb228-191" tabindex="-1"></a>  </span>
<span id="cb228-192"><a href="aplikace3.html#cb228-192" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(n.basis), <span class="at">ncol =</span> k_cv, </span>
<span id="cb228-193"><a href="aplikace3.html#cb228-193" tabindex="-1"></a>                       <span class="at">dimnames =</span> <span class="fu">list</span>(n.basis, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb228-194"><a href="aplikace3.html#cb228-194" tabindex="-1"></a>  </span>
<span id="cb228-195"><a href="aplikace3.html#cb228-195" tabindex="-1"></a>  <span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb228-196"><a href="aplikace3.html#cb228-196" tabindex="-1"></a>    <span class="co"># definujeme danou indexovou mnozinu</span></span>
<span id="cb228-197"><a href="aplikace3.html#cb228-197" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb228-198"><a href="aplikace3.html#cb228-198" tabindex="-1"></a>      </span>
<span id="cb228-199"><a href="aplikace3.html#cb228-199" tabindex="-1"></a>    x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb228-200"><a href="aplikace3.html#cb228-200" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb228-201"><a href="aplikace3.html#cb228-201" tabindex="-1"></a>    y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb228-202"><a href="aplikace3.html#cb228-202" tabindex="-1"></a>      <span class="fu">as.numeric</span>()</span>
<span id="cb228-203"><a href="aplikace3.html#cb228-203" tabindex="-1"></a>    </span>
<span id="cb228-204"><a href="aplikace3.html#cb228-204" tabindex="-1"></a>    x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb228-205"><a href="aplikace3.html#cb228-205" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb228-206"><a href="aplikace3.html#cb228-206" tabindex="-1"></a>    y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb228-207"><a href="aplikace3.html#cb228-207" tabindex="-1"></a>      <span class="fu">as.numeric</span>()</span>
<span id="cb228-208"><a href="aplikace3.html#cb228-208" tabindex="-1"></a>    </span>
<span id="cb228-209"><a href="aplikace3.html#cb228-209" tabindex="-1"></a>    dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train.cv) </span>
<span id="cb228-210"><a href="aplikace3.html#cb228-210" tabindex="-1"></a>    <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb228-211"><a href="aplikace3.html#cb228-211" tabindex="-1"></a>    </span>
<span id="cb228-212"><a href="aplikace3.html#cb228-212" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> n.basis) {</span>
<span id="cb228-213"><a href="aplikace3.html#cb228-213" tabindex="-1"></a>      <span class="co"># baze pro bety</span></span>
<span id="cb228-214"><a href="aplikace3.html#cb228-214" tabindex="-1"></a>      basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, <span class="at">nbasis =</span> i)</span>
<span id="cb228-215"><a href="aplikace3.html#cb228-215" tabindex="-1"></a>      </span>
<span id="cb228-216"><a href="aplikace3.html#cb228-216" tabindex="-1"></a>      basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb228-217"><a href="aplikace3.html#cb228-217" tabindex="-1"></a>      <span class="co"># vstupni data do modelu</span></span>
<span id="cb228-218"><a href="aplikace3.html#cb228-218" tabindex="-1"></a>      ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train.cv)</span>
<span id="cb228-219"><a href="aplikace3.html#cb228-219" tabindex="-1"></a>      <span class="co"># binomicky model ... model logisticke regrese</span></span>
<span id="cb228-220"><a href="aplikace3.html#cb228-220" tabindex="-1"></a>      model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb228-221"><a href="aplikace3.html#cb228-221" tabindex="-1"></a>                              <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb228-222"><a href="aplikace3.html#cb228-222" tabindex="-1"></a>      </span>
<span id="cb228-223"><a href="aplikace3.html#cb228-223" tabindex="-1"></a>      <span class="co"># presnost na validacni casti </span></span>
<span id="cb228-224"><a href="aplikace3.html#cb228-224" tabindex="-1"></a>      newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(y.test.cv), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb228-225"><a href="aplikace3.html#cb228-225" tabindex="-1"></a>      predictions.valid <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb228-226"><a href="aplikace3.html#cb228-226" tabindex="-1"></a>      predictions.valid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.valid <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb228-227"><a href="aplikace3.html#cb228-227" tabindex="-1"></a>      presnost.valid <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, predictions.valid<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb228-228"><a href="aplikace3.html#cb228-228" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-229"><a href="aplikace3.html#cb228-229" tabindex="-1"></a>      </span>
<span id="cb228-230"><a href="aplikace3.html#cb228-230" tabindex="-1"></a>      <span class="co"># vlozime do matice</span></span>
<span id="cb228-231"><a href="aplikace3.html#cb228-231" tabindex="-1"></a>      CV.results[<span class="fu">as.character</span>(i), <span class="fu">as.character</span>(index)] <span class="ot">&lt;-</span> presnost.valid</span>
<span id="cb228-232"><a href="aplikace3.html#cb228-232" tabindex="-1"></a>    } </span>
<span id="cb228-233"><a href="aplikace3.html#cb228-233" tabindex="-1"></a>  }</span>
<span id="cb228-234"><a href="aplikace3.html#cb228-234" tabindex="-1"></a>  </span>
<span id="cb228-235"><a href="aplikace3.html#cb228-235" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva n pres folds</span></span>
<span id="cb228-236"><a href="aplikace3.html#cb228-236" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb228-237"><a href="aplikace3.html#cb228-237" tabindex="-1"></a>  n.basis.opt <span class="ot">&lt;-</span> n.basis[<span class="fu">which.max</span>(CV.results)]</span>
<span id="cb228-238"><a href="aplikace3.html#cb228-238" tabindex="-1"></a>  CV_RESULTS<span class="sc">$</span>LR_func_n_basis[sim] <span class="ot">&lt;-</span> n.basis.opt</span>
<span id="cb228-239"><a href="aplikace3.html#cb228-239" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb228-240"><a href="aplikace3.html#cb228-240" tabindex="-1"></a>  </span>
<span id="cb228-241"><a href="aplikace3.html#cb228-241" tabindex="-1"></a>  <span class="co"># optimalni model</span></span>
<span id="cb228-242"><a href="aplikace3.html#cb228-242" tabindex="-1"></a>  basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> n.basis.opt)</span>
<span id="cb228-243"><a href="aplikace3.html#cb228-243" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb228-244"><a href="aplikace3.html#cb228-244" tabindex="-1"></a>  <span class="co"># baze pro x a bety</span></span>
<span id="cb228-245"><a href="aplikace3.html#cb228-245" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb228-246"><a href="aplikace3.html#cb228-246" tabindex="-1"></a>  basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb228-247"><a href="aplikace3.html#cb228-247" tabindex="-1"></a>  <span class="co"># vstupni data do modelu</span></span>
<span id="cb228-248"><a href="aplikace3.html#cb228-248" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb228-249"><a href="aplikace3.html#cb228-249" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb228-250"><a href="aplikace3.html#cb228-250" tabindex="-1"></a>  ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb228-251"><a href="aplikace3.html#cb228-251" tabindex="-1"></a>  <span class="co"># binomicky model ... model logisticke regrese</span></span>
<span id="cb228-252"><a href="aplikace3.html#cb228-252" tabindex="-1"></a>  model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb228-253"><a href="aplikace3.html#cb228-253" tabindex="-1"></a>                          <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb228-254"><a href="aplikace3.html#cb228-254" tabindex="-1"></a>  </span>
<span id="cb228-255"><a href="aplikace3.html#cb228-255" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb228-256"><a href="aplikace3.html#cb228-256" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> ldata)</span>
<span id="cb228-257"><a href="aplikace3.html#cb228-257" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb228-258"><a href="aplikace3.html#cb228-258" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb228-259"><a href="aplikace3.html#cb228-259" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-260"><a href="aplikace3.html#cb228-260" tabindex="-1"></a>    </span>
<span id="cb228-261"><a href="aplikace3.html#cb228-261" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb228-262"><a href="aplikace3.html#cb228-262" tabindex="-1"></a>  newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(Y.test), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb228-263"><a href="aplikace3.html#cb228-263" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb228-264"><a href="aplikace3.html#cb228-264" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb228-265"><a href="aplikace3.html#cb228-265" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb228-266"><a href="aplikace3.html#cb228-266" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-267"><a href="aplikace3.html#cb228-267" tabindex="-1"></a>  </span>
<span id="cb228-268"><a href="aplikace3.html#cb228-268" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR_functional&#39;</span>, </span>
<span id="cb228-269"><a href="aplikace3.html#cb228-269" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb228-270"><a href="aplikace3.html#cb228-270" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb228-271"><a href="aplikace3.html#cb228-271" tabindex="-1"></a>  </span>
<span id="cb228-272"><a href="aplikace3.html#cb228-272" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb228-273"><a href="aplikace3.html#cb228-273" tabindex="-1"></a>  </span>
<span id="cb228-274"><a href="aplikace3.html#cb228-274" tabindex="-1"></a>  <span class="do">### 4.2) Logistická regrese s analýzou hlavních komponent</span></span>
<span id="cb228-275"><a href="aplikace3.html#cb228-275" tabindex="-1"></a>  </span>
<span id="cb228-276"><a href="aplikace3.html#cb228-276" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb228-277"><a href="aplikace3.html#cb228-277" tabindex="-1"></a>  clf.LR <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span>  ., <span class="at">data =</span> data.PCA.train, <span class="at">family =</span> binomial)</span>
<span id="cb228-278"><a href="aplikace3.html#cb228-278" tabindex="-1"></a>  </span>
<span id="cb228-279"><a href="aplikace3.html#cb228-279" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb228-280"><a href="aplikace3.html#cb228-280" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.train, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb228-281"><a href="aplikace3.html#cb228-281" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb228-282"><a href="aplikace3.html#cb228-282" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb228-283"><a href="aplikace3.html#cb228-283" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-284"><a href="aplikace3.html#cb228-284" tabindex="-1"></a>    </span>
<span id="cb228-285"><a href="aplikace3.html#cb228-285" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb228-286"><a href="aplikace3.html#cb228-286" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.test, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb228-287"><a href="aplikace3.html#cb228-287" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb228-288"><a href="aplikace3.html#cb228-288" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb228-289"><a href="aplikace3.html#cb228-289" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-290"><a href="aplikace3.html#cb228-290" tabindex="-1"></a>  </span>
<span id="cb228-291"><a href="aplikace3.html#cb228-291" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR_score&#39;</span>, </span>
<span id="cb228-292"><a href="aplikace3.html#cb228-292" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb228-293"><a href="aplikace3.html#cb228-293" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb228-294"><a href="aplikace3.html#cb228-294" tabindex="-1"></a>  </span>
<span id="cb228-295"><a href="aplikace3.html#cb228-295" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb228-296"><a href="aplikace3.html#cb228-296" tabindex="-1"></a>  </span>
<span id="cb228-297"><a href="aplikace3.html#cb228-297" tabindex="-1"></a>  <span class="do">## 5) Rozhodovací stromy</span></span>
<span id="cb228-298"><a href="aplikace3.html#cb228-298" tabindex="-1"></a>  <span class="do">### 5.1) Diskretizace intervalu</span></span>
<span id="cb228-299"><a href="aplikace3.html#cb228-299" tabindex="-1"></a>  </span>
<span id="cb228-300"><a href="aplikace3.html#cb228-300" tabindex="-1"></a>  <span class="co"># posloupnost bodu, ve kterych funkce vyhodnotime</span></span>
<span id="cb228-301"><a href="aplikace3.html#cb228-301" tabindex="-1"></a>  t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(t), <span class="fu">max</span>(t), <span class="at">length =</span> <span class="dv">101</span>)</span>
<span id="cb228-302"><a href="aplikace3.html#cb228-302" tabindex="-1"></a>     </span>
<span id="cb228-303"><a href="aplikace3.html#cb228-303" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb228-304"><a href="aplikace3.html#cb228-304" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) <span class="co"># transpozice kvuli funkcim v radku</span></span>
<span id="cb228-305"><a href="aplikace3.html#cb228-305" tabindex="-1"></a>  grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb228-306"><a href="aplikace3.html#cb228-306" tabindex="-1"></a>  </span>
<span id="cb228-307"><a href="aplikace3.html#cb228-307" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb228-308"><a href="aplikace3.html#cb228-308" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb228-309"><a href="aplikace3.html#cb228-309" tabindex="-1"></a>  grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb228-310"><a href="aplikace3.html#cb228-310" tabindex="-1"></a>  </span>
<span id="cb228-311"><a href="aplikace3.html#cb228-311" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb228-312"><a href="aplikace3.html#cb228-312" tabindex="-1"></a>  clf.tree <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb228-313"><a href="aplikace3.html#cb228-313" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb228-314"><a href="aplikace3.html#cb228-314" tabindex="-1"></a>                   <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb228-315"><a href="aplikace3.html#cb228-315" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb228-316"><a href="aplikace3.html#cb228-316" tabindex="-1"></a>  </span>
<span id="cb228-317"><a href="aplikace3.html#cb228-317" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb228-318"><a href="aplikace3.html#cb228-318" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data)</span>
<span id="cb228-319"><a href="aplikace3.html#cb228-319" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb228-320"><a href="aplikace3.html#cb228-320" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-321"><a href="aplikace3.html#cb228-321" tabindex="-1"></a>    </span>
<span id="cb228-322"><a href="aplikace3.html#cb228-322" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb228-323"><a href="aplikace3.html#cb228-323" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb228-324"><a href="aplikace3.html#cb228-324" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb228-325"><a href="aplikace3.html#cb228-325" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-326"><a href="aplikace3.html#cb228-326" tabindex="-1"></a>  </span>
<span id="cb228-327"><a href="aplikace3.html#cb228-327" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree_discr&#39;</span>, </span>
<span id="cb228-328"><a href="aplikace3.html#cb228-328" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb228-329"><a href="aplikace3.html#cb228-329" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb228-330"><a href="aplikace3.html#cb228-330" tabindex="-1"></a>  </span>
<span id="cb228-331"><a href="aplikace3.html#cb228-331" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb228-332"><a href="aplikace3.html#cb228-332" tabindex="-1"></a>  </span>
<span id="cb228-333"><a href="aplikace3.html#cb228-333" tabindex="-1"></a>  <span class="do">### 5.2) Skóre hlavních komponent</span></span>
<span id="cb228-334"><a href="aplikace3.html#cb228-334" tabindex="-1"></a>  </span>
<span id="cb228-335"><a href="aplikace3.html#cb228-335" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb228-336"><a href="aplikace3.html#cb228-336" tabindex="-1"></a>  clf.tree.PCA <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb228-337"><a href="aplikace3.html#cb228-337" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb228-338"><a href="aplikace3.html#cb228-338" tabindex="-1"></a>                   <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb228-339"><a href="aplikace3.html#cb228-339" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb228-340"><a href="aplikace3.html#cb228-340" tabindex="-1"></a>  </span>
<span id="cb228-341"><a href="aplikace3.html#cb228-341" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb228-342"><a href="aplikace3.html#cb228-342" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb228-343"><a href="aplikace3.html#cb228-343" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb228-344"><a href="aplikace3.html#cb228-344" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-345"><a href="aplikace3.html#cb228-345" tabindex="-1"></a>    </span>
<span id="cb228-346"><a href="aplikace3.html#cb228-346" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb228-347"><a href="aplikace3.html#cb228-347" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb228-348"><a href="aplikace3.html#cb228-348" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb228-349"><a href="aplikace3.html#cb228-349" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-350"><a href="aplikace3.html#cb228-350" tabindex="-1"></a>  </span>
<span id="cb228-351"><a href="aplikace3.html#cb228-351" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree_score&#39;</span>, </span>
<span id="cb228-352"><a href="aplikace3.html#cb228-352" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb228-353"><a href="aplikace3.html#cb228-353" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb228-354"><a href="aplikace3.html#cb228-354" tabindex="-1"></a>  </span>
<span id="cb228-355"><a href="aplikace3.html#cb228-355" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb228-356"><a href="aplikace3.html#cb228-356" tabindex="-1"></a>  </span>
<span id="cb228-357"><a href="aplikace3.html#cb228-357" tabindex="-1"></a>  <span class="do">### 5.3) Bázové koeficienty</span></span>
<span id="cb228-358"><a href="aplikace3.html#cb228-358" tabindex="-1"></a>  </span>
<span id="cb228-359"><a href="aplikace3.html#cb228-359" tabindex="-1"></a>  <span class="co"># trenovaci dataset</span></span>
<span id="cb228-360"><a href="aplikace3.html#cb228-360" tabindex="-1"></a>  data.Bbasis.train <span class="ot">&lt;-</span> <span class="fu">t</span>(X.train<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb228-361"><a href="aplikace3.html#cb228-361" tabindex="-1"></a>  data.Bbasis.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb228-362"><a href="aplikace3.html#cb228-362" tabindex="-1"></a>  </span>
<span id="cb228-363"><a href="aplikace3.html#cb228-363" tabindex="-1"></a>  <span class="co"># testovaci dataset</span></span>
<span id="cb228-364"><a href="aplikace3.html#cb228-364" tabindex="-1"></a>  data.Bbasis.test <span class="ot">&lt;-</span> <span class="fu">t</span>(X.test<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb228-365"><a href="aplikace3.html#cb228-365" tabindex="-1"></a>  data.Bbasis.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb228-366"><a href="aplikace3.html#cb228-366" tabindex="-1"></a>  </span>
<span id="cb228-367"><a href="aplikace3.html#cb228-367" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb228-368"><a href="aplikace3.html#cb228-368" tabindex="-1"></a>  clf.tree.Bbasis <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb228-369"><a href="aplikace3.html#cb228-369" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb228-370"><a href="aplikace3.html#cb228-370" tabindex="-1"></a>                   <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb228-371"><a href="aplikace3.html#cb228-371" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb228-372"><a href="aplikace3.html#cb228-372" tabindex="-1"></a>  </span>
<span id="cb228-373"><a href="aplikace3.html#cb228-373" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb228-374"><a href="aplikace3.html#cb228-374" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb228-375"><a href="aplikace3.html#cb228-375" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb228-376"><a href="aplikace3.html#cb228-376" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-377"><a href="aplikace3.html#cb228-377" tabindex="-1"></a>    </span>
<span id="cb228-378"><a href="aplikace3.html#cb228-378" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb228-379"><a href="aplikace3.html#cb228-379" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb228-380"><a href="aplikace3.html#cb228-380" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb228-381"><a href="aplikace3.html#cb228-381" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-382"><a href="aplikace3.html#cb228-382" tabindex="-1"></a>  </span>
<span id="cb228-383"><a href="aplikace3.html#cb228-383" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree_Bbasis&#39;</span>, </span>
<span id="cb228-384"><a href="aplikace3.html#cb228-384" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb228-385"><a href="aplikace3.html#cb228-385" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb228-386"><a href="aplikace3.html#cb228-386" tabindex="-1"></a>  </span>
<span id="cb228-387"><a href="aplikace3.html#cb228-387" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb228-388"><a href="aplikace3.html#cb228-388" tabindex="-1"></a>  </span>
<span id="cb228-389"><a href="aplikace3.html#cb228-389" tabindex="-1"></a>  <span class="do">## 6) Náhodné lesy</span></span>
<span id="cb228-390"><a href="aplikace3.html#cb228-390" tabindex="-1"></a>  </span>
<span id="cb228-391"><a href="aplikace3.html#cb228-391" tabindex="-1"></a>  <span class="do">### 6.1) Diskretizace intervalu</span></span>
<span id="cb228-392"><a href="aplikace3.html#cb228-392" tabindex="-1"></a>  </span>
<span id="cb228-393"><a href="aplikace3.html#cb228-393" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb228-394"><a href="aplikace3.html#cb228-394" tabindex="-1"></a>  clf.RF <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb228-395"><a href="aplikace3.html#cb228-395" tabindex="-1"></a>                         <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb228-396"><a href="aplikace3.html#cb228-396" tabindex="-1"></a>                         <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-397"><a href="aplikace3.html#cb228-397" tabindex="-1"></a>                         <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb228-398"><a href="aplikace3.html#cb228-398" tabindex="-1"></a>  </span>
<span id="cb228-399"><a href="aplikace3.html#cb228-399" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb228-400"><a href="aplikace3.html#cb228-400" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data)</span>
<span id="cb228-401"><a href="aplikace3.html#cb228-401" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb228-402"><a href="aplikace3.html#cb228-402" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-403"><a href="aplikace3.html#cb228-403" tabindex="-1"></a>    </span>
<span id="cb228-404"><a href="aplikace3.html#cb228-404" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb228-405"><a href="aplikace3.html#cb228-405" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb228-406"><a href="aplikace3.html#cb228-406" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb228-407"><a href="aplikace3.html#cb228-407" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-408"><a href="aplikace3.html#cb228-408" tabindex="-1"></a>  </span>
<span id="cb228-409"><a href="aplikace3.html#cb228-409" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_discr&#39;</span>, </span>
<span id="cb228-410"><a href="aplikace3.html#cb228-410" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb228-411"><a href="aplikace3.html#cb228-411" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb228-412"><a href="aplikace3.html#cb228-412" tabindex="-1"></a>  </span>
<span id="cb228-413"><a href="aplikace3.html#cb228-413" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb228-414"><a href="aplikace3.html#cb228-414" tabindex="-1"></a>  </span>
<span id="cb228-415"><a href="aplikace3.html#cb228-415" tabindex="-1"></a>  <span class="do">### 6.2) Skóre hlavních komponent</span></span>
<span id="cb228-416"><a href="aplikace3.html#cb228-416" tabindex="-1"></a>  </span>
<span id="cb228-417"><a href="aplikace3.html#cb228-417" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb228-418"><a href="aplikace3.html#cb228-418" tabindex="-1"></a>  clf.RF.PCA <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb228-419"><a href="aplikace3.html#cb228-419" tabindex="-1"></a>                             <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb228-420"><a href="aplikace3.html#cb228-420" tabindex="-1"></a>                             <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-421"><a href="aplikace3.html#cb228-421" tabindex="-1"></a>                             <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb228-422"><a href="aplikace3.html#cb228-422" tabindex="-1"></a>  </span>
<span id="cb228-423"><a href="aplikace3.html#cb228-423" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb228-424"><a href="aplikace3.html#cb228-424" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb228-425"><a href="aplikace3.html#cb228-425" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb228-426"><a href="aplikace3.html#cb228-426" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-427"><a href="aplikace3.html#cb228-427" tabindex="-1"></a>    </span>
<span id="cb228-428"><a href="aplikace3.html#cb228-428" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb228-429"><a href="aplikace3.html#cb228-429" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb228-430"><a href="aplikace3.html#cb228-430" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb228-431"><a href="aplikace3.html#cb228-431" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-432"><a href="aplikace3.html#cb228-432" tabindex="-1"></a>  </span>
<span id="cb228-433"><a href="aplikace3.html#cb228-433" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_score&#39;</span>, </span>
<span id="cb228-434"><a href="aplikace3.html#cb228-434" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb228-435"><a href="aplikace3.html#cb228-435" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb228-436"><a href="aplikace3.html#cb228-436" tabindex="-1"></a>  </span>
<span id="cb228-437"><a href="aplikace3.html#cb228-437" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb228-438"><a href="aplikace3.html#cb228-438" tabindex="-1"></a>  </span>
<span id="cb228-439"><a href="aplikace3.html#cb228-439" tabindex="-1"></a>  <span class="do">### 6.3) Bázové koeficienty</span></span>
<span id="cb228-440"><a href="aplikace3.html#cb228-440" tabindex="-1"></a>  </span>
<span id="cb228-441"><a href="aplikace3.html#cb228-441" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb228-442"><a href="aplikace3.html#cb228-442" tabindex="-1"></a>  clf.RF.Bbasis <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb228-443"><a href="aplikace3.html#cb228-443" tabindex="-1"></a>                                <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb228-444"><a href="aplikace3.html#cb228-444" tabindex="-1"></a>                                <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-445"><a href="aplikace3.html#cb228-445" tabindex="-1"></a>                                <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb228-446"><a href="aplikace3.html#cb228-446" tabindex="-1"></a>  </span>
<span id="cb228-447"><a href="aplikace3.html#cb228-447" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb228-448"><a href="aplikace3.html#cb228-448" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb228-449"><a href="aplikace3.html#cb228-449" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb228-450"><a href="aplikace3.html#cb228-450" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-451"><a href="aplikace3.html#cb228-451" tabindex="-1"></a>    </span>
<span id="cb228-452"><a href="aplikace3.html#cb228-452" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb228-453"><a href="aplikace3.html#cb228-453" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb228-454"><a href="aplikace3.html#cb228-454" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb228-455"><a href="aplikace3.html#cb228-455" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-456"><a href="aplikace3.html#cb228-456" tabindex="-1"></a>  </span>
<span id="cb228-457"><a href="aplikace3.html#cb228-457" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_Bbasis&#39;</span>, </span>
<span id="cb228-458"><a href="aplikace3.html#cb228-458" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb228-459"><a href="aplikace3.html#cb228-459" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb228-460"><a href="aplikace3.html#cb228-460" tabindex="-1"></a>  </span>
<span id="cb228-461"><a href="aplikace3.html#cb228-461" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb228-462"><a href="aplikace3.html#cb228-462" tabindex="-1"></a>  </span>
<span id="cb228-463"><a href="aplikace3.html#cb228-463" tabindex="-1"></a>  <span class="do">## 7) SVM</span></span>
<span id="cb228-464"><a href="aplikace3.html#cb228-464" tabindex="-1"></a>  </span>
<span id="cb228-465"><a href="aplikace3.html#cb228-465" tabindex="-1"></a>  <span class="do">### 7.1) Diskretizace intervalu</span></span>
<span id="cb228-466"><a href="aplikace3.html#cb228-466" tabindex="-1"></a>  </span>
<span id="cb228-467"><a href="aplikace3.html#cb228-467" tabindex="-1"></a>  <span class="co"># rozdeleni na testovaci a trenovaci cast</span></span>
<span id="cb228-468"><a href="aplikace3.html#cb228-468" tabindex="-1"></a>  X.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb228-469"><a href="aplikace3.html#cb228-469" tabindex="-1"></a>  X.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb228-470"><a href="aplikace3.html#cb228-470" tabindex="-1"></a>  </span>
<span id="cb228-471"><a href="aplikace3.html#cb228-471" tabindex="-1"></a>  Y.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb228-472"><a href="aplikace3.html#cb228-472" tabindex="-1"></a>  Y.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb228-473"><a href="aplikace3.html#cb228-473" tabindex="-1"></a>  </span>
<span id="cb228-474"><a href="aplikace3.html#cb228-474" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb228-475"><a href="aplikace3.html#cb228-475" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) </span>
<span id="cb228-476"><a href="aplikace3.html#cb228-476" tabindex="-1"></a>  grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb228-477"><a href="aplikace3.html#cb228-477" tabindex="-1"></a>  </span>
<span id="cb228-478"><a href="aplikace3.html#cb228-478" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb228-479"><a href="aplikace3.html#cb228-479" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb228-480"><a href="aplikace3.html#cb228-480" tabindex="-1"></a>  grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb228-481"><a href="aplikace3.html#cb228-481" tabindex="-1"></a>  </span>
<span id="cb228-482"><a href="aplikace3.html#cb228-482" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb228-483"><a href="aplikace3.html#cb228-483" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb228-484"><a href="aplikace3.html#cb228-484" tabindex="-1"></a>  <span class="co"># kontrola, ze mame opravdu k = k_cv</span></span>
<span id="cb228-485"><a href="aplikace3.html#cb228-485" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">length</span>(folds) <span class="sc">!=</span> k_cv) {</span>
<span id="cb228-486"><a href="aplikace3.html#cb228-486" tabindex="-1"></a>    folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb228-487"><a href="aplikace3.html#cb228-487" tabindex="-1"></a>  }</span>
<span id="cb228-488"><a href="aplikace3.html#cb228-488" tabindex="-1"></a>  </span>
<span id="cb228-489"><a href="aplikace3.html#cb228-489" tabindex="-1"></a>  <span class="co"># ktere hodnoty gamma chceme uvazovat</span></span>
<span id="cb228-490"><a href="aplikace3.html#cb228-490" tabindex="-1"></a>  gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb228-491"><a href="aplikace3.html#cb228-491" tabindex="-1"></a>  C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb228-492"><a href="aplikace3.html#cb228-492" tabindex="-1"></a>  p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb228-493"><a href="aplikace3.html#cb228-493" tabindex="-1"></a>  coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb228-494"><a href="aplikace3.html#cb228-494" tabindex="-1"></a>  </span>
<span id="cb228-495"><a href="aplikace3.html#cb228-495" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb228-496"><a href="aplikace3.html#cb228-496" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb228-497"><a href="aplikace3.html#cb228-497" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb228-498"><a href="aplikace3.html#cb228-498" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb228-499"><a href="aplikace3.html#cb228-499" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb228-500"><a href="aplikace3.html#cb228-500" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb228-501"><a href="aplikace3.html#cb228-501" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb228-502"><a href="aplikace3.html#cb228-502" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb228-503"><a href="aplikace3.html#cb228-503" tabindex="-1"></a>  )</span>
<span id="cb228-504"><a href="aplikace3.html#cb228-504" tabindex="-1"></a>  </span>
<span id="cb228-505"><a href="aplikace3.html#cb228-505" tabindex="-1"></a>  <span class="co"># nejprve projdeme hodnoty C</span></span>
<span id="cb228-506"><a href="aplikace3.html#cb228-506" tabindex="-1"></a>  <span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb228-507"><a href="aplikace3.html#cb228-507" tabindex="-1"></a>    <span class="co"># projdeme jednotlive folds</span></span>
<span id="cb228-508"><a href="aplikace3.html#cb228-508" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb228-509"><a href="aplikace3.html#cb228-509" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb228-510"><a href="aplikace3.html#cb228-510" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb228-511"><a href="aplikace3.html#cb228-511" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb228-512"><a href="aplikace3.html#cb228-512" tabindex="-1"></a>      </span>
<span id="cb228-513"><a href="aplikace3.html#cb228-513" tabindex="-1"></a>      data.grid.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(grid.data[cv_sample, ])</span>
<span id="cb228-514"><a href="aplikace3.html#cb228-514" tabindex="-1"></a>      data.grid.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(grid.data[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb228-515"><a href="aplikace3.html#cb228-515" tabindex="-1"></a>      </span>
<span id="cb228-516"><a href="aplikace3.html#cb228-516" tabindex="-1"></a>      <span class="do">## LINEARNI JADRO</span></span>
<span id="cb228-517"><a href="aplikace3.html#cb228-517" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb228-518"><a href="aplikace3.html#cb228-518" tabindex="-1"></a>      clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb228-519"><a href="aplikace3.html#cb228-519" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb228-520"><a href="aplikace3.html#cb228-520" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-521"><a href="aplikace3.html#cb228-521" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb228-522"><a href="aplikace3.html#cb228-522" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb228-523"><a href="aplikace3.html#cb228-523" tabindex="-1"></a>      </span>
<span id="cb228-524"><a href="aplikace3.html#cb228-524" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb228-525"><a href="aplikace3.html#cb228-525" tabindex="-1"></a>      predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb228-526"><a href="aplikace3.html#cb228-526" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb228-527"><a href="aplikace3.html#cb228-527" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-528"><a href="aplikace3.html#cb228-528" tabindex="-1"></a>      </span>
<span id="cb228-529"><a href="aplikace3.html#cb228-529" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C a fold</span></span>
<span id="cb228-530"><a href="aplikace3.html#cb228-530" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb228-531"><a href="aplikace3.html#cb228-531" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb228-532"><a href="aplikace3.html#cb228-532" tabindex="-1"></a>      </span>
<span id="cb228-533"><a href="aplikace3.html#cb228-533" tabindex="-1"></a>      <span class="do">## POLYNOMIALNI JADRO</span></span>
<span id="cb228-534"><a href="aplikace3.html#cb228-534" tabindex="-1"></a>      <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb228-535"><a href="aplikace3.html#cb228-535" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb228-536"><a href="aplikace3.html#cb228-536" tabindex="-1"></a>        clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb228-537"><a href="aplikace3.html#cb228-537" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb228-538"><a href="aplikace3.html#cb228-538" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-539"><a href="aplikace3.html#cb228-539" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb228-540"><a href="aplikace3.html#cb228-540" tabindex="-1"></a>                         <span class="at">coef0 =</span> coef0,</span>
<span id="cb228-541"><a href="aplikace3.html#cb228-541" tabindex="-1"></a>                         <span class="at">degree =</span> p,</span>
<span id="cb228-542"><a href="aplikace3.html#cb228-542" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb228-543"><a href="aplikace3.html#cb228-543" tabindex="-1"></a>        </span>
<span id="cb228-544"><a href="aplikace3.html#cb228-544" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb228-545"><a href="aplikace3.html#cb228-545" tabindex="-1"></a>        predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, </span>
<span id="cb228-546"><a href="aplikace3.html#cb228-546" tabindex="-1"></a>                                      <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb228-547"><a href="aplikace3.html#cb228-547" tabindex="-1"></a>        presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb228-548"><a href="aplikace3.html#cb228-548" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-549"><a href="aplikace3.html#cb228-549" tabindex="-1"></a>        </span>
<span id="cb228-550"><a href="aplikace3.html#cb228-550" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, p a fold</span></span>
<span id="cb228-551"><a href="aplikace3.html#cb228-551" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb228-552"><a href="aplikace3.html#cb228-552" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb228-553"><a href="aplikace3.html#cb228-553" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb228-554"><a href="aplikace3.html#cb228-554" tabindex="-1"></a>      }</span>
<span id="cb228-555"><a href="aplikace3.html#cb228-555" tabindex="-1"></a>          </span>
<span id="cb228-556"><a href="aplikace3.html#cb228-556" tabindex="-1"></a>      <span class="do">## RADIALNI JADRO</span></span>
<span id="cb228-557"><a href="aplikace3.html#cb228-557" tabindex="-1"></a>      <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb228-558"><a href="aplikace3.html#cb228-558" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb228-559"><a href="aplikace3.html#cb228-559" tabindex="-1"></a>        clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb228-560"><a href="aplikace3.html#cb228-560" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb228-561"><a href="aplikace3.html#cb228-561" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-562"><a href="aplikace3.html#cb228-562" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb228-563"><a href="aplikace3.html#cb228-563" tabindex="-1"></a>                         <span class="at">gamma =</span> gamma,</span>
<span id="cb228-564"><a href="aplikace3.html#cb228-564" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb228-565"><a href="aplikace3.html#cb228-565" tabindex="-1"></a>        </span>
<span id="cb228-566"><a href="aplikace3.html#cb228-566" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb228-567"><a href="aplikace3.html#cb228-567" tabindex="-1"></a>        predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb228-568"><a href="aplikace3.html#cb228-568" tabindex="-1"></a>        presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb228-569"><a href="aplikace3.html#cb228-569" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-570"><a href="aplikace3.html#cb228-570" tabindex="-1"></a>        </span>
<span id="cb228-571"><a href="aplikace3.html#cb228-571" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, gamma a fold</span></span>
<span id="cb228-572"><a href="aplikace3.html#cb228-572" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb228-573"><a href="aplikace3.html#cb228-573" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb228-574"><a href="aplikace3.html#cb228-574" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb228-575"><a href="aplikace3.html#cb228-575" tabindex="-1"></a>      }</span>
<span id="cb228-576"><a href="aplikace3.html#cb228-576" tabindex="-1"></a>    }</span>
<span id="cb228-577"><a href="aplikace3.html#cb228-577" tabindex="-1"></a>  }</span>
<span id="cb228-578"><a href="aplikace3.html#cb228-578" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva C pres folds</span></span>
<span id="cb228-579"><a href="aplikace3.html#cb228-579" tabindex="-1"></a>  <span class="do">## Linearni jadro</span></span>
<span id="cb228-580"><a href="aplikace3.html#cb228-580" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb228-581"><a href="aplikace3.html#cb228-581" tabindex="-1"></a>  <span class="do">## Polynomialni jadro</span></span>
<span id="cb228-582"><a href="aplikace3.html#cb228-582" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb228-583"><a href="aplikace3.html#cb228-583" tabindex="-1"></a>  <span class="do">## Radialni jadro</span></span>
<span id="cb228-584"><a href="aplikace3.html#cb228-584" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb228-585"><a href="aplikace3.html#cb228-585" tabindex="-1"></a>  </span>
<span id="cb228-586"><a href="aplikace3.html#cb228-586" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb228-587"><a href="aplikace3.html#cb228-587" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb228-588"><a href="aplikace3.html#cb228-588" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb228-589"><a href="aplikace3.html#cb228-589" tabindex="-1"></a>  C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb228-590"><a href="aplikace3.html#cb228-590" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb228-591"><a href="aplikace3.html#cb228-591" tabindex="-1"></a>  </span>
<span id="cb228-592"><a href="aplikace3.html#cb228-592" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb228-593"><a href="aplikace3.html#cb228-593" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb228-594"><a href="aplikace3.html#cb228-594" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb228-595"><a href="aplikace3.html#cb228-595" tabindex="-1"></a>  </span>
<span id="cb228-596"><a href="aplikace3.html#cb228-596" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb228-597"><a href="aplikace3.html#cb228-597" tabindex="-1"></a>  p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb228-598"><a href="aplikace3.html#cb228-598" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb228-599"><a href="aplikace3.html#cb228-599" tabindex="-1"></a>  </span>
<span id="cb228-600"><a href="aplikace3.html#cb228-600" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb228-601"><a href="aplikace3.html#cb228-601" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb228-602"><a href="aplikace3.html#cb228-602" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb228-603"><a href="aplikace3.html#cb228-603" tabindex="-1"></a>  </span>
<span id="cb228-604"><a href="aplikace3.html#cb228-604" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb228-605"><a href="aplikace3.html#cb228-605" tabindex="-1"></a>  clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb228-606"><a href="aplikace3.html#cb228-606" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb228-607"><a href="aplikace3.html#cb228-607" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-608"><a href="aplikace3.html#cb228-608" tabindex="-1"></a>                   <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb228-609"><a href="aplikace3.html#cb228-609" tabindex="-1"></a>                   <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb228-610"><a href="aplikace3.html#cb228-610" tabindex="-1"></a>  </span>
<span id="cb228-611"><a href="aplikace3.html#cb228-611" tabindex="-1"></a>  clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb228-612"><a href="aplikace3.html#cb228-612" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb228-613"><a href="aplikace3.html#cb228-613" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-614"><a href="aplikace3.html#cb228-614" tabindex="-1"></a>                   <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb228-615"><a href="aplikace3.html#cb228-615" tabindex="-1"></a>                   <span class="at">degree =</span> p.opt,</span>
<span id="cb228-616"><a href="aplikace3.html#cb228-616" tabindex="-1"></a>                   <span class="at">coef0 =</span> coef0,</span>
<span id="cb228-617"><a href="aplikace3.html#cb228-617" tabindex="-1"></a>                   <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb228-618"><a href="aplikace3.html#cb228-618" tabindex="-1"></a>  </span>
<span id="cb228-619"><a href="aplikace3.html#cb228-619" tabindex="-1"></a>  clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb228-620"><a href="aplikace3.html#cb228-620" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb228-621"><a href="aplikace3.html#cb228-621" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">TRUE</span>, </span>
<span id="cb228-622"><a href="aplikace3.html#cb228-622" tabindex="-1"></a>                   <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb228-623"><a href="aplikace3.html#cb228-623" tabindex="-1"></a>                   <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb228-624"><a href="aplikace3.html#cb228-624" tabindex="-1"></a>                   <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb228-625"><a href="aplikace3.html#cb228-625" tabindex="-1"></a>  </span>
<span id="cb228-626"><a href="aplikace3.html#cb228-626" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb228-627"><a href="aplikace3.html#cb228-627" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data)</span>
<span id="cb228-628"><a href="aplikace3.html#cb228-628" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb228-629"><a href="aplikace3.html#cb228-629" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-630"><a href="aplikace3.html#cb228-630" tabindex="-1"></a>  </span>
<span id="cb228-631"><a href="aplikace3.html#cb228-631" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data)</span>
<span id="cb228-632"><a href="aplikace3.html#cb228-632" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb228-633"><a href="aplikace3.html#cb228-633" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-634"><a href="aplikace3.html#cb228-634" tabindex="-1"></a>  </span>
<span id="cb228-635"><a href="aplikace3.html#cb228-635" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data)</span>
<span id="cb228-636"><a href="aplikace3.html#cb228-636" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb228-637"><a href="aplikace3.html#cb228-637" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-638"><a href="aplikace3.html#cb228-638" tabindex="-1"></a>  </span>
<span id="cb228-639"><a href="aplikace3.html#cb228-639" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb228-640"><a href="aplikace3.html#cb228-640" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb228-641"><a href="aplikace3.html#cb228-641" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb228-642"><a href="aplikace3.html#cb228-642" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-643"><a href="aplikace3.html#cb228-643" tabindex="-1"></a>  </span>
<span id="cb228-644"><a href="aplikace3.html#cb228-644" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb228-645"><a href="aplikace3.html#cb228-645" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb228-646"><a href="aplikace3.html#cb228-646" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-647"><a href="aplikace3.html#cb228-647" tabindex="-1"></a>  </span>
<span id="cb228-648"><a href="aplikace3.html#cb228-648" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb228-649"><a href="aplikace3.html#cb228-649" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb228-650"><a href="aplikace3.html#cb228-650" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-651"><a href="aplikace3.html#cb228-651" tabindex="-1"></a>  </span>
<span id="cb228-652"><a href="aplikace3.html#cb228-652" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - diskr&#39;</span>, </span>
<span id="cb228-653"><a href="aplikace3.html#cb228-653" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - diskr&#39;</span>, </span>
<span id="cb228-654"><a href="aplikace3.html#cb228-654" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - diskr&#39;</span>), </span>
<span id="cb228-655"><a href="aplikace3.html#cb228-655" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l,</span>
<span id="cb228-656"><a href="aplikace3.html#cb228-656" tabindex="-1"></a>                                      presnost.train.p, presnost.train.r),</span>
<span id="cb228-657"><a href="aplikace3.html#cb228-657" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb228-658"><a href="aplikace3.html#cb228-658" tabindex="-1"></a>                                     presnost.test.p, presnost.test.r))</span>
<span id="cb228-659"><a href="aplikace3.html#cb228-659" tabindex="-1"></a>  </span>
<span id="cb228-660"><a href="aplikace3.html#cb228-660" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb228-661"><a href="aplikace3.html#cb228-661" tabindex="-1"></a>  </span>
<span id="cb228-662"><a href="aplikace3.html#cb228-662" tabindex="-1"></a>  <span class="do">### 7.2) Skóre hlavních komponent</span></span>
<span id="cb228-663"><a href="aplikace3.html#cb228-663" tabindex="-1"></a>  </span>
<span id="cb228-664"><a href="aplikace3.html#cb228-664" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb228-665"><a href="aplikace3.html#cb228-665" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb228-666"><a href="aplikace3.html#cb228-666" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb228-667"><a href="aplikace3.html#cb228-667" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb228-668"><a href="aplikace3.html#cb228-668" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb228-669"><a href="aplikace3.html#cb228-669" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb228-670"><a href="aplikace3.html#cb228-670" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb228-671"><a href="aplikace3.html#cb228-671" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb228-672"><a href="aplikace3.html#cb228-672" tabindex="-1"></a>  )</span>
<span id="cb228-673"><a href="aplikace3.html#cb228-673" tabindex="-1"></a>  </span>
<span id="cb228-674"><a href="aplikace3.html#cb228-674" tabindex="-1"></a>  <span class="co"># nejprve projdeme hodnoty C</span></span>
<span id="cb228-675"><a href="aplikace3.html#cb228-675" tabindex="-1"></a>  <span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb228-676"><a href="aplikace3.html#cb228-676" tabindex="-1"></a>    <span class="co"># projdeme jednotlive folds</span></span>
<span id="cb228-677"><a href="aplikace3.html#cb228-677" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb228-678"><a href="aplikace3.html#cb228-678" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb228-679"><a href="aplikace3.html#cb228-679" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb228-680"><a href="aplikace3.html#cb228-680" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.PCA.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb228-681"><a href="aplikace3.html#cb228-681" tabindex="-1"></a>      </span>
<span id="cb228-682"><a href="aplikace3.html#cb228-682" tabindex="-1"></a>      data.PCA.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA.train[cv_sample, ])</span>
<span id="cb228-683"><a href="aplikace3.html#cb228-683" tabindex="-1"></a>      data.PCA.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb228-684"><a href="aplikace3.html#cb228-684" tabindex="-1"></a>      </span>
<span id="cb228-685"><a href="aplikace3.html#cb228-685" tabindex="-1"></a>      <span class="do">## LINEARNI JADRO</span></span>
<span id="cb228-686"><a href="aplikace3.html#cb228-686" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb228-687"><a href="aplikace3.html#cb228-687" tabindex="-1"></a>      clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb228-688"><a href="aplikace3.html#cb228-688" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb228-689"><a href="aplikace3.html#cb228-689" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-690"><a href="aplikace3.html#cb228-690" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb228-691"><a href="aplikace3.html#cb228-691" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb228-692"><a href="aplikace3.html#cb228-692" tabindex="-1"></a>      </span>
<span id="cb228-693"><a href="aplikace3.html#cb228-693" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb228-694"><a href="aplikace3.html#cb228-694" tabindex="-1"></a>      predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb228-695"><a href="aplikace3.html#cb228-695" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb228-696"><a href="aplikace3.html#cb228-696" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-697"><a href="aplikace3.html#cb228-697" tabindex="-1"></a>      </span>
<span id="cb228-698"><a href="aplikace3.html#cb228-698" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C a fold</span></span>
<span id="cb228-699"><a href="aplikace3.html#cb228-699" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb228-700"><a href="aplikace3.html#cb228-700" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb228-701"><a href="aplikace3.html#cb228-701" tabindex="-1"></a>      </span>
<span id="cb228-702"><a href="aplikace3.html#cb228-702" tabindex="-1"></a>      <span class="do">## POLYNOMIALNI JADRO</span></span>
<span id="cb228-703"><a href="aplikace3.html#cb228-703" tabindex="-1"></a>      <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb228-704"><a href="aplikace3.html#cb228-704" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb228-705"><a href="aplikace3.html#cb228-705" tabindex="-1"></a>        clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb228-706"><a href="aplikace3.html#cb228-706" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb228-707"><a href="aplikace3.html#cb228-707" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-708"><a href="aplikace3.html#cb228-708" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb228-709"><a href="aplikace3.html#cb228-709" tabindex="-1"></a>                         <span class="at">coef0 =</span> coef0,</span>
<span id="cb228-710"><a href="aplikace3.html#cb228-710" tabindex="-1"></a>                         <span class="at">degree =</span> p,</span>
<span id="cb228-711"><a href="aplikace3.html#cb228-711" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb228-712"><a href="aplikace3.html#cb228-712" tabindex="-1"></a>        </span>
<span id="cb228-713"><a href="aplikace3.html#cb228-713" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb228-714"><a href="aplikace3.html#cb228-714" tabindex="-1"></a>        predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb228-715"><a href="aplikace3.html#cb228-715" tabindex="-1"></a>        presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb228-716"><a href="aplikace3.html#cb228-716" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-717"><a href="aplikace3.html#cb228-717" tabindex="-1"></a>        </span>
<span id="cb228-718"><a href="aplikace3.html#cb228-718" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, p a fold</span></span>
<span id="cb228-719"><a href="aplikace3.html#cb228-719" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb228-720"><a href="aplikace3.html#cb228-720" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb228-721"><a href="aplikace3.html#cb228-721" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb228-722"><a href="aplikace3.html#cb228-722" tabindex="-1"></a>      }</span>
<span id="cb228-723"><a href="aplikace3.html#cb228-723" tabindex="-1"></a>          </span>
<span id="cb228-724"><a href="aplikace3.html#cb228-724" tabindex="-1"></a>      <span class="do">## RADIALNI JADRO</span></span>
<span id="cb228-725"><a href="aplikace3.html#cb228-725" tabindex="-1"></a>      <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb228-726"><a href="aplikace3.html#cb228-726" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb228-727"><a href="aplikace3.html#cb228-727" tabindex="-1"></a>        clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb228-728"><a href="aplikace3.html#cb228-728" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb228-729"><a href="aplikace3.html#cb228-729" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-730"><a href="aplikace3.html#cb228-730" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb228-731"><a href="aplikace3.html#cb228-731" tabindex="-1"></a>                         <span class="at">gamma =</span> gamma,</span>
<span id="cb228-732"><a href="aplikace3.html#cb228-732" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb228-733"><a href="aplikace3.html#cb228-733" tabindex="-1"></a>        </span>
<span id="cb228-734"><a href="aplikace3.html#cb228-734" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb228-735"><a href="aplikace3.html#cb228-735" tabindex="-1"></a>        predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb228-736"><a href="aplikace3.html#cb228-736" tabindex="-1"></a>        presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb228-737"><a href="aplikace3.html#cb228-737" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-738"><a href="aplikace3.html#cb228-738" tabindex="-1"></a>        </span>
<span id="cb228-739"><a href="aplikace3.html#cb228-739" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, gamma a fold</span></span>
<span id="cb228-740"><a href="aplikace3.html#cb228-740" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb228-741"><a href="aplikace3.html#cb228-741" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb228-742"><a href="aplikace3.html#cb228-742" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb228-743"><a href="aplikace3.html#cb228-743" tabindex="-1"></a>      }</span>
<span id="cb228-744"><a href="aplikace3.html#cb228-744" tabindex="-1"></a>    }</span>
<span id="cb228-745"><a href="aplikace3.html#cb228-745" tabindex="-1"></a>  }</span>
<span id="cb228-746"><a href="aplikace3.html#cb228-746" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva C pres folds</span></span>
<span id="cb228-747"><a href="aplikace3.html#cb228-747" tabindex="-1"></a>  <span class="do">## Linearni jadro</span></span>
<span id="cb228-748"><a href="aplikace3.html#cb228-748" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb228-749"><a href="aplikace3.html#cb228-749" tabindex="-1"></a>  <span class="do">## Polynomialni jadro</span></span>
<span id="cb228-750"><a href="aplikace3.html#cb228-750" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb228-751"><a href="aplikace3.html#cb228-751" tabindex="-1"></a>  <span class="do">## Radialni jadro</span></span>
<span id="cb228-752"><a href="aplikace3.html#cb228-752" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb228-753"><a href="aplikace3.html#cb228-753" tabindex="-1"></a>  </span>
<span id="cb228-754"><a href="aplikace3.html#cb228-754" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb228-755"><a href="aplikace3.html#cb228-755" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb228-756"><a href="aplikace3.html#cb228-756" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb228-757"><a href="aplikace3.html#cb228-757" tabindex="-1"></a>  C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb228-758"><a href="aplikace3.html#cb228-758" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb228-759"><a href="aplikace3.html#cb228-759" tabindex="-1"></a>  </span>
<span id="cb228-760"><a href="aplikace3.html#cb228-760" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb228-761"><a href="aplikace3.html#cb228-761" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb228-762"><a href="aplikace3.html#cb228-762" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb228-763"><a href="aplikace3.html#cb228-763" tabindex="-1"></a>  </span>
<span id="cb228-764"><a href="aplikace3.html#cb228-764" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb228-765"><a href="aplikace3.html#cb228-765" tabindex="-1"></a>  p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb228-766"><a href="aplikace3.html#cb228-766" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb228-767"><a href="aplikace3.html#cb228-767" tabindex="-1"></a>  </span>
<span id="cb228-768"><a href="aplikace3.html#cb228-768" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb228-769"><a href="aplikace3.html#cb228-769" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb228-770"><a href="aplikace3.html#cb228-770" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb228-771"><a href="aplikace3.html#cb228-771" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb228-772"><a href="aplikace3.html#cb228-772" tabindex="-1"></a>  clf.SVM.l.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb228-773"><a href="aplikace3.html#cb228-773" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb228-774"><a href="aplikace3.html#cb228-774" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-775"><a href="aplikace3.html#cb228-775" tabindex="-1"></a>                       <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb228-776"><a href="aplikace3.html#cb228-776" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb228-777"><a href="aplikace3.html#cb228-777" tabindex="-1"></a>  </span>
<span id="cb228-778"><a href="aplikace3.html#cb228-778" tabindex="-1"></a>  clf.SVM.p.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb228-779"><a href="aplikace3.html#cb228-779" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb228-780"><a href="aplikace3.html#cb228-780" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-781"><a href="aplikace3.html#cb228-781" tabindex="-1"></a>                       <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb228-782"><a href="aplikace3.html#cb228-782" tabindex="-1"></a>                       <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb228-783"><a href="aplikace3.html#cb228-783" tabindex="-1"></a>                       <span class="at">degree =</span> p.opt,</span>
<span id="cb228-784"><a href="aplikace3.html#cb228-784" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb228-785"><a href="aplikace3.html#cb228-785" tabindex="-1"></a>  </span>
<span id="cb228-786"><a href="aplikace3.html#cb228-786" tabindex="-1"></a>  clf.SVM.r.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb228-787"><a href="aplikace3.html#cb228-787" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb228-788"><a href="aplikace3.html#cb228-788" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-789"><a href="aplikace3.html#cb228-789" tabindex="-1"></a>                       <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb228-790"><a href="aplikace3.html#cb228-790" tabindex="-1"></a>                       <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb228-791"><a href="aplikace3.html#cb228-791" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb228-792"><a href="aplikace3.html#cb228-792" tabindex="-1"></a>  </span>
<span id="cb228-793"><a href="aplikace3.html#cb228-793" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb228-794"><a href="aplikace3.html#cb228-794" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb228-795"><a href="aplikace3.html#cb228-795" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb228-796"><a href="aplikace3.html#cb228-796" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-797"><a href="aplikace3.html#cb228-797" tabindex="-1"></a>  </span>
<span id="cb228-798"><a href="aplikace3.html#cb228-798" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb228-799"><a href="aplikace3.html#cb228-799" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb228-800"><a href="aplikace3.html#cb228-800" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-801"><a href="aplikace3.html#cb228-801" tabindex="-1"></a>  </span>
<span id="cb228-802"><a href="aplikace3.html#cb228-802" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb228-803"><a href="aplikace3.html#cb228-803" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb228-804"><a href="aplikace3.html#cb228-804" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-805"><a href="aplikace3.html#cb228-805" tabindex="-1"></a>    </span>
<span id="cb228-806"><a href="aplikace3.html#cb228-806" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb228-807"><a href="aplikace3.html#cb228-807" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb228-808"><a href="aplikace3.html#cb228-808" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb228-809"><a href="aplikace3.html#cb228-809" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-810"><a href="aplikace3.html#cb228-810" tabindex="-1"></a>  </span>
<span id="cb228-811"><a href="aplikace3.html#cb228-811" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb228-812"><a href="aplikace3.html#cb228-812" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb228-813"><a href="aplikace3.html#cb228-813" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-814"><a href="aplikace3.html#cb228-814" tabindex="-1"></a>  </span>
<span id="cb228-815"><a href="aplikace3.html#cb228-815" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb228-816"><a href="aplikace3.html#cb228-816" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb228-817"><a href="aplikace3.html#cb228-817" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-818"><a href="aplikace3.html#cb228-818" tabindex="-1"></a>  </span>
<span id="cb228-819"><a href="aplikace3.html#cb228-819" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - PCA&#39;</span>, </span>
<span id="cb228-820"><a href="aplikace3.html#cb228-820" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - PCA&#39;</span>, </span>
<span id="cb228-821"><a href="aplikace3.html#cb228-821" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - PCA&#39;</span>), </span>
<span id="cb228-822"><a href="aplikace3.html#cb228-822" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, </span>
<span id="cb228-823"><a href="aplikace3.html#cb228-823" tabindex="-1"></a>                                      presnost.train.p, presnost.train.r),</span>
<span id="cb228-824"><a href="aplikace3.html#cb228-824" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb228-825"><a href="aplikace3.html#cb228-825" tabindex="-1"></a>                                     presnost.test.p, presnost.test.r))</span>
<span id="cb228-826"><a href="aplikace3.html#cb228-826" tabindex="-1"></a>  </span>
<span id="cb228-827"><a href="aplikace3.html#cb228-827" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb228-828"><a href="aplikace3.html#cb228-828" tabindex="-1"></a>  </span>
<span id="cb228-829"><a href="aplikace3.html#cb228-829" tabindex="-1"></a>  <span class="do">### 7.3) Bázové koeficienty</span></span>
<span id="cb228-830"><a href="aplikace3.html#cb228-830" tabindex="-1"></a>  </span>
<span id="cb228-831"><a href="aplikace3.html#cb228-831" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb228-832"><a href="aplikace3.html#cb228-832" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb228-833"><a href="aplikace3.html#cb228-833" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb228-834"><a href="aplikace3.html#cb228-834" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb228-835"><a href="aplikace3.html#cb228-835" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb228-836"><a href="aplikace3.html#cb228-836" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb228-837"><a href="aplikace3.html#cb228-837" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb228-838"><a href="aplikace3.html#cb228-838" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb228-839"><a href="aplikace3.html#cb228-839" tabindex="-1"></a>  )</span>
<span id="cb228-840"><a href="aplikace3.html#cb228-840" tabindex="-1"></a>  </span>
<span id="cb228-841"><a href="aplikace3.html#cb228-841" tabindex="-1"></a>  <span class="co"># nejprve projdeme hodnoty C</span></span>
<span id="cb228-842"><a href="aplikace3.html#cb228-842" tabindex="-1"></a>  <span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb228-843"><a href="aplikace3.html#cb228-843" tabindex="-1"></a>    <span class="co"># projdeme jednotlive folds</span></span>
<span id="cb228-844"><a href="aplikace3.html#cb228-844" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb228-845"><a href="aplikace3.html#cb228-845" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb228-846"><a href="aplikace3.html#cb228-846" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb228-847"><a href="aplikace3.html#cb228-847" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb228-848"><a href="aplikace3.html#cb228-848" tabindex="-1"></a>      </span>
<span id="cb228-849"><a href="aplikace3.html#cb228-849" tabindex="-1"></a>      data.Bbasis.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.Bbasis.train[cv_sample, ])</span>
<span id="cb228-850"><a href="aplikace3.html#cb228-850" tabindex="-1"></a>      data.Bbasis.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.Bbasis.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb228-851"><a href="aplikace3.html#cb228-851" tabindex="-1"></a>      </span>
<span id="cb228-852"><a href="aplikace3.html#cb228-852" tabindex="-1"></a>      <span class="do">## LINEARNI JADRO</span></span>
<span id="cb228-853"><a href="aplikace3.html#cb228-853" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb228-854"><a href="aplikace3.html#cb228-854" tabindex="-1"></a>      clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb228-855"><a href="aplikace3.html#cb228-855" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb228-856"><a href="aplikace3.html#cb228-856" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-857"><a href="aplikace3.html#cb228-857" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb228-858"><a href="aplikace3.html#cb228-858" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb228-859"><a href="aplikace3.html#cb228-859" tabindex="-1"></a>      </span>
<span id="cb228-860"><a href="aplikace3.html#cb228-860" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb228-861"><a href="aplikace3.html#cb228-861" tabindex="-1"></a>      predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb228-862"><a href="aplikace3.html#cb228-862" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb228-863"><a href="aplikace3.html#cb228-863" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-864"><a href="aplikace3.html#cb228-864" tabindex="-1"></a>      </span>
<span id="cb228-865"><a href="aplikace3.html#cb228-865" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C a fold</span></span>
<span id="cb228-866"><a href="aplikace3.html#cb228-866" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb228-867"><a href="aplikace3.html#cb228-867" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb228-868"><a href="aplikace3.html#cb228-868" tabindex="-1"></a>      </span>
<span id="cb228-869"><a href="aplikace3.html#cb228-869" tabindex="-1"></a>      <span class="do">## POLYNOMIALNI JADRO</span></span>
<span id="cb228-870"><a href="aplikace3.html#cb228-870" tabindex="-1"></a>      <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb228-871"><a href="aplikace3.html#cb228-871" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb228-872"><a href="aplikace3.html#cb228-872" tabindex="-1"></a>        clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb228-873"><a href="aplikace3.html#cb228-873" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb228-874"><a href="aplikace3.html#cb228-874" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-875"><a href="aplikace3.html#cb228-875" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb228-876"><a href="aplikace3.html#cb228-876" tabindex="-1"></a>                         <span class="at">coef0 =</span> coef0,</span>
<span id="cb228-877"><a href="aplikace3.html#cb228-877" tabindex="-1"></a>                         <span class="at">degree =</span> p,</span>
<span id="cb228-878"><a href="aplikace3.html#cb228-878" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb228-879"><a href="aplikace3.html#cb228-879" tabindex="-1"></a>        </span>
<span id="cb228-880"><a href="aplikace3.html#cb228-880" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb228-881"><a href="aplikace3.html#cb228-881" tabindex="-1"></a>        predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, </span>
<span id="cb228-882"><a href="aplikace3.html#cb228-882" tabindex="-1"></a>                                      <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb228-883"><a href="aplikace3.html#cb228-883" tabindex="-1"></a>        presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb228-884"><a href="aplikace3.html#cb228-884" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-885"><a href="aplikace3.html#cb228-885" tabindex="-1"></a>        </span>
<span id="cb228-886"><a href="aplikace3.html#cb228-886" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, p a fold</span></span>
<span id="cb228-887"><a href="aplikace3.html#cb228-887" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb228-888"><a href="aplikace3.html#cb228-888" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb228-889"><a href="aplikace3.html#cb228-889" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb228-890"><a href="aplikace3.html#cb228-890" tabindex="-1"></a>      }</span>
<span id="cb228-891"><a href="aplikace3.html#cb228-891" tabindex="-1"></a>          </span>
<span id="cb228-892"><a href="aplikace3.html#cb228-892" tabindex="-1"></a>      <span class="do">## RADIALNI JADRO</span></span>
<span id="cb228-893"><a href="aplikace3.html#cb228-893" tabindex="-1"></a>      <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb228-894"><a href="aplikace3.html#cb228-894" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb228-895"><a href="aplikace3.html#cb228-895" tabindex="-1"></a>        clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb228-896"><a href="aplikace3.html#cb228-896" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb228-897"><a href="aplikace3.html#cb228-897" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-898"><a href="aplikace3.html#cb228-898" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb228-899"><a href="aplikace3.html#cb228-899" tabindex="-1"></a>                         <span class="at">gamma =</span> gamma,</span>
<span id="cb228-900"><a href="aplikace3.html#cb228-900" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb228-901"><a href="aplikace3.html#cb228-901" tabindex="-1"></a>        </span>
<span id="cb228-902"><a href="aplikace3.html#cb228-902" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb228-903"><a href="aplikace3.html#cb228-903" tabindex="-1"></a>        predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, </span>
<span id="cb228-904"><a href="aplikace3.html#cb228-904" tabindex="-1"></a>                                      <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb228-905"><a href="aplikace3.html#cb228-905" tabindex="-1"></a>        presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb228-906"><a href="aplikace3.html#cb228-906" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-907"><a href="aplikace3.html#cb228-907" tabindex="-1"></a>        </span>
<span id="cb228-908"><a href="aplikace3.html#cb228-908" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, gamma a fold</span></span>
<span id="cb228-909"><a href="aplikace3.html#cb228-909" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb228-910"><a href="aplikace3.html#cb228-910" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb228-911"><a href="aplikace3.html#cb228-911" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb228-912"><a href="aplikace3.html#cb228-912" tabindex="-1"></a>      }</span>
<span id="cb228-913"><a href="aplikace3.html#cb228-913" tabindex="-1"></a>    }</span>
<span id="cb228-914"><a href="aplikace3.html#cb228-914" tabindex="-1"></a>  }</span>
<span id="cb228-915"><a href="aplikace3.html#cb228-915" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva C pres folds</span></span>
<span id="cb228-916"><a href="aplikace3.html#cb228-916" tabindex="-1"></a>  <span class="do">## Linearni jadro</span></span>
<span id="cb228-917"><a href="aplikace3.html#cb228-917" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb228-918"><a href="aplikace3.html#cb228-918" tabindex="-1"></a>  <span class="do">## Polynomialni jadro</span></span>
<span id="cb228-919"><a href="aplikace3.html#cb228-919" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb228-920"><a href="aplikace3.html#cb228-920" tabindex="-1"></a>  <span class="do">## Radialni jadro</span></span>
<span id="cb228-921"><a href="aplikace3.html#cb228-921" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb228-922"><a href="aplikace3.html#cb228-922" tabindex="-1"></a>  </span>
<span id="cb228-923"><a href="aplikace3.html#cb228-923" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb228-924"><a href="aplikace3.html#cb228-924" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb228-925"><a href="aplikace3.html#cb228-925" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb228-926"><a href="aplikace3.html#cb228-926" tabindex="-1"></a>  C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb228-927"><a href="aplikace3.html#cb228-927" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb228-928"><a href="aplikace3.html#cb228-928" tabindex="-1"></a>  </span>
<span id="cb228-929"><a href="aplikace3.html#cb228-929" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb228-930"><a href="aplikace3.html#cb228-930" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb228-931"><a href="aplikace3.html#cb228-931" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb228-932"><a href="aplikace3.html#cb228-932" tabindex="-1"></a>  </span>
<span id="cb228-933"><a href="aplikace3.html#cb228-933" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb228-934"><a href="aplikace3.html#cb228-934" tabindex="-1"></a>  p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb228-935"><a href="aplikace3.html#cb228-935" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb228-936"><a href="aplikace3.html#cb228-936" tabindex="-1"></a>  </span>
<span id="cb228-937"><a href="aplikace3.html#cb228-937" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb228-938"><a href="aplikace3.html#cb228-938" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb228-939"><a href="aplikace3.html#cb228-939" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb228-940"><a href="aplikace3.html#cb228-940" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb228-941"><a href="aplikace3.html#cb228-941" tabindex="-1"></a>  clf.SVM.l.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb228-942"><a href="aplikace3.html#cb228-942" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb228-943"><a href="aplikace3.html#cb228-943" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-944"><a href="aplikace3.html#cb228-944" tabindex="-1"></a>                          <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb228-945"><a href="aplikace3.html#cb228-945" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb228-946"><a href="aplikace3.html#cb228-946" tabindex="-1"></a>  </span>
<span id="cb228-947"><a href="aplikace3.html#cb228-947" tabindex="-1"></a>  clf.SVM.p.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb228-948"><a href="aplikace3.html#cb228-948" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb228-949"><a href="aplikace3.html#cb228-949" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-950"><a href="aplikace3.html#cb228-950" tabindex="-1"></a>                          <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb228-951"><a href="aplikace3.html#cb228-951" tabindex="-1"></a>                          <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb228-952"><a href="aplikace3.html#cb228-952" tabindex="-1"></a>                          <span class="at">degree =</span> p.opt,</span>
<span id="cb228-953"><a href="aplikace3.html#cb228-953" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb228-954"><a href="aplikace3.html#cb228-954" tabindex="-1"></a>  </span>
<span id="cb228-955"><a href="aplikace3.html#cb228-955" tabindex="-1"></a>  clf.SVM.r.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb228-956"><a href="aplikace3.html#cb228-956" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb228-957"><a href="aplikace3.html#cb228-957" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-958"><a href="aplikace3.html#cb228-958" tabindex="-1"></a>                          <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb228-959"><a href="aplikace3.html#cb228-959" tabindex="-1"></a>                          <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb228-960"><a href="aplikace3.html#cb228-960" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb228-961"><a href="aplikace3.html#cb228-961" tabindex="-1"></a>  </span>
<span id="cb228-962"><a href="aplikace3.html#cb228-962" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb228-963"><a href="aplikace3.html#cb228-963" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb228-964"><a href="aplikace3.html#cb228-964" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb228-965"><a href="aplikace3.html#cb228-965" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-966"><a href="aplikace3.html#cb228-966" tabindex="-1"></a>  </span>
<span id="cb228-967"><a href="aplikace3.html#cb228-967" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb228-968"><a href="aplikace3.html#cb228-968" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb228-969"><a href="aplikace3.html#cb228-969" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-970"><a href="aplikace3.html#cb228-970" tabindex="-1"></a>  </span>
<span id="cb228-971"><a href="aplikace3.html#cb228-971" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb228-972"><a href="aplikace3.html#cb228-972" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb228-973"><a href="aplikace3.html#cb228-973" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-974"><a href="aplikace3.html#cb228-974" tabindex="-1"></a>    </span>
<span id="cb228-975"><a href="aplikace3.html#cb228-975" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb228-976"><a href="aplikace3.html#cb228-976" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb228-977"><a href="aplikace3.html#cb228-977" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb228-978"><a href="aplikace3.html#cb228-978" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-979"><a href="aplikace3.html#cb228-979" tabindex="-1"></a>  </span>
<span id="cb228-980"><a href="aplikace3.html#cb228-980" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb228-981"><a href="aplikace3.html#cb228-981" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb228-982"><a href="aplikace3.html#cb228-982" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-983"><a href="aplikace3.html#cb228-983" tabindex="-1"></a>  </span>
<span id="cb228-984"><a href="aplikace3.html#cb228-984" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb228-985"><a href="aplikace3.html#cb228-985" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb228-986"><a href="aplikace3.html#cb228-986" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-987"><a href="aplikace3.html#cb228-987" tabindex="-1"></a></span>
<span id="cb228-988"><a href="aplikace3.html#cb228-988" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - Bbasis&#39;</span>, </span>
<span id="cb228-989"><a href="aplikace3.html#cb228-989" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - Bbasis&#39;</span>, </span>
<span id="cb228-990"><a href="aplikace3.html#cb228-990" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - Bbasis&#39;</span>), </span>
<span id="cb228-991"><a href="aplikace3.html#cb228-991" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, </span>
<span id="cb228-992"><a href="aplikace3.html#cb228-992" tabindex="-1"></a>                                      presnost.train.p, presnost.train.r),</span>
<span id="cb228-993"><a href="aplikace3.html#cb228-993" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb228-994"><a href="aplikace3.html#cb228-994" tabindex="-1"></a>                                     presnost.test.p, presnost.test.r))</span>
<span id="cb228-995"><a href="aplikace3.html#cb228-995" tabindex="-1"></a></span>
<span id="cb228-996"><a href="aplikace3.html#cb228-996" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb228-997"><a href="aplikace3.html#cb228-997" tabindex="-1"></a>  </span>
<span id="cb228-998"><a href="aplikace3.html#cb228-998" tabindex="-1"></a>  <span class="do">### 7.4) Projekce na B-splinovou bázi</span></span>
<span id="cb228-999"><a href="aplikace3.html#cb228-999" tabindex="-1"></a>  </span>
<span id="cb228-1000"><a href="aplikace3.html#cb228-1000" tabindex="-1"></a>  <span class="co"># hodnoty pro B-splinovou bazi</span></span>
<span id="cb228-1001"><a href="aplikace3.html#cb228-1001" tabindex="-1"></a>  rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb228-1002"><a href="aplikace3.html#cb228-1002" tabindex="-1"></a>  norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb228-1003"><a href="aplikace3.html#cb228-1003" tabindex="-1"></a>  n_basis_min <span class="ot">&lt;-</span> norder</span>
<span id="cb228-1004"><a href="aplikace3.html#cb228-1004" tabindex="-1"></a>  n_basis_max <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb228-1005"><a href="aplikace3.html#cb228-1005" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> n_basis_min<span class="sc">:</span>n_basis_max </span>
<span id="cb228-1006"><a href="aplikace3.html#cb228-1006" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb228-1007"><a href="aplikace3.html#cb228-1007" tabindex="-1"></a>  </span>
<span id="cb228-1008"><a href="aplikace3.html#cb228-1008" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">SVM.l =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb228-1009"><a href="aplikace3.html#cb228-1009" tabindex="-1"></a>                     <span class="at">SVM.p =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb228-1010"><a href="aplikace3.html#cb228-1010" tabindex="-1"></a>                     <span class="at">SVM.r =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv))</span>
<span id="cb228-1011"><a href="aplikace3.html#cb228-1011" tabindex="-1"></a>  </span>
<span id="cb228-1012"><a href="aplikace3.html#cb228-1012" tabindex="-1"></a>  <span class="cf">for</span> (d <span class="cf">in</span> dimensions) {</span>
<span id="cb228-1013"><a href="aplikace3.html#cb228-1013" tabindex="-1"></a>    bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb228-1014"><a href="aplikace3.html#cb228-1014" tabindex="-1"></a>                                   <span class="at">nbasis =</span> d)</span>
<span id="cb228-1015"><a href="aplikace3.html#cb228-1015" tabindex="-1"></a>    Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="at">argvals =</span> t, <span class="at">basisobj =</span> bbasis) </span>
<span id="cb228-1016"><a href="aplikace3.html#cb228-1016" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb228-1017"><a href="aplikace3.html#cb228-1017" tabindex="-1"></a>    </span>
<span id="cb228-1018"><a href="aplikace3.html#cb228-1018" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb228-1019"><a href="aplikace3.html#cb228-1019" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb228-1020"><a href="aplikace3.html#cb228-1020" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XX.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb228-1021"><a href="aplikace3.html#cb228-1021" tabindex="-1"></a>      </span>
<span id="cb228-1022"><a href="aplikace3.html#cb228-1022" tabindex="-1"></a>      data.projection.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[cv_sample, ])</span>
<span id="cb228-1023"><a href="aplikace3.html#cb228-1023" tabindex="-1"></a>      data.projection.train.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[cv_sample])</span>
<span id="cb228-1024"><a href="aplikace3.html#cb228-1024" tabindex="-1"></a>      data.projection.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb228-1025"><a href="aplikace3.html#cb228-1025" tabindex="-1"></a>      Y.test.cv <span class="ot">&lt;-</span> Y.train[<span class="sc">!</span>cv_sample]</span>
<span id="cb228-1026"><a href="aplikace3.html#cb228-1026" tabindex="-1"></a>      data.projection.test.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test.cv)</span>
<span id="cb228-1027"><a href="aplikace3.html#cb228-1027" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb228-1028"><a href="aplikace3.html#cb228-1028" tabindex="-1"></a>      clf.SVM.l.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb228-1029"><a href="aplikace3.html#cb228-1029" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb228-1030"><a href="aplikace3.html#cb228-1030" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-1031"><a href="aplikace3.html#cb228-1031" tabindex="-1"></a>                              <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb228-1032"><a href="aplikace3.html#cb228-1032" tabindex="-1"></a>      </span>
<span id="cb228-1033"><a href="aplikace3.html#cb228-1033" tabindex="-1"></a>      clf.SVM.p.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb228-1034"><a href="aplikace3.html#cb228-1034" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb228-1035"><a href="aplikace3.html#cb228-1035" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-1036"><a href="aplikace3.html#cb228-1036" tabindex="-1"></a>                              <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb228-1037"><a href="aplikace3.html#cb228-1037" tabindex="-1"></a>                              <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb228-1038"><a href="aplikace3.html#cb228-1038" tabindex="-1"></a>      </span>
<span id="cb228-1039"><a href="aplikace3.html#cb228-1039" tabindex="-1"></a>      clf.SVM.r.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb228-1040"><a href="aplikace3.html#cb228-1040" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb228-1041"><a href="aplikace3.html#cb228-1041" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-1042"><a href="aplikace3.html#cb228-1042" tabindex="-1"></a>                              <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb228-1043"><a href="aplikace3.html#cb228-1043" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb228-1044"><a href="aplikace3.html#cb228-1044" tabindex="-1"></a>      <span class="do">## linear kernel</span></span>
<span id="cb228-1045"><a href="aplikace3.html#cb228-1045" tabindex="-1"></a>      predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.projection,</span>
<span id="cb228-1046"><a href="aplikace3.html#cb228-1046" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb228-1047"><a href="aplikace3.html#cb228-1047" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb228-1048"><a href="aplikace3.html#cb228-1048" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-1049"><a href="aplikace3.html#cb228-1049" tabindex="-1"></a>      <span class="do">## polynomial kernel</span></span>
<span id="cb228-1050"><a href="aplikace3.html#cb228-1050" tabindex="-1"></a>      predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.projection, </span>
<span id="cb228-1051"><a href="aplikace3.html#cb228-1051" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb228-1052"><a href="aplikace3.html#cb228-1052" tabindex="-1"></a>      presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb228-1053"><a href="aplikace3.html#cb228-1053" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-1054"><a href="aplikace3.html#cb228-1054" tabindex="-1"></a>      <span class="do">## radial kernel</span></span>
<span id="cb228-1055"><a href="aplikace3.html#cb228-1055" tabindex="-1"></a>      predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.projection,</span>
<span id="cb228-1056"><a href="aplikace3.html#cb228-1056" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb228-1057"><a href="aplikace3.html#cb228-1057" tabindex="-1"></a>      presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb228-1058"><a href="aplikace3.html#cb228-1058" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-1059"><a href="aplikace3.html#cb228-1059" tabindex="-1"></a>      </span>
<span id="cb228-1060"><a href="aplikace3.html#cb228-1060" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane d a fold</span></span>
<span id="cb228-1061"><a href="aplikace3.html#cb228-1061" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb228-1062"><a href="aplikace3.html#cb228-1062" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb228-1063"><a href="aplikace3.html#cb228-1063" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb228-1064"><a href="aplikace3.html#cb228-1064" tabindex="-1"></a>    }</span>
<span id="cb228-1065"><a href="aplikace3.html#cb228-1065" tabindex="-1"></a>  }</span>
<span id="cb228-1066"><a href="aplikace3.html#cb228-1066" tabindex="-1"></a>  </span>
<span id="cb228-1067"><a href="aplikace3.html#cb228-1067" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb228-1068"><a href="aplikace3.html#cb228-1068" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb228-1069"><a href="aplikace3.html#cb228-1069" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb228-1070"><a href="aplikace3.html#cb228-1070" tabindex="-1"></a>  }</span>
<span id="cb228-1071"><a href="aplikace3.html#cb228-1071" tabindex="-1"></a>  </span>
<span id="cb228-1072"><a href="aplikace3.html#cb228-1072" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb228-1073"><a href="aplikace3.html#cb228-1073" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb228-1074"><a href="aplikace3.html#cb228-1074" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb228-1075"><a href="aplikace3.html#cb228-1075" tabindex="-1"></a>  </span>
<span id="cb228-1076"><a href="aplikace3.html#cb228-1076" tabindex="-1"></a>  <span class="co"># ulozime optimalni d do datove tabulky</span></span>
<span id="cb228-1077"><a href="aplikace3.html#cb228-1077" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb228-1078"><a href="aplikace3.html#cb228-1078" tabindex="-1"></a>  </span>
<span id="cb228-1079"><a href="aplikace3.html#cb228-1079" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb228-1080"><a href="aplikace3.html#cb228-1080" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - projection&#39;</span>, </span>
<span id="cb228-1081"><a href="aplikace3.html#cb228-1081" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb228-1082"><a href="aplikace3.html#cb228-1082" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - projection&#39;</span>), </span>
<span id="cb228-1083"><a href="aplikace3.html#cb228-1083" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb228-1084"><a href="aplikace3.html#cb228-1084" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb228-1085"><a href="aplikace3.html#cb228-1085" tabindex="-1"></a>  </span>
<span id="cb228-1086"><a href="aplikace3.html#cb228-1086" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb228-1087"><a href="aplikace3.html#cb228-1087" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb228-1088"><a href="aplikace3.html#cb228-1088" tabindex="-1"></a>    bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb228-1089"><a href="aplikace3.html#cb228-1089" tabindex="-1"></a>                                   <span class="at">nbasis =</span> d.opt[kernel_number])</span>
<span id="cb228-1090"><a href="aplikace3.html#cb228-1090" tabindex="-1"></a>    Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="at">argvals =</span> t, <span class="at">basisobj =</span> bbasis) </span>
<span id="cb228-1091"><a href="aplikace3.html#cb228-1091" tabindex="-1"></a>    </span>
<span id="cb228-1092"><a href="aplikace3.html#cb228-1092" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb228-1093"><a href="aplikace3.html#cb228-1093" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb228-1094"><a href="aplikace3.html#cb228-1094" tabindex="-1"></a>    </span>
<span id="cb228-1095"><a href="aplikace3.html#cb228-1095" tabindex="-1"></a>    data.projection.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train)</span>
<span id="cb228-1096"><a href="aplikace3.html#cb228-1096" tabindex="-1"></a>    data.projection.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb228-1097"><a href="aplikace3.html#cb228-1097" tabindex="-1"></a>    </span>
<span id="cb228-1098"><a href="aplikace3.html#cb228-1098" tabindex="-1"></a>    data.projection.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.test)</span>
<span id="cb228-1099"><a href="aplikace3.html#cb228-1099" tabindex="-1"></a>    data.projection.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb228-1100"><a href="aplikace3.html#cb228-1100" tabindex="-1"></a>    </span>
<span id="cb228-1101"><a href="aplikace3.html#cb228-1101" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb228-1102"><a href="aplikace3.html#cb228-1102" tabindex="-1"></a>    clf.SVM.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train,</span>
<span id="cb228-1103"><a href="aplikace3.html#cb228-1103" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb228-1104"><a href="aplikace3.html#cb228-1104" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-1105"><a href="aplikace3.html#cb228-1105" tabindex="-1"></a>                              <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb228-1106"><a href="aplikace3.html#cb228-1106" tabindex="-1"></a>                              <span class="at">kernel =</span> kernel_type)</span>
<span id="cb228-1107"><a href="aplikace3.html#cb228-1107" tabindex="-1"></a>    </span>
<span id="cb228-1108"><a href="aplikace3.html#cb228-1108" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb228-1109"><a href="aplikace3.html#cb228-1109" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.train)</span>
<span id="cb228-1110"><a href="aplikace3.html#cb228-1110" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb228-1111"><a href="aplikace3.html#cb228-1111" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-1112"><a href="aplikace3.html#cb228-1112" tabindex="-1"></a>      </span>
<span id="cb228-1113"><a href="aplikace3.html#cb228-1113" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb228-1114"><a href="aplikace3.html#cb228-1114" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.test)</span>
<span id="cb228-1115"><a href="aplikace3.html#cb228-1115" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb228-1116"><a href="aplikace3.html#cb228-1116" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-1117"><a href="aplikace3.html#cb228-1117" tabindex="-1"></a>    </span>
<span id="cb228-1118"><a href="aplikace3.html#cb228-1118" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb228-1119"><a href="aplikace3.html#cb228-1119" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb228-1120"><a href="aplikace3.html#cb228-1120" tabindex="-1"></a>  }</span>
<span id="cb228-1121"><a href="aplikace3.html#cb228-1121" tabindex="-1"></a>  </span>
<span id="cb228-1122"><a href="aplikace3.html#cb228-1122" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb228-1123"><a href="aplikace3.html#cb228-1123" tabindex="-1"></a>  </span>
<span id="cb228-1124"><a href="aplikace3.html#cb228-1124" tabindex="-1"></a>  <span class="do">## 7.5) SVM + RKHS</span></span>
<span id="cb228-1125"><a href="aplikace3.html#cb228-1125" tabindex="-1"></a>  </span>
<span id="cb228-1126"><a href="aplikace3.html#cb228-1126" tabindex="-1"></a>  C <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb228-1127"><a href="aplikace3.html#cb228-1127" tabindex="-1"></a>  eps <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb228-1128"><a href="aplikace3.html#cb228-1128" tabindex="-1"></a>  </span>
<span id="cb228-1129"><a href="aplikace3.html#cb228-1129" tabindex="-1"></a>  <span class="do">### Gaussovo jadro</span></span>
<span id="cb228-1130"><a href="aplikace3.html#cb228-1130" tabindex="-1"></a>  </span>
<span id="cb228-1131"><a href="aplikace3.html#cb228-1131" tabindex="-1"></a>  <span class="co"># jadro a jadrova matice ... Gaussovske s parametrem gamma</span></span>
<span id="cb228-1132"><a href="aplikace3.html#cb228-1132" tabindex="-1"></a>  Gauss.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, gamma) {</span>
<span id="cb228-1133"><a href="aplikace3.html#cb228-1133" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>gamma <span class="sc">*</span> <span class="fu">norm</span>(<span class="fu">c</span>(x <span class="sc">-</span> y) <span class="sc">|&gt;</span> <span class="fu">t</span>(), <span class="at">type =</span> <span class="st">&#39;F&#39;</span>)))</span>
<span id="cb228-1134"><a href="aplikace3.html#cb228-1134" tabindex="-1"></a>  }</span>
<span id="cb228-1135"><a href="aplikace3.html#cb228-1135" tabindex="-1"></a>  </span>
<span id="cb228-1136"><a href="aplikace3.html#cb228-1136" tabindex="-1"></a>  Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, gamma) {</span>
<span id="cb228-1137"><a href="aplikace3.html#cb228-1137" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb228-1138"><a href="aplikace3.html#cb228-1138" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb228-1139"><a href="aplikace3.html#cb228-1139" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb228-1140"><a href="aplikace3.html#cb228-1140" tabindex="-1"></a>        K[i, j] <span class="ot">&lt;-</span> <span class="fu">Gauss.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], <span class="at">gamma =</span> gamma)</span>
<span id="cb228-1141"><a href="aplikace3.html#cb228-1141" tabindex="-1"></a>      }</span>
<span id="cb228-1142"><a href="aplikace3.html#cb228-1142" tabindex="-1"></a>    }</span>
<span id="cb228-1143"><a href="aplikace3.html#cb228-1143" tabindex="-1"></a>    <span class="fu">return</span>(K)</span>
<span id="cb228-1144"><a href="aplikace3.html#cb228-1144" tabindex="-1"></a>  }</span>
<span id="cb228-1145"><a href="aplikace3.html#cb228-1145" tabindex="-1"></a>  </span>
<span id="cb228-1146"><a href="aplikace3.html#cb228-1146" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb228-1147"><a href="aplikace3.html#cb228-1147" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb228-1148"><a href="aplikace3.html#cb228-1148" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb228-1149"><a href="aplikace3.html#cb228-1149" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb228-1150"><a href="aplikace3.html#cb228-1150" tabindex="-1"></a>  </span>
<span id="cb228-1151"><a href="aplikace3.html#cb228-1151" tabindex="-1"></a>  <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb228-1152"><a href="aplikace3.html#cb228-1152" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">30</span>, <span class="at">by =</span> <span class="dv">2</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb228-1153"><a href="aplikace3.html#cb228-1153" tabindex="-1"></a>  gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">15</span>)</span>
<span id="cb228-1154"><a href="aplikace3.html#cb228-1154" tabindex="-1"></a>  </span>
<span id="cb228-1155"><a href="aplikace3.html#cb228-1155" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb228-1156"><a href="aplikace3.html#cb228-1156" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb228-1157"><a href="aplikace3.html#cb228-1157" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb228-1158"><a href="aplikace3.html#cb228-1158" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb228-1159"><a href="aplikace3.html#cb228-1159" tabindex="-1"></a>  dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">gamma =</span> <span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma.cv, <span class="dv">3</span>)),</span>
<span id="cb228-1160"><a href="aplikace3.html#cb228-1160" tabindex="-1"></a>                    <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb228-1161"><a href="aplikace3.html#cb228-1161" tabindex="-1"></a>                    <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb228-1162"><a href="aplikace3.html#cb228-1162" tabindex="-1"></a>  </span>
<span id="cb228-1163"><a href="aplikace3.html#cb228-1163" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb228-1164"><a href="aplikace3.html#cb228-1164" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb228-1165"><a href="aplikace3.html#cb228-1165" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb228-1166"><a href="aplikace3.html#cb228-1166" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb228-1167"><a href="aplikace3.html#cb228-1167" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb228-1168"><a href="aplikace3.html#cb228-1168" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb228-1169"><a href="aplikace3.html#cb228-1169" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names))</span>
<span id="cb228-1170"><a href="aplikace3.html#cb228-1170" tabindex="-1"></a>  </span>
<span id="cb228-1171"><a href="aplikace3.html#cb228-1171" tabindex="-1"></a>  <span class="co"># samotna CV</span></span>
<span id="cb228-1172"><a href="aplikace3.html#cb228-1172" tabindex="-1"></a>  <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb228-1173"><a href="aplikace3.html#cb228-1173" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb228-1174"><a href="aplikace3.html#cb228-1174" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb228-1175"><a href="aplikace3.html#cb228-1175" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb228-1176"><a href="aplikace3.html#cb228-1176" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb228-1177"><a href="aplikace3.html#cb228-1177" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb228-1178"><a href="aplikace3.html#cb228-1178" tabindex="-1"></a>    </span>
<span id="cb228-1179"><a href="aplikace3.html#cb228-1179" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb228-1180"><a href="aplikace3.html#cb228-1180" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb228-1181"><a href="aplikace3.html#cb228-1181" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb228-1182"><a href="aplikace3.html#cb228-1182" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb228-1183"><a href="aplikace3.html#cb228-1183" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb228-1184"><a href="aplikace3.html#cb228-1184" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb228-1185"><a href="aplikace3.html#cb228-1185" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb228-1186"><a href="aplikace3.html#cb228-1186" tabindex="-1"></a>                      <span class="at">epsilon =</span> eps, </span>
<span id="cb228-1187"><a href="aplikace3.html#cb228-1187" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb228-1188"><a href="aplikace3.html#cb228-1188" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb228-1189"><a href="aplikace3.html#cb228-1189" tabindex="-1"></a>                      <span class="at">gamma =</span> gamma)</span>
<span id="cb228-1190"><a href="aplikace3.html#cb228-1190" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb228-1191"><a href="aplikace3.html#cb228-1191" tabindex="-1"></a>    }</span>
<span id="cb228-1192"><a href="aplikace3.html#cb228-1192" tabindex="-1"></a>    </span>
<span id="cb228-1193"><a href="aplikace3.html#cb228-1193" tabindex="-1"></a>    <span class="co"># projdeme dimenze</span></span>
<span id="cb228-1194"><a href="aplikace3.html#cb228-1194" tabindex="-1"></a>    <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb228-1195"><a href="aplikace3.html#cb228-1195" tabindex="-1"></a>      Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb228-1196"><a href="aplikace3.html#cb228-1196" tabindex="-1"></a>                            <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb228-1197"><a href="aplikace3.html#cb228-1197" tabindex="-1"></a>                            <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb228-1198"><a href="aplikace3.html#cb228-1198" tabindex="-1"></a>      <span class="co"># vypocet reprezentace</span></span>
<span id="cb228-1199"><a href="aplikace3.html#cb228-1199" tabindex="-1"></a>      <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb228-1200"><a href="aplikace3.html#cb228-1200" tabindex="-1"></a>        Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb228-1201"><a href="aplikace3.html#cb228-1201" tabindex="-1"></a>                               alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb228-1202"><a href="aplikace3.html#cb228-1202" tabindex="-1"></a>      }</span>
<span id="cb228-1203"><a href="aplikace3.html#cb228-1203" tabindex="-1"></a>      <span class="co"># projdeme folds</span></span>
<span id="cb228-1204"><a href="aplikace3.html#cb228-1204" tabindex="-1"></a>      <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb228-1205"><a href="aplikace3.html#cb228-1205" tabindex="-1"></a>        <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb228-1206"><a href="aplikace3.html#cb228-1206" tabindex="-1"></a>        fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb228-1207"><a href="aplikace3.html#cb228-1207" tabindex="-1"></a>        <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb228-1208"><a href="aplikace3.html#cb228-1208" tabindex="-1"></a>        XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb228-1209"><a href="aplikace3.html#cb228-1209" tabindex="-1"></a>        XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb228-1210"><a href="aplikace3.html#cb228-1210" tabindex="-1"></a>        <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb228-1211"><a href="aplikace3.html#cb228-1211" tabindex="-1"></a>        Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb228-1212"><a href="aplikace3.html#cb228-1212" tabindex="-1"></a>                                    <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb228-1213"><a href="aplikace3.html#cb228-1213" tabindex="-1"></a>                                    <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb228-1214"><a href="aplikace3.html#cb228-1214" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb228-1215"><a href="aplikace3.html#cb228-1215" tabindex="-1"></a>        <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb228-1216"><a href="aplikace3.html#cb228-1216" tabindex="-1"></a>        <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb228-1217"><a href="aplikace3.html#cb228-1217" tabindex="-1"></a>          kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb228-1218"><a href="aplikace3.html#cb228-1218" tabindex="-1"></a>        </span>
<span id="cb228-1219"><a href="aplikace3.html#cb228-1219" tabindex="-1"></a>          data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb228-1220"><a href="aplikace3.html#cb228-1220" tabindex="-1"></a>          data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb228-1221"><a href="aplikace3.html#cb228-1221" tabindex="-1"></a>          </span>
<span id="cb228-1222"><a href="aplikace3.html#cb228-1222" tabindex="-1"></a>          data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb228-1223"><a href="aplikace3.html#cb228-1223" tabindex="-1"></a>          data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb228-1224"><a href="aplikace3.html#cb228-1224" tabindex="-1"></a>          </span>
<span id="cb228-1225"><a href="aplikace3.html#cb228-1225" tabindex="-1"></a>          <span class="co"># sestrojeni modelu</span></span>
<span id="cb228-1226"><a href="aplikace3.html#cb228-1226" tabindex="-1"></a>          clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb228-1227"><a href="aplikace3.html#cb228-1227" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb228-1228"><a href="aplikace3.html#cb228-1228" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-1229"><a href="aplikace3.html#cb228-1229" tabindex="-1"></a>                              <span class="at">cost =</span> C,</span>
<span id="cb228-1230"><a href="aplikace3.html#cb228-1230" tabindex="-1"></a>                              <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb228-1231"><a href="aplikace3.html#cb228-1231" tabindex="-1"></a>                              <span class="at">kernel =</span> kernel_type)</span>
<span id="cb228-1232"><a href="aplikace3.html#cb228-1232" tabindex="-1"></a>          </span>
<span id="cb228-1233"><a href="aplikace3.html#cb228-1233" tabindex="-1"></a>          <span class="co"># presnost na validacnich datech</span></span>
<span id="cb228-1234"><a href="aplikace3.html#cb228-1234" tabindex="-1"></a>          predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb228-1235"><a href="aplikace3.html#cb228-1235" tabindex="-1"></a>          presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb228-1236"><a href="aplikace3.html#cb228-1236" tabindex="-1"></a>            <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-1237"><a href="aplikace3.html#cb228-1237" tabindex="-1"></a>          </span>
<span id="cb228-1238"><a href="aplikace3.html#cb228-1238" tabindex="-1"></a>          <span class="co"># ulozeni vysledku</span></span>
<span id="cb228-1239"><a href="aplikace3.html#cb228-1239" tabindex="-1"></a>          Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb228-1240"><a href="aplikace3.html#cb228-1240" tabindex="-1"></a>        }</span>
<span id="cb228-1241"><a href="aplikace3.html#cb228-1241" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb228-1242"><a href="aplikace3.html#cb228-1242" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb228-1243"><a href="aplikace3.html#cb228-1243" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb228-1244"><a href="aplikace3.html#cb228-1244" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb228-1245"><a href="aplikace3.html#cb228-1245" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb228-1246"><a href="aplikace3.html#cb228-1246" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb228-1247"><a href="aplikace3.html#cb228-1247" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb228-1248"><a href="aplikace3.html#cb228-1248" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb228-1249"><a href="aplikace3.html#cb228-1249" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb228-1250"><a href="aplikace3.html#cb228-1250" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb228-1251"><a href="aplikace3.html#cb228-1251" tabindex="-1"></a>      }</span>
<span id="cb228-1252"><a href="aplikace3.html#cb228-1252" tabindex="-1"></a>    }</span>
<span id="cb228-1253"><a href="aplikace3.html#cb228-1253" tabindex="-1"></a>  }</span>
<span id="cb228-1254"><a href="aplikace3.html#cb228-1254" tabindex="-1"></a>  </span>
<span id="cb228-1255"><a href="aplikace3.html#cb228-1255" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb228-1256"><a href="aplikace3.html#cb228-1256" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb228-1257"><a href="aplikace3.html#cb228-1257" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb228-1258"><a href="aplikace3.html#cb228-1258" tabindex="-1"></a>  }</span>
<span id="cb228-1259"><a href="aplikace3.html#cb228-1259" tabindex="-1"></a>  </span>
<span id="cb228-1260"><a href="aplikace3.html#cb228-1260" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb228-1261"><a href="aplikace3.html#cb228-1261" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb228-1262"><a href="aplikace3.html#cb228-1262" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv))</span>
<span id="cb228-1263"><a href="aplikace3.html#cb228-1263" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb228-1264"><a href="aplikace3.html#cb228-1264" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb228-1265"><a href="aplikace3.html#cb228-1265" tabindex="-1"></a>  </span>
<span id="cb228-1266"><a href="aplikace3.html#cb228-1266" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb228-1267"><a href="aplikace3.html#cb228-1267" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb228-1268"><a href="aplikace3.html#cb228-1268" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb228-1269"><a href="aplikace3.html#cb228-1269" tabindex="-1"></a>  d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb228-1270"><a href="aplikace3.html#cb228-1270" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb228-1271"><a href="aplikace3.html#cb228-1271" tabindex="-1"></a>  </span>
<span id="cb228-1272"><a href="aplikace3.html#cb228-1272" tabindex="-1"></a>  err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb228-1273"><a href="aplikace3.html#cb228-1273" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb228-1274"><a href="aplikace3.html#cb228-1274" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb228-1275"><a href="aplikace3.html#cb228-1275" tabindex="-1"></a>  df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">gamma =</span> gamma.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb228-1276"><a href="aplikace3.html#cb228-1276" tabindex="-1"></a>             <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb228-1277"><a href="aplikace3.html#cb228-1277" tabindex="-1"></a>             <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb228-1278"><a href="aplikace3.html#cb228-1278" tabindex="-1"></a>  </span>
<span id="cb228-1279"><a href="aplikace3.html#cb228-1279" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>] <span class="ot">&lt;-</span> gamma.opt</span>
<span id="cb228-1280"><a href="aplikace3.html#cb228-1280" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb228-1281"><a href="aplikace3.html#cb228-1281" tabindex="-1"></a>  </span>
<span id="cb228-1282"><a href="aplikace3.html#cb228-1282" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb228-1283"><a href="aplikace3.html#cb228-1283" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb228-1284"><a href="aplikace3.html#cb228-1284" tabindex="-1"></a>  <span class="co"># pridame i testovaci data</span></span>
<span id="cb228-1285"><a href="aplikace3.html#cb228-1285" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb228-1286"><a href="aplikace3.html#cb228-1286" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb228-1287"><a href="aplikace3.html#cb228-1287" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, </span>
<span id="cb228-1288"><a href="aplikace3.html#cb228-1288" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, </span>
<span id="cb228-1289"><a href="aplikace3.html#cb228-1289" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>), </span>
<span id="cb228-1290"><a href="aplikace3.html#cb228-1290" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb228-1291"><a href="aplikace3.html#cb228-1291" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb228-1292"><a href="aplikace3.html#cb228-1292" tabindex="-1"></a>  </span>
<span id="cb228-1293"><a href="aplikace3.html#cb228-1293" tabindex="-1"></a>  <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb228-1294"><a href="aplikace3.html#cb228-1294" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb228-1295"><a href="aplikace3.html#cb228-1295" tabindex="-1"></a>    <span class="co"># spocitame matici K</span></span>
<span id="cb228-1296"><a href="aplikace3.html#cb228-1296" tabindex="-1"></a>    gamma <span class="ot">&lt;-</span> gamma.opt[kernel_number] <span class="co"># hodnota gamma pomoci CV</span></span>
<span id="cb228-1297"><a href="aplikace3.html#cb228-1297" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb228-1298"><a href="aplikace3.html#cb228-1298" tabindex="-1"></a>    </span>
<span id="cb228-1299"><a href="aplikace3.html#cb228-1299" tabindex="-1"></a>    <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb228-1300"><a href="aplikace3.html#cb228-1300" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb228-1301"><a href="aplikace3.html#cb228-1301" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb228-1302"><a href="aplikace3.html#cb228-1302" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb228-1303"><a href="aplikace3.html#cb228-1303" tabindex="-1"></a>    <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb228-1304"><a href="aplikace3.html#cb228-1304" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb228-1305"><a href="aplikace3.html#cb228-1305" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb228-1306"><a href="aplikace3.html#cb228-1306" tabindex="-1"></a>    </span>
<span id="cb228-1307"><a href="aplikace3.html#cb228-1307" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb228-1308"><a href="aplikace3.html#cb228-1308" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb228-1309"><a href="aplikace3.html#cb228-1309" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb228-1310"><a href="aplikace3.html#cb228-1310" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb228-1311"><a href="aplikace3.html#cb228-1311" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb228-1312"><a href="aplikace3.html#cb228-1312" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb228-1313"><a href="aplikace3.html#cb228-1313" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb228-1314"><a href="aplikace3.html#cb228-1314" tabindex="-1"></a>                      <span class="at">epsilon =</span> eps,</span>
<span id="cb228-1315"><a href="aplikace3.html#cb228-1315" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb228-1316"><a href="aplikace3.html#cb228-1316" tabindex="-1"></a>                      <span class="at">gamma =</span> gamma)</span>
<span id="cb228-1317"><a href="aplikace3.html#cb228-1317" tabindex="-1"></a>      <span class="co"># urceni alpha</span></span>
<span id="cb228-1318"><a href="aplikace3.html#cb228-1318" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb228-1319"><a href="aplikace3.html#cb228-1319" tabindex="-1"></a>    }</span>
<span id="cb228-1320"><a href="aplikace3.html#cb228-1320" tabindex="-1"></a>    <span class="co"># d</span></span>
<span id="cb228-1321"><a href="aplikace3.html#cb228-1321" tabindex="-1"></a>    d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb228-1322"><a href="aplikace3.html#cb228-1322" tabindex="-1"></a>    </span>
<span id="cb228-1323"><a href="aplikace3.html#cb228-1323" tabindex="-1"></a>    <span class="co"># urceni vektoru lambda</span></span>
<span id="cb228-1324"><a href="aplikace3.html#cb228-1324" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb228-1325"><a href="aplikace3.html#cb228-1325" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb228-1326"><a href="aplikace3.html#cb228-1326" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb228-1327"><a href="aplikace3.html#cb228-1327" tabindex="-1"></a>    </span>
<span id="cb228-1328"><a href="aplikace3.html#cb228-1328" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb228-1329"><a href="aplikace3.html#cb228-1329" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb228-1330"><a href="aplikace3.html#cb228-1330" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb228-1331"><a href="aplikace3.html#cb228-1331" tabindex="-1"></a>    }</span>
<span id="cb228-1332"><a href="aplikace3.html#cb228-1332" tabindex="-1"></a>    </span>
<span id="cb228-1333"><a href="aplikace3.html#cb228-1333" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb228-1334"><a href="aplikace3.html#cb228-1334" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb228-1335"><a href="aplikace3.html#cb228-1335" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb228-1336"><a href="aplikace3.html#cb228-1336" tabindex="-1"></a>  </span>
<span id="cb228-1337"><a href="aplikace3.html#cb228-1337" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb228-1338"><a href="aplikace3.html#cb228-1338" tabindex="-1"></a>  </span>
<span id="cb228-1339"><a href="aplikace3.html#cb228-1339" tabindex="-1"></a>    data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb228-1340"><a href="aplikace3.html#cb228-1340" tabindex="-1"></a>    data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb228-1341"><a href="aplikace3.html#cb228-1341" tabindex="-1"></a>    </span>
<span id="cb228-1342"><a href="aplikace3.html#cb228-1342" tabindex="-1"></a>    data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb228-1343"><a href="aplikace3.html#cb228-1343" tabindex="-1"></a>    data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb228-1344"><a href="aplikace3.html#cb228-1344" tabindex="-1"></a>    </span>
<span id="cb228-1345"><a href="aplikace3.html#cb228-1345" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb228-1346"><a href="aplikace3.html#cb228-1346" tabindex="-1"></a>    clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb228-1347"><a href="aplikace3.html#cb228-1347" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb228-1348"><a href="aplikace3.html#cb228-1348" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-1349"><a href="aplikace3.html#cb228-1349" tabindex="-1"></a>                        <span class="at">cost =</span> C,</span>
<span id="cb228-1350"><a href="aplikace3.html#cb228-1350" tabindex="-1"></a>                        <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb228-1351"><a href="aplikace3.html#cb228-1351" tabindex="-1"></a>                        <span class="at">kernel =</span> kernel_type)</span>
<span id="cb228-1352"><a href="aplikace3.html#cb228-1352" tabindex="-1"></a>    </span>
<span id="cb228-1353"><a href="aplikace3.html#cb228-1353" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb228-1354"><a href="aplikace3.html#cb228-1354" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb228-1355"><a href="aplikace3.html#cb228-1355" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb228-1356"><a href="aplikace3.html#cb228-1356" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-1357"><a href="aplikace3.html#cb228-1357" tabindex="-1"></a>      </span>
<span id="cb228-1358"><a href="aplikace3.html#cb228-1358" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb228-1359"><a href="aplikace3.html#cb228-1359" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb228-1360"><a href="aplikace3.html#cb228-1360" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb228-1361"><a href="aplikace3.html#cb228-1361" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-1362"><a href="aplikace3.html#cb228-1362" tabindex="-1"></a>    </span>
<span id="cb228-1363"><a href="aplikace3.html#cb228-1363" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb228-1364"><a href="aplikace3.html#cb228-1364" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb228-1365"><a href="aplikace3.html#cb228-1365" tabindex="-1"></a>  }</span>
<span id="cb228-1366"><a href="aplikace3.html#cb228-1366" tabindex="-1"></a>  </span>
<span id="cb228-1367"><a href="aplikace3.html#cb228-1367" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb228-1368"><a href="aplikace3.html#cb228-1368" tabindex="-1"></a></span>
<span id="cb228-1369"><a href="aplikace3.html#cb228-1369" tabindex="-1"></a>  <span class="do">### Polynomialni jadro</span></span>
<span id="cb228-1370"><a href="aplikace3.html#cb228-1370" tabindex="-1"></a>  </span>
<span id="cb228-1371"><a href="aplikace3.html#cb228-1371" tabindex="-1"></a>  <span class="co"># jadro a jadrova matice ... polynomialni s parametrem p</span></span>
<span id="cb228-1372"><a href="aplikace3.html#cb228-1372" tabindex="-1"></a>  Poly.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, p) {</span>
<span id="cb228-1373"><a href="aplikace3.html#cb228-1373" tabindex="-1"></a>    <span class="fu">return</span>((<span class="dv">1</span> <span class="sc">+</span> x <span class="sc">*</span> y)<span class="sc">^</span>p)</span>
<span id="cb228-1374"><a href="aplikace3.html#cb228-1374" tabindex="-1"></a>  }</span>
<span id="cb228-1375"><a href="aplikace3.html#cb228-1375" tabindex="-1"></a>  </span>
<span id="cb228-1376"><a href="aplikace3.html#cb228-1376" tabindex="-1"></a>  Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, p) {</span>
<span id="cb228-1377"><a href="aplikace3.html#cb228-1377" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb228-1378"><a href="aplikace3.html#cb228-1378" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb228-1379"><a href="aplikace3.html#cb228-1379" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb228-1380"><a href="aplikace3.html#cb228-1380" tabindex="-1"></a>        K[i, j] <span class="ot">&lt;-</span> <span class="fu">Poly.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], p)</span>
<span id="cb228-1381"><a href="aplikace3.html#cb228-1381" tabindex="-1"></a>      }</span>
<span id="cb228-1382"><a href="aplikace3.html#cb228-1382" tabindex="-1"></a>    }</span>
<span id="cb228-1383"><a href="aplikace3.html#cb228-1383" tabindex="-1"></a>    <span class="fu">return</span>(K)</span>
<span id="cb228-1384"><a href="aplikace3.html#cb228-1384" tabindex="-1"></a>  }</span>
<span id="cb228-1385"><a href="aplikace3.html#cb228-1385" tabindex="-1"></a>  </span>
<span id="cb228-1386"><a href="aplikace3.html#cb228-1386" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb228-1387"><a href="aplikace3.html#cb228-1387" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb228-1388"><a href="aplikace3.html#cb228-1388" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb228-1389"><a href="aplikace3.html#cb228-1389" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb228-1390"><a href="aplikace3.html#cb228-1390" tabindex="-1"></a>  </span>
<span id="cb228-1391"><a href="aplikace3.html#cb228-1391" tabindex="-1"></a>  <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb228-1392"><a href="aplikace3.html#cb228-1392" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb228-1393"><a href="aplikace3.html#cb228-1393" tabindex="-1"></a>  poly.cv <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb228-1394"><a href="aplikace3.html#cb228-1394" tabindex="-1"></a>  </span>
<span id="cb228-1395"><a href="aplikace3.html#cb228-1395" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb228-1396"><a href="aplikace3.html#cb228-1396" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb228-1397"><a href="aplikace3.html#cb228-1397" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb228-1398"><a href="aplikace3.html#cb228-1398" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro dane p a vrstvy odpovidaji folds</span></span>
<span id="cb228-1399"><a href="aplikace3.html#cb228-1399" tabindex="-1"></a>  dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, poly.cv),</span>
<span id="cb228-1400"><a href="aplikace3.html#cb228-1400" tabindex="-1"></a>                    <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb228-1401"><a href="aplikace3.html#cb228-1401" tabindex="-1"></a>                    <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb228-1402"><a href="aplikace3.html#cb228-1402" tabindex="-1"></a>  </span>
<span id="cb228-1403"><a href="aplikace3.html#cb228-1403" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb228-1404"><a href="aplikace3.html#cb228-1404" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb228-1405"><a href="aplikace3.html#cb228-1405" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb228-1406"><a href="aplikace3.html#cb228-1406" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb228-1407"><a href="aplikace3.html#cb228-1407" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb228-1408"><a href="aplikace3.html#cb228-1408" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb228-1409"><a href="aplikace3.html#cb228-1409" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names))</span>
<span id="cb228-1410"><a href="aplikace3.html#cb228-1410" tabindex="-1"></a>  </span>
<span id="cb228-1411"><a href="aplikace3.html#cb228-1411" tabindex="-1"></a>  <span class="co"># samotna CV</span></span>
<span id="cb228-1412"><a href="aplikace3.html#cb228-1412" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> poly.cv) {</span>
<span id="cb228-1413"><a href="aplikace3.html#cb228-1413" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb228-1414"><a href="aplikace3.html#cb228-1414" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb228-1415"><a href="aplikace3.html#cb228-1415" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb228-1416"><a href="aplikace3.html#cb228-1416" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb228-1417"><a href="aplikace3.html#cb228-1417" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb228-1418"><a href="aplikace3.html#cb228-1418" tabindex="-1"></a>    </span>
<span id="cb228-1419"><a href="aplikace3.html#cb228-1419" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb228-1420"><a href="aplikace3.html#cb228-1420" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb228-1421"><a href="aplikace3.html#cb228-1421" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb228-1422"><a href="aplikace3.html#cb228-1422" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb228-1423"><a href="aplikace3.html#cb228-1423" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb228-1424"><a href="aplikace3.html#cb228-1424" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb228-1425"><a href="aplikace3.html#cb228-1425" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb228-1426"><a href="aplikace3.html#cb228-1426" tabindex="-1"></a>                      <span class="at">epsilon =</span> eps,                   </span>
<span id="cb228-1427"><a href="aplikace3.html#cb228-1427" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb228-1428"><a href="aplikace3.html#cb228-1428" tabindex="-1"></a>                      <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb228-1429"><a href="aplikace3.html#cb228-1429" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb228-1430"><a href="aplikace3.html#cb228-1430" tabindex="-1"></a>                      <span class="at">degree =</span> p)</span>
<span id="cb228-1431"><a href="aplikace3.html#cb228-1431" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb228-1432"><a href="aplikace3.html#cb228-1432" tabindex="-1"></a>    }</span>
<span id="cb228-1433"><a href="aplikace3.html#cb228-1433" tabindex="-1"></a>    </span>
<span id="cb228-1434"><a href="aplikace3.html#cb228-1434" tabindex="-1"></a>    <span class="co"># projdeme dimenze</span></span>
<span id="cb228-1435"><a href="aplikace3.html#cb228-1435" tabindex="-1"></a>    <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb228-1436"><a href="aplikace3.html#cb228-1436" tabindex="-1"></a>      Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb228-1437"><a href="aplikace3.html#cb228-1437" tabindex="-1"></a>                            <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb228-1438"><a href="aplikace3.html#cb228-1438" tabindex="-1"></a>                            <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb228-1439"><a href="aplikace3.html#cb228-1439" tabindex="-1"></a>      <span class="co"># vypocet reprezentace</span></span>
<span id="cb228-1440"><a href="aplikace3.html#cb228-1440" tabindex="-1"></a>      <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb228-1441"><a href="aplikace3.html#cb228-1441" tabindex="-1"></a>        Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb228-1442"><a href="aplikace3.html#cb228-1442" tabindex="-1"></a>                               alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb228-1443"><a href="aplikace3.html#cb228-1443" tabindex="-1"></a>      }</span>
<span id="cb228-1444"><a href="aplikace3.html#cb228-1444" tabindex="-1"></a>      <span class="co"># projdeme folds</span></span>
<span id="cb228-1445"><a href="aplikace3.html#cb228-1445" tabindex="-1"></a>      <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb228-1446"><a href="aplikace3.html#cb228-1446" tabindex="-1"></a>        <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb228-1447"><a href="aplikace3.html#cb228-1447" tabindex="-1"></a>        fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb228-1448"><a href="aplikace3.html#cb228-1448" tabindex="-1"></a>        <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb228-1449"><a href="aplikace3.html#cb228-1449" tabindex="-1"></a>        XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb228-1450"><a href="aplikace3.html#cb228-1450" tabindex="-1"></a>        XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb228-1451"><a href="aplikace3.html#cb228-1451" tabindex="-1"></a>        <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb228-1452"><a href="aplikace3.html#cb228-1452" tabindex="-1"></a>        Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb228-1453"><a href="aplikace3.html#cb228-1453" tabindex="-1"></a>                                    <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb228-1454"><a href="aplikace3.html#cb228-1454" tabindex="-1"></a>                                    <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb228-1455"><a href="aplikace3.html#cb228-1455" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb228-1456"><a href="aplikace3.html#cb228-1456" tabindex="-1"></a>        <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb228-1457"><a href="aplikace3.html#cb228-1457" tabindex="-1"></a>        <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb228-1458"><a href="aplikace3.html#cb228-1458" tabindex="-1"></a>          kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb228-1459"><a href="aplikace3.html#cb228-1459" tabindex="-1"></a>        </span>
<span id="cb228-1460"><a href="aplikace3.html#cb228-1460" tabindex="-1"></a>          data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb228-1461"><a href="aplikace3.html#cb228-1461" tabindex="-1"></a>          data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb228-1462"><a href="aplikace3.html#cb228-1462" tabindex="-1"></a>          </span>
<span id="cb228-1463"><a href="aplikace3.html#cb228-1463" tabindex="-1"></a>          data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb228-1464"><a href="aplikace3.html#cb228-1464" tabindex="-1"></a>          data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb228-1465"><a href="aplikace3.html#cb228-1465" tabindex="-1"></a>          </span>
<span id="cb228-1466"><a href="aplikace3.html#cb228-1466" tabindex="-1"></a>          <span class="co"># sestrojeni modelu</span></span>
<span id="cb228-1467"><a href="aplikace3.html#cb228-1467" tabindex="-1"></a>          clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb228-1468"><a href="aplikace3.html#cb228-1468" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb228-1469"><a href="aplikace3.html#cb228-1469" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-1470"><a href="aplikace3.html#cb228-1470" tabindex="-1"></a>                              <span class="at">epsilon =</span> eps,                   </span>
<span id="cb228-1471"><a href="aplikace3.html#cb228-1471" tabindex="-1"></a>                              <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb228-1472"><a href="aplikace3.html#cb228-1472" tabindex="-1"></a>                              <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb228-1473"><a href="aplikace3.html#cb228-1473" tabindex="-1"></a>                              <span class="at">cost =</span> C,</span>
<span id="cb228-1474"><a href="aplikace3.html#cb228-1474" tabindex="-1"></a>                              <span class="at">kernel =</span> kernel_type)</span>
<span id="cb228-1475"><a href="aplikace3.html#cb228-1475" tabindex="-1"></a>          </span>
<span id="cb228-1476"><a href="aplikace3.html#cb228-1476" tabindex="-1"></a>          <span class="co"># presnost na validacnich datech</span></span>
<span id="cb228-1477"><a href="aplikace3.html#cb228-1477" tabindex="-1"></a>          predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb228-1478"><a href="aplikace3.html#cb228-1478" tabindex="-1"></a>          presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb228-1479"><a href="aplikace3.html#cb228-1479" tabindex="-1"></a>            <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-1480"><a href="aplikace3.html#cb228-1480" tabindex="-1"></a>          </span>
<span id="cb228-1481"><a href="aplikace3.html#cb228-1481" tabindex="-1"></a>          <span class="co"># ulozeni vysledku</span></span>
<span id="cb228-1482"><a href="aplikace3.html#cb228-1482" tabindex="-1"></a>          Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb228-1483"><a href="aplikace3.html#cb228-1483" tabindex="-1"></a>        }</span>
<span id="cb228-1484"><a href="aplikace3.html#cb228-1484" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb228-1485"><a href="aplikace3.html#cb228-1485" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb228-1486"><a href="aplikace3.html#cb228-1486" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb228-1487"><a href="aplikace3.html#cb228-1487" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb228-1488"><a href="aplikace3.html#cb228-1488" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb228-1489"><a href="aplikace3.html#cb228-1489" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb228-1490"><a href="aplikace3.html#cb228-1490" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb228-1491"><a href="aplikace3.html#cb228-1491" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb228-1492"><a href="aplikace3.html#cb228-1492" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb228-1493"><a href="aplikace3.html#cb228-1493" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb228-1494"><a href="aplikace3.html#cb228-1494" tabindex="-1"></a>      }</span>
<span id="cb228-1495"><a href="aplikace3.html#cb228-1495" tabindex="-1"></a>    }</span>
<span id="cb228-1496"><a href="aplikace3.html#cb228-1496" tabindex="-1"></a>  }</span>
<span id="cb228-1497"><a href="aplikace3.html#cb228-1497" tabindex="-1"></a>  </span>
<span id="cb228-1498"><a href="aplikace3.html#cb228-1498" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb228-1499"><a href="aplikace3.html#cb228-1499" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb228-1500"><a href="aplikace3.html#cb228-1500" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb228-1501"><a href="aplikace3.html#cb228-1501" tabindex="-1"></a>  }</span>
<span id="cb228-1502"><a href="aplikace3.html#cb228-1502" tabindex="-1"></a>  </span>
<span id="cb228-1503"><a href="aplikace3.html#cb228-1503" tabindex="-1"></a>  poly.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb228-1504"><a href="aplikace3.html#cb228-1504" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb228-1505"><a href="aplikace3.html#cb228-1505" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv))</span>
<span id="cb228-1506"><a href="aplikace3.html#cb228-1506" tabindex="-1"></a>  poly.opt[poly.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(poly.cv)</span>
<span id="cb228-1507"><a href="aplikace3.html#cb228-1507" tabindex="-1"></a>  poly.opt <span class="ot">&lt;-</span> poly.cv[poly.opt]</span>
<span id="cb228-1508"><a href="aplikace3.html#cb228-1508" tabindex="-1"></a>  </span>
<span id="cb228-1509"><a href="aplikace3.html#cb228-1509" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb228-1510"><a href="aplikace3.html#cb228-1510" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb228-1511"><a href="aplikace3.html#cb228-1511" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb228-1512"><a href="aplikace3.html#cb228-1512" tabindex="-1"></a>  d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb228-1513"><a href="aplikace3.html#cb228-1513" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb228-1514"><a href="aplikace3.html#cb228-1514" tabindex="-1"></a>  </span>
<span id="cb228-1515"><a href="aplikace3.html#cb228-1515" tabindex="-1"></a>  err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb228-1516"><a href="aplikace3.html#cb228-1516" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb228-1517"><a href="aplikace3.html#cb228-1517" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb228-1518"><a href="aplikace3.html#cb228-1518" tabindex="-1"></a>  df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">p =</span> poly.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb228-1519"><a href="aplikace3.html#cb228-1519" tabindex="-1"></a>             <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb228-1520"><a href="aplikace3.html#cb228-1520" tabindex="-1"></a>             <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb228-1521"><a href="aplikace3.html#cb228-1521" tabindex="-1"></a>  </span>
<span id="cb228-1522"><a href="aplikace3.html#cb228-1522" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">13</span><span class="sc">:</span><span class="dv">15</span>] <span class="ot">&lt;-</span> poly.opt</span>
<span id="cb228-1523"><a href="aplikace3.html#cb228-1523" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">16</span><span class="sc">:</span><span class="dv">18</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb228-1524"><a href="aplikace3.html#cb228-1524" tabindex="-1"></a>  </span>
<span id="cb228-1525"><a href="aplikace3.html#cb228-1525" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb228-1526"><a href="aplikace3.html#cb228-1526" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb228-1527"><a href="aplikace3.html#cb228-1527" tabindex="-1"></a>  <span class="co"># pridame i testovaci data</span></span>
<span id="cb228-1528"><a href="aplikace3.html#cb228-1528" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb228-1529"><a href="aplikace3.html#cb228-1529" tabindex="-1"></a>  </span>
<span id="cb228-1530"><a href="aplikace3.html#cb228-1530" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb228-1531"><a href="aplikace3.html#cb228-1531" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - poly&#39;</span>, </span>
<span id="cb228-1532"><a href="aplikace3.html#cb228-1532" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - RKHS - poly&#39;</span>, </span>
<span id="cb228-1533"><a href="aplikace3.html#cb228-1533" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - RKHS - poly&#39;</span>), </span>
<span id="cb228-1534"><a href="aplikace3.html#cb228-1534" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb228-1535"><a href="aplikace3.html#cb228-1535" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb228-1536"><a href="aplikace3.html#cb228-1536" tabindex="-1"></a>  </span>
<span id="cb228-1537"><a href="aplikace3.html#cb228-1537" tabindex="-1"></a>  <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb228-1538"><a href="aplikace3.html#cb228-1538" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb228-1539"><a href="aplikace3.html#cb228-1539" tabindex="-1"></a>    <span class="co"># spocitame matici K</span></span>
<span id="cb228-1540"><a href="aplikace3.html#cb228-1540" tabindex="-1"></a>    p <span class="ot">&lt;-</span> poly.opt[kernel_number] <span class="co"># hodnota gamma pomoci CV</span></span>
<span id="cb228-1541"><a href="aplikace3.html#cb228-1541" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb228-1542"><a href="aplikace3.html#cb228-1542" tabindex="-1"></a>    </span>
<span id="cb228-1543"><a href="aplikace3.html#cb228-1543" tabindex="-1"></a>    <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb228-1544"><a href="aplikace3.html#cb228-1544" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb228-1545"><a href="aplikace3.html#cb228-1545" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb228-1546"><a href="aplikace3.html#cb228-1546" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb228-1547"><a href="aplikace3.html#cb228-1547" tabindex="-1"></a>    <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb228-1548"><a href="aplikace3.html#cb228-1548" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb228-1549"><a href="aplikace3.html#cb228-1549" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb228-1550"><a href="aplikace3.html#cb228-1550" tabindex="-1"></a>    </span>
<span id="cb228-1551"><a href="aplikace3.html#cb228-1551" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb228-1552"><a href="aplikace3.html#cb228-1552" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb228-1553"><a href="aplikace3.html#cb228-1553" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb228-1554"><a href="aplikace3.html#cb228-1554" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb228-1555"><a href="aplikace3.html#cb228-1555" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb228-1556"><a href="aplikace3.html#cb228-1556" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb228-1557"><a href="aplikace3.html#cb228-1557" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb228-1558"><a href="aplikace3.html#cb228-1558" tabindex="-1"></a>                      <span class="at">epsilon =</span> eps,                   </span>
<span id="cb228-1559"><a href="aplikace3.html#cb228-1559" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb228-1560"><a href="aplikace3.html#cb228-1560" tabindex="-1"></a>                      <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb228-1561"><a href="aplikace3.html#cb228-1561" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb228-1562"><a href="aplikace3.html#cb228-1562" tabindex="-1"></a>                      <span class="at">degree =</span> p)</span>
<span id="cb228-1563"><a href="aplikace3.html#cb228-1563" tabindex="-1"></a>      <span class="co"># urceni alpha</span></span>
<span id="cb228-1564"><a href="aplikace3.html#cb228-1564" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb228-1565"><a href="aplikace3.html#cb228-1565" tabindex="-1"></a>    }</span>
<span id="cb228-1566"><a href="aplikace3.html#cb228-1566" tabindex="-1"></a>    <span class="co"># d</span></span>
<span id="cb228-1567"><a href="aplikace3.html#cb228-1567" tabindex="-1"></a>    d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb228-1568"><a href="aplikace3.html#cb228-1568" tabindex="-1"></a>    </span>
<span id="cb228-1569"><a href="aplikace3.html#cb228-1569" tabindex="-1"></a>    <span class="co"># urceni vektoru lambda</span></span>
<span id="cb228-1570"><a href="aplikace3.html#cb228-1570" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb228-1571"><a href="aplikace3.html#cb228-1571" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb228-1572"><a href="aplikace3.html#cb228-1572" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb228-1573"><a href="aplikace3.html#cb228-1573" tabindex="-1"></a>    </span>
<span id="cb228-1574"><a href="aplikace3.html#cb228-1574" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb228-1575"><a href="aplikace3.html#cb228-1575" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb228-1576"><a href="aplikace3.html#cb228-1576" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb228-1577"><a href="aplikace3.html#cb228-1577" tabindex="-1"></a>    }</span>
<span id="cb228-1578"><a href="aplikace3.html#cb228-1578" tabindex="-1"></a>    </span>
<span id="cb228-1579"><a href="aplikace3.html#cb228-1579" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb228-1580"><a href="aplikace3.html#cb228-1580" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb228-1581"><a href="aplikace3.html#cb228-1581" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb228-1582"><a href="aplikace3.html#cb228-1582" tabindex="-1"></a>  </span>
<span id="cb228-1583"><a href="aplikace3.html#cb228-1583" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb228-1584"><a href="aplikace3.html#cb228-1584" tabindex="-1"></a>  </span>
<span id="cb228-1585"><a href="aplikace3.html#cb228-1585" tabindex="-1"></a>    data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb228-1586"><a href="aplikace3.html#cb228-1586" tabindex="-1"></a>    data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb228-1587"><a href="aplikace3.html#cb228-1587" tabindex="-1"></a>    </span>
<span id="cb228-1588"><a href="aplikace3.html#cb228-1588" tabindex="-1"></a>    data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb228-1589"><a href="aplikace3.html#cb228-1589" tabindex="-1"></a>    data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb228-1590"><a href="aplikace3.html#cb228-1590" tabindex="-1"></a>    </span>
<span id="cb228-1591"><a href="aplikace3.html#cb228-1591" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb228-1592"><a href="aplikace3.html#cb228-1592" tabindex="-1"></a>    clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb228-1593"><a href="aplikace3.html#cb228-1593" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb228-1594"><a href="aplikace3.html#cb228-1594" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-1595"><a href="aplikace3.html#cb228-1595" tabindex="-1"></a>                        <span class="at">epsilon =</span> eps,                   </span>
<span id="cb228-1596"><a href="aplikace3.html#cb228-1596" tabindex="-1"></a>                        <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb228-1597"><a href="aplikace3.html#cb228-1597" tabindex="-1"></a>                        <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb228-1598"><a href="aplikace3.html#cb228-1598" tabindex="-1"></a>                        <span class="at">cost =</span> C,</span>
<span id="cb228-1599"><a href="aplikace3.html#cb228-1599" tabindex="-1"></a>                        <span class="at">kernel =</span> kernel_type)</span>
<span id="cb228-1600"><a href="aplikace3.html#cb228-1600" tabindex="-1"></a>    </span>
<span id="cb228-1601"><a href="aplikace3.html#cb228-1601" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb228-1602"><a href="aplikace3.html#cb228-1602" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb228-1603"><a href="aplikace3.html#cb228-1603" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb228-1604"><a href="aplikace3.html#cb228-1604" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-1605"><a href="aplikace3.html#cb228-1605" tabindex="-1"></a>      </span>
<span id="cb228-1606"><a href="aplikace3.html#cb228-1606" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb228-1607"><a href="aplikace3.html#cb228-1607" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb228-1608"><a href="aplikace3.html#cb228-1608" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb228-1609"><a href="aplikace3.html#cb228-1609" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-1610"><a href="aplikace3.html#cb228-1610" tabindex="-1"></a>    </span>
<span id="cb228-1611"><a href="aplikace3.html#cb228-1611" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb228-1612"><a href="aplikace3.html#cb228-1612" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb228-1613"><a href="aplikace3.html#cb228-1613" tabindex="-1"></a>  }</span>
<span id="cb228-1614"><a href="aplikace3.html#cb228-1614" tabindex="-1"></a>  </span>
<span id="cb228-1615"><a href="aplikace3.html#cb228-1615" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb228-1616"><a href="aplikace3.html#cb228-1616" tabindex="-1"></a>  </span>
<span id="cb228-1617"><a href="aplikace3.html#cb228-1617" tabindex="-1"></a>  <span class="do">### Linearni jadro</span></span>
<span id="cb228-1618"><a href="aplikace3.html#cb228-1618" tabindex="-1"></a>  </span>
<span id="cb228-1619"><a href="aplikace3.html#cb228-1619" tabindex="-1"></a>  <span class="co"># jadro a jadrova matice ... polynomialni s parametrem p</span></span>
<span id="cb228-1620"><a href="aplikace3.html#cb228-1620" tabindex="-1"></a>  Linear.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb228-1621"><a href="aplikace3.html#cb228-1621" tabindex="-1"></a>    <span class="fu">return</span>(x <span class="sc">*</span> y)</span>
<span id="cb228-1622"><a href="aplikace3.html#cb228-1622" tabindex="-1"></a>  }</span>
<span id="cb228-1623"><a href="aplikace3.html#cb228-1623" tabindex="-1"></a>  </span>
<span id="cb228-1624"><a href="aplikace3.html#cb228-1624" tabindex="-1"></a>  Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb228-1625"><a href="aplikace3.html#cb228-1625" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb228-1626"><a href="aplikace3.html#cb228-1626" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb228-1627"><a href="aplikace3.html#cb228-1627" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb228-1628"><a href="aplikace3.html#cb228-1628" tabindex="-1"></a>        K[i, j] <span class="ot">&lt;-</span> <span class="fu">Linear.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j])</span>
<span id="cb228-1629"><a href="aplikace3.html#cb228-1629" tabindex="-1"></a>      }</span>
<span id="cb228-1630"><a href="aplikace3.html#cb228-1630" tabindex="-1"></a>    }</span>
<span id="cb228-1631"><a href="aplikace3.html#cb228-1631" tabindex="-1"></a>    <span class="fu">return</span>(K)</span>
<span id="cb228-1632"><a href="aplikace3.html#cb228-1632" tabindex="-1"></a>  }</span>
<span id="cb228-1633"><a href="aplikace3.html#cb228-1633" tabindex="-1"></a>  </span>
<span id="cb228-1634"><a href="aplikace3.html#cb228-1634" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb228-1635"><a href="aplikace3.html#cb228-1635" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb228-1636"><a href="aplikace3.html#cb228-1636" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb228-1637"><a href="aplikace3.html#cb228-1637" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb228-1638"><a href="aplikace3.html#cb228-1638" tabindex="-1"></a>  </span>
<span id="cb228-1639"><a href="aplikace3.html#cb228-1639" tabindex="-1"></a>  <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb228-1640"><a href="aplikace3.html#cb228-1640" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">2</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb228-1641"><a href="aplikace3.html#cb228-1641" tabindex="-1"></a>  </span>
<span id="cb228-1642"><a href="aplikace3.html#cb228-1642" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb228-1643"><a href="aplikace3.html#cb228-1643" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb228-1644"><a href="aplikace3.html#cb228-1644" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane d</span></span>
<span id="cb228-1645"><a href="aplikace3.html#cb228-1645" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro vrstvy odpovidaji folds</span></span>
<span id="cb228-1646"><a href="aplikace3.html#cb228-1646" tabindex="-1"></a>  dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb228-1647"><a href="aplikace3.html#cb228-1647" tabindex="-1"></a>                    <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb228-1648"><a href="aplikace3.html#cb228-1648" tabindex="-1"></a>  </span>
<span id="cb228-1649"><a href="aplikace3.html#cb228-1649" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb228-1650"><a href="aplikace3.html#cb228-1650" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb228-1651"><a href="aplikace3.html#cb228-1651" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb228-1652"><a href="aplikace3.html#cb228-1652" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb228-1653"><a href="aplikace3.html#cb228-1653" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb228-1654"><a href="aplikace3.html#cb228-1654" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb228-1655"><a href="aplikace3.html#cb228-1655" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names))</span>
<span id="cb228-1656"><a href="aplikace3.html#cb228-1656" tabindex="-1"></a>  </span>
<span id="cb228-1657"><a href="aplikace3.html#cb228-1657" tabindex="-1"></a>  <span class="co"># samotna CV</span></span>
<span id="cb228-1658"><a href="aplikace3.html#cb228-1658" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb228-1659"><a href="aplikace3.html#cb228-1659" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb228-1660"><a href="aplikace3.html#cb228-1660" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb228-1661"><a href="aplikace3.html#cb228-1661" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb228-1662"><a href="aplikace3.html#cb228-1662" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb228-1663"><a href="aplikace3.html#cb228-1663" tabindex="-1"></a>  </span>
<span id="cb228-1664"><a href="aplikace3.html#cb228-1664" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb228-1665"><a href="aplikace3.html#cb228-1665" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb228-1666"><a href="aplikace3.html#cb228-1666" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb228-1667"><a href="aplikace3.html#cb228-1667" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb228-1668"><a href="aplikace3.html#cb228-1668" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb228-1669"><a href="aplikace3.html#cb228-1669" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb228-1670"><a href="aplikace3.html#cb228-1670" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb228-1671"><a href="aplikace3.html#cb228-1671" tabindex="-1"></a>                    <span class="at">cost =</span> C,</span>
<span id="cb228-1672"><a href="aplikace3.html#cb228-1672" tabindex="-1"></a>                    <span class="at">epsilon =</span> eps)</span>
<span id="cb228-1673"><a href="aplikace3.html#cb228-1673" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb228-1674"><a href="aplikace3.html#cb228-1674" tabindex="-1"></a>  }</span>
<span id="cb228-1675"><a href="aplikace3.html#cb228-1675" tabindex="-1"></a>  </span>
<span id="cb228-1676"><a href="aplikace3.html#cb228-1676" tabindex="-1"></a>  <span class="co"># projdeme dimenze</span></span>
<span id="cb228-1677"><a href="aplikace3.html#cb228-1677" tabindex="-1"></a>  <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb228-1678"><a href="aplikace3.html#cb228-1678" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb228-1679"><a href="aplikace3.html#cb228-1679" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb228-1680"><a href="aplikace3.html#cb228-1680" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb228-1681"><a href="aplikace3.html#cb228-1681" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb228-1682"><a href="aplikace3.html#cb228-1682" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb228-1683"><a href="aplikace3.html#cb228-1683" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb228-1684"><a href="aplikace3.html#cb228-1684" tabindex="-1"></a>                             alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb228-1685"><a href="aplikace3.html#cb228-1685" tabindex="-1"></a>    }</span>
<span id="cb228-1686"><a href="aplikace3.html#cb228-1686" tabindex="-1"></a>    <span class="co"># projdeme folds</span></span>
<span id="cb228-1687"><a href="aplikace3.html#cb228-1687" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb228-1688"><a href="aplikace3.html#cb228-1688" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb228-1689"><a href="aplikace3.html#cb228-1689" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb228-1690"><a href="aplikace3.html#cb228-1690" tabindex="-1"></a>      <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb228-1691"><a href="aplikace3.html#cb228-1691" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb228-1692"><a href="aplikace3.html#cb228-1692" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb228-1693"><a href="aplikace3.html#cb228-1693" tabindex="-1"></a>      <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb228-1694"><a href="aplikace3.html#cb228-1694" tabindex="-1"></a>      Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb228-1695"><a href="aplikace3.html#cb228-1695" tabindex="-1"></a>                                  <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb228-1696"><a href="aplikace3.html#cb228-1696" tabindex="-1"></a>                                  <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb228-1697"><a href="aplikace3.html#cb228-1697" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb228-1698"><a href="aplikace3.html#cb228-1698" tabindex="-1"></a>      <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb228-1699"><a href="aplikace3.html#cb228-1699" tabindex="-1"></a>      <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb228-1700"><a href="aplikace3.html#cb228-1700" tabindex="-1"></a>        kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb228-1701"><a href="aplikace3.html#cb228-1701" tabindex="-1"></a>      </span>
<span id="cb228-1702"><a href="aplikace3.html#cb228-1702" tabindex="-1"></a>        data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb228-1703"><a href="aplikace3.html#cb228-1703" tabindex="-1"></a>        data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb228-1704"><a href="aplikace3.html#cb228-1704" tabindex="-1"></a>        </span>
<span id="cb228-1705"><a href="aplikace3.html#cb228-1705" tabindex="-1"></a>        data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb228-1706"><a href="aplikace3.html#cb228-1706" tabindex="-1"></a>        data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb228-1707"><a href="aplikace3.html#cb228-1707" tabindex="-1"></a>        </span>
<span id="cb228-1708"><a href="aplikace3.html#cb228-1708" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb228-1709"><a href="aplikace3.html#cb228-1709" tabindex="-1"></a>        clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb228-1710"><a href="aplikace3.html#cb228-1710" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb228-1711"><a href="aplikace3.html#cb228-1711" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-1712"><a href="aplikace3.html#cb228-1712" tabindex="-1"></a>                            <span class="at">cost =</span> C,</span>
<span id="cb228-1713"><a href="aplikace3.html#cb228-1713" tabindex="-1"></a>                            <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb228-1714"><a href="aplikace3.html#cb228-1714" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb228-1715"><a href="aplikace3.html#cb228-1715" tabindex="-1"></a>        </span>
<span id="cb228-1716"><a href="aplikace3.html#cb228-1716" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb228-1717"><a href="aplikace3.html#cb228-1717" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb228-1718"><a href="aplikace3.html#cb228-1718" tabindex="-1"></a>        presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb228-1719"><a href="aplikace3.html#cb228-1719" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-1720"><a href="aplikace3.html#cb228-1720" tabindex="-1"></a>        </span>
<span id="cb228-1721"><a href="aplikace3.html#cb228-1721" tabindex="-1"></a>        <span class="co"># ulozeni vysledku</span></span>
<span id="cb228-1722"><a href="aplikace3.html#cb228-1722" tabindex="-1"></a>        Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb228-1723"><a href="aplikace3.html#cb228-1723" tabindex="-1"></a>      }</span>
<span id="cb228-1724"><a href="aplikace3.html#cb228-1724" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb228-1725"><a href="aplikace3.html#cb228-1725" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb228-1726"><a href="aplikace3.html#cb228-1726" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb228-1727"><a href="aplikace3.html#cb228-1727" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb228-1728"><a href="aplikace3.html#cb228-1728" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb228-1729"><a href="aplikace3.html#cb228-1729" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb228-1730"><a href="aplikace3.html#cb228-1730" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb228-1731"><a href="aplikace3.html#cb228-1731" tabindex="-1"></a>    }</span>
<span id="cb228-1732"><a href="aplikace3.html#cb228-1732" tabindex="-1"></a>  }</span>
<span id="cb228-1733"><a href="aplikace3.html#cb228-1733" tabindex="-1"></a>  </span>
<span id="cb228-1734"><a href="aplikace3.html#cb228-1734" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb228-1735"><a href="aplikace3.html#cb228-1735" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb228-1736"><a href="aplikace3.html#cb228-1736" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb228-1737"><a href="aplikace3.html#cb228-1737" tabindex="-1"></a>  }</span>
<span id="cb228-1738"><a href="aplikace3.html#cb228-1738" tabindex="-1"></a>  </span>
<span id="cb228-1739"><a href="aplikace3.html#cb228-1739" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb228-1740"><a href="aplikace3.html#cb228-1740" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb228-1741"><a href="aplikace3.html#cb228-1741" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb228-1742"><a href="aplikace3.html#cb228-1742" tabindex="-1"></a>  d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb228-1743"><a href="aplikace3.html#cb228-1743" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb228-1744"><a href="aplikace3.html#cb228-1744" tabindex="-1"></a>  </span>
<span id="cb228-1745"><a href="aplikace3.html#cb228-1745" tabindex="-1"></a>  err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb228-1746"><a href="aplikace3.html#cb228-1746" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb228-1747"><a href="aplikace3.html#cb228-1747" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb228-1748"><a href="aplikace3.html#cb228-1748" tabindex="-1"></a>  df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb228-1749"><a href="aplikace3.html#cb228-1749" tabindex="-1"></a>             <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb228-1750"><a href="aplikace3.html#cb228-1750" tabindex="-1"></a>             <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb228-1751"><a href="aplikace3.html#cb228-1751" tabindex="-1"></a>  </span>
<span id="cb228-1752"><a href="aplikace3.html#cb228-1752" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">19</span><span class="sc">:</span><span class="dv">21</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb228-1753"><a href="aplikace3.html#cb228-1753" tabindex="-1"></a>  </span>
<span id="cb228-1754"><a href="aplikace3.html#cb228-1754" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb228-1755"><a href="aplikace3.html#cb228-1755" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb228-1756"><a href="aplikace3.html#cb228-1756" tabindex="-1"></a>  <span class="co"># pridame i testovaci data</span></span>
<span id="cb228-1757"><a href="aplikace3.html#cb228-1757" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb228-1758"><a href="aplikace3.html#cb228-1758" tabindex="-1"></a>  </span>
<span id="cb228-1759"><a href="aplikace3.html#cb228-1759" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb228-1760"><a href="aplikace3.html#cb228-1760" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - linear&#39;</span>, </span>
<span id="cb228-1761"><a href="aplikace3.html#cb228-1761" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - RKHS - linear&#39;</span>, </span>
<span id="cb228-1762"><a href="aplikace3.html#cb228-1762" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - RKHS - linear&#39;</span>), </span>
<span id="cb228-1763"><a href="aplikace3.html#cb228-1763" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb228-1764"><a href="aplikace3.html#cb228-1764" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb228-1765"><a href="aplikace3.html#cb228-1765" tabindex="-1"></a>  </span>
<span id="cb228-1766"><a href="aplikace3.html#cb228-1766" tabindex="-1"></a>  <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb228-1767"><a href="aplikace3.html#cb228-1767" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb228-1768"><a href="aplikace3.html#cb228-1768" tabindex="-1"></a>    <span class="co"># spocitame matici K</span></span>
<span id="cb228-1769"><a href="aplikace3.html#cb228-1769" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb228-1770"><a href="aplikace3.html#cb228-1770" tabindex="-1"></a>    </span>
<span id="cb228-1771"><a href="aplikace3.html#cb228-1771" tabindex="-1"></a>    <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb228-1772"><a href="aplikace3.html#cb228-1772" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb228-1773"><a href="aplikace3.html#cb228-1773" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb228-1774"><a href="aplikace3.html#cb228-1774" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb228-1775"><a href="aplikace3.html#cb228-1775" tabindex="-1"></a>    <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb228-1776"><a href="aplikace3.html#cb228-1776" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb228-1777"><a href="aplikace3.html#cb228-1777" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb228-1778"><a href="aplikace3.html#cb228-1778" tabindex="-1"></a>    </span>
<span id="cb228-1779"><a href="aplikace3.html#cb228-1779" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb228-1780"><a href="aplikace3.html#cb228-1780" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb228-1781"><a href="aplikace3.html#cb228-1781" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb228-1782"><a href="aplikace3.html#cb228-1782" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb228-1783"><a href="aplikace3.html#cb228-1783" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb228-1784"><a href="aplikace3.html#cb228-1784" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb228-1785"><a href="aplikace3.html#cb228-1785" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb228-1786"><a href="aplikace3.html#cb228-1786" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb228-1787"><a href="aplikace3.html#cb228-1787" tabindex="-1"></a>                      <span class="at">epsilon =</span> eps)</span>
<span id="cb228-1788"><a href="aplikace3.html#cb228-1788" tabindex="-1"></a>      <span class="co"># urceni alpha</span></span>
<span id="cb228-1789"><a href="aplikace3.html#cb228-1789" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb228-1790"><a href="aplikace3.html#cb228-1790" tabindex="-1"></a>    }</span>
<span id="cb228-1791"><a href="aplikace3.html#cb228-1791" tabindex="-1"></a>    <span class="co"># d</span></span>
<span id="cb228-1792"><a href="aplikace3.html#cb228-1792" tabindex="-1"></a>    d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb228-1793"><a href="aplikace3.html#cb228-1793" tabindex="-1"></a>    </span>
<span id="cb228-1794"><a href="aplikace3.html#cb228-1794" tabindex="-1"></a>    <span class="co"># urceni vektoru lambda</span></span>
<span id="cb228-1795"><a href="aplikace3.html#cb228-1795" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb228-1796"><a href="aplikace3.html#cb228-1796" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb228-1797"><a href="aplikace3.html#cb228-1797" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb228-1798"><a href="aplikace3.html#cb228-1798" tabindex="-1"></a>    </span>
<span id="cb228-1799"><a href="aplikace3.html#cb228-1799" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb228-1800"><a href="aplikace3.html#cb228-1800" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb228-1801"><a href="aplikace3.html#cb228-1801" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb228-1802"><a href="aplikace3.html#cb228-1802" tabindex="-1"></a>    }</span>
<span id="cb228-1803"><a href="aplikace3.html#cb228-1803" tabindex="-1"></a>    </span>
<span id="cb228-1804"><a href="aplikace3.html#cb228-1804" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb228-1805"><a href="aplikace3.html#cb228-1805" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb228-1806"><a href="aplikace3.html#cb228-1806" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb228-1807"><a href="aplikace3.html#cb228-1807" tabindex="-1"></a>  </span>
<span id="cb228-1808"><a href="aplikace3.html#cb228-1808" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb228-1809"><a href="aplikace3.html#cb228-1809" tabindex="-1"></a>  </span>
<span id="cb228-1810"><a href="aplikace3.html#cb228-1810" tabindex="-1"></a>    data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb228-1811"><a href="aplikace3.html#cb228-1811" tabindex="-1"></a>    data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb228-1812"><a href="aplikace3.html#cb228-1812" tabindex="-1"></a>    </span>
<span id="cb228-1813"><a href="aplikace3.html#cb228-1813" tabindex="-1"></a>    data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb228-1814"><a href="aplikace3.html#cb228-1814" tabindex="-1"></a>    data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb228-1815"><a href="aplikace3.html#cb228-1815" tabindex="-1"></a>    </span>
<span id="cb228-1816"><a href="aplikace3.html#cb228-1816" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb228-1817"><a href="aplikace3.html#cb228-1817" tabindex="-1"></a>    clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb228-1818"><a href="aplikace3.html#cb228-1818" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb228-1819"><a href="aplikace3.html#cb228-1819" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-1820"><a href="aplikace3.html#cb228-1820" tabindex="-1"></a>                        <span class="at">cost =</span> C,</span>
<span id="cb228-1821"><a href="aplikace3.html#cb228-1821" tabindex="-1"></a>                        <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb228-1822"><a href="aplikace3.html#cb228-1822" tabindex="-1"></a>                        <span class="at">kernel =</span> kernel_type)</span>
<span id="cb228-1823"><a href="aplikace3.html#cb228-1823" tabindex="-1"></a>    </span>
<span id="cb228-1824"><a href="aplikace3.html#cb228-1824" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb228-1825"><a href="aplikace3.html#cb228-1825" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb228-1826"><a href="aplikace3.html#cb228-1826" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb228-1827"><a href="aplikace3.html#cb228-1827" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-1828"><a href="aplikace3.html#cb228-1828" tabindex="-1"></a>      </span>
<span id="cb228-1829"><a href="aplikace3.html#cb228-1829" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb228-1830"><a href="aplikace3.html#cb228-1830" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb228-1831"><a href="aplikace3.html#cb228-1831" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb228-1832"><a href="aplikace3.html#cb228-1832" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb228-1833"><a href="aplikace3.html#cb228-1833" tabindex="-1"></a>    </span>
<span id="cb228-1834"><a href="aplikace3.html#cb228-1834" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb228-1835"><a href="aplikace3.html#cb228-1835" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb228-1836"><a href="aplikace3.html#cb228-1836" tabindex="-1"></a>  }</span>
<span id="cb228-1837"><a href="aplikace3.html#cb228-1837" tabindex="-1"></a>  </span>
<span id="cb228-1838"><a href="aplikace3.html#cb228-1838" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb228-1839"><a href="aplikace3.html#cb228-1839" tabindex="-1"></a>  </span>
<span id="cb228-1840"><a href="aplikace3.html#cb228-1840" tabindex="-1"></a>  <span class="do">## pridame vysledky do objektu SIMULACE</span></span>
<span id="cb228-1841"><a href="aplikace3.html#cb228-1841" tabindex="-1"></a>  </span>
<span id="cb228-1842"><a href="aplikace3.html#cb228-1842" tabindex="-1"></a>  SIMULACE<span class="sc">$</span>train[sim, ] <span class="ot">&lt;-</span> RESULTS<span class="sc">$</span>Err.train</span>
<span id="cb228-1843"><a href="aplikace3.html#cb228-1843" tabindex="-1"></a>  SIMULACE<span class="sc">$</span>test[sim, ] <span class="ot">&lt;-</span> RESULTS<span class="sc">$</span>Err.test</span>
<span id="cb228-1844"><a href="aplikace3.html#cb228-1844" tabindex="-1"></a>  </span>
<span id="cb228-1845"><a href="aplikace3.html#cb228-1845" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;</span><span class="sc">\r</span><span class="st">&#39;</span>, sim)</span>
<span id="cb228-1846"><a href="aplikace3.html#cb228-1846" tabindex="-1"></a>}</span>
<span id="cb228-1847"><a href="aplikace3.html#cb228-1847" tabindex="-1"></a></span>
<span id="cb228-1848"><a href="aplikace3.html#cb228-1848" tabindex="-1"></a><span class="co"># ulozime vysledne hodnoty </span></span>
<span id="cb228-1849"><a href="aplikace3.html#cb228-1849" tabindex="-1"></a><span class="fu">save</span>(SIMULACE, CV_RESULTS, <span class="at">file =</span> <span class="st">&#39;RData/aplikace_03neder.RData&#39;</span>)</span></code></pre></div>
</details>
<p>Nyní spočítáme průměrné testovací a trénovací chybovosti pro jednotlivé klasifikační metody.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="aplikace3.html#cb229-1" tabindex="-1"></a><span class="co"># dame do vysledne tabulky</span></span>
<span id="cb229-2"><a href="aplikace3.html#cb229-2" tabindex="-1"></a></span>
<span id="cb229-3"><a href="aplikace3.html#cb229-3" tabindex="-1"></a>SIMULACE.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Err.train =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>train, <span class="dv">2</span>, mean),</span>
<span id="cb229-4"><a href="aplikace3.html#cb229-4" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>test, <span class="dv">2</span>, mean),</span>
<span id="cb229-5"><a href="aplikace3.html#cb229-5" tabindex="-1"></a>                          <span class="at">SD.train =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>train, <span class="dv">2</span>, sd),</span>
<span id="cb229-6"><a href="aplikace3.html#cb229-6" tabindex="-1"></a>                          <span class="at">SD.test =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>test, <span class="dv">2</span>, sd))</span>
<span id="cb229-7"><a href="aplikace3.html#cb229-7" tabindex="-1"></a></span>
<span id="cb229-8"><a href="aplikace3.html#cb229-8" tabindex="-1"></a><span class="co"># ulozime vysledne hodnoty </span></span>
<span id="cb229-9"><a href="aplikace3.html#cb229-9" tabindex="-1"></a><span class="fu">save</span>(SIMULACE.df, <span class="at">file =</span> <span class="st">&#39;RData/aplikace_03neder_res.RData&#39;</span>)</span></code></pre></div>
</details>
<div id="výsledky-6" class="section level4 hasAnchor" number="12.7.1.1">
<h4><span class="header-section-number">12.7.1.1</span> Výsledky<a href="aplikace3.html#výsledky-6" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<table>
<caption><span id="tab:unnamed-chunk-229">Tabulka 12.17: </span>Souhrnné výsledky použitých metod na simulovaných datech. <span class="math inline">\(\widehat{Err}_{train}\)</span> značí odhad trénovací chybovosti, <span class="math inline">\(\widehat{Err}_{test}\)</span> testovací chybovosti, <span class="math inline">\(\widehat{SD}_{train}\)</span> odhad směrodatné odchylky trénovacích chybovostí a <span class="math inline">\(\widehat{SD}_{test}\)</span> je odhad směrodatné odchylky testovacích chybovostí.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{train}\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{test}\)</span></th>
<th align="right"><span class="math inline">\(\widehat{SD}_{train}\)</span></th>
<th align="right"><span class="math inline">\(\widehat{SD}_{test}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>KNN</td>
<td align="right">0.1730</td>
<td align="right">0.1777</td>
<td align="right">0.0265</td>
<td align="right">0.0504</td>
</tr>
<tr class="even">
<td>LDA</td>
<td align="right">0.2996</td>
<td align="right">0.3163</td>
<td align="right">0.0207</td>
<td align="right">0.0446</td>
</tr>
<tr class="odd">
<td>QDA</td>
<td align="right">0.3017</td>
<td align="right">0.3182</td>
<td align="right">0.0217</td>
<td align="right">0.0441</td>
</tr>
<tr class="even">
<td>LR_functional</td>
<td align="right">0.0105</td>
<td align="right">0.0482</td>
<td align="right">0.0278</td>
<td align="right">0.0467</td>
</tr>
<tr class="odd">
<td>LR_score</td>
<td align="right">0.2919</td>
<td align="right">0.3103</td>
<td align="right">0.0207</td>
<td align="right">0.0447</td>
</tr>
<tr class="even">
<td>Tree_discr</td>
<td align="right">0.1857</td>
<td align="right">0.2937</td>
<td align="right">0.0449</td>
<td align="right">0.0583</td>
</tr>
<tr class="odd">
<td>Tree_score</td>
<td align="right">0.2470</td>
<td align="right">0.3360</td>
<td align="right">0.0451</td>
<td align="right">0.0574</td>
</tr>
<tr class="even">
<td>Tree_Bbasis</td>
<td align="right">0.1855</td>
<td align="right">0.2918</td>
<td align="right">0.0456</td>
<td align="right">0.0565</td>
</tr>
<tr class="odd">
<td>RF_discr</td>
<td align="right">0.0121</td>
<td align="right">0.2072</td>
<td align="right">0.0091</td>
<td align="right">0.0502</td>
</tr>
<tr class="even">
<td>RF_score</td>
<td align="right">0.0360</td>
<td align="right">0.3100</td>
<td align="right">0.0110</td>
<td align="right">0.0507</td>
</tr>
<tr class="odd">
<td>RF_Bbasis</td>
<td align="right">0.0121</td>
<td align="right">0.2066</td>
<td align="right">0.0087</td>
<td align="right">0.0453</td>
</tr>
<tr class="even">
<td>SVM linear - diskr</td>
<td align="right">0.0036</td>
<td align="right">0.0162</td>
<td align="right">0.0058</td>
<td align="right">0.0227</td>
</tr>
<tr class="odd">
<td>SVM poly - diskr</td>
<td align="right">0.0113</td>
<td align="right">0.0455</td>
<td align="right">0.0129</td>
<td align="right">0.0234</td>
</tr>
<tr class="even">
<td>SVM rbf - diskr</td>
<td align="right">0.0053</td>
<td align="right">0.0346</td>
<td align="right">0.0063</td>
<td align="right">0.0229</td>
</tr>
<tr class="odd">
<td>SVM linear - PCA</td>
<td align="right">0.2989</td>
<td align="right">0.3285</td>
<td align="right">0.0234</td>
<td align="right">0.0495</td>
</tr>
<tr class="even">
<td>SVM poly - PCA</td>
<td align="right">0.2833</td>
<td align="right">0.3515</td>
<td align="right">0.0329</td>
<td align="right">0.0452</td>
</tr>
<tr class="odd">
<td>SVM rbf - PCA</td>
<td align="right">0.1553</td>
<td align="right">0.3469</td>
<td align="right">0.1128</td>
<td align="right">0.0479</td>
</tr>
<tr class="even">
<td>SVM linear - Bbasis</td>
<td align="right">0.0113</td>
<td align="right">0.0277</td>
<td align="right">0.0074</td>
<td align="right">0.0194</td>
</tr>
<tr class="odd">
<td>SVM poly - Bbasis</td>
<td align="right">0.0137</td>
<td align="right">0.0495</td>
<td align="right">0.0104</td>
<td align="right">0.0287</td>
</tr>
<tr class="even">
<td>SVM rbf - Bbasis</td>
<td align="right">0.0153</td>
<td align="right">0.0532</td>
<td align="right">0.0063</td>
<td align="right">0.0252</td>
</tr>
<tr class="odd">
<td>SVM linear - projection</td>
<td align="right">0.0312</td>
<td align="right">0.0425</td>
<td align="right">0.0103</td>
<td align="right">0.0244</td>
</tr>
<tr class="even">
<td>SVM poly - projection</td>
<td align="right">0.0339</td>
<td align="right">0.0577</td>
<td align="right">0.0135</td>
<td align="right">0.0331</td>
</tr>
<tr class="odd">
<td>SVM rbf - projection</td>
<td align="right">0.1395</td>
<td align="right">0.2034</td>
<td align="right">0.0289</td>
<td align="right">0.0554</td>
</tr>
<tr class="even">
<td>SVM linear - RKHS - radial</td>
<td align="right">0.0008</td>
<td align="right">0.0197</td>
<td align="right">0.0024</td>
<td align="right">0.0188</td>
</tr>
<tr class="odd">
<td>SVM poly - RKHS - radial</td>
<td align="right">0.0009</td>
<td align="right">0.0132</td>
<td align="right">0.0023</td>
<td align="right">0.0178</td>
</tr>
<tr class="even">
<td>SVM rbf - RKHS - radial</td>
<td align="right">0.0036</td>
<td align="right">0.0195</td>
<td align="right">0.0047</td>
<td align="right">0.0163</td>
</tr>
<tr class="odd">
<td>SVM linear - RKHS - poly</td>
<td align="right">0.0543</td>
<td align="right">0.0832</td>
<td align="right">0.0138</td>
<td align="right">0.0321</td>
</tr>
<tr class="even">
<td>SVM poly - RKHS - poly</td>
<td align="right">0.0305</td>
<td align="right">0.0889</td>
<td align="right">0.0152</td>
<td align="right">0.0305</td>
</tr>
<tr class="odd">
<td>SVM rbf - RKHS - poly</td>
<td align="right">0.0302</td>
<td align="right">0.0642</td>
<td align="right">0.0094</td>
<td align="right">0.0294</td>
</tr>
<tr class="even">
<td>SVM linear - RKHS - linear</td>
<td align="right">0.0448</td>
<td align="right">0.0725</td>
<td align="right">0.0149</td>
<td align="right">0.0349</td>
</tr>
<tr class="odd">
<td>SVM poly - RKHS - linear</td>
<td align="right">0.0433</td>
<td align="right">0.0754</td>
<td align="right">0.0134</td>
<td align="right">0.0358</td>
</tr>
<tr class="even">
<td>SVM rbf - RKHS - linear</td>
<td align="right">0.0803</td>
<td align="right">0.1188</td>
<td align="right">0.0217</td>
<td align="right">0.0434</td>
</tr>
</tbody>
</table>
<p>V tabulce výše jsou uvedeny všechny vypočtené charakteristiky.
Jsou zde uvedeny také směrodatné odchylky, abychom mohli porovnat jakousi stálost či míru variability jednotlivých metod.</p>
<p>Můžeme také formálně otestovat, zda jsou některé metody úspěšnější než jiné. Vzhledem k nesplnění předpokladu normality nemůžeme použít klasický párový t-test. Využijeme jeho neparametrickou alternativu - Wilcoxonův test.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="aplikace3.html#cb230-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM linear - diskr&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;t&#39;</span>, <span class="at">paired =</span> T)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 0.3874749</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="aplikace3.html#cb232-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM linear - diskr&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;t&#39;</span>, <span class="at">paired =</span> T)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 0.201061</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="aplikace3.html#cb234-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM linear - RKHS - radial&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM linear - diskr&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;t&#39;</span>, <span class="at">paired =</span> T)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 0.1067453</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="aplikace3.html#cb236-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;LR_functional&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM linear - diskr&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;greater&#39;</span>, <span class="at">paired =</span> T)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 2.09865e-11</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="aplikace3.html#cb238-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;LR_functional&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;greater&#39;</span>, <span class="at">paired =</span> T)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 2.355944e-13</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="aplikace3.html#cb240-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;LR_functional&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;greater&#39;</span>, <span class="at">paired =</span> T)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 1.332949e-10</code></pre>
<p>Nakonec ještě můžeme graficky zobrazit vypočtené hodnoty ze simulace pro jednotlivé klasifikační metody pomocí krabicových diagramů, zvlášť pro testovací a trénovací chybovosti.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="aplikace3.html#cb242-1" tabindex="-1"></a><span class="co"># nastavime jinak nazvy klasifikacnich metod</span></span>
<span id="cb242-2"><a href="aplikace3.html#cb242-2" tabindex="-1"></a>methods_names <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb242-3"><a href="aplikace3.html#cb242-3" tabindex="-1"></a>      <span class="st">&#39;$K$ nejbližších sousedů&#39;</span>,</span>
<span id="cb242-4"><a href="aplikace3.html#cb242-4" tabindex="-1"></a>      <span class="st">&#39;Lineární diskriminační analýza&#39;</span>,</span>
<span id="cb242-5"><a href="aplikace3.html#cb242-5" tabindex="-1"></a>      <span class="st">&#39;Kvadratická diskriminační analýza&#39;</span>,</span>
<span id="cb242-6"><a href="aplikace3.html#cb242-6" tabindex="-1"></a>      <span class="st">&#39;Funkcionální logistická regrese&#39;</span>,</span>
<span id="cb242-7"><a href="aplikace3.html#cb242-7" tabindex="-1"></a>      <span class="st">&#39;Logistické regrese s fPCA&#39;</span>,</span>
<span id="cb242-8"><a href="aplikace3.html#cb242-8" tabindex="-1"></a>      <span class="st">&#39;Rozhodovací strom -- diskretizace&#39;</span>,</span>
<span id="cb242-9"><a href="aplikace3.html#cb242-9" tabindex="-1"></a>      <span class="st">&#39;Rozhodovací strom -- fPCA&#39;</span>,</span>
<span id="cb242-10"><a href="aplikace3.html#cb242-10" tabindex="-1"></a>      <span class="st">&#39;Rozhodovací strom -- bázové koeficienty&#39;</span>,</span>
<span id="cb242-11"><a href="aplikace3.html#cb242-11" tabindex="-1"></a>      <span class="st">&#39;Náhodný les -- diskretizace&#39;</span>,</span>
<span id="cb242-12"><a href="aplikace3.html#cb242-12" tabindex="-1"></a>      <span class="st">&#39;Náhodný les -- fPCA&#39;</span>,</span>
<span id="cb242-13"><a href="aplikace3.html#cb242-13" tabindex="-1"></a>      <span class="st">&#39;Náhodný les -- bázové koeficienty&#39;</span>,</span>
<span id="cb242-14"><a href="aplikace3.html#cb242-14" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- diskretizace&#39;</span>,</span>
<span id="cb242-15"><a href="aplikace3.html#cb242-15" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- diskretizace&#39;</span>,</span>
<span id="cb242-16"><a href="aplikace3.html#cb242-16" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- diskretizace&#39;</span>,</span>
<span id="cb242-17"><a href="aplikace3.html#cb242-17" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- fPCA&#39;</span>,</span>
<span id="cb242-18"><a href="aplikace3.html#cb242-18" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- fPCA&#39;</span>,</span>
<span id="cb242-19"><a href="aplikace3.html#cb242-19" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- fPCA&#39;</span>,</span>
<span id="cb242-20"><a href="aplikace3.html#cb242-20" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- bázové koeficienty&#39;</span>,</span>
<span id="cb242-21"><a href="aplikace3.html#cb242-21" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- bázové koeficienty&#39;</span>,</span>
<span id="cb242-22"><a href="aplikace3.html#cb242-22" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- bázové koeficienty&#39;</span>,</span>
<span id="cb242-23"><a href="aplikace3.html#cb242-23" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- projekce&#39;</span>,</span>
<span id="cb242-24"><a href="aplikace3.html#cb242-24" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- projekce&#39;</span>,</span>
<span id="cb242-25"><a href="aplikace3.html#cb242-25" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- projekce&#39;</span>,</span>
<span id="cb242-26"><a href="aplikace3.html#cb242-26" tabindex="-1"></a>      <span class="st">&#39;RKHS (radial SVR) $+$ SVM (linear)&#39;</span>,</span>
<span id="cb242-27"><a href="aplikace3.html#cb242-27" tabindex="-1"></a>      <span class="st">&#39;RKHS (radial SVR) $+$ SVM (poly)&#39;</span>,</span>
<span id="cb242-28"><a href="aplikace3.html#cb242-28" tabindex="-1"></a>      <span class="st">&#39;RKHS (radial SVR) $+$ SVM (radial)&#39;</span>,</span>
<span id="cb242-29"><a href="aplikace3.html#cb242-29" tabindex="-1"></a>      <span class="st">&#39;RKHS (poly SVR) $+$ SVM (linear)&#39;</span>,</span>
<span id="cb242-30"><a href="aplikace3.html#cb242-30" tabindex="-1"></a>      <span class="st">&#39;RKHS (poly SVR) $+$ SVM (poly)&#39;</span>,</span>
<span id="cb242-31"><a href="aplikace3.html#cb242-31" tabindex="-1"></a>      <span class="st">&#39;RKHS (poly SVR) $+$ SVM (radial)&#39;</span>,</span>
<span id="cb242-32"><a href="aplikace3.html#cb242-32" tabindex="-1"></a>      <span class="st">&#39;RKHS (linear SVR) $+$ SVM (linear)&#39;</span>,</span>
<span id="cb242-33"><a href="aplikace3.html#cb242-33" tabindex="-1"></a>      <span class="st">&#39;RKHS (linear SVR) $+$ SVM (poly)&#39;</span>,</span>
<span id="cb242-34"><a href="aplikace3.html#cb242-34" tabindex="-1"></a>      <span class="st">&#39;RKHS (linear SVR) $+$ SVM (radial)&#39;</span></span>
<span id="cb242-35"><a href="aplikace3.html#cb242-35" tabindex="-1"></a>)</span>
<span id="cb242-36"><a href="aplikace3.html#cb242-36" tabindex="-1"></a></span>
<span id="cb242-37"><a href="aplikace3.html#cb242-37" tabindex="-1"></a></span>
<span id="cb242-38"><a href="aplikace3.html#cb242-38" tabindex="-1"></a><span class="co"># barvy pro boxploty </span></span>
<span id="cb242-39"><a href="aplikace3.html#cb242-39" tabindex="-1"></a>box_col <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;#4dd2ff&#39;</span>, <span class="st">&#39;#0099cc&#39;</span>, <span class="st">&#39;#00ace6&#39;</span>, <span class="st">&#39;#00bfff&#39;</span>,</span>
<span id="cb242-40"><a href="aplikace3.html#cb242-40" tabindex="-1"></a>             <span class="st">&#39;#1ac5ff&#39;</span>, <span class="fu">rep</span>(<span class="st">&#39;#33ccff&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#0086b3&#39;</span>, <span class="dv">3</span>),</span>
<span id="cb242-41"><a href="aplikace3.html#cb242-41" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="st">&#39;#ff3814&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#ff6347&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#ff7961&#39;</span>, <span class="dv">3</span>),</span>
<span id="cb242-42"><a href="aplikace3.html#cb242-42" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="st">&#39;#ff4d2e&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#fa2600&#39;</span>, <span class="dv">9</span>))</span>
<span id="cb242-43"><a href="aplikace3.html#cb242-43" tabindex="-1"></a></span>
<span id="cb242-44"><a href="aplikace3.html#cb242-44" tabindex="-1"></a><span class="co"># box_col &lt;- c(&#39;#CA0A0A&#39;, &#39;#fa2600&#39;, &#39;#fa2600&#39;, &#39;#D15804&#39;,</span></span>
<span id="cb242-45"><a href="aplikace3.html#cb242-45" tabindex="-1"></a><span class="co">#              &#39;#D15804&#39;, rep(&#39;#D3006D&#39;, 3), rep(&#39;#BE090F&#39;, 3), c(&quot;#12DEE8&quot;, &quot;#4ECBF3&quot;, &quot;#127DE8&quot;, &quot;#4C3CD3&quot;, &quot;#4E65F3&quot;, &quot;#4E9EF3&quot;, &quot;#081D58&quot;) |&gt; rep(each = 3))</span></span>
<span id="cb242-46"><a href="aplikace3.html#cb242-46" tabindex="-1"></a></span>
<span id="cb242-47"><a href="aplikace3.html#cb242-47" tabindex="-1"></a><span class="co"># alpha pro boxploty</span></span>
<span id="cb242-48"><a href="aplikace3.html#cb242-48" tabindex="-1"></a>box_alpha <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>,</span>
<span id="cb242-49"><a href="aplikace3.html#cb242-49" tabindex="-1"></a>               <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>,</span>
<span id="cb242-50"><a href="aplikace3.html#cb242-50" tabindex="-1"></a>               <span class="fu">seq</span>(<span class="fl">0.9</span>, <span class="fl">0.6</span>, <span class="at">length =</span> <span class="dv">9</span>)) <span class="co">#- 0.3</span></span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="aplikace3.html#cb243-1" tabindex="-1"></a><span class="co"># pro trenovaci data</span></span>
<span id="cb243-2"><a href="aplikace3.html#cb243-2" tabindex="-1"></a>SIMULACE<span class="sc">$</span>train <span class="sc">|&gt;</span> </span>
<span id="cb243-3"><a href="aplikace3.html#cb243-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> methods, <span class="at">names_to =</span> <span class="st">&#39;method&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb243-4"><a href="aplikace3.html#cb243-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb243-5"><a href="aplikace3.html#cb243-5" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb243-6"><a href="aplikace3.html#cb243-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> Err, <span class="at">fill =</span> method, <span class="at">colour =</span> method, <span class="at">alpha =</span> <span class="fl">0.3</span>)) <span class="sc">+</span> </span>
<span id="cb243-7"><a href="aplikace3.html#cb243-7" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">&quot;white&quot;</span>, <span class="at">outlier.shape =</span> <span class="dv">16</span>, <span class="at">outlier.size =</span> <span class="dv">0</span>, </span>
<span id="cb243-8"><a href="aplikace3.html#cb243-8" tabindex="-1"></a>               <span class="at">notch =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb243-9"><a href="aplikace3.html#cb243-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb243-10"><a href="aplikace3.html#cb243-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Klasifikační metoda&#39;</span>,</span>
<span id="cb243-11"><a href="aplikace3.html#cb243-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(Err)[train])) <span class="sc">+</span> </span>
<span id="cb243-12"><a href="aplikace3.html#cb243-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb243-13"><a href="aplikace3.html#cb243-13" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">60</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb243-14"><a href="aplikace3.html#cb243-14" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.15</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb243-15"><a href="aplikace3.html#cb243-15" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb243-16"><a href="aplikace3.html#cb243-16" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">shape =</span> <span class="st">&#39;+&#39;</span>,</span>
<span id="cb243-17"><a href="aplikace3.html#cb243-17" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>)<span class="sc">+</span> </span>
<span id="cb243-18"><a href="aplikace3.html#cb243-18" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">min</span>(SIMULACE.df<span class="sc">$</span>Err.train), </span>
<span id="cb243-19"><a href="aplikace3.html#cb243-19" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-232"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-232-1.png" alt="Krabicové diagramy trénovacích chybovostí pro 100 simulací zvlášť pro jednotlivé klasifikační metody. Černými symboly $+$ jsou vyznačeny průměry." width="672" />
<p class="caption">
Obrázek 12.41: Krabicové diagramy trénovacích chybovostí pro 100 simulací zvlášť pro jednotlivé klasifikační metody. Černými symboly <span class="math inline">\(+\)</span> jsou vyznačeny průměry.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="aplikace3.html#cb244-1" tabindex="-1"></a><span class="co"># pro testovaci data</span></span>
<span id="cb244-2"><a href="aplikace3.html#cb244-2" tabindex="-1"></a>SIMULACE<span class="sc">$</span>test <span class="sc">|&gt;</span> </span>
<span id="cb244-3"><a href="aplikace3.html#cb244-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> methods, <span class="at">names_to =</span> <span class="st">&#39;method&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb244-4"><a href="aplikace3.html#cb244-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb244-5"><a href="aplikace3.html#cb244-5" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb244-6"><a href="aplikace3.html#cb244-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> Err, <span class="at">fill =</span> method, <span class="at">colour =</span> method, <span class="at">alpha =</span> method)) <span class="sc">+</span> </span>
<span id="cb244-7"><a href="aplikace3.html#cb244-7" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">&quot;white&quot;</span>, <span class="at">outlier.shape =</span> <span class="dv">16</span>, <span class="at">outlier.size =</span> <span class="dv">0</span>, </span>
<span id="cb244-8"><a href="aplikace3.html#cb244-8" tabindex="-1"></a>               <span class="at">notch =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb244-9"><a href="aplikace3.html#cb244-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb244-10"><a href="aplikace3.html#cb244-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Klasifikační metoda&#39;</span>,</span>
<span id="cb244-11"><a href="aplikace3.html#cb244-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;$</span><span class="sc">\\</span><span class="st">widehat{</span><span class="sc">\\</span><span class="st">textnormal{Err}}_{test}$&quot;</span></span>
<span id="cb244-12"><a href="aplikace3.html#cb244-12" tabindex="-1"></a>       <span class="co"># y = expression(widehat(Err)[test])</span></span>
<span id="cb244-13"><a href="aplikace3.html#cb244-13" tabindex="-1"></a>       ) <span class="sc">+</span> </span>
<span id="cb244-14"><a href="aplikace3.html#cb244-14" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb244-15"><a href="aplikace3.html#cb244-15" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">50</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb244-16"><a href="aplikace3.html#cb244-16" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.15</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="fl">0.9</span>, <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb244-17"><a href="aplikace3.html#cb244-17" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb244-18"><a href="aplikace3.html#cb244-18" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">shape =</span> <span class="st">&#39;+&#39;</span>,</span>
<span id="cb244-19"><a href="aplikace3.html#cb244-19" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb244-20"><a href="aplikace3.html#cb244-20" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> methods_names) <span class="sc">+</span></span>
<span id="cb244-21"><a href="aplikace3.html#cb244-21" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">2</span>), <span class="st">&quot;cm&quot;</span>)) <span class="sc">+</span></span>
<span id="cb244-22"><a href="aplikace3.html#cb244-22" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> box_col) <span class="sc">+</span></span>
<span id="cb244-23"><a href="aplikace3.html#cb244-23" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> box_alpha) <span class="sc">+</span></span>
<span id="cb244-24"><a href="aplikace3.html#cb244-24" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">min</span>(SIMULACE.df<span class="sc">$</span>Err.test), </span>
<span id="cb244-25"><a href="aplikace3.html#cb244-25" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;gray25&#39;</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-234-1.png" alt="Krabicové diagramy testovacích chybovostí pro 100 simulací zvlášť pro jednotlivé klasifikační metody. Černými symboly $+$ jsou vyznačeny průměry." width="672" />
<p class="caption">
Obrázek 12.42: Krabicové diagramy testovacích chybovostí pro 100 simulací zvlášť pro jednotlivé klasifikační metody. Černými symboly <span class="math inline">\(+\)</span> jsou vyznačeny průměry.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="aplikace3.html#cb245-1" tabindex="-1"></a><span class="co"># ggsave(&quot;figures/kap7_tecator_box_test_neder.tex&quot;, device = tikz, width = 9, height = 7)</span></span></code></pre></div>
</details>
<p>Nakonec se podívejme, jaké hodnoty hyperparametrů byly nejčastější volbou.</p>
<table>
<caption><span id="tab:unnamed-chunk-236">Tabulka 12.18: </span>Mediány hodnot hyperparametrů pro vybrané metody, u nichž se určoval nějaký hyperparametr pomocí cross-validace.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">Mediánová hodnota hyperparametru</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>KNN_K</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>nharm</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>LR_func_n_basis</td>
<td align="right">19</td>
</tr>
<tr class="even">
<td>SVM_d_Linear</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td>SVM_d_Poly</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td>SVM_d_Radial</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_radial_gamma1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>SVM_RKHS_radial_gamma2</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_radial_gamma3</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>SVM_RKHS_radial_d1</td>
<td align="right">17</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_radial_d2</td>
<td align="right">16</td>
</tr>
<tr class="even">
<td>SVM_RKHS_radial_d3</td>
<td align="right">20</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_poly_p1</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td>SVM_RKHS_poly_p2</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_poly_p3</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td>SVM_RKHS_poly_d1</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_poly_d2</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td>SVM_RKHS_poly_d3</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_linear_d1</td>
<td align="right">20</td>
</tr>
<tr class="even">
<td>SVM_RKHS_linear_d2</td>
<td align="right">17</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_linear_d3</td>
<td align="right">13</td>
</tr>
</tbody>
</table>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="aplikace3.html#cb246-1" tabindex="-1"></a>CV_res <span class="ot">&lt;-</span> CV_RESULTS <span class="sc">|&gt;</span> </span>
<span id="cb246-2"><a href="aplikace3.html#cb246-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> CV_RESULTS <span class="sc">|&gt;</span> <span class="fu">colnames</span>(), <span class="at">names_to =</span> <span class="st">&#39;method&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;hyperparameter&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb246-3"><a href="aplikace3.html#cb246-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, </span>
<span id="cb246-4"><a href="aplikace3.html#cb246-4" tabindex="-1"></a>                         <span class="at">levels =</span> CV_RESULTS <span class="sc">|&gt;</span> <span class="fu">colnames</span>(), </span>
<span id="cb246-5"><a href="aplikace3.html#cb246-5" tabindex="-1"></a>                         <span class="at">labels =</span> CV_RESULTS <span class="sc">|&gt;</span> <span class="fu">colnames</span>(), <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb246-6"><a href="aplikace3.html#cb246-6" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() </span>
<span id="cb246-7"><a href="aplikace3.html#cb246-7" tabindex="-1"></a></span>
<span id="cb246-8"><a href="aplikace3.html#cb246-8" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb246-9"><a href="aplikace3.html#cb246-9" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;KNN_K&#39;</span>, <span class="st">&#39;nharm&#39;</span>, <span class="st">&#39;LR_func_n_basis&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb246-10"><a href="aplikace3.html#cb246-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb246-11"><a href="aplikace3.html#cb246-11" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb246-12"><a href="aplikace3.html#cb246-12" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb246-13"><a href="aplikace3.html#cb246-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb246-14"><a href="aplikace3.html#cb246-14" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>) <span class="sc">+</span></span>
<span id="cb246-15"><a href="aplikace3.html#cb246-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hodnoty hyperparametru&#39;</span>,</span>
<span id="cb246-16"><a href="aplikace3.html#cb246-16" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolutní počet&#39;</span>) <span class="sc">+</span> </span>
<span id="cb246-17"><a href="aplikace3.html#cb246-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-237"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-237-1.png" alt="Histogramy hodnot hyperparametrů pro KNN, funkcionální logistickou regresi a také histogram pro počet hlavních komponent." width="672" />
<p class="caption">
Obrázek 12.43: Histogramy hodnot hyperparametrů pro KNN, funkcionální logistickou regresi a také histogram pro počet hlavních komponent.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="aplikace3.html#cb247-1" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb247-2"><a href="aplikace3.html#cb247-2" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;SVM_d_Linear&#39;</span>, <span class="st">&#39;SVM_d_Poly&#39;</span>, <span class="st">&#39;SVM_d_Radial&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb247-3"><a href="aplikace3.html#cb247-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb247-4"><a href="aplikace3.html#cb247-4" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb247-5"><a href="aplikace3.html#cb247-5" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb247-6"><a href="aplikace3.html#cb247-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb247-7"><a href="aplikace3.html#cb247-7" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>) <span class="sc">+</span></span>
<span id="cb247-8"><a href="aplikace3.html#cb247-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hodnoty hyperparametru&#39;</span>,</span>
<span id="cb247-9"><a href="aplikace3.html#cb247-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolutní počet&#39;</span>) <span class="sc">+</span> </span>
<span id="cb247-10"><a href="aplikace3.html#cb247-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-239"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-239-1.png" alt="Histogramy hodnot hyperparametrů metody SVM s projekcí na B-splinovou bázi." width="672" />
<p class="caption">
Obrázek 12.44: Histogramy hodnot hyperparametrů metody SVM s projekcí na B-splinovou bázi.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="aplikace3.html#cb248-1" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb248-2"><a href="aplikace3.html#cb248-2" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;SVM_RKHS_radial_gamma1&#39;</span>, <span class="st">&#39;SVM_RKHS_radial_gamma2&#39;</span>,</span>
<span id="cb248-3"><a href="aplikace3.html#cb248-3" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_radial_gamma3&#39;</span>, <span class="st">&#39;SVM_RKHS_radial_d1&#39;</span>, </span>
<span id="cb248-4"><a href="aplikace3.html#cb248-4" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_radial_d2&#39;</span>, <span class="st">&#39;SVM_RKHS_radial_d3&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb248-5"><a href="aplikace3.html#cb248-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb248-6"><a href="aplikace3.html#cb248-6" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb248-7"><a href="aplikace3.html#cb248-7" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">10</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb248-8"><a href="aplikace3.html#cb248-8" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb248-9"><a href="aplikace3.html#cb248-9" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb248-10"><a href="aplikace3.html#cb248-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hodnoty hyperparametru&#39;</span>,</span>
<span id="cb248-11"><a href="aplikace3.html#cb248-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolutní počet&#39;</span>) <span class="sc">+</span> </span>
<span id="cb248-12"><a href="aplikace3.html#cb248-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-241"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-241-1.png" alt="Histogramy hodnot hyperparametrů metody RKHS + SVM s radiálním jádrem." width="672" />
<p class="caption">
Obrázek 12.45: Histogramy hodnot hyperparametrů metody RKHS + SVM s radiálním jádrem.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="aplikace3.html#cb249-1" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb249-2"><a href="aplikace3.html#cb249-2" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;SVM_RKHS_poly_p1&#39;</span>, <span class="st">&#39;SVM_RKHS_poly_p2&#39;</span>,</span>
<span id="cb249-3"><a href="aplikace3.html#cb249-3" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_poly_p3&#39;</span>, <span class="st">&#39;SVM_RKHS_poly_d1&#39;</span>,</span>
<span id="cb249-4"><a href="aplikace3.html#cb249-4" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_poly_d2&#39;</span>, <span class="st">&#39;SVM_RKHS_poly_d3&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb249-5"><a href="aplikace3.html#cb249-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb249-6"><a href="aplikace3.html#cb249-6" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb249-7"><a href="aplikace3.html#cb249-7" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb249-8"><a href="aplikace3.html#cb249-8" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb249-9"><a href="aplikace3.html#cb249-9" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb249-10"><a href="aplikace3.html#cb249-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hodnoty hyperparametru&#39;</span>,</span>
<span id="cb249-11"><a href="aplikace3.html#cb249-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolutní počet&#39;</span>) <span class="sc">+</span> </span>
<span id="cb249-12"><a href="aplikace3.html#cb249-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-243"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-243-1.png" alt="Histogramy hodnot hyperparametrů metody RKHS + SVM s polynomiálním jádrem." width="672" />
<p class="caption">
Obrázek 12.46: Histogramy hodnot hyperparametrů metody RKHS + SVM s polynomiálním jádrem.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="aplikace3.html#cb250-1" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb250-2"><a href="aplikace3.html#cb250-2" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;SVM_RKHS_linear_d1&#39;</span>,</span>
<span id="cb250-3"><a href="aplikace3.html#cb250-3" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_linear_d2&#39;</span>, <span class="st">&#39;SVM_RKHS_linear_d3&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb250-4"><a href="aplikace3.html#cb250-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb250-5"><a href="aplikace3.html#cb250-5" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb250-6"><a href="aplikace3.html#cb250-6" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb250-7"><a href="aplikace3.html#cb250-7" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb250-8"><a href="aplikace3.html#cb250-8" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb250-9"><a href="aplikace3.html#cb250-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hodnoty hyperparametru&#39;</span>,</span>
<span id="cb250-10"><a href="aplikace3.html#cb250-10" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolutní počet&#39;</span>) <span class="sc">+</span> </span>
<span id="cb250-11"><a href="aplikace3.html#cb250-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-245"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-245-1.png" alt="Histogramy hodnot hyperparametrů metody RKHS + SVM s lineárním jádrem." width="672" />
<p class="caption">
Obrázek 12.47: Histogramy hodnot hyperparametrů metody RKHS + SVM s lineárním jádrem.
</p>
</div>
</div>
</div>
<div id="simulace-pro-derivovaná-data" class="section level3 hasAnchor" number="12.7.2">
<h3><span class="header-section-number">12.7.2</span> Simulace pro derivovaná data<a href="aplikace3.html#simulace-pro-derivovaná-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Nyní se konečně podívejme na simulaci derivovaných dat (určili jsme druhou derivaci křivek).</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="aplikace3.html#cb251-1" tabindex="-1"></a><span class="co"># nastaveni generatoru pseudonahodnych cisel</span></span>
<span id="cb251-2"><a href="aplikace3.html#cb251-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb251-3"><a href="aplikace3.html#cb251-3" tabindex="-1"></a></span>
<span id="cb251-4"><a href="aplikace3.html#cb251-4" tabindex="-1"></a><span class="co"># pocet simulaci</span></span>
<span id="cb251-5"><a href="aplikace3.html#cb251-5" tabindex="-1"></a>n.sim <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb251-6"><a href="aplikace3.html#cb251-6" tabindex="-1"></a></span>
<span id="cb251-7"><a href="aplikace3.html#cb251-7" tabindex="-1"></a><span class="do">## list, do ktereho budeme ukladat hodnoty chybovosti</span></span>
<span id="cb251-8"><a href="aplikace3.html#cb251-8" tabindex="-1"></a><span class="co"># ve sloupcich budou metody</span></span>
<span id="cb251-9"><a href="aplikace3.html#cb251-9" tabindex="-1"></a><span class="co"># v radcich budou jednotliva opakovani</span></span>
<span id="cb251-10"><a href="aplikace3.html#cb251-10" tabindex="-1"></a><span class="co"># list ma dve polozky ... train a test</span></span>
<span id="cb251-11"><a href="aplikace3.html#cb251-11" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;KNN&#39;</span>, <span class="st">&#39;LDA&#39;</span>, <span class="st">&#39;QDA&#39;</span>, <span class="st">&#39;LR_functional&#39;</span>, <span class="st">&#39;LR_score&#39;</span>, <span class="st">&#39;Tree_discr&#39;</span>,</span>
<span id="cb251-12"><a href="aplikace3.html#cb251-12" tabindex="-1"></a>             <span class="st">&#39;Tree_score&#39;</span>, <span class="st">&#39;Tree_Bbasis&#39;</span>, <span class="st">&#39;RF_discr&#39;</span>, <span class="st">&#39;RF_score&#39;</span>, <span class="st">&#39;RF_Bbasis&#39;</span>, </span>
<span id="cb251-13"><a href="aplikace3.html#cb251-13" tabindex="-1"></a>             <span class="st">&#39;SVM linear - diskr&#39;</span>, <span class="st">&#39;SVM poly - diskr&#39;</span>, <span class="st">&#39;SVM rbf - diskr&#39;</span>, </span>
<span id="cb251-14"><a href="aplikace3.html#cb251-14" tabindex="-1"></a>             <span class="st">&#39;SVM linear - PCA&#39;</span>, <span class="st">&#39;SVM poly - PCA&#39;</span>, <span class="st">&#39;SVM rbf - PCA&#39;</span>, </span>
<span id="cb251-15"><a href="aplikace3.html#cb251-15" tabindex="-1"></a>             <span class="st">&#39;SVM linear - Bbasis&#39;</span>, <span class="st">&#39;SVM poly - Bbasis&#39;</span>, <span class="st">&#39;SVM rbf - Bbasis&#39;</span>,</span>
<span id="cb251-16"><a href="aplikace3.html#cb251-16" tabindex="-1"></a>             <span class="st">&#39;SVM linear - projection&#39;</span>, <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb251-17"><a href="aplikace3.html#cb251-17" tabindex="-1"></a>             <span class="st">&#39;SVM rbf - projection&#39;</span>, <span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, </span>
<span id="cb251-18"><a href="aplikace3.html#cb251-18" tabindex="-1"></a>             <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>, </span>
<span id="cb251-19"><a href="aplikace3.html#cb251-19" tabindex="-1"></a>             <span class="st">&#39;SVM linear - RKHS - poly&#39;</span>, <span class="st">&#39;SVM poly - RKHS - poly&#39;</span>, </span>
<span id="cb251-20"><a href="aplikace3.html#cb251-20" tabindex="-1"></a>             <span class="st">&#39;SVM rbf - RKHS - poly&#39;</span>, <span class="st">&#39;SVM linear - RKHS - linear&#39;</span>, </span>
<span id="cb251-21"><a href="aplikace3.html#cb251-21" tabindex="-1"></a>             <span class="st">&#39;SVM poly - RKHS - linear&#39;</span>, <span class="st">&#39;SVM rbf - RKHS - linear&#39;</span>)</span>
<span id="cb251-22"><a href="aplikace3.html#cb251-22" tabindex="-1"></a></span>
<span id="cb251-23"><a href="aplikace3.html#cb251-23" tabindex="-1"></a>SIMULACE <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">train =</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(methods), </span>
<span id="cb251-24"><a href="aplikace3.html#cb251-24" tabindex="-1"></a>                                             <span class="at">nrow =</span> n.sim,</span>
<span id="cb251-25"><a href="aplikace3.html#cb251-25" tabindex="-1"></a>                                             <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n.sim, methods))), </span>
<span id="cb251-26"><a href="aplikace3.html#cb251-26" tabindex="-1"></a>                 <span class="at">test =</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(methods), </span>
<span id="cb251-27"><a href="aplikace3.html#cb251-27" tabindex="-1"></a>                                             <span class="at">nrow =</span> n.sim,</span>
<span id="cb251-28"><a href="aplikace3.html#cb251-28" tabindex="-1"></a>                                             <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n.sim, methods))))</span>
<span id="cb251-29"><a href="aplikace3.html#cb251-29" tabindex="-1"></a></span>
<span id="cb251-30"><a href="aplikace3.html#cb251-30" tabindex="-1"></a><span class="co"># objekt na ulozeni optimalnich hodnot hyperparametru, ktere se urcuji pomoci CV</span></span>
<span id="cb251-31"><a href="aplikace3.html#cb251-31" tabindex="-1"></a>CV_RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">KNN_K =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n.sim), </span>
<span id="cb251-32"><a href="aplikace3.html#cb251-32" tabindex="-1"></a>                         <span class="at">nharm =</span> <span class="cn">NA</span>, </span>
<span id="cb251-33"><a href="aplikace3.html#cb251-33" tabindex="-1"></a>                         <span class="at">LR_func_n_basis =</span> <span class="cn">NA</span>,</span>
<span id="cb251-34"><a href="aplikace3.html#cb251-34" tabindex="-1"></a>                         <span class="at">SVM_d_Linear =</span> <span class="cn">NA</span>,</span>
<span id="cb251-35"><a href="aplikace3.html#cb251-35" tabindex="-1"></a>                         <span class="at">SVM_d_Poly =</span> <span class="cn">NA</span>,</span>
<span id="cb251-36"><a href="aplikace3.html#cb251-36" tabindex="-1"></a>                         <span class="at">SVM_d_Radial =</span> <span class="cn">NA</span>, </span>
<span id="cb251-37"><a href="aplikace3.html#cb251-37" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_gamma1 =</span> <span class="cn">NA</span>,</span>
<span id="cb251-38"><a href="aplikace3.html#cb251-38" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_gamma2 =</span> <span class="cn">NA</span>,</span>
<span id="cb251-39"><a href="aplikace3.html#cb251-39" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_gamma3 =</span> <span class="cn">NA</span>,</span>
<span id="cb251-40"><a href="aplikace3.html#cb251-40" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_d1 =</span> <span class="cn">NA</span>,</span>
<span id="cb251-41"><a href="aplikace3.html#cb251-41" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_d2 =</span> <span class="cn">NA</span>,</span>
<span id="cb251-42"><a href="aplikace3.html#cb251-42" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_d3 =</span> <span class="cn">NA</span>,</span>
<span id="cb251-43"><a href="aplikace3.html#cb251-43" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_p1 =</span> <span class="cn">NA</span>,</span>
<span id="cb251-44"><a href="aplikace3.html#cb251-44" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_p2 =</span> <span class="cn">NA</span>,</span>
<span id="cb251-45"><a href="aplikace3.html#cb251-45" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_p3 =</span> <span class="cn">NA</span>,</span>
<span id="cb251-46"><a href="aplikace3.html#cb251-46" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_d1 =</span> <span class="cn">NA</span>,</span>
<span id="cb251-47"><a href="aplikace3.html#cb251-47" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_d2 =</span> <span class="cn">NA</span>,</span>
<span id="cb251-48"><a href="aplikace3.html#cb251-48" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_d3 =</span> <span class="cn">NA</span>,</span>
<span id="cb251-49"><a href="aplikace3.html#cb251-49" tabindex="-1"></a>                         <span class="at">SVM_RKHS_linear_d1 =</span> <span class="cn">NA</span>,</span>
<span id="cb251-50"><a href="aplikace3.html#cb251-50" tabindex="-1"></a>                         <span class="at">SVM_RKHS_linear_d2 =</span> <span class="cn">NA</span>,</span>
<span id="cb251-51"><a href="aplikace3.html#cb251-51" tabindex="-1"></a>                         <span class="at">SVM_RKHS_linear_d3 =</span> <span class="cn">NA</span>)</span></code></pre></div>
</details>
<p>Nyní zopakujeme celou předchozí část 100-krát a hodnoty chybovostí si budeme ukládat to listu <code>SIMULACE</code>.
Do datové tabulky <code>CV_RESULTS</code> si potom budeme ukládat hodnoty optimálních hyperparametrů – pro metodu <span class="math inline">\(K\)</span> nejbližších sousedů a pro SVM hodnotu dimenze <span class="math inline">\(d\)</span> v případě projekce na B-splinovou bázi. Také uložíme všechny hodnoty hyperparametrů pro metodu SVM + RKHS.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="aplikace3.html#cb252-1" tabindex="-1"></a><span class="co"># nastaveni generatoru pseudonahodnych cisel</span></span>
<span id="cb252-2"><a href="aplikace3.html#cb252-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb252-3"><a href="aplikace3.html#cb252-3" tabindex="-1"></a></span>
<span id="cb252-4"><a href="aplikace3.html#cb252-4" tabindex="-1"></a><span class="do">## SIMULACE</span></span>
<span id="cb252-5"><a href="aplikace3.html#cb252-5" tabindex="-1"></a></span>
<span id="cb252-6"><a href="aplikace3.html#cb252-6" tabindex="-1"></a><span class="cf">for</span>(sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.sim) {</span>
<span id="cb252-7"><a href="aplikace3.html#cb252-7" tabindex="-1"></a>  <span class="co"># rozdeleni na testovaci a trenovaci cast</span></span>
<span id="cb252-8"><a href="aplikace3.html#cb252-8" tabindex="-1"></a>  split <span class="ot">&lt;-</span> <span class="fu">sample.split</span>(XXder<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb252-9"><a href="aplikace3.html#cb252-9" tabindex="-1"></a>  </span>
<span id="cb252-10"><a href="aplikace3.html#cb252-10" tabindex="-1"></a>  <span class="co"># vytvoreni vektoru 0 a 1, 0 pro &lt; 20 a 1 pro &gt; 20 </span></span>
<span id="cb252-11"><a href="aplikace3.html#cb252-11" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(labels <span class="sc">==</span> <span class="st">&#39;large&#39;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb252-12"><a href="aplikace3.html#cb252-12" tabindex="-1"></a>  </span>
<span id="cb252-13"><a href="aplikace3.html#cb252-13" tabindex="-1"></a>  X.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXder, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb252-14"><a href="aplikace3.html#cb252-14" tabindex="-1"></a>  X.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXder, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb252-15"><a href="aplikace3.html#cb252-15" tabindex="-1"></a>  </span>
<span id="cb252-16"><a href="aplikace3.html#cb252-16" tabindex="-1"></a>  Y.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb252-17"><a href="aplikace3.html#cb252-17" tabindex="-1"></a>  Y.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb252-18"><a href="aplikace3.html#cb252-18" tabindex="-1"></a>  </span>
<span id="cb252-19"><a href="aplikace3.html#cb252-19" tabindex="-1"></a>  x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb252-20"><a href="aplikace3.html#cb252-20" tabindex="-1"></a>  y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.train))</span>
<span id="cb252-21"><a href="aplikace3.html#cb252-21" tabindex="-1"></a>  </span>
<span id="cb252-22"><a href="aplikace3.html#cb252-22" tabindex="-1"></a>  <span class="do">## 1) K nejbližších sousedů</span></span>
<span id="cb252-23"><a href="aplikace3.html#cb252-23" tabindex="-1"></a>  </span>
<span id="cb252-24"><a href="aplikace3.html#cb252-24" tabindex="-1"></a>  k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb252-25"><a href="aplikace3.html#cb252-25" tabindex="-1"></a>  neighbours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="co"># pocet sousedu </span></span>
<span id="cb252-26"><a href="aplikace3.html#cb252-26" tabindex="-1"></a>  </span>
<span id="cb252-27"><a href="aplikace3.html#cb252-27" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb252-28"><a href="aplikace3.html#cb252-28" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb252-29"><a href="aplikace3.html#cb252-29" tabindex="-1"></a>  </span>
<span id="cb252-30"><a href="aplikace3.html#cb252-30" tabindex="-1"></a>  <span class="co"># kontrola, ze mame opravdu k = k_cv</span></span>
<span id="cb252-31"><a href="aplikace3.html#cb252-31" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">length</span>(folds) <span class="sc">!=</span> k_cv) {</span>
<span id="cb252-32"><a href="aplikace3.html#cb252-32" tabindex="-1"></a>    folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb252-33"><a href="aplikace3.html#cb252-33" tabindex="-1"></a>  }</span>
<span id="cb252-34"><a href="aplikace3.html#cb252-34" tabindex="-1"></a>  </span>
<span id="cb252-35"><a href="aplikace3.html#cb252-35" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(neighbours), <span class="at">ncol =</span> k_cv)</span>
<span id="cb252-36"><a href="aplikace3.html#cb252-36" tabindex="-1"></a>  </span>
<span id="cb252-37"><a href="aplikace3.html#cb252-37" tabindex="-1"></a>  <span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb252-38"><a href="aplikace3.html#cb252-38" tabindex="-1"></a>    <span class="co"># definujeme danou indexovou mnozinu</span></span>
<span id="cb252-39"><a href="aplikace3.html#cb252-39" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb252-40"><a href="aplikace3.html#cb252-40" tabindex="-1"></a>      </span>
<span id="cb252-41"><a href="aplikace3.html#cb252-41" tabindex="-1"></a>    x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb252-42"><a href="aplikace3.html#cb252-42" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb252-43"><a href="aplikace3.html#cb252-43" tabindex="-1"></a>    y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb252-44"><a href="aplikace3.html#cb252-44" tabindex="-1"></a>      <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb252-45"><a href="aplikace3.html#cb252-45" tabindex="-1"></a>    </span>
<span id="cb252-46"><a href="aplikace3.html#cb252-46" tabindex="-1"></a>    x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb252-47"><a href="aplikace3.html#cb252-47" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb252-48"><a href="aplikace3.html#cb252-48" tabindex="-1"></a>    y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb252-49"><a href="aplikace3.html#cb252-49" tabindex="-1"></a>      <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb252-50"><a href="aplikace3.html#cb252-50" tabindex="-1"></a>    </span>
<span id="cb252-51"><a href="aplikace3.html#cb252-51" tabindex="-1"></a>    <span class="co"># projdeme kazdou cast ... k-krat zopakujeme</span></span>
<span id="cb252-52"><a href="aplikace3.html#cb252-52" tabindex="-1"></a>    <span class="cf">for</span>(neighbour <span class="cf">in</span> neighbours) {</span>
<span id="cb252-53"><a href="aplikace3.html#cb252-53" tabindex="-1"></a>      <span class="co"># model pro konkretni volbu K</span></span>
<span id="cb252-54"><a href="aplikace3.html#cb252-54" tabindex="-1"></a>      neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train.cv, </span>
<span id="cb252-55"><a href="aplikace3.html#cb252-55" tabindex="-1"></a>                                <span class="at">fdataobj =</span> x.train.cv, </span>
<span id="cb252-56"><a href="aplikace3.html#cb252-56" tabindex="-1"></a>                                <span class="at">knn =</span> neighbour) </span>
<span id="cb252-57"><a href="aplikace3.html#cb252-57" tabindex="-1"></a>      <span class="co"># predikce na validacni casti</span></span>
<span id="cb252-58"><a href="aplikace3.html#cb252-58" tabindex="-1"></a>      model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb252-59"><a href="aplikace3.html#cb252-59" tabindex="-1"></a>                                      <span class="at">new.fdataobj =</span> x.test.cv)</span>
<span id="cb252-60"><a href="aplikace3.html#cb252-60" tabindex="-1"></a>      <span class="co"># presnost na validacni casti</span></span>
<span id="cb252-61"><a href="aplikace3.html#cb252-61" tabindex="-1"></a>      presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, model.neighb.predict) <span class="sc">|&gt;</span> </span>
<span id="cb252-62"><a href="aplikace3.html#cb252-62" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-63"><a href="aplikace3.html#cb252-63" tabindex="-1"></a>      </span>
<span id="cb252-64"><a href="aplikace3.html#cb252-64" tabindex="-1"></a>      <span class="co"># presnost vlozime na pozici pro dane K a fold</span></span>
<span id="cb252-65"><a href="aplikace3.html#cb252-65" tabindex="-1"></a>      CV.results[neighbour, index] <span class="ot">&lt;-</span> presnost</span>
<span id="cb252-66"><a href="aplikace3.html#cb252-66" tabindex="-1"></a>    }</span>
<span id="cb252-67"><a href="aplikace3.html#cb252-67" tabindex="-1"></a>  }</span>
<span id="cb252-68"><a href="aplikace3.html#cb252-68" tabindex="-1"></a>  </span>
<span id="cb252-69"><a href="aplikace3.html#cb252-69" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva K pres folds</span></span>
<span id="cb252-70"><a href="aplikace3.html#cb252-70" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb252-71"><a href="aplikace3.html#cb252-71" tabindex="-1"></a>  K.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(CV.results)</span>
<span id="cb252-72"><a href="aplikace3.html#cb252-72" tabindex="-1"></a>  CV_RESULTS<span class="sc">$</span>KNN_K[sim] <span class="ot">&lt;-</span> K.opt</span>
<span id="cb252-73"><a href="aplikace3.html#cb252-73" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb252-74"><a href="aplikace3.html#cb252-74" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">K =</span> neighbours, <span class="at">CV =</span> CV.results)</span>
<span id="cb252-75"><a href="aplikace3.html#cb252-75" tabindex="-1"></a>  </span>
<span id="cb252-76"><a href="aplikace3.html#cb252-76" tabindex="-1"></a>  neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, <span class="at">fdataobj =</span> x.train, <span class="at">knn =</span> K.opt)</span>
<span id="cb252-77"><a href="aplikace3.html#cb252-77" tabindex="-1"></a>  </span>
<span id="cb252-78"><a href="aplikace3.html#cb252-78" tabindex="-1"></a>  <span class="co"># predikce</span></span>
<span id="cb252-79"><a href="aplikace3.html#cb252-79" tabindex="-1"></a>  model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb252-80"><a href="aplikace3.html#cb252-80" tabindex="-1"></a>                                  <span class="at">new.fdataobj =</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb252-81"><a href="aplikace3.html#cb252-81" tabindex="-1"></a>  </span>
<span id="cb252-82"><a href="aplikace3.html#cb252-82" tabindex="-1"></a>  presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.test)), model.neighb.predict) <span class="sc">|&gt;</span></span>
<span id="cb252-83"><a href="aplikace3.html#cb252-83" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span></span>
<span id="cb252-84"><a href="aplikace3.html#cb252-84" tabindex="-1"></a>    <span class="fu">diag</span>() <span class="sc">|&gt;</span></span>
<span id="cb252-85"><a href="aplikace3.html#cb252-85" tabindex="-1"></a>    <span class="fu">sum</span>()</span>
<span id="cb252-86"><a href="aplikace3.html#cb252-86" tabindex="-1"></a>  </span>
<span id="cb252-87"><a href="aplikace3.html#cb252-87" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;KNN&#39;</span>, </span>
<span id="cb252-88"><a href="aplikace3.html#cb252-88" tabindex="-1"></a>                        <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> neighb.model<span class="sc">$</span>max.prob,</span>
<span id="cb252-89"><a href="aplikace3.html#cb252-89" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost)</span>
<span id="cb252-90"><a href="aplikace3.html#cb252-90" tabindex="-1"></a>  </span>
<span id="cb252-91"><a href="aplikace3.html#cb252-91" tabindex="-1"></a>  <span class="do">## 2) Lineární diskriminační analýza</span></span>
<span id="cb252-92"><a href="aplikace3.html#cb252-92" tabindex="-1"></a>  </span>
<span id="cb252-93"><a href="aplikace3.html#cb252-93" tabindex="-1"></a>  <span class="co"># analyza hlavnich komponent</span></span>
<span id="cb252-94"><a href="aplikace3.html#cb252-94" tabindex="-1"></a>  data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> <span class="dv">10</span>) <span class="co"># nharm - maximalni pocet HK</span></span>
<span id="cb252-95"><a href="aplikace3.html#cb252-95" tabindex="-1"></a>  nharm <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">cumsum</span>(data.PCA<span class="sc">$</span>varprop) <span class="sc">&gt;=</span> <span class="fl">0.9</span>)[<span class="dv">1</span>] <span class="co"># urceni p</span></span>
<span id="cb252-96"><a href="aplikace3.html#cb252-96" tabindex="-1"></a>  CV_RESULTS<span class="sc">$</span>nharm[sim] <span class="ot">&lt;-</span> nharm</span>
<span id="cb252-97"><a href="aplikace3.html#cb252-97" tabindex="-1"></a>  <span class="cf">if</span>(nharm <span class="sc">==</span> <span class="dv">1</span>) nharm <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb252-98"><a href="aplikace3.html#cb252-98" tabindex="-1"></a>  </span>
<span id="cb252-99"><a href="aplikace3.html#cb252-99" tabindex="-1"></a>  data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> nharm) </span>
<span id="cb252-100"><a href="aplikace3.html#cb252-100" tabindex="-1"></a>  data.PCA.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA<span class="sc">$</span>scores) <span class="co"># skore prvnich p HK</span></span>
<span id="cb252-101"><a href="aplikace3.html#cb252-101" tabindex="-1"></a>  data.PCA.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train) <span class="co"># prislusnost do trid</span></span>
<span id="cb252-102"><a href="aplikace3.html#cb252-102" tabindex="-1"></a>  </span>
<span id="cb252-103"><a href="aplikace3.html#cb252-103" tabindex="-1"></a>  <span class="co"># vypocet skoru testovacich funkci</span></span>
<span id="cb252-104"><a href="aplikace3.html#cb252-104" tabindex="-1"></a>  scores <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> nharm, <span class="at">nrow =</span> <span class="fu">length</span>(Y.test)) <span class="co"># prazdna matice </span></span>
<span id="cb252-105"><a href="aplikace3.html#cb252-105" tabindex="-1"></a>  </span>
<span id="cb252-106"><a href="aplikace3.html#cb252-106" tabindex="-1"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(scores)[<span class="dv">1</span>]) {</span>
<span id="cb252-107"><a href="aplikace3.html#cb252-107" tabindex="-1"></a>    xfd <span class="ot">=</span> X.test[k] <span class="sc">-</span> data.PCA<span class="sc">$</span>meanfd[<span class="dv">1</span>] <span class="co"># k-te pozorovani - prumerna funkce</span></span>
<span id="cb252-108"><a href="aplikace3.html#cb252-108" tabindex="-1"></a>    scores[k, ] <span class="ot">=</span> <span class="fu">inprod</span>(xfd, data.PCA<span class="sc">$</span>harmonics) </span>
<span id="cb252-109"><a href="aplikace3.html#cb252-109" tabindex="-1"></a>    <span class="co"># skalarni soucin rezidua a vlastnich funkci rho (funkcionalni hlavni komponenty)</span></span>
<span id="cb252-110"><a href="aplikace3.html#cb252-110" tabindex="-1"></a>  }</span>
<span id="cb252-111"><a href="aplikace3.html#cb252-111" tabindex="-1"></a>  </span>
<span id="cb252-112"><a href="aplikace3.html#cb252-112" tabindex="-1"></a>  data.PCA.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(scores)</span>
<span id="cb252-113"><a href="aplikace3.html#cb252-113" tabindex="-1"></a>  data.PCA.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb252-114"><a href="aplikace3.html#cb252-114" tabindex="-1"></a>  <span class="fu">colnames</span>(data.PCA.test) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data.PCA.train) </span>
<span id="cb252-115"><a href="aplikace3.html#cb252-115" tabindex="-1"></a>  </span>
<span id="cb252-116"><a href="aplikace3.html#cb252-116" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb252-117"><a href="aplikace3.html#cb252-117" tabindex="-1"></a>  clf.LDA <span class="ot">&lt;-</span> <span class="fu">lda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb252-118"><a href="aplikace3.html#cb252-118" tabindex="-1"></a>  </span>
<span id="cb252-119"><a href="aplikace3.html#cb252-119" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb252-120"><a href="aplikace3.html#cb252-120" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb252-121"><a href="aplikace3.html#cb252-121" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb252-122"><a href="aplikace3.html#cb252-122" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-123"><a href="aplikace3.html#cb252-123" tabindex="-1"></a>    </span>
<span id="cb252-124"><a href="aplikace3.html#cb252-124" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb252-125"><a href="aplikace3.html#cb252-125" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb252-126"><a href="aplikace3.html#cb252-126" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb252-127"><a href="aplikace3.html#cb252-127" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-128"><a href="aplikace3.html#cb252-128" tabindex="-1"></a>  </span>
<span id="cb252-129"><a href="aplikace3.html#cb252-129" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LDA&#39;</span>, </span>
<span id="cb252-130"><a href="aplikace3.html#cb252-130" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb252-131"><a href="aplikace3.html#cb252-131" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb252-132"><a href="aplikace3.html#cb252-132" tabindex="-1"></a>  </span>
<span id="cb252-133"><a href="aplikace3.html#cb252-133" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb252-134"><a href="aplikace3.html#cb252-134" tabindex="-1"></a>  </span>
<span id="cb252-135"><a href="aplikace3.html#cb252-135" tabindex="-1"></a>  <span class="do">## 3) Kvadratická diskriminační analýza</span></span>
<span id="cb252-136"><a href="aplikace3.html#cb252-136" tabindex="-1"></a>  </span>
<span id="cb252-137"><a href="aplikace3.html#cb252-137" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb252-138"><a href="aplikace3.html#cb252-138" tabindex="-1"></a>  clf.QDA <span class="ot">&lt;-</span> <span class="fu">qda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb252-139"><a href="aplikace3.html#cb252-139" tabindex="-1"></a>  </span>
<span id="cb252-140"><a href="aplikace3.html#cb252-140" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb252-141"><a href="aplikace3.html#cb252-141" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb252-142"><a href="aplikace3.html#cb252-142" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb252-143"><a href="aplikace3.html#cb252-143" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-144"><a href="aplikace3.html#cb252-144" tabindex="-1"></a>    </span>
<span id="cb252-145"><a href="aplikace3.html#cb252-145" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb252-146"><a href="aplikace3.html#cb252-146" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb252-147"><a href="aplikace3.html#cb252-147" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb252-148"><a href="aplikace3.html#cb252-148" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-149"><a href="aplikace3.html#cb252-149" tabindex="-1"></a>  </span>
<span id="cb252-150"><a href="aplikace3.html#cb252-150" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;QDA&#39;</span>, </span>
<span id="cb252-151"><a href="aplikace3.html#cb252-151" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb252-152"><a href="aplikace3.html#cb252-152" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb252-153"><a href="aplikace3.html#cb252-153" tabindex="-1"></a>  </span>
<span id="cb252-154"><a href="aplikace3.html#cb252-154" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb252-155"><a href="aplikace3.html#cb252-155" tabindex="-1"></a>  </span>
<span id="cb252-156"><a href="aplikace3.html#cb252-156" tabindex="-1"></a>  <span class="do">## 4) Logistická regrese</span></span>
<span id="cb252-157"><a href="aplikace3.html#cb252-157" tabindex="-1"></a>  <span class="do">### 4.1) Funkcionální logistická regrese</span></span>
<span id="cb252-158"><a href="aplikace3.html#cb252-158" tabindex="-1"></a>  </span>
<span id="cb252-159"><a href="aplikace3.html#cb252-159" tabindex="-1"></a>  <span class="co"># vytvorime vhodne objekty</span></span>
<span id="cb252-160"><a href="aplikace3.html#cb252-160" tabindex="-1"></a>  x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb252-161"><a href="aplikace3.html#cb252-161" tabindex="-1"></a>  y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Y.train)</span>
<span id="cb252-162"><a href="aplikace3.html#cb252-162" tabindex="-1"></a>  </span>
<span id="cb252-163"><a href="aplikace3.html#cb252-163" tabindex="-1"></a>  <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb252-164"><a href="aplikace3.html#cb252-164" tabindex="-1"></a>  tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb252-165"><a href="aplikace3.html#cb252-165" tabindex="-1"></a>  </span>
<span id="cb252-166"><a href="aplikace3.html#cb252-166" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb252-167"><a href="aplikace3.html#cb252-167" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb252-168"><a href="aplikace3.html#cb252-168" tabindex="-1"></a>  <span class="co"># B-spline baze </span></span>
<span id="cb252-169"><a href="aplikace3.html#cb252-169" tabindex="-1"></a>  nbasis.x <span class="ot">&lt;-</span> <span class="dv">7</span></span>
<span id="cb252-170"><a href="aplikace3.html#cb252-170" tabindex="-1"></a>  basis1 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), </span>
<span id="cb252-171"><a href="aplikace3.html#cb252-171" tabindex="-1"></a>                                 <span class="at">nbasis =</span> nbasis.x)</span>
<span id="cb252-172"><a href="aplikace3.html#cb252-172" tabindex="-1"></a>  </span>
<span id="cb252-173"><a href="aplikace3.html#cb252-173" tabindex="-1"></a>  <span class="do">### 10-fold cross-validation</span></span>
<span id="cb252-174"><a href="aplikace3.html#cb252-174" tabindex="-1"></a>  n.basis.max <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb252-175"><a href="aplikace3.html#cb252-175" tabindex="-1"></a>  n.basis <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span>n.basis.max</span>
<span id="cb252-176"><a href="aplikace3.html#cb252-176" tabindex="-1"></a>  k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb252-177"><a href="aplikace3.html#cb252-177" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb252-178"><a href="aplikace3.html#cb252-178" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb252-179"><a href="aplikace3.html#cb252-179" tabindex="-1"></a>  <span class="co"># kontrola, ze mame opravdu k = k_cv</span></span>
<span id="cb252-180"><a href="aplikace3.html#cb252-180" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">length</span>(folds) <span class="sc">!=</span> k_cv) {</span>
<span id="cb252-181"><a href="aplikace3.html#cb252-181" tabindex="-1"></a>    folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb252-182"><a href="aplikace3.html#cb252-182" tabindex="-1"></a>  }</span>
<span id="cb252-183"><a href="aplikace3.html#cb252-183" tabindex="-1"></a>  <span class="do">## prvky, ktere se behem cyklu nemeni</span></span>
<span id="cb252-184"><a href="aplikace3.html#cb252-184" tabindex="-1"></a>  <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb252-185"><a href="aplikace3.html#cb252-185" tabindex="-1"></a>  tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb252-186"><a href="aplikace3.html#cb252-186" tabindex="-1"></a>  rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(tt)</span>
<span id="cb252-187"><a href="aplikace3.html#cb252-187" tabindex="-1"></a>  <span class="co"># vztah</span></span>
<span id="cb252-188"><a href="aplikace3.html#cb252-188" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb252-189"><a href="aplikace3.html#cb252-189" tabindex="-1"></a>  <span class="co"># baze pro x</span></span>
<span id="cb252-190"><a href="aplikace3.html#cb252-190" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1)</span>
<span id="cb252-191"><a href="aplikace3.html#cb252-191" tabindex="-1"></a>  </span>
<span id="cb252-192"><a href="aplikace3.html#cb252-192" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(n.basis), <span class="at">ncol =</span> k_cv, </span>
<span id="cb252-193"><a href="aplikace3.html#cb252-193" tabindex="-1"></a>                       <span class="at">dimnames =</span> <span class="fu">list</span>(n.basis, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb252-194"><a href="aplikace3.html#cb252-194" tabindex="-1"></a>  </span>
<span id="cb252-195"><a href="aplikace3.html#cb252-195" tabindex="-1"></a>  <span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb252-196"><a href="aplikace3.html#cb252-196" tabindex="-1"></a>    <span class="co"># definujeme danou indexovou mnozinu</span></span>
<span id="cb252-197"><a href="aplikace3.html#cb252-197" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb252-198"><a href="aplikace3.html#cb252-198" tabindex="-1"></a>      </span>
<span id="cb252-199"><a href="aplikace3.html#cb252-199" tabindex="-1"></a>    x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb252-200"><a href="aplikace3.html#cb252-200" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb252-201"><a href="aplikace3.html#cb252-201" tabindex="-1"></a>    y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb252-202"><a href="aplikace3.html#cb252-202" tabindex="-1"></a>      <span class="fu">as.numeric</span>()</span>
<span id="cb252-203"><a href="aplikace3.html#cb252-203" tabindex="-1"></a>    </span>
<span id="cb252-204"><a href="aplikace3.html#cb252-204" tabindex="-1"></a>    x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb252-205"><a href="aplikace3.html#cb252-205" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb252-206"><a href="aplikace3.html#cb252-206" tabindex="-1"></a>    y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb252-207"><a href="aplikace3.html#cb252-207" tabindex="-1"></a>      <span class="fu">as.numeric</span>()</span>
<span id="cb252-208"><a href="aplikace3.html#cb252-208" tabindex="-1"></a>    </span>
<span id="cb252-209"><a href="aplikace3.html#cb252-209" tabindex="-1"></a>    dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train.cv) </span>
<span id="cb252-210"><a href="aplikace3.html#cb252-210" tabindex="-1"></a>    <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb252-211"><a href="aplikace3.html#cb252-211" tabindex="-1"></a>    </span>
<span id="cb252-212"><a href="aplikace3.html#cb252-212" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> n.basis) {</span>
<span id="cb252-213"><a href="aplikace3.html#cb252-213" tabindex="-1"></a>      <span class="co"># baze pro bety</span></span>
<span id="cb252-214"><a href="aplikace3.html#cb252-214" tabindex="-1"></a>      basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, <span class="at">nbasis =</span> i)</span>
<span id="cb252-215"><a href="aplikace3.html#cb252-215" tabindex="-1"></a>      </span>
<span id="cb252-216"><a href="aplikace3.html#cb252-216" tabindex="-1"></a>      basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb252-217"><a href="aplikace3.html#cb252-217" tabindex="-1"></a>      <span class="co"># vstupni data do modelu</span></span>
<span id="cb252-218"><a href="aplikace3.html#cb252-218" tabindex="-1"></a>      ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train.cv)</span>
<span id="cb252-219"><a href="aplikace3.html#cb252-219" tabindex="-1"></a>      <span class="co"># binomicky model ... model logisticke regrese</span></span>
<span id="cb252-220"><a href="aplikace3.html#cb252-220" tabindex="-1"></a>      model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb252-221"><a href="aplikace3.html#cb252-221" tabindex="-1"></a>                              <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb252-222"><a href="aplikace3.html#cb252-222" tabindex="-1"></a>      </span>
<span id="cb252-223"><a href="aplikace3.html#cb252-223" tabindex="-1"></a>      <span class="co"># presnost na validacni casti </span></span>
<span id="cb252-224"><a href="aplikace3.html#cb252-224" tabindex="-1"></a>      newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(y.test.cv), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb252-225"><a href="aplikace3.html#cb252-225" tabindex="-1"></a>      predictions.valid <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb252-226"><a href="aplikace3.html#cb252-226" tabindex="-1"></a>      predictions.valid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.valid <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb252-227"><a href="aplikace3.html#cb252-227" tabindex="-1"></a>      presnost.valid <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, predictions.valid<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb252-228"><a href="aplikace3.html#cb252-228" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-229"><a href="aplikace3.html#cb252-229" tabindex="-1"></a>      </span>
<span id="cb252-230"><a href="aplikace3.html#cb252-230" tabindex="-1"></a>      <span class="co"># vlozime do matice</span></span>
<span id="cb252-231"><a href="aplikace3.html#cb252-231" tabindex="-1"></a>      CV.results[<span class="fu">as.character</span>(i), <span class="fu">as.character</span>(index)] <span class="ot">&lt;-</span> presnost.valid</span>
<span id="cb252-232"><a href="aplikace3.html#cb252-232" tabindex="-1"></a>    } </span>
<span id="cb252-233"><a href="aplikace3.html#cb252-233" tabindex="-1"></a>  }</span>
<span id="cb252-234"><a href="aplikace3.html#cb252-234" tabindex="-1"></a>  </span>
<span id="cb252-235"><a href="aplikace3.html#cb252-235" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva n pres folds</span></span>
<span id="cb252-236"><a href="aplikace3.html#cb252-236" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb252-237"><a href="aplikace3.html#cb252-237" tabindex="-1"></a>  n.basis.opt <span class="ot">&lt;-</span> n.basis[<span class="fu">which.max</span>(CV.results)]</span>
<span id="cb252-238"><a href="aplikace3.html#cb252-238" tabindex="-1"></a>  CV_RESULTS<span class="sc">$</span>LR_func_n_basis[sim] <span class="ot">&lt;-</span> n.basis.opt</span>
<span id="cb252-239"><a href="aplikace3.html#cb252-239" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb252-240"><a href="aplikace3.html#cb252-240" tabindex="-1"></a>  </span>
<span id="cb252-241"><a href="aplikace3.html#cb252-241" tabindex="-1"></a>  <span class="co"># optimalni model</span></span>
<span id="cb252-242"><a href="aplikace3.html#cb252-242" tabindex="-1"></a>  basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> n.basis.opt)</span>
<span id="cb252-243"><a href="aplikace3.html#cb252-243" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb252-244"><a href="aplikace3.html#cb252-244" tabindex="-1"></a>  <span class="co"># baze pro x a bety</span></span>
<span id="cb252-245"><a href="aplikace3.html#cb252-245" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb252-246"><a href="aplikace3.html#cb252-246" tabindex="-1"></a>  basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb252-247"><a href="aplikace3.html#cb252-247" tabindex="-1"></a>  <span class="co"># vstupni data do modelu</span></span>
<span id="cb252-248"><a href="aplikace3.html#cb252-248" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb252-249"><a href="aplikace3.html#cb252-249" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb252-250"><a href="aplikace3.html#cb252-250" tabindex="-1"></a>  ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb252-251"><a href="aplikace3.html#cb252-251" tabindex="-1"></a>  <span class="co"># binomicky model ... model logisticke regrese</span></span>
<span id="cb252-252"><a href="aplikace3.html#cb252-252" tabindex="-1"></a>  model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb252-253"><a href="aplikace3.html#cb252-253" tabindex="-1"></a>                          <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb252-254"><a href="aplikace3.html#cb252-254" tabindex="-1"></a>  </span>
<span id="cb252-255"><a href="aplikace3.html#cb252-255" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb252-256"><a href="aplikace3.html#cb252-256" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> ldata)</span>
<span id="cb252-257"><a href="aplikace3.html#cb252-257" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb252-258"><a href="aplikace3.html#cb252-258" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb252-259"><a href="aplikace3.html#cb252-259" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-260"><a href="aplikace3.html#cb252-260" tabindex="-1"></a>    </span>
<span id="cb252-261"><a href="aplikace3.html#cb252-261" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb252-262"><a href="aplikace3.html#cb252-262" tabindex="-1"></a>  newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(Y.test), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb252-263"><a href="aplikace3.html#cb252-263" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb252-264"><a href="aplikace3.html#cb252-264" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb252-265"><a href="aplikace3.html#cb252-265" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb252-266"><a href="aplikace3.html#cb252-266" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-267"><a href="aplikace3.html#cb252-267" tabindex="-1"></a>  </span>
<span id="cb252-268"><a href="aplikace3.html#cb252-268" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR_functional&#39;</span>, </span>
<span id="cb252-269"><a href="aplikace3.html#cb252-269" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb252-270"><a href="aplikace3.html#cb252-270" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb252-271"><a href="aplikace3.html#cb252-271" tabindex="-1"></a>  </span>
<span id="cb252-272"><a href="aplikace3.html#cb252-272" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb252-273"><a href="aplikace3.html#cb252-273" tabindex="-1"></a>  </span>
<span id="cb252-274"><a href="aplikace3.html#cb252-274" tabindex="-1"></a>  <span class="do">### 4.2) Logistická regrese s analýzou hlavních komponent</span></span>
<span id="cb252-275"><a href="aplikace3.html#cb252-275" tabindex="-1"></a>  </span>
<span id="cb252-276"><a href="aplikace3.html#cb252-276" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb252-277"><a href="aplikace3.html#cb252-277" tabindex="-1"></a>  clf.LR <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span>  ., <span class="at">data =</span> data.PCA.train, <span class="at">family =</span> binomial)</span>
<span id="cb252-278"><a href="aplikace3.html#cb252-278" tabindex="-1"></a>  </span>
<span id="cb252-279"><a href="aplikace3.html#cb252-279" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb252-280"><a href="aplikace3.html#cb252-280" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.train, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb252-281"><a href="aplikace3.html#cb252-281" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb252-282"><a href="aplikace3.html#cb252-282" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb252-283"><a href="aplikace3.html#cb252-283" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-284"><a href="aplikace3.html#cb252-284" tabindex="-1"></a>    </span>
<span id="cb252-285"><a href="aplikace3.html#cb252-285" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb252-286"><a href="aplikace3.html#cb252-286" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.test, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb252-287"><a href="aplikace3.html#cb252-287" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb252-288"><a href="aplikace3.html#cb252-288" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb252-289"><a href="aplikace3.html#cb252-289" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-290"><a href="aplikace3.html#cb252-290" tabindex="-1"></a>  </span>
<span id="cb252-291"><a href="aplikace3.html#cb252-291" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR_score&#39;</span>, </span>
<span id="cb252-292"><a href="aplikace3.html#cb252-292" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb252-293"><a href="aplikace3.html#cb252-293" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb252-294"><a href="aplikace3.html#cb252-294" tabindex="-1"></a>  </span>
<span id="cb252-295"><a href="aplikace3.html#cb252-295" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb252-296"><a href="aplikace3.html#cb252-296" tabindex="-1"></a>  </span>
<span id="cb252-297"><a href="aplikace3.html#cb252-297" tabindex="-1"></a>  <span class="do">## 5) Rozhodovací stromy</span></span>
<span id="cb252-298"><a href="aplikace3.html#cb252-298" tabindex="-1"></a>  <span class="do">### 5.1) Diskretizace intervalu</span></span>
<span id="cb252-299"><a href="aplikace3.html#cb252-299" tabindex="-1"></a>  </span>
<span id="cb252-300"><a href="aplikace3.html#cb252-300" tabindex="-1"></a>  <span class="co"># posloupnost bodu, ve kterych funkce vyhodnotime</span></span>
<span id="cb252-301"><a href="aplikace3.html#cb252-301" tabindex="-1"></a>  t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(t), <span class="fu">max</span>(t), <span class="at">length =</span> <span class="dv">101</span>)</span>
<span id="cb252-302"><a href="aplikace3.html#cb252-302" tabindex="-1"></a>     </span>
<span id="cb252-303"><a href="aplikace3.html#cb252-303" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb252-304"><a href="aplikace3.html#cb252-304" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) <span class="co"># transpozice kvuli funkcim v radku</span></span>
<span id="cb252-305"><a href="aplikace3.html#cb252-305" tabindex="-1"></a>  grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb252-306"><a href="aplikace3.html#cb252-306" tabindex="-1"></a>  </span>
<span id="cb252-307"><a href="aplikace3.html#cb252-307" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb252-308"><a href="aplikace3.html#cb252-308" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb252-309"><a href="aplikace3.html#cb252-309" tabindex="-1"></a>  grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb252-310"><a href="aplikace3.html#cb252-310" tabindex="-1"></a>  </span>
<span id="cb252-311"><a href="aplikace3.html#cb252-311" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb252-312"><a href="aplikace3.html#cb252-312" tabindex="-1"></a>  clf.tree <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb252-313"><a href="aplikace3.html#cb252-313" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb252-314"><a href="aplikace3.html#cb252-314" tabindex="-1"></a>                   <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb252-315"><a href="aplikace3.html#cb252-315" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb252-316"><a href="aplikace3.html#cb252-316" tabindex="-1"></a>  </span>
<span id="cb252-317"><a href="aplikace3.html#cb252-317" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb252-318"><a href="aplikace3.html#cb252-318" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data)</span>
<span id="cb252-319"><a href="aplikace3.html#cb252-319" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb252-320"><a href="aplikace3.html#cb252-320" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-321"><a href="aplikace3.html#cb252-321" tabindex="-1"></a>    </span>
<span id="cb252-322"><a href="aplikace3.html#cb252-322" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb252-323"><a href="aplikace3.html#cb252-323" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb252-324"><a href="aplikace3.html#cb252-324" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb252-325"><a href="aplikace3.html#cb252-325" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-326"><a href="aplikace3.html#cb252-326" tabindex="-1"></a>  </span>
<span id="cb252-327"><a href="aplikace3.html#cb252-327" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree_discr&#39;</span>, </span>
<span id="cb252-328"><a href="aplikace3.html#cb252-328" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb252-329"><a href="aplikace3.html#cb252-329" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb252-330"><a href="aplikace3.html#cb252-330" tabindex="-1"></a>  </span>
<span id="cb252-331"><a href="aplikace3.html#cb252-331" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb252-332"><a href="aplikace3.html#cb252-332" tabindex="-1"></a>  </span>
<span id="cb252-333"><a href="aplikace3.html#cb252-333" tabindex="-1"></a>  <span class="do">### 5.2) Skóre hlavních komponent</span></span>
<span id="cb252-334"><a href="aplikace3.html#cb252-334" tabindex="-1"></a>  </span>
<span id="cb252-335"><a href="aplikace3.html#cb252-335" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb252-336"><a href="aplikace3.html#cb252-336" tabindex="-1"></a>  clf.tree.PCA <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb252-337"><a href="aplikace3.html#cb252-337" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb252-338"><a href="aplikace3.html#cb252-338" tabindex="-1"></a>                   <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb252-339"><a href="aplikace3.html#cb252-339" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb252-340"><a href="aplikace3.html#cb252-340" tabindex="-1"></a>  </span>
<span id="cb252-341"><a href="aplikace3.html#cb252-341" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb252-342"><a href="aplikace3.html#cb252-342" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb252-343"><a href="aplikace3.html#cb252-343" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb252-344"><a href="aplikace3.html#cb252-344" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-345"><a href="aplikace3.html#cb252-345" tabindex="-1"></a>    </span>
<span id="cb252-346"><a href="aplikace3.html#cb252-346" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb252-347"><a href="aplikace3.html#cb252-347" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb252-348"><a href="aplikace3.html#cb252-348" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb252-349"><a href="aplikace3.html#cb252-349" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-350"><a href="aplikace3.html#cb252-350" tabindex="-1"></a>  </span>
<span id="cb252-351"><a href="aplikace3.html#cb252-351" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree_score&#39;</span>, </span>
<span id="cb252-352"><a href="aplikace3.html#cb252-352" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb252-353"><a href="aplikace3.html#cb252-353" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb252-354"><a href="aplikace3.html#cb252-354" tabindex="-1"></a>  </span>
<span id="cb252-355"><a href="aplikace3.html#cb252-355" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb252-356"><a href="aplikace3.html#cb252-356" tabindex="-1"></a>  </span>
<span id="cb252-357"><a href="aplikace3.html#cb252-357" tabindex="-1"></a>  <span class="do">### 5.3) Bázové koeficienty</span></span>
<span id="cb252-358"><a href="aplikace3.html#cb252-358" tabindex="-1"></a>  </span>
<span id="cb252-359"><a href="aplikace3.html#cb252-359" tabindex="-1"></a>  <span class="co"># trenovaci dataset</span></span>
<span id="cb252-360"><a href="aplikace3.html#cb252-360" tabindex="-1"></a>  data.Bbasis.train <span class="ot">&lt;-</span> <span class="fu">t</span>(X.train<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb252-361"><a href="aplikace3.html#cb252-361" tabindex="-1"></a>  data.Bbasis.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb252-362"><a href="aplikace3.html#cb252-362" tabindex="-1"></a>  </span>
<span id="cb252-363"><a href="aplikace3.html#cb252-363" tabindex="-1"></a>  <span class="co"># testovaci dataset</span></span>
<span id="cb252-364"><a href="aplikace3.html#cb252-364" tabindex="-1"></a>  data.Bbasis.test <span class="ot">&lt;-</span> <span class="fu">t</span>(X.test<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb252-365"><a href="aplikace3.html#cb252-365" tabindex="-1"></a>  data.Bbasis.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb252-366"><a href="aplikace3.html#cb252-366" tabindex="-1"></a>  </span>
<span id="cb252-367"><a href="aplikace3.html#cb252-367" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb252-368"><a href="aplikace3.html#cb252-368" tabindex="-1"></a>  clf.tree.Bbasis <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb252-369"><a href="aplikace3.html#cb252-369" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb252-370"><a href="aplikace3.html#cb252-370" tabindex="-1"></a>                   <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb252-371"><a href="aplikace3.html#cb252-371" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb252-372"><a href="aplikace3.html#cb252-372" tabindex="-1"></a>  </span>
<span id="cb252-373"><a href="aplikace3.html#cb252-373" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb252-374"><a href="aplikace3.html#cb252-374" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb252-375"><a href="aplikace3.html#cb252-375" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb252-376"><a href="aplikace3.html#cb252-376" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-377"><a href="aplikace3.html#cb252-377" tabindex="-1"></a>    </span>
<span id="cb252-378"><a href="aplikace3.html#cb252-378" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb252-379"><a href="aplikace3.html#cb252-379" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb252-380"><a href="aplikace3.html#cb252-380" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb252-381"><a href="aplikace3.html#cb252-381" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-382"><a href="aplikace3.html#cb252-382" tabindex="-1"></a>  </span>
<span id="cb252-383"><a href="aplikace3.html#cb252-383" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree_Bbasis&#39;</span>, </span>
<span id="cb252-384"><a href="aplikace3.html#cb252-384" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb252-385"><a href="aplikace3.html#cb252-385" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb252-386"><a href="aplikace3.html#cb252-386" tabindex="-1"></a>  </span>
<span id="cb252-387"><a href="aplikace3.html#cb252-387" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb252-388"><a href="aplikace3.html#cb252-388" tabindex="-1"></a>  </span>
<span id="cb252-389"><a href="aplikace3.html#cb252-389" tabindex="-1"></a>  <span class="do">## 6) Náhodné lesy</span></span>
<span id="cb252-390"><a href="aplikace3.html#cb252-390" tabindex="-1"></a>  </span>
<span id="cb252-391"><a href="aplikace3.html#cb252-391" tabindex="-1"></a>  <span class="do">### 6.1) Diskretizace intervalu</span></span>
<span id="cb252-392"><a href="aplikace3.html#cb252-392" tabindex="-1"></a>  </span>
<span id="cb252-393"><a href="aplikace3.html#cb252-393" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb252-394"><a href="aplikace3.html#cb252-394" tabindex="-1"></a>  clf.RF <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb252-395"><a href="aplikace3.html#cb252-395" tabindex="-1"></a>                         <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb252-396"><a href="aplikace3.html#cb252-396" tabindex="-1"></a>                         <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-397"><a href="aplikace3.html#cb252-397" tabindex="-1"></a>                         <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb252-398"><a href="aplikace3.html#cb252-398" tabindex="-1"></a>  </span>
<span id="cb252-399"><a href="aplikace3.html#cb252-399" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb252-400"><a href="aplikace3.html#cb252-400" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data)</span>
<span id="cb252-401"><a href="aplikace3.html#cb252-401" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb252-402"><a href="aplikace3.html#cb252-402" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-403"><a href="aplikace3.html#cb252-403" tabindex="-1"></a>    </span>
<span id="cb252-404"><a href="aplikace3.html#cb252-404" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb252-405"><a href="aplikace3.html#cb252-405" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb252-406"><a href="aplikace3.html#cb252-406" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb252-407"><a href="aplikace3.html#cb252-407" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-408"><a href="aplikace3.html#cb252-408" tabindex="-1"></a>  </span>
<span id="cb252-409"><a href="aplikace3.html#cb252-409" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_discr&#39;</span>, </span>
<span id="cb252-410"><a href="aplikace3.html#cb252-410" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb252-411"><a href="aplikace3.html#cb252-411" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb252-412"><a href="aplikace3.html#cb252-412" tabindex="-1"></a>  </span>
<span id="cb252-413"><a href="aplikace3.html#cb252-413" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb252-414"><a href="aplikace3.html#cb252-414" tabindex="-1"></a>  </span>
<span id="cb252-415"><a href="aplikace3.html#cb252-415" tabindex="-1"></a>  <span class="do">### 6.2) Skóre hlavních komponent</span></span>
<span id="cb252-416"><a href="aplikace3.html#cb252-416" tabindex="-1"></a>  </span>
<span id="cb252-417"><a href="aplikace3.html#cb252-417" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb252-418"><a href="aplikace3.html#cb252-418" tabindex="-1"></a>  clf.RF.PCA <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb252-419"><a href="aplikace3.html#cb252-419" tabindex="-1"></a>                             <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb252-420"><a href="aplikace3.html#cb252-420" tabindex="-1"></a>                             <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-421"><a href="aplikace3.html#cb252-421" tabindex="-1"></a>                             <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb252-422"><a href="aplikace3.html#cb252-422" tabindex="-1"></a>  </span>
<span id="cb252-423"><a href="aplikace3.html#cb252-423" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb252-424"><a href="aplikace3.html#cb252-424" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb252-425"><a href="aplikace3.html#cb252-425" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb252-426"><a href="aplikace3.html#cb252-426" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-427"><a href="aplikace3.html#cb252-427" tabindex="-1"></a>    </span>
<span id="cb252-428"><a href="aplikace3.html#cb252-428" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb252-429"><a href="aplikace3.html#cb252-429" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb252-430"><a href="aplikace3.html#cb252-430" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb252-431"><a href="aplikace3.html#cb252-431" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-432"><a href="aplikace3.html#cb252-432" tabindex="-1"></a>  </span>
<span id="cb252-433"><a href="aplikace3.html#cb252-433" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_score&#39;</span>, </span>
<span id="cb252-434"><a href="aplikace3.html#cb252-434" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb252-435"><a href="aplikace3.html#cb252-435" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb252-436"><a href="aplikace3.html#cb252-436" tabindex="-1"></a>  </span>
<span id="cb252-437"><a href="aplikace3.html#cb252-437" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb252-438"><a href="aplikace3.html#cb252-438" tabindex="-1"></a>  </span>
<span id="cb252-439"><a href="aplikace3.html#cb252-439" tabindex="-1"></a>  <span class="do">### 6.3) Bázové koeficienty</span></span>
<span id="cb252-440"><a href="aplikace3.html#cb252-440" tabindex="-1"></a>  </span>
<span id="cb252-441"><a href="aplikace3.html#cb252-441" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb252-442"><a href="aplikace3.html#cb252-442" tabindex="-1"></a>  clf.RF.Bbasis <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb252-443"><a href="aplikace3.html#cb252-443" tabindex="-1"></a>                                <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb252-444"><a href="aplikace3.html#cb252-444" tabindex="-1"></a>                                <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-445"><a href="aplikace3.html#cb252-445" tabindex="-1"></a>                                <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb252-446"><a href="aplikace3.html#cb252-446" tabindex="-1"></a>  </span>
<span id="cb252-447"><a href="aplikace3.html#cb252-447" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb252-448"><a href="aplikace3.html#cb252-448" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb252-449"><a href="aplikace3.html#cb252-449" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb252-450"><a href="aplikace3.html#cb252-450" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-451"><a href="aplikace3.html#cb252-451" tabindex="-1"></a>    </span>
<span id="cb252-452"><a href="aplikace3.html#cb252-452" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb252-453"><a href="aplikace3.html#cb252-453" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb252-454"><a href="aplikace3.html#cb252-454" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb252-455"><a href="aplikace3.html#cb252-455" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-456"><a href="aplikace3.html#cb252-456" tabindex="-1"></a>  </span>
<span id="cb252-457"><a href="aplikace3.html#cb252-457" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_Bbasis&#39;</span>, </span>
<span id="cb252-458"><a href="aplikace3.html#cb252-458" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb252-459"><a href="aplikace3.html#cb252-459" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb252-460"><a href="aplikace3.html#cb252-460" tabindex="-1"></a>  </span>
<span id="cb252-461"><a href="aplikace3.html#cb252-461" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb252-462"><a href="aplikace3.html#cb252-462" tabindex="-1"></a>  </span>
<span id="cb252-463"><a href="aplikace3.html#cb252-463" tabindex="-1"></a>  <span class="do">## 7) SVM</span></span>
<span id="cb252-464"><a href="aplikace3.html#cb252-464" tabindex="-1"></a>  </span>
<span id="cb252-465"><a href="aplikace3.html#cb252-465" tabindex="-1"></a>  <span class="do">### 7.1) Diskretizace intervalu</span></span>
<span id="cb252-466"><a href="aplikace3.html#cb252-466" tabindex="-1"></a>  </span>
<span id="cb252-467"><a href="aplikace3.html#cb252-467" tabindex="-1"></a>  <span class="co"># rozdeleni na testovaci a trenovaci cast</span></span>
<span id="cb252-468"><a href="aplikace3.html#cb252-468" tabindex="-1"></a>  X.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm_der, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb252-469"><a href="aplikace3.html#cb252-469" tabindex="-1"></a>  X.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm_der, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb252-470"><a href="aplikace3.html#cb252-470" tabindex="-1"></a>  </span>
<span id="cb252-471"><a href="aplikace3.html#cb252-471" tabindex="-1"></a>  Y.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb252-472"><a href="aplikace3.html#cb252-472" tabindex="-1"></a>  Y.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb252-473"><a href="aplikace3.html#cb252-473" tabindex="-1"></a>  </span>
<span id="cb252-474"><a href="aplikace3.html#cb252-474" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb252-475"><a href="aplikace3.html#cb252-475" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) </span>
<span id="cb252-476"><a href="aplikace3.html#cb252-476" tabindex="-1"></a>  grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb252-477"><a href="aplikace3.html#cb252-477" tabindex="-1"></a>  </span>
<span id="cb252-478"><a href="aplikace3.html#cb252-478" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb252-479"><a href="aplikace3.html#cb252-479" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb252-480"><a href="aplikace3.html#cb252-480" tabindex="-1"></a>  grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb252-481"><a href="aplikace3.html#cb252-481" tabindex="-1"></a>  </span>
<span id="cb252-482"><a href="aplikace3.html#cb252-482" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb252-483"><a href="aplikace3.html#cb252-483" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb252-484"><a href="aplikace3.html#cb252-484" tabindex="-1"></a>  <span class="co"># kontrola, ze mame opravdu k = k_cv</span></span>
<span id="cb252-485"><a href="aplikace3.html#cb252-485" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">length</span>(folds) <span class="sc">!=</span> k_cv) {</span>
<span id="cb252-486"><a href="aplikace3.html#cb252-486" tabindex="-1"></a>    folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb252-487"><a href="aplikace3.html#cb252-487" tabindex="-1"></a>  }</span>
<span id="cb252-488"><a href="aplikace3.html#cb252-488" tabindex="-1"></a>  </span>
<span id="cb252-489"><a href="aplikace3.html#cb252-489" tabindex="-1"></a>  <span class="co"># ktere hodnoty gamma chceme uvazovat</span></span>
<span id="cb252-490"><a href="aplikace3.html#cb252-490" tabindex="-1"></a>  gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb252-491"><a href="aplikace3.html#cb252-491" tabindex="-1"></a>  C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb252-492"><a href="aplikace3.html#cb252-492" tabindex="-1"></a>  p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb252-493"><a href="aplikace3.html#cb252-493" tabindex="-1"></a>  coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb252-494"><a href="aplikace3.html#cb252-494" tabindex="-1"></a>  </span>
<span id="cb252-495"><a href="aplikace3.html#cb252-495" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb252-496"><a href="aplikace3.html#cb252-496" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb252-497"><a href="aplikace3.html#cb252-497" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb252-498"><a href="aplikace3.html#cb252-498" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb252-499"><a href="aplikace3.html#cb252-499" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb252-500"><a href="aplikace3.html#cb252-500" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb252-501"><a href="aplikace3.html#cb252-501" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb252-502"><a href="aplikace3.html#cb252-502" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb252-503"><a href="aplikace3.html#cb252-503" tabindex="-1"></a>  )</span>
<span id="cb252-504"><a href="aplikace3.html#cb252-504" tabindex="-1"></a>  </span>
<span id="cb252-505"><a href="aplikace3.html#cb252-505" tabindex="-1"></a>  <span class="co"># nejprve projdeme hodnoty C</span></span>
<span id="cb252-506"><a href="aplikace3.html#cb252-506" tabindex="-1"></a>  <span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb252-507"><a href="aplikace3.html#cb252-507" tabindex="-1"></a>    <span class="co"># projdeme jednotlive folds</span></span>
<span id="cb252-508"><a href="aplikace3.html#cb252-508" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb252-509"><a href="aplikace3.html#cb252-509" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb252-510"><a href="aplikace3.html#cb252-510" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb252-511"><a href="aplikace3.html#cb252-511" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb252-512"><a href="aplikace3.html#cb252-512" tabindex="-1"></a>      </span>
<span id="cb252-513"><a href="aplikace3.html#cb252-513" tabindex="-1"></a>      data.grid.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(grid.data[cv_sample, ])</span>
<span id="cb252-514"><a href="aplikace3.html#cb252-514" tabindex="-1"></a>      data.grid.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(grid.data[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb252-515"><a href="aplikace3.html#cb252-515" tabindex="-1"></a>      </span>
<span id="cb252-516"><a href="aplikace3.html#cb252-516" tabindex="-1"></a>      <span class="do">## LINEARNI JADRO</span></span>
<span id="cb252-517"><a href="aplikace3.html#cb252-517" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb252-518"><a href="aplikace3.html#cb252-518" tabindex="-1"></a>      clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb252-519"><a href="aplikace3.html#cb252-519" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb252-520"><a href="aplikace3.html#cb252-520" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-521"><a href="aplikace3.html#cb252-521" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb252-522"><a href="aplikace3.html#cb252-522" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb252-523"><a href="aplikace3.html#cb252-523" tabindex="-1"></a>      </span>
<span id="cb252-524"><a href="aplikace3.html#cb252-524" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb252-525"><a href="aplikace3.html#cb252-525" tabindex="-1"></a>      predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb252-526"><a href="aplikace3.html#cb252-526" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb252-527"><a href="aplikace3.html#cb252-527" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-528"><a href="aplikace3.html#cb252-528" tabindex="-1"></a>      </span>
<span id="cb252-529"><a href="aplikace3.html#cb252-529" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C a fold</span></span>
<span id="cb252-530"><a href="aplikace3.html#cb252-530" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb252-531"><a href="aplikace3.html#cb252-531" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb252-532"><a href="aplikace3.html#cb252-532" tabindex="-1"></a>      </span>
<span id="cb252-533"><a href="aplikace3.html#cb252-533" tabindex="-1"></a>      <span class="do">## POLYNOMIALNI JADRO</span></span>
<span id="cb252-534"><a href="aplikace3.html#cb252-534" tabindex="-1"></a>      <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb252-535"><a href="aplikace3.html#cb252-535" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb252-536"><a href="aplikace3.html#cb252-536" tabindex="-1"></a>        clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb252-537"><a href="aplikace3.html#cb252-537" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb252-538"><a href="aplikace3.html#cb252-538" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-539"><a href="aplikace3.html#cb252-539" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb252-540"><a href="aplikace3.html#cb252-540" tabindex="-1"></a>                         <span class="at">coef0 =</span> coef0,</span>
<span id="cb252-541"><a href="aplikace3.html#cb252-541" tabindex="-1"></a>                         <span class="at">degree =</span> p,</span>
<span id="cb252-542"><a href="aplikace3.html#cb252-542" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb252-543"><a href="aplikace3.html#cb252-543" tabindex="-1"></a>        </span>
<span id="cb252-544"><a href="aplikace3.html#cb252-544" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb252-545"><a href="aplikace3.html#cb252-545" tabindex="-1"></a>        predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, </span>
<span id="cb252-546"><a href="aplikace3.html#cb252-546" tabindex="-1"></a>                                      <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb252-547"><a href="aplikace3.html#cb252-547" tabindex="-1"></a>        presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb252-548"><a href="aplikace3.html#cb252-548" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-549"><a href="aplikace3.html#cb252-549" tabindex="-1"></a>        </span>
<span id="cb252-550"><a href="aplikace3.html#cb252-550" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, p a fold</span></span>
<span id="cb252-551"><a href="aplikace3.html#cb252-551" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb252-552"><a href="aplikace3.html#cb252-552" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb252-553"><a href="aplikace3.html#cb252-553" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb252-554"><a href="aplikace3.html#cb252-554" tabindex="-1"></a>      }</span>
<span id="cb252-555"><a href="aplikace3.html#cb252-555" tabindex="-1"></a>          </span>
<span id="cb252-556"><a href="aplikace3.html#cb252-556" tabindex="-1"></a>      <span class="do">## RADIALNI JADRO</span></span>
<span id="cb252-557"><a href="aplikace3.html#cb252-557" tabindex="-1"></a>      <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb252-558"><a href="aplikace3.html#cb252-558" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb252-559"><a href="aplikace3.html#cb252-559" tabindex="-1"></a>        clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb252-560"><a href="aplikace3.html#cb252-560" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb252-561"><a href="aplikace3.html#cb252-561" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-562"><a href="aplikace3.html#cb252-562" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb252-563"><a href="aplikace3.html#cb252-563" tabindex="-1"></a>                         <span class="at">gamma =</span> gamma,</span>
<span id="cb252-564"><a href="aplikace3.html#cb252-564" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb252-565"><a href="aplikace3.html#cb252-565" tabindex="-1"></a>        </span>
<span id="cb252-566"><a href="aplikace3.html#cb252-566" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb252-567"><a href="aplikace3.html#cb252-567" tabindex="-1"></a>        predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb252-568"><a href="aplikace3.html#cb252-568" tabindex="-1"></a>        presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb252-569"><a href="aplikace3.html#cb252-569" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-570"><a href="aplikace3.html#cb252-570" tabindex="-1"></a>        </span>
<span id="cb252-571"><a href="aplikace3.html#cb252-571" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, gamma a fold</span></span>
<span id="cb252-572"><a href="aplikace3.html#cb252-572" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb252-573"><a href="aplikace3.html#cb252-573" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb252-574"><a href="aplikace3.html#cb252-574" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb252-575"><a href="aplikace3.html#cb252-575" tabindex="-1"></a>      }</span>
<span id="cb252-576"><a href="aplikace3.html#cb252-576" tabindex="-1"></a>    }</span>
<span id="cb252-577"><a href="aplikace3.html#cb252-577" tabindex="-1"></a>  }</span>
<span id="cb252-578"><a href="aplikace3.html#cb252-578" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva C pres folds</span></span>
<span id="cb252-579"><a href="aplikace3.html#cb252-579" tabindex="-1"></a>  <span class="do">## Linearni jadro</span></span>
<span id="cb252-580"><a href="aplikace3.html#cb252-580" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb252-581"><a href="aplikace3.html#cb252-581" tabindex="-1"></a>  <span class="do">## Polynomialni jadro</span></span>
<span id="cb252-582"><a href="aplikace3.html#cb252-582" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb252-583"><a href="aplikace3.html#cb252-583" tabindex="-1"></a>  <span class="do">## Radialni jadro</span></span>
<span id="cb252-584"><a href="aplikace3.html#cb252-584" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb252-585"><a href="aplikace3.html#cb252-585" tabindex="-1"></a>  </span>
<span id="cb252-586"><a href="aplikace3.html#cb252-586" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb252-587"><a href="aplikace3.html#cb252-587" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb252-588"><a href="aplikace3.html#cb252-588" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb252-589"><a href="aplikace3.html#cb252-589" tabindex="-1"></a>  C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb252-590"><a href="aplikace3.html#cb252-590" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb252-591"><a href="aplikace3.html#cb252-591" tabindex="-1"></a>  </span>
<span id="cb252-592"><a href="aplikace3.html#cb252-592" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb252-593"><a href="aplikace3.html#cb252-593" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb252-594"><a href="aplikace3.html#cb252-594" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb252-595"><a href="aplikace3.html#cb252-595" tabindex="-1"></a>  </span>
<span id="cb252-596"><a href="aplikace3.html#cb252-596" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb252-597"><a href="aplikace3.html#cb252-597" tabindex="-1"></a>  p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb252-598"><a href="aplikace3.html#cb252-598" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb252-599"><a href="aplikace3.html#cb252-599" tabindex="-1"></a>  </span>
<span id="cb252-600"><a href="aplikace3.html#cb252-600" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb252-601"><a href="aplikace3.html#cb252-601" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb252-602"><a href="aplikace3.html#cb252-602" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb252-603"><a href="aplikace3.html#cb252-603" tabindex="-1"></a>  </span>
<span id="cb252-604"><a href="aplikace3.html#cb252-604" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb252-605"><a href="aplikace3.html#cb252-605" tabindex="-1"></a>  clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb252-606"><a href="aplikace3.html#cb252-606" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb252-607"><a href="aplikace3.html#cb252-607" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-608"><a href="aplikace3.html#cb252-608" tabindex="-1"></a>                   <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb252-609"><a href="aplikace3.html#cb252-609" tabindex="-1"></a>                   <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb252-610"><a href="aplikace3.html#cb252-610" tabindex="-1"></a>  </span>
<span id="cb252-611"><a href="aplikace3.html#cb252-611" tabindex="-1"></a>  clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb252-612"><a href="aplikace3.html#cb252-612" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb252-613"><a href="aplikace3.html#cb252-613" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-614"><a href="aplikace3.html#cb252-614" tabindex="-1"></a>                   <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb252-615"><a href="aplikace3.html#cb252-615" tabindex="-1"></a>                   <span class="at">degree =</span> p.opt,</span>
<span id="cb252-616"><a href="aplikace3.html#cb252-616" tabindex="-1"></a>                   <span class="at">coef0 =</span> coef0,</span>
<span id="cb252-617"><a href="aplikace3.html#cb252-617" tabindex="-1"></a>                   <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb252-618"><a href="aplikace3.html#cb252-618" tabindex="-1"></a>  </span>
<span id="cb252-619"><a href="aplikace3.html#cb252-619" tabindex="-1"></a>  clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb252-620"><a href="aplikace3.html#cb252-620" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb252-621"><a href="aplikace3.html#cb252-621" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">TRUE</span>, </span>
<span id="cb252-622"><a href="aplikace3.html#cb252-622" tabindex="-1"></a>                   <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb252-623"><a href="aplikace3.html#cb252-623" tabindex="-1"></a>                   <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb252-624"><a href="aplikace3.html#cb252-624" tabindex="-1"></a>                   <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb252-625"><a href="aplikace3.html#cb252-625" tabindex="-1"></a>  </span>
<span id="cb252-626"><a href="aplikace3.html#cb252-626" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb252-627"><a href="aplikace3.html#cb252-627" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data)</span>
<span id="cb252-628"><a href="aplikace3.html#cb252-628" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb252-629"><a href="aplikace3.html#cb252-629" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-630"><a href="aplikace3.html#cb252-630" tabindex="-1"></a>  </span>
<span id="cb252-631"><a href="aplikace3.html#cb252-631" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data)</span>
<span id="cb252-632"><a href="aplikace3.html#cb252-632" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb252-633"><a href="aplikace3.html#cb252-633" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-634"><a href="aplikace3.html#cb252-634" tabindex="-1"></a>  </span>
<span id="cb252-635"><a href="aplikace3.html#cb252-635" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data)</span>
<span id="cb252-636"><a href="aplikace3.html#cb252-636" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb252-637"><a href="aplikace3.html#cb252-637" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-638"><a href="aplikace3.html#cb252-638" tabindex="-1"></a>  </span>
<span id="cb252-639"><a href="aplikace3.html#cb252-639" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb252-640"><a href="aplikace3.html#cb252-640" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb252-641"><a href="aplikace3.html#cb252-641" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb252-642"><a href="aplikace3.html#cb252-642" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-643"><a href="aplikace3.html#cb252-643" tabindex="-1"></a>  </span>
<span id="cb252-644"><a href="aplikace3.html#cb252-644" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb252-645"><a href="aplikace3.html#cb252-645" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb252-646"><a href="aplikace3.html#cb252-646" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-647"><a href="aplikace3.html#cb252-647" tabindex="-1"></a>  </span>
<span id="cb252-648"><a href="aplikace3.html#cb252-648" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb252-649"><a href="aplikace3.html#cb252-649" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb252-650"><a href="aplikace3.html#cb252-650" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-651"><a href="aplikace3.html#cb252-651" tabindex="-1"></a>  </span>
<span id="cb252-652"><a href="aplikace3.html#cb252-652" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - diskr&#39;</span>, </span>
<span id="cb252-653"><a href="aplikace3.html#cb252-653" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - diskr&#39;</span>, </span>
<span id="cb252-654"><a href="aplikace3.html#cb252-654" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - diskr&#39;</span>), </span>
<span id="cb252-655"><a href="aplikace3.html#cb252-655" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l,</span>
<span id="cb252-656"><a href="aplikace3.html#cb252-656" tabindex="-1"></a>                                      presnost.train.p, presnost.train.r),</span>
<span id="cb252-657"><a href="aplikace3.html#cb252-657" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb252-658"><a href="aplikace3.html#cb252-658" tabindex="-1"></a>                                     presnost.test.p, presnost.test.r))</span>
<span id="cb252-659"><a href="aplikace3.html#cb252-659" tabindex="-1"></a>  </span>
<span id="cb252-660"><a href="aplikace3.html#cb252-660" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb252-661"><a href="aplikace3.html#cb252-661" tabindex="-1"></a>  </span>
<span id="cb252-662"><a href="aplikace3.html#cb252-662" tabindex="-1"></a>  <span class="do">### 7.2) Skóre hlavních komponent</span></span>
<span id="cb252-663"><a href="aplikace3.html#cb252-663" tabindex="-1"></a>  </span>
<span id="cb252-664"><a href="aplikace3.html#cb252-664" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb252-665"><a href="aplikace3.html#cb252-665" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb252-666"><a href="aplikace3.html#cb252-666" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb252-667"><a href="aplikace3.html#cb252-667" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb252-668"><a href="aplikace3.html#cb252-668" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb252-669"><a href="aplikace3.html#cb252-669" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb252-670"><a href="aplikace3.html#cb252-670" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb252-671"><a href="aplikace3.html#cb252-671" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb252-672"><a href="aplikace3.html#cb252-672" tabindex="-1"></a>  )</span>
<span id="cb252-673"><a href="aplikace3.html#cb252-673" tabindex="-1"></a>  </span>
<span id="cb252-674"><a href="aplikace3.html#cb252-674" tabindex="-1"></a>  <span class="co"># nejprve projdeme hodnoty C</span></span>
<span id="cb252-675"><a href="aplikace3.html#cb252-675" tabindex="-1"></a>  <span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb252-676"><a href="aplikace3.html#cb252-676" tabindex="-1"></a>    <span class="co"># projdeme jednotlive folds</span></span>
<span id="cb252-677"><a href="aplikace3.html#cb252-677" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb252-678"><a href="aplikace3.html#cb252-678" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb252-679"><a href="aplikace3.html#cb252-679" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb252-680"><a href="aplikace3.html#cb252-680" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.PCA.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb252-681"><a href="aplikace3.html#cb252-681" tabindex="-1"></a>      </span>
<span id="cb252-682"><a href="aplikace3.html#cb252-682" tabindex="-1"></a>      data.PCA.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA.train[cv_sample, ])</span>
<span id="cb252-683"><a href="aplikace3.html#cb252-683" tabindex="-1"></a>      data.PCA.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb252-684"><a href="aplikace3.html#cb252-684" tabindex="-1"></a>      </span>
<span id="cb252-685"><a href="aplikace3.html#cb252-685" tabindex="-1"></a>      <span class="do">## LINEARNI JADRO</span></span>
<span id="cb252-686"><a href="aplikace3.html#cb252-686" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb252-687"><a href="aplikace3.html#cb252-687" tabindex="-1"></a>      clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb252-688"><a href="aplikace3.html#cb252-688" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb252-689"><a href="aplikace3.html#cb252-689" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-690"><a href="aplikace3.html#cb252-690" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb252-691"><a href="aplikace3.html#cb252-691" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb252-692"><a href="aplikace3.html#cb252-692" tabindex="-1"></a>      </span>
<span id="cb252-693"><a href="aplikace3.html#cb252-693" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb252-694"><a href="aplikace3.html#cb252-694" tabindex="-1"></a>      predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb252-695"><a href="aplikace3.html#cb252-695" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb252-696"><a href="aplikace3.html#cb252-696" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-697"><a href="aplikace3.html#cb252-697" tabindex="-1"></a>      </span>
<span id="cb252-698"><a href="aplikace3.html#cb252-698" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C a fold</span></span>
<span id="cb252-699"><a href="aplikace3.html#cb252-699" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb252-700"><a href="aplikace3.html#cb252-700" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb252-701"><a href="aplikace3.html#cb252-701" tabindex="-1"></a>      </span>
<span id="cb252-702"><a href="aplikace3.html#cb252-702" tabindex="-1"></a>      <span class="do">## POLYNOMIALNI JADRO</span></span>
<span id="cb252-703"><a href="aplikace3.html#cb252-703" tabindex="-1"></a>      <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb252-704"><a href="aplikace3.html#cb252-704" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb252-705"><a href="aplikace3.html#cb252-705" tabindex="-1"></a>        clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb252-706"><a href="aplikace3.html#cb252-706" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb252-707"><a href="aplikace3.html#cb252-707" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-708"><a href="aplikace3.html#cb252-708" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb252-709"><a href="aplikace3.html#cb252-709" tabindex="-1"></a>                         <span class="at">coef0 =</span> coef0,</span>
<span id="cb252-710"><a href="aplikace3.html#cb252-710" tabindex="-1"></a>                         <span class="at">degree =</span> p,</span>
<span id="cb252-711"><a href="aplikace3.html#cb252-711" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb252-712"><a href="aplikace3.html#cb252-712" tabindex="-1"></a>        </span>
<span id="cb252-713"><a href="aplikace3.html#cb252-713" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb252-714"><a href="aplikace3.html#cb252-714" tabindex="-1"></a>        predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb252-715"><a href="aplikace3.html#cb252-715" tabindex="-1"></a>        presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb252-716"><a href="aplikace3.html#cb252-716" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-717"><a href="aplikace3.html#cb252-717" tabindex="-1"></a>        </span>
<span id="cb252-718"><a href="aplikace3.html#cb252-718" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, p a fold</span></span>
<span id="cb252-719"><a href="aplikace3.html#cb252-719" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb252-720"><a href="aplikace3.html#cb252-720" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb252-721"><a href="aplikace3.html#cb252-721" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb252-722"><a href="aplikace3.html#cb252-722" tabindex="-1"></a>      }</span>
<span id="cb252-723"><a href="aplikace3.html#cb252-723" tabindex="-1"></a>          </span>
<span id="cb252-724"><a href="aplikace3.html#cb252-724" tabindex="-1"></a>      <span class="do">## RADIALNI JADRO</span></span>
<span id="cb252-725"><a href="aplikace3.html#cb252-725" tabindex="-1"></a>      <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb252-726"><a href="aplikace3.html#cb252-726" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb252-727"><a href="aplikace3.html#cb252-727" tabindex="-1"></a>        clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb252-728"><a href="aplikace3.html#cb252-728" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb252-729"><a href="aplikace3.html#cb252-729" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-730"><a href="aplikace3.html#cb252-730" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb252-731"><a href="aplikace3.html#cb252-731" tabindex="-1"></a>                         <span class="at">gamma =</span> gamma,</span>
<span id="cb252-732"><a href="aplikace3.html#cb252-732" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb252-733"><a href="aplikace3.html#cb252-733" tabindex="-1"></a>        </span>
<span id="cb252-734"><a href="aplikace3.html#cb252-734" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb252-735"><a href="aplikace3.html#cb252-735" tabindex="-1"></a>        predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb252-736"><a href="aplikace3.html#cb252-736" tabindex="-1"></a>        presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb252-737"><a href="aplikace3.html#cb252-737" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-738"><a href="aplikace3.html#cb252-738" tabindex="-1"></a>        </span>
<span id="cb252-739"><a href="aplikace3.html#cb252-739" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, gamma a fold</span></span>
<span id="cb252-740"><a href="aplikace3.html#cb252-740" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb252-741"><a href="aplikace3.html#cb252-741" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb252-742"><a href="aplikace3.html#cb252-742" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb252-743"><a href="aplikace3.html#cb252-743" tabindex="-1"></a>      }</span>
<span id="cb252-744"><a href="aplikace3.html#cb252-744" tabindex="-1"></a>    }</span>
<span id="cb252-745"><a href="aplikace3.html#cb252-745" tabindex="-1"></a>  }</span>
<span id="cb252-746"><a href="aplikace3.html#cb252-746" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva C pres folds</span></span>
<span id="cb252-747"><a href="aplikace3.html#cb252-747" tabindex="-1"></a>  <span class="do">## Linearni jadro</span></span>
<span id="cb252-748"><a href="aplikace3.html#cb252-748" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb252-749"><a href="aplikace3.html#cb252-749" tabindex="-1"></a>  <span class="do">## Polynomialni jadro</span></span>
<span id="cb252-750"><a href="aplikace3.html#cb252-750" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb252-751"><a href="aplikace3.html#cb252-751" tabindex="-1"></a>  <span class="do">## Radialni jadro</span></span>
<span id="cb252-752"><a href="aplikace3.html#cb252-752" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb252-753"><a href="aplikace3.html#cb252-753" tabindex="-1"></a>  </span>
<span id="cb252-754"><a href="aplikace3.html#cb252-754" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb252-755"><a href="aplikace3.html#cb252-755" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb252-756"><a href="aplikace3.html#cb252-756" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb252-757"><a href="aplikace3.html#cb252-757" tabindex="-1"></a>  C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb252-758"><a href="aplikace3.html#cb252-758" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb252-759"><a href="aplikace3.html#cb252-759" tabindex="-1"></a>  </span>
<span id="cb252-760"><a href="aplikace3.html#cb252-760" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb252-761"><a href="aplikace3.html#cb252-761" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb252-762"><a href="aplikace3.html#cb252-762" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb252-763"><a href="aplikace3.html#cb252-763" tabindex="-1"></a>  </span>
<span id="cb252-764"><a href="aplikace3.html#cb252-764" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb252-765"><a href="aplikace3.html#cb252-765" tabindex="-1"></a>  p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb252-766"><a href="aplikace3.html#cb252-766" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb252-767"><a href="aplikace3.html#cb252-767" tabindex="-1"></a>  </span>
<span id="cb252-768"><a href="aplikace3.html#cb252-768" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb252-769"><a href="aplikace3.html#cb252-769" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb252-770"><a href="aplikace3.html#cb252-770" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb252-771"><a href="aplikace3.html#cb252-771" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb252-772"><a href="aplikace3.html#cb252-772" tabindex="-1"></a>  clf.SVM.l.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb252-773"><a href="aplikace3.html#cb252-773" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb252-774"><a href="aplikace3.html#cb252-774" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-775"><a href="aplikace3.html#cb252-775" tabindex="-1"></a>                       <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb252-776"><a href="aplikace3.html#cb252-776" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb252-777"><a href="aplikace3.html#cb252-777" tabindex="-1"></a>  </span>
<span id="cb252-778"><a href="aplikace3.html#cb252-778" tabindex="-1"></a>  clf.SVM.p.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb252-779"><a href="aplikace3.html#cb252-779" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb252-780"><a href="aplikace3.html#cb252-780" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-781"><a href="aplikace3.html#cb252-781" tabindex="-1"></a>                       <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb252-782"><a href="aplikace3.html#cb252-782" tabindex="-1"></a>                       <span class="at">coef0 =</span> coef0,</span>
<span id="cb252-783"><a href="aplikace3.html#cb252-783" tabindex="-1"></a>                       <span class="at">degree =</span> p.opt,</span>
<span id="cb252-784"><a href="aplikace3.html#cb252-784" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb252-785"><a href="aplikace3.html#cb252-785" tabindex="-1"></a>  </span>
<span id="cb252-786"><a href="aplikace3.html#cb252-786" tabindex="-1"></a>  clf.SVM.r.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb252-787"><a href="aplikace3.html#cb252-787" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb252-788"><a href="aplikace3.html#cb252-788" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-789"><a href="aplikace3.html#cb252-789" tabindex="-1"></a>                       <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb252-790"><a href="aplikace3.html#cb252-790" tabindex="-1"></a>                       <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb252-791"><a href="aplikace3.html#cb252-791" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb252-792"><a href="aplikace3.html#cb252-792" tabindex="-1"></a>  </span>
<span id="cb252-793"><a href="aplikace3.html#cb252-793" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb252-794"><a href="aplikace3.html#cb252-794" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb252-795"><a href="aplikace3.html#cb252-795" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb252-796"><a href="aplikace3.html#cb252-796" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-797"><a href="aplikace3.html#cb252-797" tabindex="-1"></a>  </span>
<span id="cb252-798"><a href="aplikace3.html#cb252-798" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb252-799"><a href="aplikace3.html#cb252-799" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb252-800"><a href="aplikace3.html#cb252-800" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-801"><a href="aplikace3.html#cb252-801" tabindex="-1"></a>  </span>
<span id="cb252-802"><a href="aplikace3.html#cb252-802" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb252-803"><a href="aplikace3.html#cb252-803" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb252-804"><a href="aplikace3.html#cb252-804" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-805"><a href="aplikace3.html#cb252-805" tabindex="-1"></a>    </span>
<span id="cb252-806"><a href="aplikace3.html#cb252-806" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb252-807"><a href="aplikace3.html#cb252-807" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb252-808"><a href="aplikace3.html#cb252-808" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb252-809"><a href="aplikace3.html#cb252-809" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-810"><a href="aplikace3.html#cb252-810" tabindex="-1"></a>  </span>
<span id="cb252-811"><a href="aplikace3.html#cb252-811" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb252-812"><a href="aplikace3.html#cb252-812" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb252-813"><a href="aplikace3.html#cb252-813" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-814"><a href="aplikace3.html#cb252-814" tabindex="-1"></a>  </span>
<span id="cb252-815"><a href="aplikace3.html#cb252-815" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb252-816"><a href="aplikace3.html#cb252-816" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb252-817"><a href="aplikace3.html#cb252-817" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-818"><a href="aplikace3.html#cb252-818" tabindex="-1"></a>  </span>
<span id="cb252-819"><a href="aplikace3.html#cb252-819" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - PCA&#39;</span>, </span>
<span id="cb252-820"><a href="aplikace3.html#cb252-820" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - PCA&#39;</span>, </span>
<span id="cb252-821"><a href="aplikace3.html#cb252-821" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - PCA&#39;</span>), </span>
<span id="cb252-822"><a href="aplikace3.html#cb252-822" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, </span>
<span id="cb252-823"><a href="aplikace3.html#cb252-823" tabindex="-1"></a>                                      presnost.train.p, presnost.train.r),</span>
<span id="cb252-824"><a href="aplikace3.html#cb252-824" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb252-825"><a href="aplikace3.html#cb252-825" tabindex="-1"></a>                                     presnost.test.p, presnost.test.r))</span>
<span id="cb252-826"><a href="aplikace3.html#cb252-826" tabindex="-1"></a>  </span>
<span id="cb252-827"><a href="aplikace3.html#cb252-827" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb252-828"><a href="aplikace3.html#cb252-828" tabindex="-1"></a>  </span>
<span id="cb252-829"><a href="aplikace3.html#cb252-829" tabindex="-1"></a>  <span class="do">### 7.3) Bázové koeficienty</span></span>
<span id="cb252-830"><a href="aplikace3.html#cb252-830" tabindex="-1"></a>  </span>
<span id="cb252-831"><a href="aplikace3.html#cb252-831" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb252-832"><a href="aplikace3.html#cb252-832" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb252-833"><a href="aplikace3.html#cb252-833" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb252-834"><a href="aplikace3.html#cb252-834" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb252-835"><a href="aplikace3.html#cb252-835" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb252-836"><a href="aplikace3.html#cb252-836" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb252-837"><a href="aplikace3.html#cb252-837" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb252-838"><a href="aplikace3.html#cb252-838" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb252-839"><a href="aplikace3.html#cb252-839" tabindex="-1"></a>  )</span>
<span id="cb252-840"><a href="aplikace3.html#cb252-840" tabindex="-1"></a>  </span>
<span id="cb252-841"><a href="aplikace3.html#cb252-841" tabindex="-1"></a>  <span class="co"># nejprve projdeme hodnoty C</span></span>
<span id="cb252-842"><a href="aplikace3.html#cb252-842" tabindex="-1"></a>  <span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb252-843"><a href="aplikace3.html#cb252-843" tabindex="-1"></a>    <span class="co"># projdeme jednotlive folds</span></span>
<span id="cb252-844"><a href="aplikace3.html#cb252-844" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb252-845"><a href="aplikace3.html#cb252-845" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb252-846"><a href="aplikace3.html#cb252-846" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb252-847"><a href="aplikace3.html#cb252-847" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb252-848"><a href="aplikace3.html#cb252-848" tabindex="-1"></a>      </span>
<span id="cb252-849"><a href="aplikace3.html#cb252-849" tabindex="-1"></a>      data.Bbasis.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.Bbasis.train[cv_sample, ])</span>
<span id="cb252-850"><a href="aplikace3.html#cb252-850" tabindex="-1"></a>      data.Bbasis.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.Bbasis.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb252-851"><a href="aplikace3.html#cb252-851" tabindex="-1"></a>      </span>
<span id="cb252-852"><a href="aplikace3.html#cb252-852" tabindex="-1"></a>      <span class="do">## LINEARNI JADRO</span></span>
<span id="cb252-853"><a href="aplikace3.html#cb252-853" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb252-854"><a href="aplikace3.html#cb252-854" tabindex="-1"></a>      clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb252-855"><a href="aplikace3.html#cb252-855" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb252-856"><a href="aplikace3.html#cb252-856" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-857"><a href="aplikace3.html#cb252-857" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb252-858"><a href="aplikace3.html#cb252-858" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb252-859"><a href="aplikace3.html#cb252-859" tabindex="-1"></a>      </span>
<span id="cb252-860"><a href="aplikace3.html#cb252-860" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb252-861"><a href="aplikace3.html#cb252-861" tabindex="-1"></a>      predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb252-862"><a href="aplikace3.html#cb252-862" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb252-863"><a href="aplikace3.html#cb252-863" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-864"><a href="aplikace3.html#cb252-864" tabindex="-1"></a>      </span>
<span id="cb252-865"><a href="aplikace3.html#cb252-865" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C a fold</span></span>
<span id="cb252-866"><a href="aplikace3.html#cb252-866" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb252-867"><a href="aplikace3.html#cb252-867" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb252-868"><a href="aplikace3.html#cb252-868" tabindex="-1"></a>      </span>
<span id="cb252-869"><a href="aplikace3.html#cb252-869" tabindex="-1"></a>      <span class="do">## POLYNOMIALNI JADRO</span></span>
<span id="cb252-870"><a href="aplikace3.html#cb252-870" tabindex="-1"></a>      <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb252-871"><a href="aplikace3.html#cb252-871" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb252-872"><a href="aplikace3.html#cb252-872" tabindex="-1"></a>        clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb252-873"><a href="aplikace3.html#cb252-873" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb252-874"><a href="aplikace3.html#cb252-874" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-875"><a href="aplikace3.html#cb252-875" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb252-876"><a href="aplikace3.html#cb252-876" tabindex="-1"></a>                         <span class="at">coef0 =</span> coef0,</span>
<span id="cb252-877"><a href="aplikace3.html#cb252-877" tabindex="-1"></a>                         <span class="at">degree =</span> p,</span>
<span id="cb252-878"><a href="aplikace3.html#cb252-878" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb252-879"><a href="aplikace3.html#cb252-879" tabindex="-1"></a>        </span>
<span id="cb252-880"><a href="aplikace3.html#cb252-880" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb252-881"><a href="aplikace3.html#cb252-881" tabindex="-1"></a>        predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, </span>
<span id="cb252-882"><a href="aplikace3.html#cb252-882" tabindex="-1"></a>                                      <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb252-883"><a href="aplikace3.html#cb252-883" tabindex="-1"></a>        presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb252-884"><a href="aplikace3.html#cb252-884" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-885"><a href="aplikace3.html#cb252-885" tabindex="-1"></a>        </span>
<span id="cb252-886"><a href="aplikace3.html#cb252-886" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, p a fold</span></span>
<span id="cb252-887"><a href="aplikace3.html#cb252-887" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb252-888"><a href="aplikace3.html#cb252-888" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb252-889"><a href="aplikace3.html#cb252-889" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb252-890"><a href="aplikace3.html#cb252-890" tabindex="-1"></a>      }</span>
<span id="cb252-891"><a href="aplikace3.html#cb252-891" tabindex="-1"></a>          </span>
<span id="cb252-892"><a href="aplikace3.html#cb252-892" tabindex="-1"></a>      <span class="do">## RADIALNI JADRO</span></span>
<span id="cb252-893"><a href="aplikace3.html#cb252-893" tabindex="-1"></a>      <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb252-894"><a href="aplikace3.html#cb252-894" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb252-895"><a href="aplikace3.html#cb252-895" tabindex="-1"></a>        clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb252-896"><a href="aplikace3.html#cb252-896" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb252-897"><a href="aplikace3.html#cb252-897" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-898"><a href="aplikace3.html#cb252-898" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb252-899"><a href="aplikace3.html#cb252-899" tabindex="-1"></a>                         <span class="at">gamma =</span> gamma,</span>
<span id="cb252-900"><a href="aplikace3.html#cb252-900" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb252-901"><a href="aplikace3.html#cb252-901" tabindex="-1"></a>        </span>
<span id="cb252-902"><a href="aplikace3.html#cb252-902" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb252-903"><a href="aplikace3.html#cb252-903" tabindex="-1"></a>        predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, </span>
<span id="cb252-904"><a href="aplikace3.html#cb252-904" tabindex="-1"></a>                                      <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb252-905"><a href="aplikace3.html#cb252-905" tabindex="-1"></a>        presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb252-906"><a href="aplikace3.html#cb252-906" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-907"><a href="aplikace3.html#cb252-907" tabindex="-1"></a>        </span>
<span id="cb252-908"><a href="aplikace3.html#cb252-908" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, gamma a fold</span></span>
<span id="cb252-909"><a href="aplikace3.html#cb252-909" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb252-910"><a href="aplikace3.html#cb252-910" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb252-911"><a href="aplikace3.html#cb252-911" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb252-912"><a href="aplikace3.html#cb252-912" tabindex="-1"></a>      }</span>
<span id="cb252-913"><a href="aplikace3.html#cb252-913" tabindex="-1"></a>    }</span>
<span id="cb252-914"><a href="aplikace3.html#cb252-914" tabindex="-1"></a>  }</span>
<span id="cb252-915"><a href="aplikace3.html#cb252-915" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva C pres folds</span></span>
<span id="cb252-916"><a href="aplikace3.html#cb252-916" tabindex="-1"></a>  <span class="do">## Linearni jadro</span></span>
<span id="cb252-917"><a href="aplikace3.html#cb252-917" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb252-918"><a href="aplikace3.html#cb252-918" tabindex="-1"></a>  <span class="do">## Polynomialni jadro</span></span>
<span id="cb252-919"><a href="aplikace3.html#cb252-919" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb252-920"><a href="aplikace3.html#cb252-920" tabindex="-1"></a>  <span class="do">## Radialni jadro</span></span>
<span id="cb252-921"><a href="aplikace3.html#cb252-921" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb252-922"><a href="aplikace3.html#cb252-922" tabindex="-1"></a>  </span>
<span id="cb252-923"><a href="aplikace3.html#cb252-923" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb252-924"><a href="aplikace3.html#cb252-924" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb252-925"><a href="aplikace3.html#cb252-925" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb252-926"><a href="aplikace3.html#cb252-926" tabindex="-1"></a>  C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb252-927"><a href="aplikace3.html#cb252-927" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb252-928"><a href="aplikace3.html#cb252-928" tabindex="-1"></a>  </span>
<span id="cb252-929"><a href="aplikace3.html#cb252-929" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb252-930"><a href="aplikace3.html#cb252-930" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb252-931"><a href="aplikace3.html#cb252-931" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb252-932"><a href="aplikace3.html#cb252-932" tabindex="-1"></a>  </span>
<span id="cb252-933"><a href="aplikace3.html#cb252-933" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb252-934"><a href="aplikace3.html#cb252-934" tabindex="-1"></a>  p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb252-935"><a href="aplikace3.html#cb252-935" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb252-936"><a href="aplikace3.html#cb252-936" tabindex="-1"></a>  </span>
<span id="cb252-937"><a href="aplikace3.html#cb252-937" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb252-938"><a href="aplikace3.html#cb252-938" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb252-939"><a href="aplikace3.html#cb252-939" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb252-940"><a href="aplikace3.html#cb252-940" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb252-941"><a href="aplikace3.html#cb252-941" tabindex="-1"></a>  clf.SVM.l.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb252-942"><a href="aplikace3.html#cb252-942" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb252-943"><a href="aplikace3.html#cb252-943" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-944"><a href="aplikace3.html#cb252-944" tabindex="-1"></a>                          <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb252-945"><a href="aplikace3.html#cb252-945" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb252-946"><a href="aplikace3.html#cb252-946" tabindex="-1"></a>  </span>
<span id="cb252-947"><a href="aplikace3.html#cb252-947" tabindex="-1"></a>  clf.SVM.p.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb252-948"><a href="aplikace3.html#cb252-948" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb252-949"><a href="aplikace3.html#cb252-949" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-950"><a href="aplikace3.html#cb252-950" tabindex="-1"></a>                          <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb252-951"><a href="aplikace3.html#cb252-951" tabindex="-1"></a>                          <span class="at">degree =</span> p.opt,</span>
<span id="cb252-952"><a href="aplikace3.html#cb252-952" tabindex="-1"></a>                          <span class="at">coef0 =</span> coef0,</span>
<span id="cb252-953"><a href="aplikace3.html#cb252-953" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb252-954"><a href="aplikace3.html#cb252-954" tabindex="-1"></a>  </span>
<span id="cb252-955"><a href="aplikace3.html#cb252-955" tabindex="-1"></a>  clf.SVM.r.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb252-956"><a href="aplikace3.html#cb252-956" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb252-957"><a href="aplikace3.html#cb252-957" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-958"><a href="aplikace3.html#cb252-958" tabindex="-1"></a>                          <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb252-959"><a href="aplikace3.html#cb252-959" tabindex="-1"></a>                          <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb252-960"><a href="aplikace3.html#cb252-960" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb252-961"><a href="aplikace3.html#cb252-961" tabindex="-1"></a>  </span>
<span id="cb252-962"><a href="aplikace3.html#cb252-962" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb252-963"><a href="aplikace3.html#cb252-963" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb252-964"><a href="aplikace3.html#cb252-964" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb252-965"><a href="aplikace3.html#cb252-965" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-966"><a href="aplikace3.html#cb252-966" tabindex="-1"></a>  </span>
<span id="cb252-967"><a href="aplikace3.html#cb252-967" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb252-968"><a href="aplikace3.html#cb252-968" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb252-969"><a href="aplikace3.html#cb252-969" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-970"><a href="aplikace3.html#cb252-970" tabindex="-1"></a>  </span>
<span id="cb252-971"><a href="aplikace3.html#cb252-971" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb252-972"><a href="aplikace3.html#cb252-972" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb252-973"><a href="aplikace3.html#cb252-973" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-974"><a href="aplikace3.html#cb252-974" tabindex="-1"></a>    </span>
<span id="cb252-975"><a href="aplikace3.html#cb252-975" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb252-976"><a href="aplikace3.html#cb252-976" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb252-977"><a href="aplikace3.html#cb252-977" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb252-978"><a href="aplikace3.html#cb252-978" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-979"><a href="aplikace3.html#cb252-979" tabindex="-1"></a>  </span>
<span id="cb252-980"><a href="aplikace3.html#cb252-980" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb252-981"><a href="aplikace3.html#cb252-981" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb252-982"><a href="aplikace3.html#cb252-982" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-983"><a href="aplikace3.html#cb252-983" tabindex="-1"></a>  </span>
<span id="cb252-984"><a href="aplikace3.html#cb252-984" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb252-985"><a href="aplikace3.html#cb252-985" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb252-986"><a href="aplikace3.html#cb252-986" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-987"><a href="aplikace3.html#cb252-987" tabindex="-1"></a></span>
<span id="cb252-988"><a href="aplikace3.html#cb252-988" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - Bbasis&#39;</span>, </span>
<span id="cb252-989"><a href="aplikace3.html#cb252-989" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - Bbasis&#39;</span>, </span>
<span id="cb252-990"><a href="aplikace3.html#cb252-990" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - Bbasis&#39;</span>), </span>
<span id="cb252-991"><a href="aplikace3.html#cb252-991" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, </span>
<span id="cb252-992"><a href="aplikace3.html#cb252-992" tabindex="-1"></a>                                      presnost.train.p, presnost.train.r),</span>
<span id="cb252-993"><a href="aplikace3.html#cb252-993" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb252-994"><a href="aplikace3.html#cb252-994" tabindex="-1"></a>                                     presnost.test.p, presnost.test.r))</span>
<span id="cb252-995"><a href="aplikace3.html#cb252-995" tabindex="-1"></a></span>
<span id="cb252-996"><a href="aplikace3.html#cb252-996" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb252-997"><a href="aplikace3.html#cb252-997" tabindex="-1"></a>  </span>
<span id="cb252-998"><a href="aplikace3.html#cb252-998" tabindex="-1"></a>  <span class="do">### 7.4) Projekce na B-splinovou bázi</span></span>
<span id="cb252-999"><a href="aplikace3.html#cb252-999" tabindex="-1"></a>  </span>
<span id="cb252-1000"><a href="aplikace3.html#cb252-1000" tabindex="-1"></a>  <span class="co"># hodnoty pro B-splinovou bazi</span></span>
<span id="cb252-1001"><a href="aplikace3.html#cb252-1001" tabindex="-1"></a>  rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb252-1002"><a href="aplikace3.html#cb252-1002" tabindex="-1"></a>  norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb252-1003"><a href="aplikace3.html#cb252-1003" tabindex="-1"></a>  n_basis_min <span class="ot">&lt;-</span> norder</span>
<span id="cb252-1004"><a href="aplikace3.html#cb252-1004" tabindex="-1"></a>  n_basis_max <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb252-1005"><a href="aplikace3.html#cb252-1005" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> n_basis_min<span class="sc">:</span>n_basis_max </span>
<span id="cb252-1006"><a href="aplikace3.html#cb252-1006" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb252-1007"><a href="aplikace3.html#cb252-1007" tabindex="-1"></a>  </span>
<span id="cb252-1008"><a href="aplikace3.html#cb252-1008" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">SVM.l =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb252-1009"><a href="aplikace3.html#cb252-1009" tabindex="-1"></a>                     <span class="at">SVM.p =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb252-1010"><a href="aplikace3.html#cb252-1010" tabindex="-1"></a>                     <span class="at">SVM.r =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv))</span>
<span id="cb252-1011"><a href="aplikace3.html#cb252-1011" tabindex="-1"></a>  </span>
<span id="cb252-1012"><a href="aplikace3.html#cb252-1012" tabindex="-1"></a>  <span class="cf">for</span> (d <span class="cf">in</span> dimensions) {</span>
<span id="cb252-1013"><a href="aplikace3.html#cb252-1013" tabindex="-1"></a>    bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb252-1014"><a href="aplikace3.html#cb252-1014" tabindex="-1"></a>                                   <span class="at">nbasis =</span> d)</span>
<span id="cb252-1015"><a href="aplikace3.html#cb252-1015" tabindex="-1"></a>    Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="at">argvals =</span> t, <span class="at">basisobj =</span> bbasis) </span>
<span id="cb252-1016"><a href="aplikace3.html#cb252-1016" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb252-1017"><a href="aplikace3.html#cb252-1017" tabindex="-1"></a>    </span>
<span id="cb252-1018"><a href="aplikace3.html#cb252-1018" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb252-1019"><a href="aplikace3.html#cb252-1019" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb252-1020"><a href="aplikace3.html#cb252-1020" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XX.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb252-1021"><a href="aplikace3.html#cb252-1021" tabindex="-1"></a>      </span>
<span id="cb252-1022"><a href="aplikace3.html#cb252-1022" tabindex="-1"></a>      data.projection.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[cv_sample, ])</span>
<span id="cb252-1023"><a href="aplikace3.html#cb252-1023" tabindex="-1"></a>      data.projection.train.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[cv_sample])</span>
<span id="cb252-1024"><a href="aplikace3.html#cb252-1024" tabindex="-1"></a>      data.projection.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb252-1025"><a href="aplikace3.html#cb252-1025" tabindex="-1"></a>      Y.test.cv <span class="ot">&lt;-</span> Y.train[<span class="sc">!</span>cv_sample]</span>
<span id="cb252-1026"><a href="aplikace3.html#cb252-1026" tabindex="-1"></a>      data.projection.test.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test.cv)</span>
<span id="cb252-1027"><a href="aplikace3.html#cb252-1027" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb252-1028"><a href="aplikace3.html#cb252-1028" tabindex="-1"></a>      clf.SVM.l.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb252-1029"><a href="aplikace3.html#cb252-1029" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb252-1030"><a href="aplikace3.html#cb252-1030" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-1031"><a href="aplikace3.html#cb252-1031" tabindex="-1"></a>                              <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb252-1032"><a href="aplikace3.html#cb252-1032" tabindex="-1"></a>      </span>
<span id="cb252-1033"><a href="aplikace3.html#cb252-1033" tabindex="-1"></a>      clf.SVM.p.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb252-1034"><a href="aplikace3.html#cb252-1034" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb252-1035"><a href="aplikace3.html#cb252-1035" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-1036"><a href="aplikace3.html#cb252-1036" tabindex="-1"></a>                              <span class="at">coef0 =</span> coef0,</span>
<span id="cb252-1037"><a href="aplikace3.html#cb252-1037" tabindex="-1"></a>                              <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb252-1038"><a href="aplikace3.html#cb252-1038" tabindex="-1"></a>      </span>
<span id="cb252-1039"><a href="aplikace3.html#cb252-1039" tabindex="-1"></a>      clf.SVM.r.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb252-1040"><a href="aplikace3.html#cb252-1040" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb252-1041"><a href="aplikace3.html#cb252-1041" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-1042"><a href="aplikace3.html#cb252-1042" tabindex="-1"></a>                              <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb252-1043"><a href="aplikace3.html#cb252-1043" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb252-1044"><a href="aplikace3.html#cb252-1044" tabindex="-1"></a>      <span class="do">## linear kernel</span></span>
<span id="cb252-1045"><a href="aplikace3.html#cb252-1045" tabindex="-1"></a>      predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.projection,</span>
<span id="cb252-1046"><a href="aplikace3.html#cb252-1046" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb252-1047"><a href="aplikace3.html#cb252-1047" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb252-1048"><a href="aplikace3.html#cb252-1048" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-1049"><a href="aplikace3.html#cb252-1049" tabindex="-1"></a>      <span class="do">## polynomial kernel</span></span>
<span id="cb252-1050"><a href="aplikace3.html#cb252-1050" tabindex="-1"></a>      predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.projection, </span>
<span id="cb252-1051"><a href="aplikace3.html#cb252-1051" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb252-1052"><a href="aplikace3.html#cb252-1052" tabindex="-1"></a>      presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb252-1053"><a href="aplikace3.html#cb252-1053" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-1054"><a href="aplikace3.html#cb252-1054" tabindex="-1"></a>      <span class="do">## radial kernel</span></span>
<span id="cb252-1055"><a href="aplikace3.html#cb252-1055" tabindex="-1"></a>      predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.projection,</span>
<span id="cb252-1056"><a href="aplikace3.html#cb252-1056" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb252-1057"><a href="aplikace3.html#cb252-1057" tabindex="-1"></a>      presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb252-1058"><a href="aplikace3.html#cb252-1058" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-1059"><a href="aplikace3.html#cb252-1059" tabindex="-1"></a>      </span>
<span id="cb252-1060"><a href="aplikace3.html#cb252-1060" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane d a fold</span></span>
<span id="cb252-1061"><a href="aplikace3.html#cb252-1061" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb252-1062"><a href="aplikace3.html#cb252-1062" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb252-1063"><a href="aplikace3.html#cb252-1063" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb252-1064"><a href="aplikace3.html#cb252-1064" tabindex="-1"></a>    }</span>
<span id="cb252-1065"><a href="aplikace3.html#cb252-1065" tabindex="-1"></a>  }</span>
<span id="cb252-1066"><a href="aplikace3.html#cb252-1066" tabindex="-1"></a>  </span>
<span id="cb252-1067"><a href="aplikace3.html#cb252-1067" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb252-1068"><a href="aplikace3.html#cb252-1068" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb252-1069"><a href="aplikace3.html#cb252-1069" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb252-1070"><a href="aplikace3.html#cb252-1070" tabindex="-1"></a>  }</span>
<span id="cb252-1071"><a href="aplikace3.html#cb252-1071" tabindex="-1"></a>  </span>
<span id="cb252-1072"><a href="aplikace3.html#cb252-1072" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb252-1073"><a href="aplikace3.html#cb252-1073" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb252-1074"><a href="aplikace3.html#cb252-1074" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb252-1075"><a href="aplikace3.html#cb252-1075" tabindex="-1"></a>  </span>
<span id="cb252-1076"><a href="aplikace3.html#cb252-1076" tabindex="-1"></a>  <span class="co"># ulozime optimalni d do datove tabulky</span></span>
<span id="cb252-1077"><a href="aplikace3.html#cb252-1077" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb252-1078"><a href="aplikace3.html#cb252-1078" tabindex="-1"></a>  </span>
<span id="cb252-1079"><a href="aplikace3.html#cb252-1079" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb252-1080"><a href="aplikace3.html#cb252-1080" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - projection&#39;</span>, </span>
<span id="cb252-1081"><a href="aplikace3.html#cb252-1081" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb252-1082"><a href="aplikace3.html#cb252-1082" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - projection&#39;</span>), </span>
<span id="cb252-1083"><a href="aplikace3.html#cb252-1083" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb252-1084"><a href="aplikace3.html#cb252-1084" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb252-1085"><a href="aplikace3.html#cb252-1085" tabindex="-1"></a>  </span>
<span id="cb252-1086"><a href="aplikace3.html#cb252-1086" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb252-1087"><a href="aplikace3.html#cb252-1087" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb252-1088"><a href="aplikace3.html#cb252-1088" tabindex="-1"></a>    bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb252-1089"><a href="aplikace3.html#cb252-1089" tabindex="-1"></a>                                   <span class="at">nbasis =</span> d.opt[kernel_number])</span>
<span id="cb252-1090"><a href="aplikace3.html#cb252-1090" tabindex="-1"></a>    Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="at">argvals =</span> t, <span class="at">basisobj =</span> bbasis) </span>
<span id="cb252-1091"><a href="aplikace3.html#cb252-1091" tabindex="-1"></a>    </span>
<span id="cb252-1092"><a href="aplikace3.html#cb252-1092" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb252-1093"><a href="aplikace3.html#cb252-1093" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb252-1094"><a href="aplikace3.html#cb252-1094" tabindex="-1"></a>    </span>
<span id="cb252-1095"><a href="aplikace3.html#cb252-1095" tabindex="-1"></a>    data.projection.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train)</span>
<span id="cb252-1096"><a href="aplikace3.html#cb252-1096" tabindex="-1"></a>    data.projection.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb252-1097"><a href="aplikace3.html#cb252-1097" tabindex="-1"></a>    </span>
<span id="cb252-1098"><a href="aplikace3.html#cb252-1098" tabindex="-1"></a>    data.projection.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.test)</span>
<span id="cb252-1099"><a href="aplikace3.html#cb252-1099" tabindex="-1"></a>    data.projection.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb252-1100"><a href="aplikace3.html#cb252-1100" tabindex="-1"></a>    </span>
<span id="cb252-1101"><a href="aplikace3.html#cb252-1101" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb252-1102"><a href="aplikace3.html#cb252-1102" tabindex="-1"></a>    clf.SVM.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train,</span>
<span id="cb252-1103"><a href="aplikace3.html#cb252-1103" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb252-1104"><a href="aplikace3.html#cb252-1104" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-1105"><a href="aplikace3.html#cb252-1105" tabindex="-1"></a>                              <span class="at">coef0 =</span> coef0,</span>
<span id="cb252-1106"><a href="aplikace3.html#cb252-1106" tabindex="-1"></a>                              <span class="at">kernel =</span> kernel_type)</span>
<span id="cb252-1107"><a href="aplikace3.html#cb252-1107" tabindex="-1"></a>    </span>
<span id="cb252-1108"><a href="aplikace3.html#cb252-1108" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb252-1109"><a href="aplikace3.html#cb252-1109" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.train)</span>
<span id="cb252-1110"><a href="aplikace3.html#cb252-1110" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb252-1111"><a href="aplikace3.html#cb252-1111" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-1112"><a href="aplikace3.html#cb252-1112" tabindex="-1"></a>      </span>
<span id="cb252-1113"><a href="aplikace3.html#cb252-1113" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb252-1114"><a href="aplikace3.html#cb252-1114" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.test)</span>
<span id="cb252-1115"><a href="aplikace3.html#cb252-1115" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb252-1116"><a href="aplikace3.html#cb252-1116" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-1117"><a href="aplikace3.html#cb252-1117" tabindex="-1"></a>    </span>
<span id="cb252-1118"><a href="aplikace3.html#cb252-1118" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb252-1119"><a href="aplikace3.html#cb252-1119" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb252-1120"><a href="aplikace3.html#cb252-1120" tabindex="-1"></a>  }</span>
<span id="cb252-1121"><a href="aplikace3.html#cb252-1121" tabindex="-1"></a>  </span>
<span id="cb252-1122"><a href="aplikace3.html#cb252-1122" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb252-1123"><a href="aplikace3.html#cb252-1123" tabindex="-1"></a>  </span>
<span id="cb252-1124"><a href="aplikace3.html#cb252-1124" tabindex="-1"></a>  <span class="do">## 7.5) SVM + RKHS</span></span>
<span id="cb252-1125"><a href="aplikace3.html#cb252-1125" tabindex="-1"></a>  </span>
<span id="cb252-1126"><a href="aplikace3.html#cb252-1126" tabindex="-1"></a>  C <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb252-1127"><a href="aplikace3.html#cb252-1127" tabindex="-1"></a>  eps <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb252-1128"><a href="aplikace3.html#cb252-1128" tabindex="-1"></a>  </span>
<span id="cb252-1129"><a href="aplikace3.html#cb252-1129" tabindex="-1"></a>  <span class="do">### Gaussovo jadro</span></span>
<span id="cb252-1130"><a href="aplikace3.html#cb252-1130" tabindex="-1"></a>  </span>
<span id="cb252-1131"><a href="aplikace3.html#cb252-1131" tabindex="-1"></a>  <span class="co"># jadro a jadrova matice ... Gaussovske s parametrem gamma</span></span>
<span id="cb252-1132"><a href="aplikace3.html#cb252-1132" tabindex="-1"></a>  Gauss.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, gamma) {</span>
<span id="cb252-1133"><a href="aplikace3.html#cb252-1133" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>gamma <span class="sc">*</span> <span class="fu">norm</span>(<span class="fu">c</span>(x <span class="sc">-</span> y) <span class="sc">|&gt;</span> <span class="fu">t</span>(), <span class="at">type =</span> <span class="st">&#39;F&#39;</span>)))</span>
<span id="cb252-1134"><a href="aplikace3.html#cb252-1134" tabindex="-1"></a>  }</span>
<span id="cb252-1135"><a href="aplikace3.html#cb252-1135" tabindex="-1"></a>  </span>
<span id="cb252-1136"><a href="aplikace3.html#cb252-1136" tabindex="-1"></a>  Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, gamma) {</span>
<span id="cb252-1137"><a href="aplikace3.html#cb252-1137" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb252-1138"><a href="aplikace3.html#cb252-1138" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb252-1139"><a href="aplikace3.html#cb252-1139" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb252-1140"><a href="aplikace3.html#cb252-1140" tabindex="-1"></a>        K[i, j] <span class="ot">&lt;-</span> <span class="fu">Gauss.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], <span class="at">gamma =</span> gamma)</span>
<span id="cb252-1141"><a href="aplikace3.html#cb252-1141" tabindex="-1"></a>      }</span>
<span id="cb252-1142"><a href="aplikace3.html#cb252-1142" tabindex="-1"></a>    }</span>
<span id="cb252-1143"><a href="aplikace3.html#cb252-1143" tabindex="-1"></a>    <span class="fu">return</span>(K)</span>
<span id="cb252-1144"><a href="aplikace3.html#cb252-1144" tabindex="-1"></a>  }</span>
<span id="cb252-1145"><a href="aplikace3.html#cb252-1145" tabindex="-1"></a>  </span>
<span id="cb252-1146"><a href="aplikace3.html#cb252-1146" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb252-1147"><a href="aplikace3.html#cb252-1147" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb252-1148"><a href="aplikace3.html#cb252-1148" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb252-1149"><a href="aplikace3.html#cb252-1149" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb252-1150"><a href="aplikace3.html#cb252-1150" tabindex="-1"></a>  </span>
<span id="cb252-1151"><a href="aplikace3.html#cb252-1151" tabindex="-1"></a>  <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb252-1152"><a href="aplikace3.html#cb252-1152" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">30</span>, <span class="at">by =</span> <span class="dv">2</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb252-1153"><a href="aplikace3.html#cb252-1153" tabindex="-1"></a>  gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">15</span>)</span>
<span id="cb252-1154"><a href="aplikace3.html#cb252-1154" tabindex="-1"></a>  </span>
<span id="cb252-1155"><a href="aplikace3.html#cb252-1155" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb252-1156"><a href="aplikace3.html#cb252-1156" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb252-1157"><a href="aplikace3.html#cb252-1157" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb252-1158"><a href="aplikace3.html#cb252-1158" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb252-1159"><a href="aplikace3.html#cb252-1159" tabindex="-1"></a>  dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">gamma =</span> <span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma.cv, <span class="dv">3</span>)),</span>
<span id="cb252-1160"><a href="aplikace3.html#cb252-1160" tabindex="-1"></a>                    <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb252-1161"><a href="aplikace3.html#cb252-1161" tabindex="-1"></a>                    <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb252-1162"><a href="aplikace3.html#cb252-1162" tabindex="-1"></a>  </span>
<span id="cb252-1163"><a href="aplikace3.html#cb252-1163" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb252-1164"><a href="aplikace3.html#cb252-1164" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb252-1165"><a href="aplikace3.html#cb252-1165" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb252-1166"><a href="aplikace3.html#cb252-1166" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb252-1167"><a href="aplikace3.html#cb252-1167" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb252-1168"><a href="aplikace3.html#cb252-1168" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb252-1169"><a href="aplikace3.html#cb252-1169" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names))</span>
<span id="cb252-1170"><a href="aplikace3.html#cb252-1170" tabindex="-1"></a>  </span>
<span id="cb252-1171"><a href="aplikace3.html#cb252-1171" tabindex="-1"></a>  <span class="co"># samotna CV</span></span>
<span id="cb252-1172"><a href="aplikace3.html#cb252-1172" tabindex="-1"></a>  <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb252-1173"><a href="aplikace3.html#cb252-1173" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb252-1174"><a href="aplikace3.html#cb252-1174" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb252-1175"><a href="aplikace3.html#cb252-1175" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb252-1176"><a href="aplikace3.html#cb252-1176" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb252-1177"><a href="aplikace3.html#cb252-1177" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb252-1178"><a href="aplikace3.html#cb252-1178" tabindex="-1"></a>    </span>
<span id="cb252-1179"><a href="aplikace3.html#cb252-1179" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb252-1180"><a href="aplikace3.html#cb252-1180" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb252-1181"><a href="aplikace3.html#cb252-1181" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb252-1182"><a href="aplikace3.html#cb252-1182" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb252-1183"><a href="aplikace3.html#cb252-1183" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb252-1184"><a href="aplikace3.html#cb252-1184" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb252-1185"><a href="aplikace3.html#cb252-1185" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb252-1186"><a href="aplikace3.html#cb252-1186" tabindex="-1"></a>                      <span class="at">epsilon =</span> eps, </span>
<span id="cb252-1187"><a href="aplikace3.html#cb252-1187" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb252-1188"><a href="aplikace3.html#cb252-1188" tabindex="-1"></a>                      <span class="at">gamma =</span> gamma)</span>
<span id="cb252-1189"><a href="aplikace3.html#cb252-1189" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb252-1190"><a href="aplikace3.html#cb252-1190" tabindex="-1"></a>    }</span>
<span id="cb252-1191"><a href="aplikace3.html#cb252-1191" tabindex="-1"></a>    </span>
<span id="cb252-1192"><a href="aplikace3.html#cb252-1192" tabindex="-1"></a>    <span class="co"># projdeme dimenze</span></span>
<span id="cb252-1193"><a href="aplikace3.html#cb252-1193" tabindex="-1"></a>    <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb252-1194"><a href="aplikace3.html#cb252-1194" tabindex="-1"></a>      Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb252-1195"><a href="aplikace3.html#cb252-1195" tabindex="-1"></a>                            <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb252-1196"><a href="aplikace3.html#cb252-1196" tabindex="-1"></a>                            <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb252-1197"><a href="aplikace3.html#cb252-1197" tabindex="-1"></a>      <span class="co"># vypocet reprezentace</span></span>
<span id="cb252-1198"><a href="aplikace3.html#cb252-1198" tabindex="-1"></a>      <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb252-1199"><a href="aplikace3.html#cb252-1199" tabindex="-1"></a>        Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb252-1200"><a href="aplikace3.html#cb252-1200" tabindex="-1"></a>                               alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb252-1201"><a href="aplikace3.html#cb252-1201" tabindex="-1"></a>      }</span>
<span id="cb252-1202"><a href="aplikace3.html#cb252-1202" tabindex="-1"></a>      <span class="co"># projdeme folds</span></span>
<span id="cb252-1203"><a href="aplikace3.html#cb252-1203" tabindex="-1"></a>      <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb252-1204"><a href="aplikace3.html#cb252-1204" tabindex="-1"></a>        <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb252-1205"><a href="aplikace3.html#cb252-1205" tabindex="-1"></a>        fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb252-1206"><a href="aplikace3.html#cb252-1206" tabindex="-1"></a>        <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb252-1207"><a href="aplikace3.html#cb252-1207" tabindex="-1"></a>        XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb252-1208"><a href="aplikace3.html#cb252-1208" tabindex="-1"></a>        XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb252-1209"><a href="aplikace3.html#cb252-1209" tabindex="-1"></a>        <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb252-1210"><a href="aplikace3.html#cb252-1210" tabindex="-1"></a>        Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb252-1211"><a href="aplikace3.html#cb252-1211" tabindex="-1"></a>                                    <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb252-1212"><a href="aplikace3.html#cb252-1212" tabindex="-1"></a>                                    <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb252-1213"><a href="aplikace3.html#cb252-1213" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb252-1214"><a href="aplikace3.html#cb252-1214" tabindex="-1"></a>        <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb252-1215"><a href="aplikace3.html#cb252-1215" tabindex="-1"></a>        <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb252-1216"><a href="aplikace3.html#cb252-1216" tabindex="-1"></a>          kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb252-1217"><a href="aplikace3.html#cb252-1217" tabindex="-1"></a>        </span>
<span id="cb252-1218"><a href="aplikace3.html#cb252-1218" tabindex="-1"></a>          data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb252-1219"><a href="aplikace3.html#cb252-1219" tabindex="-1"></a>          data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb252-1220"><a href="aplikace3.html#cb252-1220" tabindex="-1"></a>          </span>
<span id="cb252-1221"><a href="aplikace3.html#cb252-1221" tabindex="-1"></a>          data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb252-1222"><a href="aplikace3.html#cb252-1222" tabindex="-1"></a>          data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb252-1223"><a href="aplikace3.html#cb252-1223" tabindex="-1"></a>          </span>
<span id="cb252-1224"><a href="aplikace3.html#cb252-1224" tabindex="-1"></a>          <span class="co"># sestrojeni modelu</span></span>
<span id="cb252-1225"><a href="aplikace3.html#cb252-1225" tabindex="-1"></a>          clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb252-1226"><a href="aplikace3.html#cb252-1226" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb252-1227"><a href="aplikace3.html#cb252-1227" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-1228"><a href="aplikace3.html#cb252-1228" tabindex="-1"></a>                              <span class="at">cost =</span> C,</span>
<span id="cb252-1229"><a href="aplikace3.html#cb252-1229" tabindex="-1"></a>                              <span class="at">coef0 =</span> coef0,</span>
<span id="cb252-1230"><a href="aplikace3.html#cb252-1230" tabindex="-1"></a>                              <span class="at">kernel =</span> kernel_type)</span>
<span id="cb252-1231"><a href="aplikace3.html#cb252-1231" tabindex="-1"></a>          </span>
<span id="cb252-1232"><a href="aplikace3.html#cb252-1232" tabindex="-1"></a>          <span class="co"># presnost na validacnich datech</span></span>
<span id="cb252-1233"><a href="aplikace3.html#cb252-1233" tabindex="-1"></a>          predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb252-1234"><a href="aplikace3.html#cb252-1234" tabindex="-1"></a>          presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb252-1235"><a href="aplikace3.html#cb252-1235" tabindex="-1"></a>            <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-1236"><a href="aplikace3.html#cb252-1236" tabindex="-1"></a>          </span>
<span id="cb252-1237"><a href="aplikace3.html#cb252-1237" tabindex="-1"></a>          <span class="co"># ulozeni vysledku</span></span>
<span id="cb252-1238"><a href="aplikace3.html#cb252-1238" tabindex="-1"></a>          Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb252-1239"><a href="aplikace3.html#cb252-1239" tabindex="-1"></a>        }</span>
<span id="cb252-1240"><a href="aplikace3.html#cb252-1240" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb252-1241"><a href="aplikace3.html#cb252-1241" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb252-1242"><a href="aplikace3.html#cb252-1242" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb252-1243"><a href="aplikace3.html#cb252-1243" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb252-1244"><a href="aplikace3.html#cb252-1244" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb252-1245"><a href="aplikace3.html#cb252-1245" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb252-1246"><a href="aplikace3.html#cb252-1246" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb252-1247"><a href="aplikace3.html#cb252-1247" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb252-1248"><a href="aplikace3.html#cb252-1248" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb252-1249"><a href="aplikace3.html#cb252-1249" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb252-1250"><a href="aplikace3.html#cb252-1250" tabindex="-1"></a>      }</span>
<span id="cb252-1251"><a href="aplikace3.html#cb252-1251" tabindex="-1"></a>    }</span>
<span id="cb252-1252"><a href="aplikace3.html#cb252-1252" tabindex="-1"></a>  }</span>
<span id="cb252-1253"><a href="aplikace3.html#cb252-1253" tabindex="-1"></a>  </span>
<span id="cb252-1254"><a href="aplikace3.html#cb252-1254" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb252-1255"><a href="aplikace3.html#cb252-1255" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb252-1256"><a href="aplikace3.html#cb252-1256" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb252-1257"><a href="aplikace3.html#cb252-1257" tabindex="-1"></a>  }</span>
<span id="cb252-1258"><a href="aplikace3.html#cb252-1258" tabindex="-1"></a>  </span>
<span id="cb252-1259"><a href="aplikace3.html#cb252-1259" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb252-1260"><a href="aplikace3.html#cb252-1260" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb252-1261"><a href="aplikace3.html#cb252-1261" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv))</span>
<span id="cb252-1262"><a href="aplikace3.html#cb252-1262" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb252-1263"><a href="aplikace3.html#cb252-1263" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb252-1264"><a href="aplikace3.html#cb252-1264" tabindex="-1"></a>  </span>
<span id="cb252-1265"><a href="aplikace3.html#cb252-1265" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb252-1266"><a href="aplikace3.html#cb252-1266" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb252-1267"><a href="aplikace3.html#cb252-1267" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb252-1268"><a href="aplikace3.html#cb252-1268" tabindex="-1"></a>  d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb252-1269"><a href="aplikace3.html#cb252-1269" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb252-1270"><a href="aplikace3.html#cb252-1270" tabindex="-1"></a>  </span>
<span id="cb252-1271"><a href="aplikace3.html#cb252-1271" tabindex="-1"></a>  err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb252-1272"><a href="aplikace3.html#cb252-1272" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb252-1273"><a href="aplikace3.html#cb252-1273" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb252-1274"><a href="aplikace3.html#cb252-1274" tabindex="-1"></a>  df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">gamma =</span> gamma.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb252-1275"><a href="aplikace3.html#cb252-1275" tabindex="-1"></a>             <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb252-1276"><a href="aplikace3.html#cb252-1276" tabindex="-1"></a>             <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb252-1277"><a href="aplikace3.html#cb252-1277" tabindex="-1"></a>  </span>
<span id="cb252-1278"><a href="aplikace3.html#cb252-1278" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>] <span class="ot">&lt;-</span> gamma.opt</span>
<span id="cb252-1279"><a href="aplikace3.html#cb252-1279" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb252-1280"><a href="aplikace3.html#cb252-1280" tabindex="-1"></a>  </span>
<span id="cb252-1281"><a href="aplikace3.html#cb252-1281" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb252-1282"><a href="aplikace3.html#cb252-1282" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb252-1283"><a href="aplikace3.html#cb252-1283" tabindex="-1"></a>  <span class="co"># pridame i testovaci data</span></span>
<span id="cb252-1284"><a href="aplikace3.html#cb252-1284" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb252-1285"><a href="aplikace3.html#cb252-1285" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb252-1286"><a href="aplikace3.html#cb252-1286" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, </span>
<span id="cb252-1287"><a href="aplikace3.html#cb252-1287" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, </span>
<span id="cb252-1288"><a href="aplikace3.html#cb252-1288" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>), </span>
<span id="cb252-1289"><a href="aplikace3.html#cb252-1289" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb252-1290"><a href="aplikace3.html#cb252-1290" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb252-1291"><a href="aplikace3.html#cb252-1291" tabindex="-1"></a>  </span>
<span id="cb252-1292"><a href="aplikace3.html#cb252-1292" tabindex="-1"></a>  <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb252-1293"><a href="aplikace3.html#cb252-1293" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb252-1294"><a href="aplikace3.html#cb252-1294" tabindex="-1"></a>    <span class="co"># spocitame matici K</span></span>
<span id="cb252-1295"><a href="aplikace3.html#cb252-1295" tabindex="-1"></a>    gamma <span class="ot">&lt;-</span> gamma.opt[kernel_number] <span class="co"># hodnota gamma pomoci CV</span></span>
<span id="cb252-1296"><a href="aplikace3.html#cb252-1296" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb252-1297"><a href="aplikace3.html#cb252-1297" tabindex="-1"></a>    </span>
<span id="cb252-1298"><a href="aplikace3.html#cb252-1298" tabindex="-1"></a>    <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb252-1299"><a href="aplikace3.html#cb252-1299" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb252-1300"><a href="aplikace3.html#cb252-1300" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb252-1301"><a href="aplikace3.html#cb252-1301" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb252-1302"><a href="aplikace3.html#cb252-1302" tabindex="-1"></a>    <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb252-1303"><a href="aplikace3.html#cb252-1303" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb252-1304"><a href="aplikace3.html#cb252-1304" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb252-1305"><a href="aplikace3.html#cb252-1305" tabindex="-1"></a>    </span>
<span id="cb252-1306"><a href="aplikace3.html#cb252-1306" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb252-1307"><a href="aplikace3.html#cb252-1307" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb252-1308"><a href="aplikace3.html#cb252-1308" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb252-1309"><a href="aplikace3.html#cb252-1309" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb252-1310"><a href="aplikace3.html#cb252-1310" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb252-1311"><a href="aplikace3.html#cb252-1311" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb252-1312"><a href="aplikace3.html#cb252-1312" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb252-1313"><a href="aplikace3.html#cb252-1313" tabindex="-1"></a>                      <span class="at">epsilon =</span> eps,</span>
<span id="cb252-1314"><a href="aplikace3.html#cb252-1314" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb252-1315"><a href="aplikace3.html#cb252-1315" tabindex="-1"></a>                      <span class="at">gamma =</span> gamma)</span>
<span id="cb252-1316"><a href="aplikace3.html#cb252-1316" tabindex="-1"></a>      <span class="co"># urceni alpha</span></span>
<span id="cb252-1317"><a href="aplikace3.html#cb252-1317" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb252-1318"><a href="aplikace3.html#cb252-1318" tabindex="-1"></a>    }</span>
<span id="cb252-1319"><a href="aplikace3.html#cb252-1319" tabindex="-1"></a>    <span class="co"># d</span></span>
<span id="cb252-1320"><a href="aplikace3.html#cb252-1320" tabindex="-1"></a>    d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb252-1321"><a href="aplikace3.html#cb252-1321" tabindex="-1"></a>    </span>
<span id="cb252-1322"><a href="aplikace3.html#cb252-1322" tabindex="-1"></a>    <span class="co"># urceni vektoru lambda</span></span>
<span id="cb252-1323"><a href="aplikace3.html#cb252-1323" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb252-1324"><a href="aplikace3.html#cb252-1324" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb252-1325"><a href="aplikace3.html#cb252-1325" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb252-1326"><a href="aplikace3.html#cb252-1326" tabindex="-1"></a>    </span>
<span id="cb252-1327"><a href="aplikace3.html#cb252-1327" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb252-1328"><a href="aplikace3.html#cb252-1328" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb252-1329"><a href="aplikace3.html#cb252-1329" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb252-1330"><a href="aplikace3.html#cb252-1330" tabindex="-1"></a>    }</span>
<span id="cb252-1331"><a href="aplikace3.html#cb252-1331" tabindex="-1"></a>    </span>
<span id="cb252-1332"><a href="aplikace3.html#cb252-1332" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb252-1333"><a href="aplikace3.html#cb252-1333" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb252-1334"><a href="aplikace3.html#cb252-1334" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb252-1335"><a href="aplikace3.html#cb252-1335" tabindex="-1"></a>  </span>
<span id="cb252-1336"><a href="aplikace3.html#cb252-1336" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb252-1337"><a href="aplikace3.html#cb252-1337" tabindex="-1"></a>  </span>
<span id="cb252-1338"><a href="aplikace3.html#cb252-1338" tabindex="-1"></a>    data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb252-1339"><a href="aplikace3.html#cb252-1339" tabindex="-1"></a>    data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb252-1340"><a href="aplikace3.html#cb252-1340" tabindex="-1"></a>    </span>
<span id="cb252-1341"><a href="aplikace3.html#cb252-1341" tabindex="-1"></a>    data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb252-1342"><a href="aplikace3.html#cb252-1342" tabindex="-1"></a>    data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb252-1343"><a href="aplikace3.html#cb252-1343" tabindex="-1"></a>    </span>
<span id="cb252-1344"><a href="aplikace3.html#cb252-1344" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb252-1345"><a href="aplikace3.html#cb252-1345" tabindex="-1"></a>    clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb252-1346"><a href="aplikace3.html#cb252-1346" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb252-1347"><a href="aplikace3.html#cb252-1347" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-1348"><a href="aplikace3.html#cb252-1348" tabindex="-1"></a>                        <span class="at">cost =</span> C,</span>
<span id="cb252-1349"><a href="aplikace3.html#cb252-1349" tabindex="-1"></a>                        <span class="at">coef0 =</span> coef0,</span>
<span id="cb252-1350"><a href="aplikace3.html#cb252-1350" tabindex="-1"></a>                        <span class="at">kernel =</span> kernel_type)</span>
<span id="cb252-1351"><a href="aplikace3.html#cb252-1351" tabindex="-1"></a>    </span>
<span id="cb252-1352"><a href="aplikace3.html#cb252-1352" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb252-1353"><a href="aplikace3.html#cb252-1353" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb252-1354"><a href="aplikace3.html#cb252-1354" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb252-1355"><a href="aplikace3.html#cb252-1355" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-1356"><a href="aplikace3.html#cb252-1356" tabindex="-1"></a>      </span>
<span id="cb252-1357"><a href="aplikace3.html#cb252-1357" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb252-1358"><a href="aplikace3.html#cb252-1358" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb252-1359"><a href="aplikace3.html#cb252-1359" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb252-1360"><a href="aplikace3.html#cb252-1360" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-1361"><a href="aplikace3.html#cb252-1361" tabindex="-1"></a>    </span>
<span id="cb252-1362"><a href="aplikace3.html#cb252-1362" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb252-1363"><a href="aplikace3.html#cb252-1363" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb252-1364"><a href="aplikace3.html#cb252-1364" tabindex="-1"></a>  }</span>
<span id="cb252-1365"><a href="aplikace3.html#cb252-1365" tabindex="-1"></a>  </span>
<span id="cb252-1366"><a href="aplikace3.html#cb252-1366" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb252-1367"><a href="aplikace3.html#cb252-1367" tabindex="-1"></a></span>
<span id="cb252-1368"><a href="aplikace3.html#cb252-1368" tabindex="-1"></a>  <span class="do">### Polynomialni jadro</span></span>
<span id="cb252-1369"><a href="aplikace3.html#cb252-1369" tabindex="-1"></a>  </span>
<span id="cb252-1370"><a href="aplikace3.html#cb252-1370" tabindex="-1"></a>  <span class="co"># jadro a jadrova matice ... polynomialni s parametrem p</span></span>
<span id="cb252-1371"><a href="aplikace3.html#cb252-1371" tabindex="-1"></a>  Poly.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, p) {</span>
<span id="cb252-1372"><a href="aplikace3.html#cb252-1372" tabindex="-1"></a>    <span class="fu">return</span>((<span class="dv">1</span> <span class="sc">+</span> x <span class="sc">*</span> y)<span class="sc">^</span>p)</span>
<span id="cb252-1373"><a href="aplikace3.html#cb252-1373" tabindex="-1"></a>  }</span>
<span id="cb252-1374"><a href="aplikace3.html#cb252-1374" tabindex="-1"></a>  </span>
<span id="cb252-1375"><a href="aplikace3.html#cb252-1375" tabindex="-1"></a>  Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, p) {</span>
<span id="cb252-1376"><a href="aplikace3.html#cb252-1376" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb252-1377"><a href="aplikace3.html#cb252-1377" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb252-1378"><a href="aplikace3.html#cb252-1378" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb252-1379"><a href="aplikace3.html#cb252-1379" tabindex="-1"></a>        K[i, j] <span class="ot">&lt;-</span> <span class="fu">Poly.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], p)</span>
<span id="cb252-1380"><a href="aplikace3.html#cb252-1380" tabindex="-1"></a>      }</span>
<span id="cb252-1381"><a href="aplikace3.html#cb252-1381" tabindex="-1"></a>    }</span>
<span id="cb252-1382"><a href="aplikace3.html#cb252-1382" tabindex="-1"></a>    <span class="fu">return</span>(K)</span>
<span id="cb252-1383"><a href="aplikace3.html#cb252-1383" tabindex="-1"></a>  }</span>
<span id="cb252-1384"><a href="aplikace3.html#cb252-1384" tabindex="-1"></a>  </span>
<span id="cb252-1385"><a href="aplikace3.html#cb252-1385" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb252-1386"><a href="aplikace3.html#cb252-1386" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb252-1387"><a href="aplikace3.html#cb252-1387" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb252-1388"><a href="aplikace3.html#cb252-1388" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb252-1389"><a href="aplikace3.html#cb252-1389" tabindex="-1"></a>  </span>
<span id="cb252-1390"><a href="aplikace3.html#cb252-1390" tabindex="-1"></a>  <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb252-1391"><a href="aplikace3.html#cb252-1391" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb252-1392"><a href="aplikace3.html#cb252-1392" tabindex="-1"></a>  poly.cv <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb252-1393"><a href="aplikace3.html#cb252-1393" tabindex="-1"></a>  </span>
<span id="cb252-1394"><a href="aplikace3.html#cb252-1394" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb252-1395"><a href="aplikace3.html#cb252-1395" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb252-1396"><a href="aplikace3.html#cb252-1396" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb252-1397"><a href="aplikace3.html#cb252-1397" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro dane p a vrstvy odpovidaji folds</span></span>
<span id="cb252-1398"><a href="aplikace3.html#cb252-1398" tabindex="-1"></a>  dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, poly.cv),</span>
<span id="cb252-1399"><a href="aplikace3.html#cb252-1399" tabindex="-1"></a>                    <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb252-1400"><a href="aplikace3.html#cb252-1400" tabindex="-1"></a>                    <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb252-1401"><a href="aplikace3.html#cb252-1401" tabindex="-1"></a>  </span>
<span id="cb252-1402"><a href="aplikace3.html#cb252-1402" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb252-1403"><a href="aplikace3.html#cb252-1403" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb252-1404"><a href="aplikace3.html#cb252-1404" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb252-1405"><a href="aplikace3.html#cb252-1405" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb252-1406"><a href="aplikace3.html#cb252-1406" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb252-1407"><a href="aplikace3.html#cb252-1407" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb252-1408"><a href="aplikace3.html#cb252-1408" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names))</span>
<span id="cb252-1409"><a href="aplikace3.html#cb252-1409" tabindex="-1"></a>  </span>
<span id="cb252-1410"><a href="aplikace3.html#cb252-1410" tabindex="-1"></a>  <span class="co"># samotna CV</span></span>
<span id="cb252-1411"><a href="aplikace3.html#cb252-1411" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> poly.cv) {</span>
<span id="cb252-1412"><a href="aplikace3.html#cb252-1412" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb252-1413"><a href="aplikace3.html#cb252-1413" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb252-1414"><a href="aplikace3.html#cb252-1414" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb252-1415"><a href="aplikace3.html#cb252-1415" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb252-1416"><a href="aplikace3.html#cb252-1416" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb252-1417"><a href="aplikace3.html#cb252-1417" tabindex="-1"></a>    </span>
<span id="cb252-1418"><a href="aplikace3.html#cb252-1418" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb252-1419"><a href="aplikace3.html#cb252-1419" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb252-1420"><a href="aplikace3.html#cb252-1420" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb252-1421"><a href="aplikace3.html#cb252-1421" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb252-1422"><a href="aplikace3.html#cb252-1422" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb252-1423"><a href="aplikace3.html#cb252-1423" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb252-1424"><a href="aplikace3.html#cb252-1424" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb252-1425"><a href="aplikace3.html#cb252-1425" tabindex="-1"></a>                      <span class="at">epsilon =</span> eps,                   </span>
<span id="cb252-1426"><a href="aplikace3.html#cb252-1426" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb252-1427"><a href="aplikace3.html#cb252-1427" tabindex="-1"></a>                      <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb252-1428"><a href="aplikace3.html#cb252-1428" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb252-1429"><a href="aplikace3.html#cb252-1429" tabindex="-1"></a>                      <span class="at">degree =</span> p)</span>
<span id="cb252-1430"><a href="aplikace3.html#cb252-1430" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb252-1431"><a href="aplikace3.html#cb252-1431" tabindex="-1"></a>    }</span>
<span id="cb252-1432"><a href="aplikace3.html#cb252-1432" tabindex="-1"></a>    </span>
<span id="cb252-1433"><a href="aplikace3.html#cb252-1433" tabindex="-1"></a>    <span class="co"># projdeme dimenze</span></span>
<span id="cb252-1434"><a href="aplikace3.html#cb252-1434" tabindex="-1"></a>    <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb252-1435"><a href="aplikace3.html#cb252-1435" tabindex="-1"></a>      Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb252-1436"><a href="aplikace3.html#cb252-1436" tabindex="-1"></a>                            <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb252-1437"><a href="aplikace3.html#cb252-1437" tabindex="-1"></a>                            <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb252-1438"><a href="aplikace3.html#cb252-1438" tabindex="-1"></a>      <span class="co"># vypocet reprezentace</span></span>
<span id="cb252-1439"><a href="aplikace3.html#cb252-1439" tabindex="-1"></a>      <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb252-1440"><a href="aplikace3.html#cb252-1440" tabindex="-1"></a>        Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb252-1441"><a href="aplikace3.html#cb252-1441" tabindex="-1"></a>                               alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb252-1442"><a href="aplikace3.html#cb252-1442" tabindex="-1"></a>      }</span>
<span id="cb252-1443"><a href="aplikace3.html#cb252-1443" tabindex="-1"></a>      <span class="co"># projdeme folds</span></span>
<span id="cb252-1444"><a href="aplikace3.html#cb252-1444" tabindex="-1"></a>      <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb252-1445"><a href="aplikace3.html#cb252-1445" tabindex="-1"></a>        <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb252-1446"><a href="aplikace3.html#cb252-1446" tabindex="-1"></a>        fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb252-1447"><a href="aplikace3.html#cb252-1447" tabindex="-1"></a>        <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb252-1448"><a href="aplikace3.html#cb252-1448" tabindex="-1"></a>        XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb252-1449"><a href="aplikace3.html#cb252-1449" tabindex="-1"></a>        XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb252-1450"><a href="aplikace3.html#cb252-1450" tabindex="-1"></a>        <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb252-1451"><a href="aplikace3.html#cb252-1451" tabindex="-1"></a>        Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb252-1452"><a href="aplikace3.html#cb252-1452" tabindex="-1"></a>                                    <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb252-1453"><a href="aplikace3.html#cb252-1453" tabindex="-1"></a>                                    <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb252-1454"><a href="aplikace3.html#cb252-1454" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb252-1455"><a href="aplikace3.html#cb252-1455" tabindex="-1"></a>        <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb252-1456"><a href="aplikace3.html#cb252-1456" tabindex="-1"></a>        <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb252-1457"><a href="aplikace3.html#cb252-1457" tabindex="-1"></a>          kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb252-1458"><a href="aplikace3.html#cb252-1458" tabindex="-1"></a>        </span>
<span id="cb252-1459"><a href="aplikace3.html#cb252-1459" tabindex="-1"></a>          data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb252-1460"><a href="aplikace3.html#cb252-1460" tabindex="-1"></a>          data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb252-1461"><a href="aplikace3.html#cb252-1461" tabindex="-1"></a>          </span>
<span id="cb252-1462"><a href="aplikace3.html#cb252-1462" tabindex="-1"></a>          data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb252-1463"><a href="aplikace3.html#cb252-1463" tabindex="-1"></a>          data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb252-1464"><a href="aplikace3.html#cb252-1464" tabindex="-1"></a>          </span>
<span id="cb252-1465"><a href="aplikace3.html#cb252-1465" tabindex="-1"></a>          <span class="co"># sestrojeni modelu</span></span>
<span id="cb252-1466"><a href="aplikace3.html#cb252-1466" tabindex="-1"></a>          clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb252-1467"><a href="aplikace3.html#cb252-1467" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb252-1468"><a href="aplikace3.html#cb252-1468" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-1469"><a href="aplikace3.html#cb252-1469" tabindex="-1"></a>                              <span class="at">epsilon =</span> eps,                   </span>
<span id="cb252-1470"><a href="aplikace3.html#cb252-1470" tabindex="-1"></a>                              <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb252-1471"><a href="aplikace3.html#cb252-1471" tabindex="-1"></a>                              <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb252-1472"><a href="aplikace3.html#cb252-1472" tabindex="-1"></a>                              <span class="at">cost =</span> C,</span>
<span id="cb252-1473"><a href="aplikace3.html#cb252-1473" tabindex="-1"></a>                              <span class="at">kernel =</span> kernel_type)</span>
<span id="cb252-1474"><a href="aplikace3.html#cb252-1474" tabindex="-1"></a>          </span>
<span id="cb252-1475"><a href="aplikace3.html#cb252-1475" tabindex="-1"></a>          <span class="co"># presnost na validacnich datech</span></span>
<span id="cb252-1476"><a href="aplikace3.html#cb252-1476" tabindex="-1"></a>          predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb252-1477"><a href="aplikace3.html#cb252-1477" tabindex="-1"></a>          presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb252-1478"><a href="aplikace3.html#cb252-1478" tabindex="-1"></a>            <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-1479"><a href="aplikace3.html#cb252-1479" tabindex="-1"></a>          </span>
<span id="cb252-1480"><a href="aplikace3.html#cb252-1480" tabindex="-1"></a>          <span class="co"># ulozeni vysledku</span></span>
<span id="cb252-1481"><a href="aplikace3.html#cb252-1481" tabindex="-1"></a>          Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb252-1482"><a href="aplikace3.html#cb252-1482" tabindex="-1"></a>        }</span>
<span id="cb252-1483"><a href="aplikace3.html#cb252-1483" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb252-1484"><a href="aplikace3.html#cb252-1484" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb252-1485"><a href="aplikace3.html#cb252-1485" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb252-1486"><a href="aplikace3.html#cb252-1486" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb252-1487"><a href="aplikace3.html#cb252-1487" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb252-1488"><a href="aplikace3.html#cb252-1488" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb252-1489"><a href="aplikace3.html#cb252-1489" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb252-1490"><a href="aplikace3.html#cb252-1490" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb252-1491"><a href="aplikace3.html#cb252-1491" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb252-1492"><a href="aplikace3.html#cb252-1492" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb252-1493"><a href="aplikace3.html#cb252-1493" tabindex="-1"></a>      }</span>
<span id="cb252-1494"><a href="aplikace3.html#cb252-1494" tabindex="-1"></a>    }</span>
<span id="cb252-1495"><a href="aplikace3.html#cb252-1495" tabindex="-1"></a>  }</span>
<span id="cb252-1496"><a href="aplikace3.html#cb252-1496" tabindex="-1"></a>  </span>
<span id="cb252-1497"><a href="aplikace3.html#cb252-1497" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb252-1498"><a href="aplikace3.html#cb252-1498" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb252-1499"><a href="aplikace3.html#cb252-1499" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb252-1500"><a href="aplikace3.html#cb252-1500" tabindex="-1"></a>  }</span>
<span id="cb252-1501"><a href="aplikace3.html#cb252-1501" tabindex="-1"></a>  </span>
<span id="cb252-1502"><a href="aplikace3.html#cb252-1502" tabindex="-1"></a>  poly.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb252-1503"><a href="aplikace3.html#cb252-1503" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb252-1504"><a href="aplikace3.html#cb252-1504" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv))</span>
<span id="cb252-1505"><a href="aplikace3.html#cb252-1505" tabindex="-1"></a>  poly.opt[poly.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(poly.cv)</span>
<span id="cb252-1506"><a href="aplikace3.html#cb252-1506" tabindex="-1"></a>  poly.opt <span class="ot">&lt;-</span> poly.cv[poly.opt]</span>
<span id="cb252-1507"><a href="aplikace3.html#cb252-1507" tabindex="-1"></a>  </span>
<span id="cb252-1508"><a href="aplikace3.html#cb252-1508" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb252-1509"><a href="aplikace3.html#cb252-1509" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb252-1510"><a href="aplikace3.html#cb252-1510" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb252-1511"><a href="aplikace3.html#cb252-1511" tabindex="-1"></a>  d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb252-1512"><a href="aplikace3.html#cb252-1512" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb252-1513"><a href="aplikace3.html#cb252-1513" tabindex="-1"></a>  </span>
<span id="cb252-1514"><a href="aplikace3.html#cb252-1514" tabindex="-1"></a>  err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb252-1515"><a href="aplikace3.html#cb252-1515" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb252-1516"><a href="aplikace3.html#cb252-1516" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb252-1517"><a href="aplikace3.html#cb252-1517" tabindex="-1"></a>  df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">p =</span> poly.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb252-1518"><a href="aplikace3.html#cb252-1518" tabindex="-1"></a>             <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb252-1519"><a href="aplikace3.html#cb252-1519" tabindex="-1"></a>             <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb252-1520"><a href="aplikace3.html#cb252-1520" tabindex="-1"></a>  </span>
<span id="cb252-1521"><a href="aplikace3.html#cb252-1521" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">13</span><span class="sc">:</span><span class="dv">15</span>] <span class="ot">&lt;-</span> poly.opt</span>
<span id="cb252-1522"><a href="aplikace3.html#cb252-1522" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">16</span><span class="sc">:</span><span class="dv">18</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb252-1523"><a href="aplikace3.html#cb252-1523" tabindex="-1"></a>  </span>
<span id="cb252-1524"><a href="aplikace3.html#cb252-1524" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb252-1525"><a href="aplikace3.html#cb252-1525" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb252-1526"><a href="aplikace3.html#cb252-1526" tabindex="-1"></a>  <span class="co"># pridame i testovaci data</span></span>
<span id="cb252-1527"><a href="aplikace3.html#cb252-1527" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb252-1528"><a href="aplikace3.html#cb252-1528" tabindex="-1"></a>  </span>
<span id="cb252-1529"><a href="aplikace3.html#cb252-1529" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb252-1530"><a href="aplikace3.html#cb252-1530" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - poly&#39;</span>, </span>
<span id="cb252-1531"><a href="aplikace3.html#cb252-1531" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - RKHS - poly&#39;</span>, </span>
<span id="cb252-1532"><a href="aplikace3.html#cb252-1532" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - RKHS - poly&#39;</span>), </span>
<span id="cb252-1533"><a href="aplikace3.html#cb252-1533" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb252-1534"><a href="aplikace3.html#cb252-1534" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb252-1535"><a href="aplikace3.html#cb252-1535" tabindex="-1"></a>  </span>
<span id="cb252-1536"><a href="aplikace3.html#cb252-1536" tabindex="-1"></a>  <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb252-1537"><a href="aplikace3.html#cb252-1537" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb252-1538"><a href="aplikace3.html#cb252-1538" tabindex="-1"></a>    <span class="co"># spocitame matici K</span></span>
<span id="cb252-1539"><a href="aplikace3.html#cb252-1539" tabindex="-1"></a>    p <span class="ot">&lt;-</span> poly.opt[kernel_number] <span class="co"># hodnota gamma pomoci CV</span></span>
<span id="cb252-1540"><a href="aplikace3.html#cb252-1540" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb252-1541"><a href="aplikace3.html#cb252-1541" tabindex="-1"></a>    </span>
<span id="cb252-1542"><a href="aplikace3.html#cb252-1542" tabindex="-1"></a>    <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb252-1543"><a href="aplikace3.html#cb252-1543" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb252-1544"><a href="aplikace3.html#cb252-1544" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb252-1545"><a href="aplikace3.html#cb252-1545" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb252-1546"><a href="aplikace3.html#cb252-1546" tabindex="-1"></a>    <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb252-1547"><a href="aplikace3.html#cb252-1547" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb252-1548"><a href="aplikace3.html#cb252-1548" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb252-1549"><a href="aplikace3.html#cb252-1549" tabindex="-1"></a>    </span>
<span id="cb252-1550"><a href="aplikace3.html#cb252-1550" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb252-1551"><a href="aplikace3.html#cb252-1551" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb252-1552"><a href="aplikace3.html#cb252-1552" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb252-1553"><a href="aplikace3.html#cb252-1553" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb252-1554"><a href="aplikace3.html#cb252-1554" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb252-1555"><a href="aplikace3.html#cb252-1555" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb252-1556"><a href="aplikace3.html#cb252-1556" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb252-1557"><a href="aplikace3.html#cb252-1557" tabindex="-1"></a>                      <span class="at">epsilon =</span> eps,                   </span>
<span id="cb252-1558"><a href="aplikace3.html#cb252-1558" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb252-1559"><a href="aplikace3.html#cb252-1559" tabindex="-1"></a>                      <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb252-1560"><a href="aplikace3.html#cb252-1560" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb252-1561"><a href="aplikace3.html#cb252-1561" tabindex="-1"></a>                      <span class="at">degree =</span> p)</span>
<span id="cb252-1562"><a href="aplikace3.html#cb252-1562" tabindex="-1"></a>      <span class="co"># urceni alpha</span></span>
<span id="cb252-1563"><a href="aplikace3.html#cb252-1563" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb252-1564"><a href="aplikace3.html#cb252-1564" tabindex="-1"></a>    }</span>
<span id="cb252-1565"><a href="aplikace3.html#cb252-1565" tabindex="-1"></a>    <span class="co"># d</span></span>
<span id="cb252-1566"><a href="aplikace3.html#cb252-1566" tabindex="-1"></a>    d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb252-1567"><a href="aplikace3.html#cb252-1567" tabindex="-1"></a>    </span>
<span id="cb252-1568"><a href="aplikace3.html#cb252-1568" tabindex="-1"></a>    <span class="co"># urceni vektoru lambda</span></span>
<span id="cb252-1569"><a href="aplikace3.html#cb252-1569" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb252-1570"><a href="aplikace3.html#cb252-1570" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb252-1571"><a href="aplikace3.html#cb252-1571" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb252-1572"><a href="aplikace3.html#cb252-1572" tabindex="-1"></a>    </span>
<span id="cb252-1573"><a href="aplikace3.html#cb252-1573" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb252-1574"><a href="aplikace3.html#cb252-1574" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb252-1575"><a href="aplikace3.html#cb252-1575" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb252-1576"><a href="aplikace3.html#cb252-1576" tabindex="-1"></a>    }</span>
<span id="cb252-1577"><a href="aplikace3.html#cb252-1577" tabindex="-1"></a>    </span>
<span id="cb252-1578"><a href="aplikace3.html#cb252-1578" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb252-1579"><a href="aplikace3.html#cb252-1579" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb252-1580"><a href="aplikace3.html#cb252-1580" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb252-1581"><a href="aplikace3.html#cb252-1581" tabindex="-1"></a>  </span>
<span id="cb252-1582"><a href="aplikace3.html#cb252-1582" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb252-1583"><a href="aplikace3.html#cb252-1583" tabindex="-1"></a>  </span>
<span id="cb252-1584"><a href="aplikace3.html#cb252-1584" tabindex="-1"></a>    data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb252-1585"><a href="aplikace3.html#cb252-1585" tabindex="-1"></a>    data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb252-1586"><a href="aplikace3.html#cb252-1586" tabindex="-1"></a>    </span>
<span id="cb252-1587"><a href="aplikace3.html#cb252-1587" tabindex="-1"></a>    data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb252-1588"><a href="aplikace3.html#cb252-1588" tabindex="-1"></a>    data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb252-1589"><a href="aplikace3.html#cb252-1589" tabindex="-1"></a>    </span>
<span id="cb252-1590"><a href="aplikace3.html#cb252-1590" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb252-1591"><a href="aplikace3.html#cb252-1591" tabindex="-1"></a>    clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb252-1592"><a href="aplikace3.html#cb252-1592" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb252-1593"><a href="aplikace3.html#cb252-1593" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-1594"><a href="aplikace3.html#cb252-1594" tabindex="-1"></a>                        <span class="at">epsilon =</span> eps,                   </span>
<span id="cb252-1595"><a href="aplikace3.html#cb252-1595" tabindex="-1"></a>                        <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb252-1596"><a href="aplikace3.html#cb252-1596" tabindex="-1"></a>                        <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb252-1597"><a href="aplikace3.html#cb252-1597" tabindex="-1"></a>                        <span class="at">cost =</span> C,</span>
<span id="cb252-1598"><a href="aplikace3.html#cb252-1598" tabindex="-1"></a>                        <span class="at">kernel =</span> kernel_type)</span>
<span id="cb252-1599"><a href="aplikace3.html#cb252-1599" tabindex="-1"></a>    </span>
<span id="cb252-1600"><a href="aplikace3.html#cb252-1600" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb252-1601"><a href="aplikace3.html#cb252-1601" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb252-1602"><a href="aplikace3.html#cb252-1602" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb252-1603"><a href="aplikace3.html#cb252-1603" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-1604"><a href="aplikace3.html#cb252-1604" tabindex="-1"></a>      </span>
<span id="cb252-1605"><a href="aplikace3.html#cb252-1605" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb252-1606"><a href="aplikace3.html#cb252-1606" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb252-1607"><a href="aplikace3.html#cb252-1607" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb252-1608"><a href="aplikace3.html#cb252-1608" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-1609"><a href="aplikace3.html#cb252-1609" tabindex="-1"></a>    </span>
<span id="cb252-1610"><a href="aplikace3.html#cb252-1610" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb252-1611"><a href="aplikace3.html#cb252-1611" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb252-1612"><a href="aplikace3.html#cb252-1612" tabindex="-1"></a>  }</span>
<span id="cb252-1613"><a href="aplikace3.html#cb252-1613" tabindex="-1"></a>  </span>
<span id="cb252-1614"><a href="aplikace3.html#cb252-1614" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb252-1615"><a href="aplikace3.html#cb252-1615" tabindex="-1"></a>  </span>
<span id="cb252-1616"><a href="aplikace3.html#cb252-1616" tabindex="-1"></a>  <span class="do">### Linearni jadro</span></span>
<span id="cb252-1617"><a href="aplikace3.html#cb252-1617" tabindex="-1"></a>  </span>
<span id="cb252-1618"><a href="aplikace3.html#cb252-1618" tabindex="-1"></a>  <span class="co"># jadro a jadrova matice ... polynomialni s parametrem p</span></span>
<span id="cb252-1619"><a href="aplikace3.html#cb252-1619" tabindex="-1"></a>  Linear.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb252-1620"><a href="aplikace3.html#cb252-1620" tabindex="-1"></a>    <span class="fu">return</span>(x <span class="sc">*</span> y)</span>
<span id="cb252-1621"><a href="aplikace3.html#cb252-1621" tabindex="-1"></a>  }</span>
<span id="cb252-1622"><a href="aplikace3.html#cb252-1622" tabindex="-1"></a>  </span>
<span id="cb252-1623"><a href="aplikace3.html#cb252-1623" tabindex="-1"></a>  Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb252-1624"><a href="aplikace3.html#cb252-1624" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb252-1625"><a href="aplikace3.html#cb252-1625" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb252-1626"><a href="aplikace3.html#cb252-1626" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb252-1627"><a href="aplikace3.html#cb252-1627" tabindex="-1"></a>        K[i, j] <span class="ot">&lt;-</span> <span class="fu">Linear.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j])</span>
<span id="cb252-1628"><a href="aplikace3.html#cb252-1628" tabindex="-1"></a>      }</span>
<span id="cb252-1629"><a href="aplikace3.html#cb252-1629" tabindex="-1"></a>    }</span>
<span id="cb252-1630"><a href="aplikace3.html#cb252-1630" tabindex="-1"></a>    <span class="fu">return</span>(K)</span>
<span id="cb252-1631"><a href="aplikace3.html#cb252-1631" tabindex="-1"></a>  }</span>
<span id="cb252-1632"><a href="aplikace3.html#cb252-1632" tabindex="-1"></a>  </span>
<span id="cb252-1633"><a href="aplikace3.html#cb252-1633" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb252-1634"><a href="aplikace3.html#cb252-1634" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb252-1635"><a href="aplikace3.html#cb252-1635" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb252-1636"><a href="aplikace3.html#cb252-1636" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb252-1637"><a href="aplikace3.html#cb252-1637" tabindex="-1"></a>  </span>
<span id="cb252-1638"><a href="aplikace3.html#cb252-1638" tabindex="-1"></a>  <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb252-1639"><a href="aplikace3.html#cb252-1639" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">2</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb252-1640"><a href="aplikace3.html#cb252-1640" tabindex="-1"></a>  </span>
<span id="cb252-1641"><a href="aplikace3.html#cb252-1641" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb252-1642"><a href="aplikace3.html#cb252-1642" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb252-1643"><a href="aplikace3.html#cb252-1643" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane d</span></span>
<span id="cb252-1644"><a href="aplikace3.html#cb252-1644" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro vrstvy odpovidaji folds</span></span>
<span id="cb252-1645"><a href="aplikace3.html#cb252-1645" tabindex="-1"></a>  dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb252-1646"><a href="aplikace3.html#cb252-1646" tabindex="-1"></a>                    <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb252-1647"><a href="aplikace3.html#cb252-1647" tabindex="-1"></a>  </span>
<span id="cb252-1648"><a href="aplikace3.html#cb252-1648" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb252-1649"><a href="aplikace3.html#cb252-1649" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb252-1650"><a href="aplikace3.html#cb252-1650" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb252-1651"><a href="aplikace3.html#cb252-1651" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb252-1652"><a href="aplikace3.html#cb252-1652" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb252-1653"><a href="aplikace3.html#cb252-1653" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb252-1654"><a href="aplikace3.html#cb252-1654" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names))</span>
<span id="cb252-1655"><a href="aplikace3.html#cb252-1655" tabindex="-1"></a>  </span>
<span id="cb252-1656"><a href="aplikace3.html#cb252-1656" tabindex="-1"></a>  <span class="co"># samotna CV</span></span>
<span id="cb252-1657"><a href="aplikace3.html#cb252-1657" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb252-1658"><a href="aplikace3.html#cb252-1658" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb252-1659"><a href="aplikace3.html#cb252-1659" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb252-1660"><a href="aplikace3.html#cb252-1660" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb252-1661"><a href="aplikace3.html#cb252-1661" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb252-1662"><a href="aplikace3.html#cb252-1662" tabindex="-1"></a>  </span>
<span id="cb252-1663"><a href="aplikace3.html#cb252-1663" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb252-1664"><a href="aplikace3.html#cb252-1664" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb252-1665"><a href="aplikace3.html#cb252-1665" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb252-1666"><a href="aplikace3.html#cb252-1666" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb252-1667"><a href="aplikace3.html#cb252-1667" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb252-1668"><a href="aplikace3.html#cb252-1668" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb252-1669"><a href="aplikace3.html#cb252-1669" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb252-1670"><a href="aplikace3.html#cb252-1670" tabindex="-1"></a>                    <span class="at">cost =</span> C,</span>
<span id="cb252-1671"><a href="aplikace3.html#cb252-1671" tabindex="-1"></a>                    <span class="at">epsilon =</span> eps)</span>
<span id="cb252-1672"><a href="aplikace3.html#cb252-1672" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb252-1673"><a href="aplikace3.html#cb252-1673" tabindex="-1"></a>  }</span>
<span id="cb252-1674"><a href="aplikace3.html#cb252-1674" tabindex="-1"></a>  </span>
<span id="cb252-1675"><a href="aplikace3.html#cb252-1675" tabindex="-1"></a>  <span class="co"># projdeme dimenze</span></span>
<span id="cb252-1676"><a href="aplikace3.html#cb252-1676" tabindex="-1"></a>  <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb252-1677"><a href="aplikace3.html#cb252-1677" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb252-1678"><a href="aplikace3.html#cb252-1678" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb252-1679"><a href="aplikace3.html#cb252-1679" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb252-1680"><a href="aplikace3.html#cb252-1680" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb252-1681"><a href="aplikace3.html#cb252-1681" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb252-1682"><a href="aplikace3.html#cb252-1682" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb252-1683"><a href="aplikace3.html#cb252-1683" tabindex="-1"></a>                             alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb252-1684"><a href="aplikace3.html#cb252-1684" tabindex="-1"></a>    }</span>
<span id="cb252-1685"><a href="aplikace3.html#cb252-1685" tabindex="-1"></a>    <span class="co"># projdeme folds</span></span>
<span id="cb252-1686"><a href="aplikace3.html#cb252-1686" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb252-1687"><a href="aplikace3.html#cb252-1687" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb252-1688"><a href="aplikace3.html#cb252-1688" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb252-1689"><a href="aplikace3.html#cb252-1689" tabindex="-1"></a>      <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb252-1690"><a href="aplikace3.html#cb252-1690" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb252-1691"><a href="aplikace3.html#cb252-1691" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb252-1692"><a href="aplikace3.html#cb252-1692" tabindex="-1"></a>      <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb252-1693"><a href="aplikace3.html#cb252-1693" tabindex="-1"></a>      Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb252-1694"><a href="aplikace3.html#cb252-1694" tabindex="-1"></a>                                  <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb252-1695"><a href="aplikace3.html#cb252-1695" tabindex="-1"></a>                                  <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb252-1696"><a href="aplikace3.html#cb252-1696" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb252-1697"><a href="aplikace3.html#cb252-1697" tabindex="-1"></a>      <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb252-1698"><a href="aplikace3.html#cb252-1698" tabindex="-1"></a>      <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb252-1699"><a href="aplikace3.html#cb252-1699" tabindex="-1"></a>        kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb252-1700"><a href="aplikace3.html#cb252-1700" tabindex="-1"></a>      </span>
<span id="cb252-1701"><a href="aplikace3.html#cb252-1701" tabindex="-1"></a>        data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb252-1702"><a href="aplikace3.html#cb252-1702" tabindex="-1"></a>        data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb252-1703"><a href="aplikace3.html#cb252-1703" tabindex="-1"></a>        </span>
<span id="cb252-1704"><a href="aplikace3.html#cb252-1704" tabindex="-1"></a>        data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb252-1705"><a href="aplikace3.html#cb252-1705" tabindex="-1"></a>        data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb252-1706"><a href="aplikace3.html#cb252-1706" tabindex="-1"></a>        </span>
<span id="cb252-1707"><a href="aplikace3.html#cb252-1707" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb252-1708"><a href="aplikace3.html#cb252-1708" tabindex="-1"></a>        clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb252-1709"><a href="aplikace3.html#cb252-1709" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb252-1710"><a href="aplikace3.html#cb252-1710" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-1711"><a href="aplikace3.html#cb252-1711" tabindex="-1"></a>                            <span class="at">cost =</span> C,</span>
<span id="cb252-1712"><a href="aplikace3.html#cb252-1712" tabindex="-1"></a>                            <span class="at">coef0 =</span> coef0,</span>
<span id="cb252-1713"><a href="aplikace3.html#cb252-1713" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb252-1714"><a href="aplikace3.html#cb252-1714" tabindex="-1"></a>        </span>
<span id="cb252-1715"><a href="aplikace3.html#cb252-1715" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb252-1716"><a href="aplikace3.html#cb252-1716" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb252-1717"><a href="aplikace3.html#cb252-1717" tabindex="-1"></a>        presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb252-1718"><a href="aplikace3.html#cb252-1718" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-1719"><a href="aplikace3.html#cb252-1719" tabindex="-1"></a>        </span>
<span id="cb252-1720"><a href="aplikace3.html#cb252-1720" tabindex="-1"></a>        <span class="co"># ulozeni vysledku</span></span>
<span id="cb252-1721"><a href="aplikace3.html#cb252-1721" tabindex="-1"></a>        Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb252-1722"><a href="aplikace3.html#cb252-1722" tabindex="-1"></a>      }</span>
<span id="cb252-1723"><a href="aplikace3.html#cb252-1723" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb252-1724"><a href="aplikace3.html#cb252-1724" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb252-1725"><a href="aplikace3.html#cb252-1725" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb252-1726"><a href="aplikace3.html#cb252-1726" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb252-1727"><a href="aplikace3.html#cb252-1727" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb252-1728"><a href="aplikace3.html#cb252-1728" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb252-1729"><a href="aplikace3.html#cb252-1729" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb252-1730"><a href="aplikace3.html#cb252-1730" tabindex="-1"></a>    }</span>
<span id="cb252-1731"><a href="aplikace3.html#cb252-1731" tabindex="-1"></a>  }</span>
<span id="cb252-1732"><a href="aplikace3.html#cb252-1732" tabindex="-1"></a>  </span>
<span id="cb252-1733"><a href="aplikace3.html#cb252-1733" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb252-1734"><a href="aplikace3.html#cb252-1734" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb252-1735"><a href="aplikace3.html#cb252-1735" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb252-1736"><a href="aplikace3.html#cb252-1736" tabindex="-1"></a>  }</span>
<span id="cb252-1737"><a href="aplikace3.html#cb252-1737" tabindex="-1"></a>  </span>
<span id="cb252-1738"><a href="aplikace3.html#cb252-1738" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb252-1739"><a href="aplikace3.html#cb252-1739" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb252-1740"><a href="aplikace3.html#cb252-1740" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb252-1741"><a href="aplikace3.html#cb252-1741" tabindex="-1"></a>  d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb252-1742"><a href="aplikace3.html#cb252-1742" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb252-1743"><a href="aplikace3.html#cb252-1743" tabindex="-1"></a>  </span>
<span id="cb252-1744"><a href="aplikace3.html#cb252-1744" tabindex="-1"></a>  err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb252-1745"><a href="aplikace3.html#cb252-1745" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb252-1746"><a href="aplikace3.html#cb252-1746" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb252-1747"><a href="aplikace3.html#cb252-1747" tabindex="-1"></a>  df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb252-1748"><a href="aplikace3.html#cb252-1748" tabindex="-1"></a>             <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb252-1749"><a href="aplikace3.html#cb252-1749" tabindex="-1"></a>             <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb252-1750"><a href="aplikace3.html#cb252-1750" tabindex="-1"></a>  </span>
<span id="cb252-1751"><a href="aplikace3.html#cb252-1751" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">19</span><span class="sc">:</span><span class="dv">21</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb252-1752"><a href="aplikace3.html#cb252-1752" tabindex="-1"></a>  </span>
<span id="cb252-1753"><a href="aplikace3.html#cb252-1753" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb252-1754"><a href="aplikace3.html#cb252-1754" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb252-1755"><a href="aplikace3.html#cb252-1755" tabindex="-1"></a>  <span class="co"># pridame i testovaci data</span></span>
<span id="cb252-1756"><a href="aplikace3.html#cb252-1756" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb252-1757"><a href="aplikace3.html#cb252-1757" tabindex="-1"></a>  </span>
<span id="cb252-1758"><a href="aplikace3.html#cb252-1758" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb252-1759"><a href="aplikace3.html#cb252-1759" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - linear&#39;</span>, </span>
<span id="cb252-1760"><a href="aplikace3.html#cb252-1760" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - RKHS - linear&#39;</span>, </span>
<span id="cb252-1761"><a href="aplikace3.html#cb252-1761" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - RKHS - linear&#39;</span>), </span>
<span id="cb252-1762"><a href="aplikace3.html#cb252-1762" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb252-1763"><a href="aplikace3.html#cb252-1763" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb252-1764"><a href="aplikace3.html#cb252-1764" tabindex="-1"></a>  </span>
<span id="cb252-1765"><a href="aplikace3.html#cb252-1765" tabindex="-1"></a>  <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb252-1766"><a href="aplikace3.html#cb252-1766" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb252-1767"><a href="aplikace3.html#cb252-1767" tabindex="-1"></a>    <span class="co"># spocitame matici K</span></span>
<span id="cb252-1768"><a href="aplikace3.html#cb252-1768" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb252-1769"><a href="aplikace3.html#cb252-1769" tabindex="-1"></a>    </span>
<span id="cb252-1770"><a href="aplikace3.html#cb252-1770" tabindex="-1"></a>    <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb252-1771"><a href="aplikace3.html#cb252-1771" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb252-1772"><a href="aplikace3.html#cb252-1772" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb252-1773"><a href="aplikace3.html#cb252-1773" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb252-1774"><a href="aplikace3.html#cb252-1774" tabindex="-1"></a>    <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb252-1775"><a href="aplikace3.html#cb252-1775" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb252-1776"><a href="aplikace3.html#cb252-1776" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb252-1777"><a href="aplikace3.html#cb252-1777" tabindex="-1"></a>    </span>
<span id="cb252-1778"><a href="aplikace3.html#cb252-1778" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb252-1779"><a href="aplikace3.html#cb252-1779" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb252-1780"><a href="aplikace3.html#cb252-1780" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb252-1781"><a href="aplikace3.html#cb252-1781" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb252-1782"><a href="aplikace3.html#cb252-1782" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb252-1783"><a href="aplikace3.html#cb252-1783" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb252-1784"><a href="aplikace3.html#cb252-1784" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb252-1785"><a href="aplikace3.html#cb252-1785" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb252-1786"><a href="aplikace3.html#cb252-1786" tabindex="-1"></a>                      <span class="at">epsilon =</span> eps)</span>
<span id="cb252-1787"><a href="aplikace3.html#cb252-1787" tabindex="-1"></a>      <span class="co"># urceni alpha</span></span>
<span id="cb252-1788"><a href="aplikace3.html#cb252-1788" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb252-1789"><a href="aplikace3.html#cb252-1789" tabindex="-1"></a>    }</span>
<span id="cb252-1790"><a href="aplikace3.html#cb252-1790" tabindex="-1"></a>    <span class="co"># d</span></span>
<span id="cb252-1791"><a href="aplikace3.html#cb252-1791" tabindex="-1"></a>    d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb252-1792"><a href="aplikace3.html#cb252-1792" tabindex="-1"></a>    </span>
<span id="cb252-1793"><a href="aplikace3.html#cb252-1793" tabindex="-1"></a>    <span class="co"># urceni vektoru lambda</span></span>
<span id="cb252-1794"><a href="aplikace3.html#cb252-1794" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb252-1795"><a href="aplikace3.html#cb252-1795" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb252-1796"><a href="aplikace3.html#cb252-1796" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb252-1797"><a href="aplikace3.html#cb252-1797" tabindex="-1"></a>    </span>
<span id="cb252-1798"><a href="aplikace3.html#cb252-1798" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb252-1799"><a href="aplikace3.html#cb252-1799" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb252-1800"><a href="aplikace3.html#cb252-1800" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb252-1801"><a href="aplikace3.html#cb252-1801" tabindex="-1"></a>    }</span>
<span id="cb252-1802"><a href="aplikace3.html#cb252-1802" tabindex="-1"></a>    </span>
<span id="cb252-1803"><a href="aplikace3.html#cb252-1803" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb252-1804"><a href="aplikace3.html#cb252-1804" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb252-1805"><a href="aplikace3.html#cb252-1805" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb252-1806"><a href="aplikace3.html#cb252-1806" tabindex="-1"></a>  </span>
<span id="cb252-1807"><a href="aplikace3.html#cb252-1807" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb252-1808"><a href="aplikace3.html#cb252-1808" tabindex="-1"></a>  </span>
<span id="cb252-1809"><a href="aplikace3.html#cb252-1809" tabindex="-1"></a>    data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb252-1810"><a href="aplikace3.html#cb252-1810" tabindex="-1"></a>    data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb252-1811"><a href="aplikace3.html#cb252-1811" tabindex="-1"></a>    </span>
<span id="cb252-1812"><a href="aplikace3.html#cb252-1812" tabindex="-1"></a>    data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb252-1813"><a href="aplikace3.html#cb252-1813" tabindex="-1"></a>    data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb252-1814"><a href="aplikace3.html#cb252-1814" tabindex="-1"></a>    </span>
<span id="cb252-1815"><a href="aplikace3.html#cb252-1815" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb252-1816"><a href="aplikace3.html#cb252-1816" tabindex="-1"></a>    clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb252-1817"><a href="aplikace3.html#cb252-1817" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb252-1818"><a href="aplikace3.html#cb252-1818" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-1819"><a href="aplikace3.html#cb252-1819" tabindex="-1"></a>                        <span class="at">cost =</span> C,</span>
<span id="cb252-1820"><a href="aplikace3.html#cb252-1820" tabindex="-1"></a>                        <span class="at">coef0 =</span> coef0,</span>
<span id="cb252-1821"><a href="aplikace3.html#cb252-1821" tabindex="-1"></a>                        <span class="at">kernel =</span> kernel_type)</span>
<span id="cb252-1822"><a href="aplikace3.html#cb252-1822" tabindex="-1"></a>    </span>
<span id="cb252-1823"><a href="aplikace3.html#cb252-1823" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb252-1824"><a href="aplikace3.html#cb252-1824" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb252-1825"><a href="aplikace3.html#cb252-1825" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb252-1826"><a href="aplikace3.html#cb252-1826" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-1827"><a href="aplikace3.html#cb252-1827" tabindex="-1"></a>      </span>
<span id="cb252-1828"><a href="aplikace3.html#cb252-1828" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb252-1829"><a href="aplikace3.html#cb252-1829" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb252-1830"><a href="aplikace3.html#cb252-1830" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb252-1831"><a href="aplikace3.html#cb252-1831" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-1832"><a href="aplikace3.html#cb252-1832" tabindex="-1"></a>    </span>
<span id="cb252-1833"><a href="aplikace3.html#cb252-1833" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb252-1834"><a href="aplikace3.html#cb252-1834" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb252-1835"><a href="aplikace3.html#cb252-1835" tabindex="-1"></a>  }</span>
<span id="cb252-1836"><a href="aplikace3.html#cb252-1836" tabindex="-1"></a>  </span>
<span id="cb252-1837"><a href="aplikace3.html#cb252-1837" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb252-1838"><a href="aplikace3.html#cb252-1838" tabindex="-1"></a>  </span>
<span id="cb252-1839"><a href="aplikace3.html#cb252-1839" tabindex="-1"></a>  <span class="do">## pridame vysledky do objektu SIMULACE</span></span>
<span id="cb252-1840"><a href="aplikace3.html#cb252-1840" tabindex="-1"></a>  </span>
<span id="cb252-1841"><a href="aplikace3.html#cb252-1841" tabindex="-1"></a>  SIMULACE<span class="sc">$</span>train[sim, ] <span class="ot">&lt;-</span> RESULTS<span class="sc">$</span>Err.train</span>
<span id="cb252-1842"><a href="aplikace3.html#cb252-1842" tabindex="-1"></a>  SIMULACE<span class="sc">$</span>test[sim, ] <span class="ot">&lt;-</span> RESULTS<span class="sc">$</span>Err.test</span>
<span id="cb252-1843"><a href="aplikace3.html#cb252-1843" tabindex="-1"></a>  </span>
<span id="cb252-1844"><a href="aplikace3.html#cb252-1844" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;</span><span class="sc">\r</span><span class="st">&#39;</span>, sim)</span>
<span id="cb252-1845"><a href="aplikace3.html#cb252-1845" tabindex="-1"></a>}</span>
<span id="cb252-1846"><a href="aplikace3.html#cb252-1846" tabindex="-1"></a></span>
<span id="cb252-1847"><a href="aplikace3.html#cb252-1847" tabindex="-1"></a><span class="co"># ulozime vysledne hodnoty </span></span>
<span id="cb252-1848"><a href="aplikace3.html#cb252-1848" tabindex="-1"></a><span class="fu">save</span>(SIMULACE, CV_RESULTS, <span class="at">file =</span> <span class="st">&#39;RData/aplikace_03der.RData&#39;</span>)</span></code></pre></div>
</details>
<p>Nyní spočítáme průměrné testovací a trénovací chybovosti pro jednotlivé klasifikační metody.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="aplikace3.html#cb253-1" tabindex="-1"></a><span class="co"># dame do vysledne tabulky</span></span>
<span id="cb253-2"><a href="aplikace3.html#cb253-2" tabindex="-1"></a></span>
<span id="cb253-3"><a href="aplikace3.html#cb253-3" tabindex="-1"></a>SIMULACE.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Err.train =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>train, <span class="dv">2</span>, mean),</span>
<span id="cb253-4"><a href="aplikace3.html#cb253-4" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>test, <span class="dv">2</span>, mean),</span>
<span id="cb253-5"><a href="aplikace3.html#cb253-5" tabindex="-1"></a>                          <span class="at">SD.train =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>train, <span class="dv">2</span>, sd),</span>
<span id="cb253-6"><a href="aplikace3.html#cb253-6" tabindex="-1"></a>                          <span class="at">SD.test =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>test, <span class="dv">2</span>, sd))</span>
<span id="cb253-7"><a href="aplikace3.html#cb253-7" tabindex="-1"></a></span>
<span id="cb253-8"><a href="aplikace3.html#cb253-8" tabindex="-1"></a><span class="co"># ulozime vysledne hodnoty </span></span>
<span id="cb253-9"><a href="aplikace3.html#cb253-9" tabindex="-1"></a><span class="fu">save</span>(SIMULACE.df, <span class="at">file =</span> <span class="st">&#39;RData/aplikace_03der_res.RData&#39;</span>)</span></code></pre></div>
</details>
<div id="výsledky-7" class="section level4 hasAnchor" number="12.7.2.1">
<h4><span class="header-section-number">12.7.2.1</span> Výsledky<a href="aplikace3.html#výsledky-7" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<table>
<caption><span id="tab:unnamed-chunk-251">Tabulka 12.19: </span>Souhrnné výsledky použitých metod na simulovaných datech. <span class="math inline">\(\widehat{Err}_{train}\)</span> značí odhad trénovací chybovosti, <span class="math inline">\(\widehat{Err}_{test}\)</span> testovací chybovosti, <span class="math inline">\(\widehat{SD}_{train}\)</span> odhad směrodatné odchylky trénovacích chybovostí a <span class="math inline">\(\widehat{SD}_{test}\)</span> je odhad směrodatné odchylky testovacích chybovostí.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{train}\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{test}\)</span></th>
<th align="right"><span class="math inline">\(\widehat{SD}_{train}\)</span></th>
<th align="right"><span class="math inline">\(\widehat{SD}_{test}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>KNN</td>
<td align="right">0.0147</td>
<td align="right">0.0212</td>
<td align="right">0.0066</td>
<td align="right">0.0170</td>
</tr>
<tr class="even">
<td>LDA</td>
<td align="right">0.0558</td>
<td align="right">0.0626</td>
<td align="right">0.0089</td>
<td align="right">0.0287</td>
</tr>
<tr class="odd">
<td>QDA</td>
<td align="right">0.0105</td>
<td align="right">0.0145</td>
<td align="right">0.0064</td>
<td align="right">0.0129</td>
</tr>
<tr class="even">
<td>LR_functional</td>
<td align="right">0.0009</td>
<td align="right">0.0405</td>
<td align="right">0.0032</td>
<td align="right">0.0327</td>
</tr>
<tr class="odd">
<td>LR_score</td>
<td align="right">0.0081</td>
<td align="right">0.0145</td>
<td align="right">0.0059</td>
<td align="right">0.0157</td>
</tr>
<tr class="even">
<td>Tree_discr</td>
<td align="right">0.0109</td>
<td align="right">0.0263</td>
<td align="right">0.0454</td>
<td align="right">0.0603</td>
</tr>
<tr class="odd">
<td>Tree_score</td>
<td align="right">0.0171</td>
<td align="right">0.0229</td>
<td align="right">0.0063</td>
<td align="right">0.0176</td>
</tr>
<tr class="even">
<td>Tree_Bbasis</td>
<td align="right">0.0107</td>
<td align="right">0.0251</td>
<td align="right">0.0455</td>
<td align="right">0.0595</td>
</tr>
<tr class="odd">
<td>RF_discr</td>
<td align="right">0.0003</td>
<td align="right">0.0117</td>
<td align="right">0.0015</td>
<td align="right">0.0122</td>
</tr>
<tr class="even">
<td>RF_score</td>
<td align="right">0.0057</td>
<td align="right">0.0168</td>
<td align="right">0.0032</td>
<td align="right">0.0164</td>
</tr>
<tr class="odd">
<td>RF_Bbasis</td>
<td align="right">0.0001</td>
<td align="right">0.0089</td>
<td align="right">0.0007</td>
<td align="right">0.0103</td>
</tr>
<tr class="even">
<td>SVM linear - diskr</td>
<td align="right">0.0033</td>
<td align="right">0.0091</td>
<td align="right">0.0052</td>
<td align="right">0.0137</td>
</tr>
<tr class="odd">
<td>SVM poly - diskr</td>
<td align="right">0.0013</td>
<td align="right">0.0152</td>
<td align="right">0.0032</td>
<td align="right">0.0164</td>
</tr>
<tr class="even">
<td>SVM rbf - diskr</td>
<td align="right">0.0025</td>
<td align="right">0.0148</td>
<td align="right">0.0040</td>
<td align="right">0.0135</td>
</tr>
<tr class="odd">
<td>SVM linear - PCA</td>
<td align="right">0.0097</td>
<td align="right">0.0197</td>
<td align="right">0.0062</td>
<td align="right">0.0203</td>
</tr>
<tr class="even">
<td>SVM poly - PCA</td>
<td align="right">0.0080</td>
<td align="right">0.0174</td>
<td align="right">0.0060</td>
<td align="right">0.0167</td>
</tr>
<tr class="odd">
<td>SVM rbf - PCA</td>
<td align="right">0.0073</td>
<td align="right">0.0174</td>
<td align="right">0.0058</td>
<td align="right">0.0144</td>
</tr>
<tr class="even">
<td>SVM linear - Bbasis</td>
<td align="right">0.0033</td>
<td align="right">0.0249</td>
<td align="right">0.0065</td>
<td align="right">0.0216</td>
</tr>
<tr class="odd">
<td>SVM poly - Bbasis</td>
<td align="right">0.0031</td>
<td align="right">0.0234</td>
<td align="right">0.0044</td>
<td align="right">0.0174</td>
</tr>
<tr class="even">
<td>SVM rbf - Bbasis</td>
<td align="right">0.0033</td>
<td align="right">0.0220</td>
<td align="right">0.0068</td>
<td align="right">0.0197</td>
</tr>
<tr class="odd">
<td>SVM linear - projection</td>
<td align="right">0.0297</td>
<td align="right">0.0449</td>
<td align="right">0.0086</td>
<td align="right">0.0274</td>
</tr>
<tr class="even">
<td>SVM poly - projection</td>
<td align="right">0.0339</td>
<td align="right">0.0560</td>
<td align="right">0.0142</td>
<td align="right">0.0393</td>
</tr>
<tr class="odd">
<td>SVM rbf - projection</td>
<td align="right">0.1454</td>
<td align="right">0.1954</td>
<td align="right">0.0306</td>
<td align="right">0.0605</td>
</tr>
<tr class="even">
<td>SVM linear - RKHS - radial</td>
<td align="right">0.0007</td>
<td align="right">0.0238</td>
<td align="right">0.0020</td>
<td align="right">0.0152</td>
</tr>
<tr class="odd">
<td>SVM poly - RKHS - radial</td>
<td align="right">0.0024</td>
<td align="right">0.0238</td>
<td align="right">0.0037</td>
<td align="right">0.0170</td>
</tr>
<tr class="even">
<td>SVM rbf - RKHS - radial</td>
<td align="right">0.0038</td>
<td align="right">0.0203</td>
<td align="right">0.0046</td>
<td align="right">0.0148</td>
</tr>
<tr class="odd">
<td>SVM linear - RKHS - poly</td>
<td align="right">0.0142</td>
<td align="right">0.0386</td>
<td align="right">0.0071</td>
<td align="right">0.0215</td>
</tr>
<tr class="even">
<td>SVM poly - RKHS - poly</td>
<td align="right">0.0070</td>
<td align="right">0.0488</td>
<td align="right">0.0094</td>
<td align="right">0.0254</td>
</tr>
<tr class="odd">
<td>SVM rbf - RKHS - poly</td>
<td align="right">0.0127</td>
<td align="right">0.0535</td>
<td align="right">0.0102</td>
<td align="right">0.0232</td>
</tr>
<tr class="even">
<td>SVM linear - RKHS - linear</td>
<td align="right">0.0063</td>
<td align="right">0.0442</td>
<td align="right">0.0089</td>
<td align="right">0.0219</td>
</tr>
<tr class="odd">
<td>SVM poly - RKHS - linear</td>
<td align="right">0.0035</td>
<td align="right">0.0397</td>
<td align="right">0.0058</td>
<td align="right">0.0250</td>
</tr>
<tr class="even">
<td>SVM rbf - RKHS - linear</td>
<td align="right">0.0061</td>
<td align="right">0.0426</td>
<td align="right">0.0075</td>
<td align="right">0.0233</td>
</tr>
</tbody>
</table>
<p>V tabulce výše jsou uvedeny všechny vypočtené charakteristiky.
Jsou zde uvedeny také směrodatné odchylky, abychom mohli porovnat jakousi stálost či míru variability jednotlivých metod.</p>
<p>Můžeme také formálně otestovat, zda jsou některé metody úspěšnější než jiné. Vzhledem k nesplnění předpokladu normality nemůžeme použít klasický párový t-test. Využijeme jeho neparametrickou alternativu - Wilcoxonův test.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="aplikace3.html#cb254-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;RF_Bbasis&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;RF_discr&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;less&#39;</span>, <span class="at">paired =</span> T)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 0.0005059073</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="aplikace3.html#cb256-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;RF_Bbasis&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM linear - diskr&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;t&#39;</span>, <span class="at">paired =</span> T)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 0.8449667</code></pre>
<p>Nakonec ještě můžeme graficky zobrazit vypočtené hodnoty ze simulace pro jednotlivé klasifikační metody pomocí krabicových diagramů, zvlášť pro testovací a trénovací chybovosti.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="aplikace3.html#cb258-1" tabindex="-1"></a><span class="co"># pro trenovaci data</span></span>
<span id="cb258-2"><a href="aplikace3.html#cb258-2" tabindex="-1"></a>SIMULACE<span class="sc">$</span>train <span class="sc">|&gt;</span> </span>
<span id="cb258-3"><a href="aplikace3.html#cb258-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> methods, <span class="at">names_to =</span> <span class="st">&#39;method&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb258-4"><a href="aplikace3.html#cb258-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb258-5"><a href="aplikace3.html#cb258-5" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb258-6"><a href="aplikace3.html#cb258-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> Err, <span class="at">fill =</span> method, <span class="at">colour =</span> method, <span class="at">alpha =</span> <span class="fl">0.3</span>)) <span class="sc">+</span> </span>
<span id="cb258-7"><a href="aplikace3.html#cb258-7" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">&quot;white&quot;</span>, <span class="at">outlier.shape =</span> <span class="dv">16</span>, <span class="at">outlier.size =</span> <span class="dv">0</span>, </span>
<span id="cb258-8"><a href="aplikace3.html#cb258-8" tabindex="-1"></a>               <span class="at">notch =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb258-9"><a href="aplikace3.html#cb258-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb258-10"><a href="aplikace3.html#cb258-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Klasifikační metoda&#39;</span>,</span>
<span id="cb258-11"><a href="aplikace3.html#cb258-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(Err)[train])) <span class="sc">+</span> </span>
<span id="cb258-12"><a href="aplikace3.html#cb258-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb258-13"><a href="aplikace3.html#cb258-13" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">40</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb258-14"><a href="aplikace3.html#cb258-14" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.15</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb258-15"><a href="aplikace3.html#cb258-15" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb258-16"><a href="aplikace3.html#cb258-16" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">shape =</span> <span class="st">&#39;+&#39;</span>,</span>
<span id="cb258-17"><a href="aplikace3.html#cb258-17" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>)<span class="sc">+</span> </span>
<span id="cb258-18"><a href="aplikace3.html#cb258-18" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">min</span>(SIMULACE.df<span class="sc">$</span>Err.train), </span>
<span id="cb258-19"><a href="aplikace3.html#cb258-19" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-253"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-253-1.png" alt="Krabicové diagramy trénovacích chybovostí pro 100 simulací zvlášť pro jednotlivé klasifikační metody. Černými symboly $+$ jsou vyznačeny průměry." width="672" />
<p class="caption">
Obrázek 12.48: Krabicové diagramy trénovacích chybovostí pro 100 simulací zvlášť pro jednotlivé klasifikační metody. Černými symboly <span class="math inline">\(+\)</span> jsou vyznačeny průměry.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="aplikace3.html#cb259-1" tabindex="-1"></a><span class="co"># pro testovaci data</span></span>
<span id="cb259-2"><a href="aplikace3.html#cb259-2" tabindex="-1"></a>SIMULACE<span class="sc">$</span>test <span class="sc">|&gt;</span> </span>
<span id="cb259-3"><a href="aplikace3.html#cb259-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> methods, <span class="at">names_to =</span> <span class="st">&#39;method&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb259-4"><a href="aplikace3.html#cb259-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb259-5"><a href="aplikace3.html#cb259-5" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb259-6"><a href="aplikace3.html#cb259-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> Err, <span class="at">fill =</span> method, <span class="at">colour =</span> method, <span class="at">alpha =</span> method)) <span class="sc">+</span></span>
<span id="cb259-7"><a href="aplikace3.html#cb259-7" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">&quot;white&quot;</span>, <span class="at">outlier.shape =</span> <span class="dv">16</span>, <span class="at">outlier.size =</span> <span class="dv">0</span>, </span>
<span id="cb259-8"><a href="aplikace3.html#cb259-8" tabindex="-1"></a>               <span class="at">notch =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb259-9"><a href="aplikace3.html#cb259-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb259-10"><a href="aplikace3.html#cb259-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Klasifikační metoda&#39;</span>,</span>
<span id="cb259-11"><a href="aplikace3.html#cb259-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;$</span><span class="sc">\\</span><span class="st">widehat{</span><span class="sc">\\</span><span class="st">textnormal{Err}}_{test}$&quot;</span></span>
<span id="cb259-12"><a href="aplikace3.html#cb259-12" tabindex="-1"></a>       <span class="co"># y = expression(widehat(Err)[train])</span></span>
<span id="cb259-13"><a href="aplikace3.html#cb259-13" tabindex="-1"></a>       ) <span class="sc">+</span> </span>
<span id="cb259-14"><a href="aplikace3.html#cb259-14" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb259-15"><a href="aplikace3.html#cb259-15" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">50</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb259-16"><a href="aplikace3.html#cb259-16" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.15</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="fl">0.9</span>, <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb259-17"><a href="aplikace3.html#cb259-17" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb259-18"><a href="aplikace3.html#cb259-18" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">shape =</span> <span class="st">&#39;+&#39;</span>,</span>
<span id="cb259-19"><a href="aplikace3.html#cb259-19" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb259-20"><a href="aplikace3.html#cb259-20" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> methods_names) <span class="sc">+</span></span>
<span id="cb259-21"><a href="aplikace3.html#cb259-21" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">2</span>), <span class="st">&quot;cm&quot;</span>)) <span class="sc">+</span></span>
<span id="cb259-22"><a href="aplikace3.html#cb259-22" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.15</span>)) <span class="sc">+</span></span>
<span id="cb259-23"><a href="aplikace3.html#cb259-23" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> box_col) <span class="sc">+</span></span>
<span id="cb259-24"><a href="aplikace3.html#cb259-24" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> box_alpha) <span class="sc">+</span> </span>
<span id="cb259-25"><a href="aplikace3.html#cb259-25" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">min</span>(SIMULACE.df<span class="sc">$</span>Err.test), </span>
<span id="cb259-26"><a href="aplikace3.html#cb259-26" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey20&#39;</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-255"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-255-1.png" alt="Krabicové diagramy testovacích chybovostí pro 100 simulací zvlášť pro jednotlivé klasifikační metody. Černými symboly $+$ jsou vyznačeny průměry." width="672" />
<p class="caption">
Obrázek 12.49: Krabicové diagramy testovacích chybovostí pro 100 simulací zvlášť pro jednotlivé klasifikační metody. Černými symboly <span class="math inline">\(+\)</span> jsou vyznačeny průměry.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="aplikace3.html#cb260-1" tabindex="-1"></a><span class="co"># ggsave(&quot;figures/kap7_tecator_box_test_der.tex&quot;, device = tikz, width = 9, height = 7)</span></span></code></pre></div>
</details>
<p>Nakonec se podívejme, jaké hodnoty hyperparametrů byly nejčastější volbou.</p>
<table>
<caption><span id="tab:unnamed-chunk-257">Tabulka 12.20: </span>Mediány hodnot hyperparametrů pro vybrané metody, u nichž se určoval nějaký hyperparametr pomocí cross-validace.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">Mediánová hodnota hyperparametru</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>KNN_K</td>
<td align="right">5.0</td>
</tr>
<tr class="even">
<td>nharm</td>
<td align="right">2.0</td>
</tr>
<tr class="odd">
<td>LR_func_n_basis</td>
<td align="right">6.0</td>
</tr>
<tr class="even">
<td>SVM_d_Linear</td>
<td align="right">6.0</td>
</tr>
<tr class="odd">
<td>SVM_d_Poly</td>
<td align="right">6.0</td>
</tr>
<tr class="even">
<td>SVM_d_Radial</td>
<td align="right">6.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_radial_gamma1</td>
<td align="right">0.5</td>
</tr>
<tr class="even">
<td>SVM_RKHS_radial_gamma2</td>
<td align="right">0.3</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_radial_gamma3</td>
<td align="right">0.3</td>
</tr>
<tr class="even">
<td>SVM_RKHS_radial_d1</td>
<td align="right">14.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_radial_d2</td>
<td align="right">12.0</td>
</tr>
<tr class="even">
<td>SVM_RKHS_radial_d3</td>
<td align="right">10.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_poly_p1</td>
<td align="right">4.0</td>
</tr>
<tr class="even">
<td>SVM_RKHS_poly_p2</td>
<td align="right">4.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_poly_p3</td>
<td align="right">4.0</td>
</tr>
<tr class="even">
<td>SVM_RKHS_poly_d1</td>
<td align="right">5.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_poly_d2</td>
<td align="right">5.5</td>
</tr>
<tr class="even">
<td>SVM_RKHS_poly_d3</td>
<td align="right">4.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_linear_d1</td>
<td align="right">21.0</td>
</tr>
<tr class="even">
<td>SVM_RKHS_linear_d2</td>
<td align="right">21.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_linear_d3</td>
<td align="right">24.0</td>
</tr>
</tbody>
</table>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="aplikace3.html#cb261-1" tabindex="-1"></a>CV_res <span class="ot">&lt;-</span> CV_RESULTS <span class="sc">|&gt;</span> </span>
<span id="cb261-2"><a href="aplikace3.html#cb261-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> CV_RESULTS <span class="sc">|&gt;</span> <span class="fu">colnames</span>(), <span class="at">names_to =</span> <span class="st">&#39;method&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;hyperparameter&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb261-3"><a href="aplikace3.html#cb261-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, </span>
<span id="cb261-4"><a href="aplikace3.html#cb261-4" tabindex="-1"></a>                         <span class="at">levels =</span> CV_RESULTS <span class="sc">|&gt;</span> <span class="fu">colnames</span>(), </span>
<span id="cb261-5"><a href="aplikace3.html#cb261-5" tabindex="-1"></a>                         <span class="at">labels =</span> CV_RESULTS <span class="sc">|&gt;</span> <span class="fu">colnames</span>(), <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb261-6"><a href="aplikace3.html#cb261-6" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() </span>
<span id="cb261-7"><a href="aplikace3.html#cb261-7" tabindex="-1"></a></span>
<span id="cb261-8"><a href="aplikace3.html#cb261-8" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb261-9"><a href="aplikace3.html#cb261-9" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;KNN_K&#39;</span>, <span class="st">&#39;nharm&#39;</span>, <span class="st">&#39;LR_func_n_basis&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb261-10"><a href="aplikace3.html#cb261-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb261-11"><a href="aplikace3.html#cb261-11" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb261-12"><a href="aplikace3.html#cb261-12" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb261-13"><a href="aplikace3.html#cb261-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb261-14"><a href="aplikace3.html#cb261-14" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>) <span class="sc">+</span></span>
<span id="cb261-15"><a href="aplikace3.html#cb261-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hodnoty hyperparametru&#39;</span>,</span>
<span id="cb261-16"><a href="aplikace3.html#cb261-16" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolutní počet&#39;</span>) <span class="sc">+</span> </span>
<span id="cb261-17"><a href="aplikace3.html#cb261-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-258"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-258-1.png" alt="Histogramy hodnot hyperparametrů pro KNN, funkcionální logistickou regresi a také histogram pro počet hlavních komponent." width="672" />
<p class="caption">
Obrázek 12.50: Histogramy hodnot hyperparametrů pro KNN, funkcionální logistickou regresi a také histogram pro počet hlavních komponent.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="aplikace3.html#cb262-1" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb262-2"><a href="aplikace3.html#cb262-2" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;SVM_d_Linear&#39;</span>, <span class="st">&#39;SVM_d_Poly&#39;</span>, <span class="st">&#39;SVM_d_Radial&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb262-3"><a href="aplikace3.html#cb262-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb262-4"><a href="aplikace3.html#cb262-4" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb262-5"><a href="aplikace3.html#cb262-5" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb262-6"><a href="aplikace3.html#cb262-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb262-7"><a href="aplikace3.html#cb262-7" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>) <span class="sc">+</span></span>
<span id="cb262-8"><a href="aplikace3.html#cb262-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hodnoty hyperparametru&#39;</span>,</span>
<span id="cb262-9"><a href="aplikace3.html#cb262-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolutní počet&#39;</span>) <span class="sc">+</span> </span>
<span id="cb262-10"><a href="aplikace3.html#cb262-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-260"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-260-1.png" alt="Histogramy hodnot hyperparametrů metody SVM s projekcí na B-splinovou bázi." width="672" />
<p class="caption">
Obrázek 12.51: Histogramy hodnot hyperparametrů metody SVM s projekcí na B-splinovou bázi.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="aplikace3.html#cb263-1" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb263-2"><a href="aplikace3.html#cb263-2" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;SVM_RKHS_radial_gamma1&#39;</span>, <span class="st">&#39;SVM_RKHS_radial_gamma2&#39;</span>,</span>
<span id="cb263-3"><a href="aplikace3.html#cb263-3" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_radial_gamma3&#39;</span>, <span class="st">&#39;SVM_RKHS_radial_d1&#39;</span>, </span>
<span id="cb263-4"><a href="aplikace3.html#cb263-4" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_radial_d2&#39;</span>, <span class="st">&#39;SVM_RKHS_radial_d3&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb263-5"><a href="aplikace3.html#cb263-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb263-6"><a href="aplikace3.html#cb263-6" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb263-7"><a href="aplikace3.html#cb263-7" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">10</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb263-8"><a href="aplikace3.html#cb263-8" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb263-9"><a href="aplikace3.html#cb263-9" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb263-10"><a href="aplikace3.html#cb263-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hodnoty hyperparametru&#39;</span>,</span>
<span id="cb263-11"><a href="aplikace3.html#cb263-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolutní počet&#39;</span>) <span class="sc">+</span> </span>
<span id="cb263-12"><a href="aplikace3.html#cb263-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-262"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-262-1.png" alt="Histogramy hodnot hyperparametrů metody RKHS + SVM s radiálním jádrem." width="672" />
<p class="caption">
Obrázek 12.52: Histogramy hodnot hyperparametrů metody RKHS + SVM s radiálním jádrem.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="aplikace3.html#cb264-1" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb264-2"><a href="aplikace3.html#cb264-2" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;SVM_RKHS_poly_p1&#39;</span>, <span class="st">&#39;SVM_RKHS_poly_p2&#39;</span>,</span>
<span id="cb264-3"><a href="aplikace3.html#cb264-3" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_poly_p3&#39;</span>, <span class="st">&#39;SVM_RKHS_poly_d1&#39;</span>,</span>
<span id="cb264-4"><a href="aplikace3.html#cb264-4" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_poly_d2&#39;</span>, <span class="st">&#39;SVM_RKHS_poly_d3&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb264-5"><a href="aplikace3.html#cb264-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb264-6"><a href="aplikace3.html#cb264-6" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb264-7"><a href="aplikace3.html#cb264-7" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb264-8"><a href="aplikace3.html#cb264-8" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb264-9"><a href="aplikace3.html#cb264-9" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb264-10"><a href="aplikace3.html#cb264-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hodnoty hyperparametru&#39;</span>,</span>
<span id="cb264-11"><a href="aplikace3.html#cb264-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolutní počet&#39;</span>) <span class="sc">+</span> </span>
<span id="cb264-12"><a href="aplikace3.html#cb264-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-264"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-264-1.png" alt="Histogramy hodnot hyperparametrů metody RKHS + SVM s polynomiálním jádrem." width="672" />
<p class="caption">
Obrázek 12.53: Histogramy hodnot hyperparametrů metody RKHS + SVM s polynomiálním jádrem.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="aplikace3.html#cb265-1" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb265-2"><a href="aplikace3.html#cb265-2" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;SVM_RKHS_linear_d1&#39;</span>,</span>
<span id="cb265-3"><a href="aplikace3.html#cb265-3" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_linear_d2&#39;</span>, <span class="st">&#39;SVM_RKHS_linear_d3&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb265-4"><a href="aplikace3.html#cb265-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb265-5"><a href="aplikace3.html#cb265-5" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb265-6"><a href="aplikace3.html#cb265-6" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb265-7"><a href="aplikace3.html#cb265-7" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb265-8"><a href="aplikace3.html#cb265-8" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb265-9"><a href="aplikace3.html#cb265-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hodnoty hyperparametru&#39;</span>,</span>
<span id="cb265-10"><a href="aplikace3.html#cb265-10" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolutní počet&#39;</span>) <span class="sc">+</span> </span>
<span id="cb265-11"><a href="aplikace3.html#cb265-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-266"></span>
<img src="12-Application_3_files/figure-html/unnamed-chunk-266-1.png" alt="Histogramy hodnot hyperparametrů metody RKHS + SVM s lineárním jádrem." width="672" />
<p class="caption">
Obrázek 12.54: Histogramy hodnot hyperparametrů metody RKHS + SVM s lineárním jádrem.
</p>
</div>

</div>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Muñoz, A.
and González, J.
(2010) <em>Representing functional data using support vector machines</em>, Pattern Recognition Letters, 31(6), pp. 511–516.
<a href="https://www.sciencedirect.com/science/article/pii/S0167865509001913">doi:10.1016/j.patrec.2009.07.014</a>.<a href="aplikace3.html#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="aplikace2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="aplikace-na-reálných-datech-4.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": null,
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/Tomas-Pompa/MastersThesis/blob/main/12-Application_3.Rmd",
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
