<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Kapitola 4 Závislost na parametru \(\sigma^2_{shift}\) | Diplomová práce</title>
  <meta name="description" content="Kapitola 4 Závislost na parametru \(\sigma^2_{shift}\) | Diplomová práce" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Kapitola 4 Závislost na parametru \(\sigma^2_{shift}\) | Diplomová práce" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Kapitola 4 Závislost na parametru \(\sigma^2_{shift}\) | Diplomová práce" />
  
  
  

<meta name="author" content="Tomáš Pompa" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="simulace2sigma.html"/>
<link rel="next" href="simulace3.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/codefolding-lua-1.1/codefolding-lua.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="sci-lg-eng-rgb.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>SVM pro funkcionální data</a></li>
<li class="part"><span><b>Simulační studie</b></span></li>
<li class="chapter" data-level="1" data-path="simulace1.html"><a href="simulace1.html"><i class="fa fa-check"></i><b>1</b> Simulace 1</a>
<ul>
<li class="chapter" data-level="1.1" data-path="simulace1.html"><a href="simulace1.html#simulace-funkcionálních-dat"><i class="fa fa-check"></i><b>1.1</b> Simulace funkcionálních dat</a></li>
<li class="chapter" data-level="1.2" data-path="simulace1.html"><a href="simulace1.html#vyhlazení-pozorovaných-křivek"><i class="fa fa-check"></i><b>1.2</b> Vyhlazení pozorovaných křivek</a></li>
<li class="chapter" data-level="1.3" data-path="simulace1.html"><a href="simulace1.html#klasifikace-křivek"><i class="fa fa-check"></i><b>1.3</b> Klasifikace křivek</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="simulace1.html"><a href="simulace1.html#k-nejbližších-sousedů"><i class="fa fa-check"></i><b>1.3.1</b> <span class="math inline">\(K\)</span> nejbližších sousedů</a></li>
<li class="chapter" data-level="1.3.2" data-path="simulace1.html"><a href="simulace1.html#lineární-diskriminační-analýza"><i class="fa fa-check"></i><b>1.3.2</b> Lineární diskriminační analýza</a></li>
<li class="chapter" data-level="1.3.3" data-path="simulace1.html"><a href="simulace1.html#kvadratická-diskriminační-analýza"><i class="fa fa-check"></i><b>1.3.3</b> Kvadratická diskriminační analýza</a></li>
<li class="chapter" data-level="1.3.4" data-path="simulace1.html"><a href="simulace1.html#logistická-regrese"><i class="fa fa-check"></i><b>1.3.4</b> Logistická regrese</a></li>
<li class="chapter" data-level="1.3.5" data-path="simulace1.html"><a href="simulace1.html#rozhodovací-stromy"><i class="fa fa-check"></i><b>1.3.5</b> Rozhodovací stromy</a></li>
<li class="chapter" data-level="1.3.6" data-path="simulace1.html"><a href="simulace1.html#náhodné-lesy"><i class="fa fa-check"></i><b>1.3.6</b> Náhodné lesy</a></li>
<li class="chapter" data-level="1.3.7" data-path="simulace1.html"><a href="simulace1.html#support-vector-machines"><i class="fa fa-check"></i><b>1.3.7</b> Support Vector Machines</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="simulace1.html"><a href="simulace1.html#tabulka-výsledků"><i class="fa fa-check"></i><b>1.4</b> Tabulka výsledků</a></li>
<li class="chapter" data-level="1.5" data-path="simulace1.html"><a href="simulace1.html#simulační-studie"><i class="fa fa-check"></i><b>1.5</b> Simulační studie</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="simulace1.html"><a href="simulace1.html#výsledky"><i class="fa fa-check"></i><b>1.5.1</b> Výsledky</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="simulace2.html"><a href="simulace2.html"><i class="fa fa-check"></i><b>2</b> Simulace 2</a>
<ul>
<li class="chapter" data-level="2.1" data-path="simulace2.html"><a href="simulace2.html#simulace-funkcionálních-dat-1"><i class="fa fa-check"></i><b>2.1</b> Simulace funkcionálních dat</a></li>
<li class="chapter" data-level="2.2" data-path="simulace2.html"><a href="simulace2.html#vyhlazení-pozorovaných-křivek-1"><i class="fa fa-check"></i><b>2.2</b> Vyhlazení pozorovaných křivek</a></li>
<li class="chapter" data-level="2.3" data-path="simulace2.html"><a href="simulace2.html#klasifikace-křivek-1"><i class="fa fa-check"></i><b>2.3</b> Klasifikace křivek</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="simulace2.html"><a href="simulace2.html#k-nejbližších-sousedů-1"><i class="fa fa-check"></i><b>2.3.1</b> <span class="math inline">\(K\)</span> nejbližších sousedů</a></li>
<li class="chapter" data-level="2.3.2" data-path="simulace2.html"><a href="simulace2.html#lineární-diskriminační-analýza-1"><i class="fa fa-check"></i><b>2.3.2</b> Lineární diskriminační analýza</a></li>
<li class="chapter" data-level="2.3.3" data-path="simulace2.html"><a href="simulace2.html#kvadratická-diskriminační-analýza-1"><i class="fa fa-check"></i><b>2.3.3</b> Kvadratická diskriminační analýza</a></li>
<li class="chapter" data-level="2.3.4" data-path="simulace2.html"><a href="simulace2.html#logistická-regrese-1"><i class="fa fa-check"></i><b>2.3.4</b> Logistická regrese</a></li>
<li class="chapter" data-level="2.3.5" data-path="simulace2.html"><a href="simulace2.html#rozhodovací-stromy-1"><i class="fa fa-check"></i><b>2.3.5</b> Rozhodovací stromy</a></li>
<li class="chapter" data-level="2.3.6" data-path="simulace2.html"><a href="simulace2.html#náhodné-lesy-1"><i class="fa fa-check"></i><b>2.3.6</b> Náhodné lesy</a></li>
<li class="chapter" data-level="2.3.7" data-path="simulace2.html"><a href="simulace2.html#support-vector-machines-1"><i class="fa fa-check"></i><b>2.3.7</b> Support Vector Machines</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="simulace2.html"><a href="simulace2.html#tabulka-výsledků-1"><i class="fa fa-check"></i><b>2.4</b> Tabulka výsledků</a></li>
<li class="chapter" data-level="2.5" data-path="simulace2.html"><a href="simulace2.html#simulační-studie-1"><i class="fa fa-check"></i><b>2.5</b> Simulační studie</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="simulace2.html"><a href="simulace2.html#výsledky-1"><i class="fa fa-check"></i><b>2.5.1</b> Výsledky</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="simulace2sigma.html"><a href="simulace2sigma.html"><i class="fa fa-check"></i><b>3</b> Závislost na parametru <span class="math inline">\(\sigma^2\)</span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="simulace2sigma.html"><a href="simulace2sigma.html#simulace-funkcionálních-dat-2"><i class="fa fa-check"></i><b>3.1</b> Simulace funkcionálních dat</a></li>
<li class="chapter" data-level="3.2" data-path="simulace2sigma.html"><a href="simulace2sigma.html#vyhlazení-pozorovaných-křivek-2"><i class="fa fa-check"></i><b>3.2</b> Vyhlazení pozorovaných křivek</a></li>
<li class="chapter" data-level="3.3" data-path="simulace2sigma.html"><a href="simulace2sigma.html#klasifikace-křivek-2"><i class="fa fa-check"></i><b>3.3</b> Klasifikace křivek</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="simulace2sigma.html"><a href="simulace2sigma.html#k-nejbližších-sousedů-2"><i class="fa fa-check"></i><b>3.3.1</b> <span class="math inline">\(K\)</span> nejbližších sousedů</a></li>
<li class="chapter" data-level="3.3.2" data-path="simulace2sigma.html"><a href="simulace2sigma.html#lineární-diskriminační-analýza-2"><i class="fa fa-check"></i><b>3.3.2</b> Lineární diskriminační analýza</a></li>
<li class="chapter" data-level="3.3.3" data-path="simulace2sigma.html"><a href="simulace2sigma.html#kvadratická-diskriminační-analýza-2"><i class="fa fa-check"></i><b>3.3.3</b> Kvadratická diskriminační analýza</a></li>
<li class="chapter" data-level="3.3.4" data-path="simulace2sigma.html"><a href="simulace2sigma.html#support-vector-machines-2"><i class="fa fa-check"></i><b>3.3.4</b> Support Vector Machines</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="simulace2sigma.html"><a href="simulace2sigma.html#tabulka-výsledků-2"><i class="fa fa-check"></i><b>3.4</b> Tabulka výsledků</a></li>
<li class="chapter" data-level="3.5" data-path="simulace2sigma.html"><a href="simulace2sigma.html#simulační-studie-2"><i class="fa fa-check"></i><b>3.5</b> Simulační studie</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="simulace2sigma.html"><a href="simulace2sigma.html#grafický-výstup"><i class="fa fa-check"></i><b>3.5.1</b> Grafický výstup</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simulace2shift.html"><a href="simulace2shift.html"><i class="fa fa-check"></i><b>4</b> Závislost na parametru <span class="math inline">\(\sigma^2_{shift}\)</span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="simulace2shift.html"><a href="simulace2shift.html#simulace-funkcionálních-dat-3"><i class="fa fa-check"></i><b>4.1</b> Simulace funkcionálních dat</a></li>
<li class="chapter" data-level="4.2" data-path="simulace2shift.html"><a href="simulace2shift.html#vyhlazení-pozorovaných-křivek-3"><i class="fa fa-check"></i><b>4.2</b> Vyhlazení pozorovaných křivek</a></li>
<li class="chapter" data-level="4.3" data-path="simulace2shift.html"><a href="simulace2shift.html#klasifikace-křivek-3"><i class="fa fa-check"></i><b>4.3</b> Klasifikace křivek</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="simulace2shift.html"><a href="simulace2shift.html#k-nejbližších-sousedů-3"><i class="fa fa-check"></i><b>4.3.1</b> <span class="math inline">\(K\)</span> nejbližších sousedů</a></li>
<li class="chapter" data-level="4.3.2" data-path="simulace2shift.html"><a href="simulace2shift.html#lineární-diskriminační-analýza-3"><i class="fa fa-check"></i><b>4.3.2</b> Lineární diskriminační analýza</a></li>
<li class="chapter" data-level="4.3.3" data-path="simulace2shift.html"><a href="simulace2shift.html#kvadratická-diskriminační-analýza-3"><i class="fa fa-check"></i><b>4.3.3</b> Kvadratická diskriminační analýza</a></li>
<li class="chapter" data-level="4.3.4" data-path="simulace2shift.html"><a href="simulace2shift.html#support-vector-machines-3"><i class="fa fa-check"></i><b>4.3.4</b> Support Vector Machines</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="simulace2shift.html"><a href="simulace2shift.html#tabulka-výsledků-3"><i class="fa fa-check"></i><b>4.4</b> Tabulka výsledků</a></li>
<li class="chapter" data-level="4.5" data-path="simulace2shift.html"><a href="simulace2shift.html#simulační-studie-3"><i class="fa fa-check"></i><b>4.5</b> Simulační studie</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="simulace2shift.html"><a href="simulace2shift.html#grafický-výstup-1"><i class="fa fa-check"></i><b>4.5.1</b> Grafický výstup</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="simulace3.html"><a href="simulace3.html"><i class="fa fa-check"></i><b>5</b> Simulace 3</a>
<ul>
<li class="chapter" data-level="5.1" data-path="simulace3.html"><a href="simulace3.html#simulace-funkcionálních-dat-4"><i class="fa fa-check"></i><b>5.1</b> Simulace funkcionálních dat</a></li>
<li class="chapter" data-level="5.2" data-path="simulace3.html"><a href="simulace3.html#vyhlazení-pozorovaných-křivek-4"><i class="fa fa-check"></i><b>5.2</b> Vyhlazení pozorovaných křivek</a></li>
<li class="chapter" data-level="5.3" data-path="simulace3.html"><a href="simulace3.html#klasifikace-křivek-4"><i class="fa fa-check"></i><b>5.3</b> Klasifikace křivek</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="simulace3.html"><a href="simulace3.html#k-nejbližších-sousedů-4"><i class="fa fa-check"></i><b>5.3.1</b> <span class="math inline">\(K\)</span> nejbližších sousedů</a></li>
<li class="chapter" data-level="5.3.2" data-path="simulace3.html"><a href="simulace3.html#lineární-diskriminační-analýza-4"><i class="fa fa-check"></i><b>5.3.2</b> Lineární diskriminační analýza</a></li>
<li class="chapter" data-level="5.3.3" data-path="simulace3.html"><a href="simulace3.html#kvadratická-diskriminační-analýza-4"><i class="fa fa-check"></i><b>5.3.3</b> Kvadratická diskriminační analýza</a></li>
<li class="chapter" data-level="5.3.4" data-path="simulace3.html"><a href="simulace3.html#logistická-regrese-2"><i class="fa fa-check"></i><b>5.3.4</b> Logistická regrese</a></li>
<li class="chapter" data-level="5.3.5" data-path="simulace3.html"><a href="simulace3.html#rozhodovací-stromy-2"><i class="fa fa-check"></i><b>5.3.5</b> Rozhodovací stromy</a></li>
<li class="chapter" data-level="5.3.6" data-path="simulace3.html"><a href="simulace3.html#náhodné-lesy-2"><i class="fa fa-check"></i><b>5.3.6</b> Náhodné lesy</a></li>
<li class="chapter" data-level="5.3.7" data-path="simulace3.html"><a href="simulace3.html#support-vector-machines-4"><i class="fa fa-check"></i><b>5.3.7</b> Support Vector Machines</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="simulace3.html"><a href="simulace3.html#tabulka-výsledků-4"><i class="fa fa-check"></i><b>5.4</b> Tabulka výsledků</a></li>
<li class="chapter" data-level="5.5" data-path="simulace3.html"><a href="simulace3.html#simulační-studie-4"><i class="fa fa-check"></i><b>5.5</b> Simulační studie</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="simulace3.html"><a href="simulace3.html#výsledky-2"><i class="fa fa-check"></i><b>5.5.1</b> Výsledky</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="simulace3sigma.html"><a href="simulace3sigma.html"><i class="fa fa-check"></i><b>6</b> Závislost na parametru <span class="math inline">\(\sigma^2\)</span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="simulace3sigma.html"><a href="simulace3sigma.html#simulace-funkcionálních-dat-5"><i class="fa fa-check"></i><b>6.1</b> Simulace funkcionálních dat</a></li>
<li class="chapter" data-level="6.2" data-path="simulace3sigma.html"><a href="simulace3sigma.html#vyhlazení-pozorovaných-křivek-5"><i class="fa fa-check"></i><b>6.2</b> Vyhlazení pozorovaných křivek</a></li>
<li class="chapter" data-level="6.3" data-path="simulace3sigma.html"><a href="simulace3sigma.html#klasifikace-křivek-5"><i class="fa fa-check"></i><b>6.3</b> Klasifikace křivek</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="simulace3sigma.html"><a href="simulace3sigma.html#k-nejbližších-sousedů-5"><i class="fa fa-check"></i><b>6.3.1</b> <span class="math inline">\(K\)</span> nejbližších sousedů</a></li>
<li class="chapter" data-level="6.3.2" data-path="simulace3sigma.html"><a href="simulace3sigma.html#lineární-diskriminační-analýza-5"><i class="fa fa-check"></i><b>6.3.2</b> Lineární diskriminační analýza</a></li>
<li class="chapter" data-level="6.3.3" data-path="simulace3sigma.html"><a href="simulace3sigma.html#kvadratická-diskriminační-analýza-5"><i class="fa fa-check"></i><b>6.3.3</b> Kvadratická diskriminační analýza</a></li>
<li class="chapter" data-level="6.3.4" data-path="simulace3sigma.html"><a href="simulace3sigma.html#logistická-regrese-3"><i class="fa fa-check"></i><b>6.3.4</b> Logistická regrese</a></li>
<li class="chapter" data-level="6.3.5" data-path="simulace3sigma.html"><a href="simulace3sigma.html#support-vector-machines-5"><i class="fa fa-check"></i><b>6.3.5</b> Support Vector Machines</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="simulace3sigma.html"><a href="simulace3sigma.html#tabulka-výsledků-5"><i class="fa fa-check"></i><b>6.4</b> Tabulka výsledků</a></li>
<li class="chapter" data-level="6.5" data-path="simulace3sigma.html"><a href="simulace3sigma.html#simulační-studie-5"><i class="fa fa-check"></i><b>6.5</b> Simulační studie</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simulace3shift.html"><a href="simulace3shift.html"><i class="fa fa-check"></i><b>7</b> Závislost na parametru <span class="math inline">\(\sigma^2_{shift}\)</span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="simulace3shift.html"><a href="simulace3shift.html#simulace-funkcionálních-dat-6"><i class="fa fa-check"></i><b>7.1</b> Simulace funkcionálních dat</a></li>
<li class="chapter" data-level="7.2" data-path="simulace3shift.html"><a href="simulace3shift.html#vyhlazení-pozorovaných-křivek-6"><i class="fa fa-check"></i><b>7.2</b> Vyhlazení pozorovaných křivek</a></li>
<li class="chapter" data-level="7.3" data-path="simulace3shift.html"><a href="simulace3shift.html#klasifikace-křivek-6"><i class="fa fa-check"></i><b>7.3</b> Klasifikace křivek</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="simulace3shift.html"><a href="simulace3shift.html#k-nejbližších-sousedů-6"><i class="fa fa-check"></i><b>7.3.1</b> <span class="math inline">\(K\)</span> nejbližších sousedů</a></li>
<li class="chapter" data-level="7.3.2" data-path="simulace3shift.html"><a href="simulace3shift.html#lineární-diskriminační-analýza-6"><i class="fa fa-check"></i><b>7.3.2</b> Lineární diskriminační analýza</a></li>
<li class="chapter" data-level="7.3.3" data-path="simulace3shift.html"><a href="simulace3shift.html#kvadratická-diskriminační-analýza-6"><i class="fa fa-check"></i><b>7.3.3</b> Kvadratická diskriminační analýza</a></li>
<li class="chapter" data-level="7.3.4" data-path="simulace3shift.html"><a href="simulace3shift.html#logistická-regrese-4"><i class="fa fa-check"></i><b>7.3.4</b> Logistická regrese</a></li>
<li class="chapter" data-level="7.3.5" data-path="simulace3shift.html"><a href="simulace3shift.html#support-vector-machines-6"><i class="fa fa-check"></i><b>7.3.5</b> Support Vector Machines</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="simulace3shift.html"><a href="simulace3shift.html#tabulka-výsledků-6"><i class="fa fa-check"></i><b>7.4</b> Tabulka výsledků</a></li>
<li class="chapter" data-level="7.5" data-path="simulace3shift.html"><a href="simulace3shift.html#simulační-studie-6"><i class="fa fa-check"></i><b>7.5</b> Simulační studie</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="simulace3shift.html"><a href="simulace3shift.html#grafický-výstup-2"><i class="fa fa-check"></i><b>7.5.1</b> Grafický výstup</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulace-4.html"><a href="simulace-4.html"><i class="fa fa-check"></i><b>8</b> Simulace 4</a>
<ul>
<li class="chapter" data-level="8.1" data-path="simulace-4.html"><a href="simulace-4.html#simulace-funkcionálních-dat-7"><i class="fa fa-check"></i><b>8.1</b> Simulace funkcionálních dat</a></li>
<li class="chapter" data-level="8.2" data-path="simulace-4.html"><a href="simulace-4.html#vyhlazení-pozorovaných-křivek-7"><i class="fa fa-check"></i><b>8.2</b> Vyhlazení pozorovaných křivek</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="simulace-4.html"><a href="simulace-4.html#výpočet-derivací"><i class="fa fa-check"></i><b>8.2.1</b> Výpočet derivací</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="simulace-4.html"><a href="simulace-4.html#klasifikace-křivek-7"><i class="fa fa-check"></i><b>8.3</b> Klasifikace křivek</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="simulace-4.html"><a href="simulace-4.html#k-nejbližších-sousedů-7"><i class="fa fa-check"></i><b>8.3.1</b> <span class="math inline">\(K\)</span> nejbližších sousedů</a></li>
<li class="chapter" data-level="8.3.2" data-path="simulace-4.html"><a href="simulace-4.html#lineární-diskriminační-analýza-7"><i class="fa fa-check"></i><b>8.3.2</b> Lineární diskriminační analýza</a></li>
<li class="chapter" data-level="8.3.3" data-path="simulace-4.html"><a href="simulace-4.html#kvadratická-diskriminační-analýza-7"><i class="fa fa-check"></i><b>8.3.3</b> Kvadratická diskriminační analýza</a></li>
<li class="chapter" data-level="8.3.4" data-path="simulace-4.html"><a href="simulace-4.html#logistická-regrese-5"><i class="fa fa-check"></i><b>8.3.4</b> Logistická regrese</a></li>
<li class="chapter" data-level="8.3.5" data-path="simulace-4.html"><a href="simulace-4.html#rozhodovací-stromy-3"><i class="fa fa-check"></i><b>8.3.5</b> Rozhodovací stromy</a></li>
<li class="chapter" data-level="8.3.6" data-path="simulace-4.html"><a href="simulace-4.html#náhodné-lesy-3"><i class="fa fa-check"></i><b>8.3.6</b> Náhodné lesy</a></li>
<li class="chapter" data-level="8.3.7" data-path="simulace-4.html"><a href="simulace-4.html#support-vector-machines-7"><i class="fa fa-check"></i><b>8.3.7</b> Support Vector Machines</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="simulace-4.html"><a href="simulace-4.html#tabulka-výsledků-7"><i class="fa fa-check"></i><b>8.4</b> Tabulka výsledků</a></li>
<li class="chapter" data-level="8.5" data-path="simulace-4.html"><a href="simulace-4.html#simulační-studie-7"><i class="fa fa-check"></i><b>8.5</b> Simulační studie</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="simulace-4.html"><a href="simulace-4.html#výsledky-3"><i class="fa fa-check"></i><b>8.5.1</b> Výsledky</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Aplikace na datech</b></span></li>
<li class="chapter" data-level="9" data-path="aplikace-na-reálných-datech-1.html"><a href="aplikace-na-reálných-datech-1.html"><i class="fa fa-check"></i><b>9</b> Aplikace na reálných datech 1</a>
<ul>
<li class="chapter" data-level="9.1" data-path="aplikace-na-reálných-datech-1.html"><a href="aplikace-na-reálných-datech-1.html#vyhlazení-pozorovaných-křivek-8"><i class="fa fa-check"></i><b>9.1</b> Vyhlazení pozorovaných křivek</a></li>
<li class="chapter" data-level="9.2" data-path="aplikace-na-reálných-datech-1.html"><a href="aplikace-na-reálných-datech-1.html#klasifikace-křivek-8"><i class="fa fa-check"></i><b>9.2</b> Klasifikace křivek</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="aplikace-na-reálných-datech-1.html"><a href="aplikace-na-reálných-datech-1.html#k-nejbližších-sousedů-8"><i class="fa fa-check"></i><b>9.2.1</b> <span class="math inline">\(K\)</span> nejbližších sousedů</a></li>
<li class="chapter" data-level="9.2.2" data-path="aplikace-na-reálných-datech-1.html"><a href="aplikace-na-reálných-datech-1.html#lineární-diskriminační-analýza-8"><i class="fa fa-check"></i><b>9.2.2</b> Lineární diskriminační analýza</a></li>
<li class="chapter" data-level="9.2.3" data-path="aplikace-na-reálných-datech-1.html"><a href="aplikace-na-reálných-datech-1.html#kvadratická-diskriminační-analýza-8"><i class="fa fa-check"></i><b>9.2.3</b> Kvadratická diskriminační analýza</a></li>
<li class="chapter" data-level="9.2.4" data-path="aplikace-na-reálných-datech-1.html"><a href="aplikace-na-reálných-datech-1.html#logistická-regrese-6"><i class="fa fa-check"></i><b>9.2.4</b> Logistická regrese</a></li>
<li class="chapter" data-level="9.2.5" data-path="aplikace-na-reálných-datech-1.html"><a href="aplikace-na-reálných-datech-1.html#rozhodovací-stromy-4"><i class="fa fa-check"></i><b>9.2.5</b> Rozhodovací stromy</a></li>
<li class="chapter" data-level="9.2.6" data-path="aplikace-na-reálných-datech-1.html"><a href="aplikace-na-reálných-datech-1.html#náhodné-lesy-4"><i class="fa fa-check"></i><b>9.2.6</b> Náhodné lesy</a></li>
<li class="chapter" data-level="9.2.7" data-path="aplikace-na-reálných-datech-1.html"><a href="aplikace-na-reálných-datech-1.html#support-vector-machines-8"><i class="fa fa-check"></i><b>9.2.7</b> Support Vector Machines</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="aplikace-na-reálných-datech-1.html"><a href="aplikace-na-reálných-datech-1.html#tabulka-výsledků-8"><i class="fa fa-check"></i><b>9.3</b> Tabulka výsledků</a></li>
<li class="chapter" data-level="9.4" data-path="aplikace-na-reálných-datech-1.html"><a href="aplikace-na-reálných-datech-1.html#simulační-studie-8"><i class="fa fa-check"></i><b>9.4</b> Simulační studie</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="aplikace-na-reálných-datech-1.html"><a href="aplikace-na-reálných-datech-1.html#výsledky-4"><i class="fa fa-check"></i><b>9.4.1</b> Výsledky</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="aplikace-na-reálných-datech-2.html"><a href="aplikace-na-reálných-datech-2.html"><i class="fa fa-check"></i><b>10</b> Aplikace na reálných datech 2</a>
<ul>
<li class="chapter" data-level="10.1" data-path="aplikace-na-reálných-datech-2.html"><a href="aplikace-na-reálných-datech-2.html#vyhlazení-pozorovaných-křivek-9"><i class="fa fa-check"></i><b>10.1</b> Vyhlazení pozorovaných křivek</a></li>
<li class="chapter" data-level="10.2" data-path="aplikace-na-reálných-datech-2.html"><a href="aplikace-na-reálných-datech-2.html#klasifikace-křivek-9"><i class="fa fa-check"></i><b>10.2</b> Klasifikace křivek</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="aplikace-na-reálných-datech-2.html"><a href="aplikace-na-reálných-datech-2.html#k-nejbližších-sousedů-9"><i class="fa fa-check"></i><b>10.2.1</b> <span class="math inline">\(K\)</span> nejbližších sousedů</a></li>
<li class="chapter" data-level="10.2.2" data-path="aplikace-na-reálných-datech-2.html"><a href="aplikace-na-reálných-datech-2.html#lineární-diskriminační-analýza-9"><i class="fa fa-check"></i><b>10.2.2</b> Lineární diskriminační analýza</a></li>
<li class="chapter" data-level="10.2.3" data-path="aplikace-na-reálných-datech-2.html"><a href="aplikace-na-reálných-datech-2.html#kvadratická-diskriminační-analýza-9"><i class="fa fa-check"></i><b>10.2.3</b> Kvadratická diskriminační analýza</a></li>
<li class="chapter" data-level="10.2.4" data-path="aplikace-na-reálných-datech-2.html"><a href="aplikace-na-reálných-datech-2.html#logistická-regrese-7"><i class="fa fa-check"></i><b>10.2.4</b> Logistická regrese</a></li>
<li class="chapter" data-level="10.2.5" data-path="aplikace-na-reálných-datech-2.html"><a href="aplikace-na-reálných-datech-2.html#svm"><i class="fa fa-check"></i><b>10.2.5</b> SVM</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="aplikace-na-reálných-datech-3.html"><a href="aplikace-na-reálných-datech-3.html"><i class="fa fa-check"></i><b>11</b> Aplikace na reálných datech 3</a>
<ul>
<li class="chapter" data-level="11.1" data-path="aplikace-na-reálných-datech-3.html"><a href="aplikace-na-reálných-datech-3.html#handwrit-data"><i class="fa fa-check"></i><b>11.1</b> <code>handwrit</code> data</a></li>
<li class="chapter" data-level="11.2" data-path="aplikace-na-reálných-datech-3.html"><a href="aplikace-na-reálných-datech-3.html#growth-data"><i class="fa fa-check"></i><b>11.2</b> <code>growth</code> data</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Diplomová práce</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulace2shift" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Kapitola 4</span> Závislost na parametru <span class="math inline">\(\sigma^2_{shift}\)</span><a href="simulace2shift.html#simulace2shift" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>V této části se budeme zabývat závislostí výsledků ze sekce <a href="simulace2.html#simulace2">2</a> na hodnotě <span class="math inline">\(\sigma^2_{shift}\)</span>, která definuje rozptyl normálního rozdělení, ze kterého generujeme posun pro generované křivky. Očekáváme, že s rostoucí hodnotou <span class="math inline">\(\sigma^2_{shift}\)</span> se budou výsledky jednotlivých metod zhoršovat a tudíž klasifikace nebude tak úspěšná. Přitom předpokládáme, že metody, které využívají funkcionální podstatu dat, budou více úspěšné v porovnání s klasickými metodami při zvětšující se hodnotě <span class="math inline">\(\sigma^2_{shift}\)</span>. V předchozí sekci <a href="simulace2sigma.html#simulace2sigma">3</a> jsme se podívali na závislost výsledků na hodnotě <span class="math inline">\(\sigma^2\)</span>, tedy na rozptylu normálního rozdělení, ze kterého generujeme náhodné chyby kolem generujících křivek.</p>
<div id="simulace-funkcionálních-dat-3" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Simulace funkcionálních dat<a href="simulace2shift.html#simulace-funkcionálních-dat-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Nejprve si simulujeme funkce, které budeme následně chtít klasifikovat.
Budeme uvažovat pro jednoduchost dvě klasifikační třídy.
Pro tuto simulaci zvolíme následující postup:</p>
<ul>
<li><p>zvolíme vhodné body (pro každou klasifikační třídu jiné), které proložíme interpolačním splajnem,</p></li>
<li><p>takto získané funkce využijeme ke generování náhodných křivek pro obě třídy,</p></li>
<li><p>generujeme body ze zvoleného intervalu pomocí vyhlazených funkcí interpolačním splajnem, které obsahují, například gaussovský, šum,</p></li>
<li><p>takto získané diskrétní body vyhladíme do podoby funkcionálního objektu pomocí nějakého vhodného bázového systému.</p></li>
</ul>
<p>Tímto postupem získáme funkcionální objekty společně s hodnotou kategoriální proměnné <span class="math inline">\(Y\)</span>, která rozlišuje příslušnost do klasifikační třídy.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="simulace2shift.html#cb314-1" tabindex="-1"></a><span class="co"># nacteme potrebne balicky </span></span>
<span id="cb314-2"><a href="simulace2shift.html#cb314-2" tabindex="-1"></a></span>
<span id="cb314-3"><a href="simulace2shift.html#cb314-3" tabindex="-1"></a><span class="fu">library</span>(fda)</span>
<span id="cb314-4"><a href="simulace2shift.html#cb314-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb314-5"><a href="simulace2shift.html#cb314-5" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb314-6"><a href="simulace2shift.html#cb314-6" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb314-7"><a href="simulace2shift.html#cb314-7" tabindex="-1"></a><span class="fu">library</span>(ddalpha)</span>
<span id="cb314-8"><a href="simulace2shift.html#cb314-8" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb314-9"><a href="simulace2shift.html#cb314-9" tabindex="-1"></a></span>
<span id="cb314-10"><a href="simulace2shift.html#cb314-10" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span></code></pre></div>
</details>
<p>Uvažujme tedy dvě klasifikační třídy, <span class="math inline">\(Y \in \{0, 1\}\)</span>, pro každou ze tříd stejný počet <code>n</code> generovaných funkcí.
Definujme si nejprve dvě funkce, každá bude pro jednu třídu.
Funkce budeme uvažovat na intervalu <span class="math inline">\(I = [0, 12]\)</span>.</p>
<p>V tomto případě si definujeme v prvním kroku body, kterými má náš interpolační splajn procházet. Následně proložíme těmito body interpolační splajn, k čemuž využijeme funkci <code>spline()</code> z knihovny <code>stats</code>. Pro lepší interpretovatelnost simulovaných dat jsme definovali interval <span class="math inline">\(I = [0, 12]\)</span> a funkce pro obě klasifikační třídy zvolíme tak, aby při troše fantazie mohli představovat například vývoj určité veličiny (teplota, tlak, srážky, nezaměstnanost, prodej nějaké komodity atd.) v průběhu roku. Budeme předpokládat, že se vývoj této veličiny periodicky opakuje v čase (s roční periodou), proto ve funkci <code>spline()</code> zvolíme parametr <code>method = 'periodic'</code>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="simulace2shift.html#cb315-1" tabindex="-1"></a><span class="co"># definujici body pro tridu 0</span></span>
<span id="cb315-2"><a href="simulace2shift.html#cb315-2" tabindex="-1"></a>x<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="fl">2.96</span>, <span class="fl">3.64</span>, <span class="fl">4.2</span>, <span class="fl">5.3</span>, <span class="fl">6.22</span>, <span class="fl">7.32</span>, <span class="fl">8.3</span>, <span class="fl">9.3</span>, <span class="fl">10.6</span>, <span class="fl">11.54</span>, <span class="dv">12</span>)</span>
<span id="cb315-3"><a href="simulace2shift.html#cb315-3" tabindex="-1"></a>y<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="fl">4.66</span>, <span class="fl">4.6</span>, <span class="fl">3.48</span>, <span class="fl">2.08</span>, <span class="fl">1.5</span>, <span class="fl">1.32</span>, <span class="fl">2.78</span>, <span class="fl">3.82</span>, <span class="fl">4.48</span>, <span class="fl">3.88</span>, <span class="fl">3.16</span>, <span class="dv">3</span>)</span>
<span id="cb315-4"><a href="simulace2shift.html#cb315-4" tabindex="-1"></a></span>
<span id="cb315-5"><a href="simulace2shift.html#cb315-5" tabindex="-1"></a><span class="co"># definujici body pro tridu 1</span></span>
<span id="cb315-6"><a href="simulace2shift.html#cb315-6" tabindex="-1"></a>x<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.3</span>, <span class="dv">2</span>, <span class="fl">2.7</span>, <span class="fl">3.33</span>, <span class="fl">3.68</span>, <span class="fl">4.06</span>, <span class="fl">4.72</span>, <span class="fl">5.9</span>, <span class="fl">6.9</span>, <span class="dv">8</span>, <span class="fl">9.02</span>, <span class="fl">10.1</span>, <span class="fl">11.25</span>, <span class="dv">12</span>)</span>
<span id="cb315-7"><a href="simulace2shift.html#cb315-7" tabindex="-1"></a>y<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.8</span>, <span class="fl">3.95</span>, <span class="fl">4.82</span>, <span class="fl">5.1</span>, <span class="fl">4.8</span>, <span class="dv">4</span>, <span class="fl">2.73</span>, <span class="fl">1.67</span>, <span class="fl">1.53</span>, <span class="fl">2.2</span>, <span class="dv">3</span>, <span class="fl">3.73</span>, <span class="fl">3.69</span>, <span class="fl">3.6</span>, <span class="fl">2.8</span>)</span>
<span id="cb315-8"><a href="simulace2shift.html#cb315-8" tabindex="-1"></a></span>
<span id="cb315-9"><a href="simulace2shift.html#cb315-9" tabindex="-1"></a><span class="co"># # definujici body pro tridu 0</span></span>
<span id="cb315-10"><a href="simulace2shift.html#cb315-10" tabindex="-1"></a><span class="co"># x.0 &lt;- c(0, 2, 2.96, 3.64, 4.2, 5.3, 6.22, 7.32, 8.3, 9.3, 10.6, 11.54, 12)</span></span>
<span id="cb315-11"><a href="simulace2shift.html#cb315-11" tabindex="-1"></a><span class="co"># y.0 &lt;- c(3, 4.66, 4.6, 3.48, 2.08, 1.5, 1.32, 2.78, 3.82, 4.48, 3.88, 3.16, 3)</span></span>
<span id="cb315-12"><a href="simulace2shift.html#cb315-12" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb315-13"><a href="simulace2shift.html#cb315-13" tabindex="-1"></a><span class="co"># # definujici body pro tridu 1</span></span>
<span id="cb315-14"><a href="simulace2shift.html#cb315-14" tabindex="-1"></a><span class="co"># x.1 &lt;- c(0, 1.3, 2, 2.7, 3.33, 3.68, 4.06, 4.72, 5.9, 6.9, 8, 9.02, 10.1, 11.25, 12)</span></span>
<span id="cb315-15"><a href="simulace2shift.html#cb315-15" tabindex="-1"></a><span class="co"># y.1 &lt;- c(2.9, 3.95, 4.62, 4.6, 4.1, 3.6, 2.73, 1.67, 1.53, 2.2, 3, 3.73, 3.69, 3.6, 2.9)</span></span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="simulace2shift.html#cb316-1" tabindex="-1"></a><span class="co"># graf bodu</span></span>
<span id="cb316-2"><a href="simulace2shift.html#cb316-2" tabindex="-1"></a>dat_points <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(x<span class="fl">.0</span>, x<span class="fl">.1</span>),</span>
<span id="cb316-3"><a href="simulace2shift.html#cb316-3" tabindex="-1"></a>                         <span class="at">y =</span> <span class="fu">c</span>(y<span class="fl">.0</span>, y<span class="fl">.1</span>),</span>
<span id="cb316-4"><a href="simulace2shift.html#cb316-4" tabindex="-1"></a>                         <span class="at">Class =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>), </span>
<span id="cb316-5"><a href="simulace2shift.html#cb316-5" tabindex="-1"></a>                                     <span class="fu">c</span>(<span class="fu">length</span>(x<span class="fl">.0</span>), <span class="fu">length</span>(x<span class="fl">.1</span>))))</span>
<span id="cb316-6"><a href="simulace2shift.html#cb316-6" tabindex="-1"></a></span>
<span id="cb316-7"><a href="simulace2shift.html#cb316-7" tabindex="-1"></a><span class="fu">ggplot</span>(dat_points, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">colour =</span> Class)) <span class="sc">+</span> </span>
<span id="cb316-8"><a href="simulace2shift.html#cb316-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb316-9"><a href="simulace2shift.html#cb316-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb316-10"><a href="simulace2shift.html#cb316-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">colour =</span> <span class="st">&#39;Klasifikační</span><span class="sc">\n</span><span class="st">      třída&#39;</span>)</span></code></pre></div>
</details>
<p><img src="04-Simulace_2_shift_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Jejich grafy jsou na obrázcích níže.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="simulace2shift.html#cb317-1" tabindex="-1"></a><span class="co"># generujici funkce pro Y = 0 a Y = 1</span></span>
<span id="cb317-2"><a href="simulace2shift.html#cb317-2" tabindex="-1"></a>funkce_0 <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb317-3"><a href="simulace2shift.html#cb317-3" tabindex="-1"></a>  sp <span class="ot">&lt;-</span> <span class="fu">spline</span>(x<span class="fl">.0</span>, y<span class="fl">.0</span>, <span class="at">method =</span> <span class="st">&#39;periodic&#39;</span>, <span class="at">n =</span> n)</span>
<span id="cb317-4"><a href="simulace2shift.html#cb317-4" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x =</span> sp<span class="sc">$</span>x, <span class="at">y =</span> sp<span class="sc">$</span>y))</span>
<span id="cb317-5"><a href="simulace2shift.html#cb317-5" tabindex="-1"></a>}</span>
<span id="cb317-6"><a href="simulace2shift.html#cb317-6" tabindex="-1"></a><span class="co"># pridat nahodny posun v zacatku nebo periode</span></span>
<span id="cb317-7"><a href="simulace2shift.html#cb317-7" tabindex="-1"></a>funkce_1 <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb317-8"><a href="simulace2shift.html#cb317-8" tabindex="-1"></a>  sp <span class="ot">&lt;-</span> <span class="fu">spline</span>(x<span class="fl">.1</span>, y<span class="fl">.1</span>, <span class="at">method =</span> <span class="st">&#39;periodic&#39;</span>, <span class="at">n =</span> n)</span>
<span id="cb317-9"><a href="simulace2shift.html#cb317-9" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x =</span> sp<span class="sc">$</span>x, <span class="at">y =</span> sp<span class="sc">$</span>y))</span>
<span id="cb317-10"><a href="simulace2shift.html#cb317-10" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="simulace2shift.html#cb318-1" tabindex="-1"></a>n_x <span class="ot">&lt;-</span> <span class="dv">501</span></span>
<span id="cb318-2"><a href="simulace2shift.html#cb318-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">funkce_0</span>(n_x)<span class="sc">$</span>x</span>
<span id="cb318-3"><a href="simulace2shift.html#cb318-3" tabindex="-1"></a>y0 <span class="ot">&lt;-</span> <span class="fu">funkce_0</span>(n_x)<span class="sc">$</span>y</span>
<span id="cb318-4"><a href="simulace2shift.html#cb318-4" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">funkce_1</span>(n_x)<span class="sc">$</span>y</span>
<span id="cb318-5"><a href="simulace2shift.html#cb318-5" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rep</span>(x, <span class="dv">2</span>),</span>
<span id="cb318-6"><a href="simulace2shift.html#cb318-6" tabindex="-1"></a>                 <span class="at">y =</span> <span class="fu">c</span>(y0, y1),</span>
<span id="cb318-7"><a href="simulace2shift.html#cb318-7" tabindex="-1"></a>                 <span class="at">Y =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(x)))</span>
<span id="cb318-8"><a href="simulace2shift.html#cb318-8" tabindex="-1"></a></span>
<span id="cb318-9"><a href="simulace2shift.html#cb318-9" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">colour =</span> Y)) <span class="sc">+</span> </span>
<span id="cb318-10"><a href="simulace2shift.html#cb318-10" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb318-11"><a href="simulace2shift.html#cb318-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb318-12"><a href="simulace2shift.html#cb318-12" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">colour =</span> <span class="st">&#39;Klasifikační</span><span class="sc">\n</span><span class="st">      třída&#39;</span>) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-5"></span>
<img src="04-Simulace_2_shift_files/figure-html/unnamed-chunk-5-1.png" alt="Znázornění dvou funkcí na intervalu $[0, 1]$, ze kterých generujeme pozorování ze tříd 0 a 1." width="672" />
<p class="caption">
Obrázek 3.1: Znázornění dvou funkcí na intervalu <span class="math inline">\([0, 1]\)</span>, ze kterých generujeme pozorování ze tříd 0 a 1.
</p>
</div>
<p>Nyní si vytvoříme funkci pro generování náhodných funkcí s přidaným šumem (resp. bodů na předem dané síti) ze zvolené generující funkce.
Argument <code>t</code> označuje vektor hodnot, ve kterých chceme dané funkce vyhodnotit, <code>fun</code> značí generující funkci, <code>n</code> počet funkcí a <code>sigma</code> směrodatnou odchylku <span class="math inline">\(\sigma\)</span> normálního rozdělení <span class="math inline">\(\text{N}(\mu, \sigma^2)\)</span>, ze kterého náhodně generujeme gaussovský bílý šum s <span class="math inline">\(\mu = 0\)</span>.
Abychom ukázali výhodu použití metod, které pracují s funkcionálními daty, přidáme při generování ke každému simulovanému pozorování navíc i náhodný člen, který bude mít význam vertikálního posunu celé funkce.
Tento posun budeme generovat s normálního rozdělění s parametrem <span class="math inline">\(\sigma^2 = 4\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="simulace2shift.html#cb319-1" tabindex="-1"></a>generate_values <span class="ot">&lt;-</span> <span class="cf">function</span>(t, fun, n, sigma, <span class="at">sigma_shift =</span> <span class="dv">0</span>) {</span>
<span id="cb319-2"><a href="simulace2shift.html#cb319-2" tabindex="-1"></a>  <span class="co"># Arguments:</span></span>
<span id="cb319-3"><a href="simulace2shift.html#cb319-3" tabindex="-1"></a>  <span class="co"># t ... vector of values, where the function will be evaluated</span></span>
<span id="cb319-4"><a href="simulace2shift.html#cb319-4" tabindex="-1"></a>  <span class="co"># fun ... generating function of t </span></span>
<span id="cb319-5"><a href="simulace2shift.html#cb319-5" tabindex="-1"></a>  <span class="co"># n ... the number of generated functions / objects</span></span>
<span id="cb319-6"><a href="simulace2shift.html#cb319-6" tabindex="-1"></a>  <span class="co"># sigma ... standard deviation of normal distribution to add noise to data</span></span>
<span id="cb319-7"><a href="simulace2shift.html#cb319-7" tabindex="-1"></a>  <span class="co"># sigma_shift ... parameter of normal distribution for generating shift</span></span>
<span id="cb319-8"><a href="simulace2shift.html#cb319-8" tabindex="-1"></a>  </span>
<span id="cb319-9"><a href="simulace2shift.html#cb319-9" tabindex="-1"></a>  <span class="co"># Value:</span></span>
<span id="cb319-10"><a href="simulace2shift.html#cb319-10" tabindex="-1"></a>  <span class="co"># X ... matrix of dimension length(t) times n with generated values of one </span></span>
<span id="cb319-11"><a href="simulace2shift.html#cb319-11" tabindex="-1"></a>  <span class="co"># function in a column </span></span>
<span id="cb319-12"><a href="simulace2shift.html#cb319-12" tabindex="-1"></a>  </span>
<span id="cb319-13"><a href="simulace2shift.html#cb319-13" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">fun</span>(<span class="fu">length</span>(t))<span class="sc">$</span>y, <span class="at">times =</span> n), <span class="at">ncol =</span> n, <span class="at">nrow =</span> <span class="fu">length</span>(t), <span class="at">byrow =</span> <span class="cn">FALSE</span>)</span>
<span id="cb319-14"><a href="simulace2shift.html#cb319-14" tabindex="-1"></a>  noise <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> <span class="fu">length</span>(t), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sigma),</span>
<span id="cb319-15"><a href="simulace2shift.html#cb319-15" tabindex="-1"></a>                  <span class="at">ncol =</span> n, <span class="at">nrow =</span> <span class="fu">length</span>(t), <span class="at">byrow =</span> <span class="cn">FALSE</span>)</span>
<span id="cb319-16"><a href="simulace2shift.html#cb319-16" tabindex="-1"></a>  shift <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma_shift), <span class="at">each =</span> <span class="fu">length</span>(t)),</span>
<span id="cb319-17"><a href="simulace2shift.html#cb319-17" tabindex="-1"></a>                  <span class="at">ncol =</span> n, <span class="at">nrow =</span> <span class="fu">length</span>(t))</span>
<span id="cb319-18"><a href="simulace2shift.html#cb319-18" tabindex="-1"></a>  <span class="fu">return</span>(X <span class="sc">+</span> noise <span class="sc">+</span> shift)</span>
<span id="cb319-19"><a href="simulace2shift.html#cb319-19" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Nyní můžeme generovat funkce.
V každé ze dvou tříd budeme uvažovat 100 pozorování, tedy <code>n = 100</code>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="simulace2shift.html#cb320-1" tabindex="-1"></a><span class="co"># pocet vygenerovanych pozorovani pro kazdou tridu</span></span>
<span id="cb320-2"><a href="simulace2shift.html#cb320-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb320-3"><a href="simulace2shift.html#cb320-3" tabindex="-1"></a><span class="co"># vektor casu ekvidistantni na intervalu [0, 12]</span></span>
<span id="cb320-4"><a href="simulace2shift.html#cb320-4" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">12</span>, <span class="at">length =</span> <span class="dv">51</span>)</span>
<span id="cb320-5"><a href="simulace2shift.html#cb320-5" tabindex="-1"></a></span>
<span id="cb320-6"><a href="simulace2shift.html#cb320-6" tabindex="-1"></a><span class="co"># pro Y = 0</span></span>
<span id="cb320-7"><a href="simulace2shift.html#cb320-7" tabindex="-1"></a>X0 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_0, n, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb320-8"><a href="simulace2shift.html#cb320-8" tabindex="-1"></a><span class="co"># pro Y = 1</span></span>
<span id="cb320-9"><a href="simulace2shift.html#cb320-9" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_1, n, <span class="dv">1</span>, <span class="dv">2</span>)</span></code></pre></div>
</details>
<p>Vykreslíme vygenerované (ještě nevyhlazené) funkce barevně v závislosti na třídě (pouze prvních 10 pozorování z každé třídy pro přehlednost).</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="simulace2shift.html#cb321-1" tabindex="-1"></a>n_curves_plot <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># pocet krivek, ktere chceme vykreslit z kazde skupiny</span></span>
<span id="cb321-2"><a href="simulace2shift.html#cb321-2" tabindex="-1"></a></span>
<span id="cb321-3"><a href="simulace2shift.html#cb321-3" tabindex="-1"></a>DF0 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(t, X0[, <span class="dv">1</span><span class="sc">:</span>n_curves_plot]) <span class="sc">|&gt;</span> </span>
<span id="cb321-4"><a href="simulace2shift.html#cb321-4" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb321-5"><a href="simulace2shift.html#cb321-5" tabindex="-1"></a>  <span class="fu">reshape</span>(<span class="at">varying =</span> <span class="dv">2</span><span class="sc">:</span>(n_curves_plot <span class="sc">+</span> <span class="dv">1</span>), <span class="at">direction =</span> <span class="st">&#39;long&#39;</span>, <span class="at">sep =</span> <span class="st">&#39;&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb321-6"><a href="simulace2shift.html#cb321-6" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="sc">-</span>id) <span class="sc">|&gt;</span> </span>
<span id="cb321-7"><a href="simulace2shift.html#cb321-7" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb321-8"><a href="simulace2shift.html#cb321-8" tabindex="-1"></a>  <span class="at">time =</span> time <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb321-9"><a href="simulace2shift.html#cb321-9" tabindex="-1"></a>  <span class="at">group =</span> <span class="dv">0</span></span>
<span id="cb321-10"><a href="simulace2shift.html#cb321-10" tabindex="-1"></a>  )</span>
<span id="cb321-11"><a href="simulace2shift.html#cb321-11" tabindex="-1"></a></span>
<span id="cb321-12"><a href="simulace2shift.html#cb321-12" tabindex="-1"></a>DF1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(t, X1[, <span class="dv">1</span><span class="sc">:</span>n_curves_plot]) <span class="sc">|&gt;</span> </span>
<span id="cb321-13"><a href="simulace2shift.html#cb321-13" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb321-14"><a href="simulace2shift.html#cb321-14" tabindex="-1"></a>  <span class="fu">reshape</span>(<span class="at">varying =</span> <span class="dv">2</span><span class="sc">:</span>(n_curves_plot <span class="sc">+</span> <span class="dv">1</span>), <span class="at">direction =</span> <span class="st">&#39;long&#39;</span>, <span class="at">sep =</span> <span class="st">&#39;&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb321-15"><a href="simulace2shift.html#cb321-15" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="sc">-</span>id) <span class="sc">|&gt;</span> </span>
<span id="cb321-16"><a href="simulace2shift.html#cb321-16" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb321-17"><a href="simulace2shift.html#cb321-17" tabindex="-1"></a>  <span class="at">time =</span> time <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb321-18"><a href="simulace2shift.html#cb321-18" tabindex="-1"></a>  <span class="at">group =</span> <span class="dv">1</span></span>
<span id="cb321-19"><a href="simulace2shift.html#cb321-19" tabindex="-1"></a>  )</span>
<span id="cb321-20"><a href="simulace2shift.html#cb321-20" tabindex="-1"></a></span>
<span id="cb321-21"><a href="simulace2shift.html#cb321-21" tabindex="-1"></a>DF <span class="ot">&lt;-</span> <span class="fu">rbind</span>(DF0, DF1) <span class="sc">|&gt;</span></span>
<span id="cb321-22"><a href="simulace2shift.html#cb321-22" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">factor</span>(group))</span>
<span id="cb321-23"><a href="simulace2shift.html#cb321-23" tabindex="-1"></a></span>
<span id="cb321-24"><a href="simulace2shift.html#cb321-24" tabindex="-1"></a>DF <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> V, <span class="at">group =</span> <span class="fu">interaction</span>(time, group), </span>
<span id="cb321-25"><a href="simulace2shift.html#cb321-25" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb321-26"><a href="simulace2shift.html#cb321-26" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb321-27"><a href="simulace2shift.html#cb321-27" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb321-28"><a href="simulace2shift.html#cb321-28" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;x&#39;</span>,</span>
<span id="cb321-29"><a href="simulace2shift.html#cb321-29" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;y&#39;</span>,</span>
<span id="cb321-30"><a href="simulace2shift.html#cb321-30" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Klasifikační</span><span class="sc">\n</span><span class="st">      třída&#39;</span>) <span class="sc">+</span></span>
<span id="cb321-31"><a href="simulace2shift.html#cb321-31" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-8"></span>
<img src="04-Simulace_2_shift_files/figure-html/unnamed-chunk-8-1.png" alt="Prvních 10 vygenerovaných pozorování z každé ze dvou klasifikačních tříd. Pozorovaná data nejsou vyhlazená." width="672" />
<p class="caption">
Obrázek 3.2: Prvních 10 vygenerovaných pozorování z každé ze dvou klasifikačních tříd. Pozorovaná data nejsou vyhlazená.
</p>
</div>
</div>
<div id="vyhlazení-pozorovaných-křivek-3" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Vyhlazení pozorovaných křivek<a href="simulace2shift.html#vyhlazení-pozorovaných-křivek-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Nyní převedeme pozorované diskrétní hodnoty (vektory hodnot) na funkcionální objekty, se kterými budeme následně pracovat.
Jelikož se nyní jedná o periodické křivky na intervalu <span class="math inline">\(I = [0, 12]\)</span>, využijeme k vyhlazení <em>fourierovu</em> bázi.</p>
<p>Za uzly bereme celý vektor <code>t</code>, budeme uvažovat tzv. <em>harmonic acceleration penalties</em>. <em>Harmonic acceleration</em> pro funkci <span class="math inline">\(x(t)\)</span> je
<span class="math display">\[
Lx = \omega^2 Dx + D^3x,
\]</span>
kde <span class="math inline">\(D^mx\)</span> značí <span class="math inline">\(m\)</span>-tou derivaci funkce <span class="math inline">\(x(t)\)</span> podle <span class="math inline">\(t\)</span>. Platí přitom <span class="math inline">\(L\sin(\omega x) = 0 = L\cos(\omega x)\)</span>. Potom jako penalizaci bereme hodnotu funkcionálu
<span class="math display">\[
J_L(x) = \int \left[Lx(t)\right]^2\text dt.
\]</span></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="simulace2shift.html#cb322-1" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb322-2"><a href="simulace2shift.html#cb322-2" tabindex="-1"></a></span>
<span id="cb322-3"><a href="simulace2shift.html#cb322-3" tabindex="-1"></a>fbasis <span class="ot">&lt;-</span> <span class="fu">create.fourier.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb322-4"><a href="simulace2shift.html#cb322-4" tabindex="-1"></a>                               <span class="at">nbasis =</span> <span class="fu">length</span>(t))</span>
<span id="cb322-5"><a href="simulace2shift.html#cb322-5" tabindex="-1"></a></span>
<span id="cb322-6"><a href="simulace2shift.html#cb322-6" tabindex="-1"></a>omega <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">/</span> <span class="fu">diff</span>(rangeval)</span>
<span id="cb322-7"><a href="simulace2shift.html#cb322-7" tabindex="-1"></a>acvec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, omega<span class="sc">^</span><span class="dv">2</span>, <span class="dv">0</span>)</span>
<span id="cb322-8"><a href="simulace2shift.html#cb322-8" tabindex="-1"></a>harmLfd <span class="ot">&lt;-</span> <span class="fu">vec2Lfd</span>(<span class="at">bwtvec =</span> acvec, <span class="at">rangeval =</span> rangeval)</span></code></pre></div>
</details>
<p>Najdeme vhodnou hodnotu vyhlazovacího parametru <span class="math inline">\(\lambda &gt; 0\)</span> pomocí <span class="math inline">\(GCV(\lambda)\)</span>, tedy pomocí zobecněné cross–validace.
Hodnotu <span class="math inline">\(\lambda\)</span> budeme uvažovat pro obě klasifikační skupiny stejnou, neboť pro testovací pozorování bychom dopředu nevěděli, kterou hodnotu <span class="math inline">\(\lambda\)</span>, v případě rozdílné volby pro každou třídu, máme volit.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="simulace2shift.html#cb323-1" tabindex="-1"></a><span class="co"># spojeni pozorovani do jedne matice</span></span>
<span id="cb323-2"><a href="simulace2shift.html#cb323-2" tabindex="-1"></a>XX <span class="ot">&lt;-</span> <span class="fu">cbind</span>(X0, X1)</span>
<span id="cb323-3"><a href="simulace2shift.html#cb323-3" tabindex="-1"></a></span>
<span id="cb323-4"><a href="simulace2shift.html#cb323-4" tabindex="-1"></a>lambda.vect <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">2</span>, <span class="at">length.out =</span> <span class="dv">25</span>) <span class="co"># vektor lambd</span></span>
<span id="cb323-5"><a href="simulace2shift.html#cb323-5" tabindex="-1"></a>gcv <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="at">length =</span> <span class="fu">length</span>(lambda.vect)) <span class="co"># prazdny vektor pro ulozebi GCV</span></span>
<span id="cb323-6"><a href="simulace2shift.html#cb323-6" tabindex="-1"></a></span>
<span id="cb323-7"><a href="simulace2shift.html#cb323-7" tabindex="-1"></a><span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambda.vect)) {</span>
<span id="cb323-8"><a href="simulace2shift.html#cb323-8" tabindex="-1"></a>  curv.Fdpar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(fbasis, harmLfd, lambda.vect[index])</span>
<span id="cb323-9"><a href="simulace2shift.html#cb323-9" tabindex="-1"></a>  FSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.Fdpar) <span class="co"># vyhlazeni</span></span>
<span id="cb323-10"><a href="simulace2shift.html#cb323-10" tabindex="-1"></a>  gcv[index] <span class="ot">&lt;-</span> <span class="fu">mean</span>(FSmooth<span class="sc">$</span>gcv) <span class="co"># prumer pres vsechny pozorovane krivky</span></span>
<span id="cb323-11"><a href="simulace2shift.html#cb323-11" tabindex="-1"></a>}</span>
<span id="cb323-12"><a href="simulace2shift.html#cb323-12" tabindex="-1"></a></span>
<span id="cb323-13"><a href="simulace2shift.html#cb323-13" tabindex="-1"></a>GCV <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb323-14"><a href="simulace2shift.html#cb323-14" tabindex="-1"></a>  <span class="at">lambda =</span> <span class="fu">round</span>(<span class="fu">log10</span>(lambda.vect), <span class="dv">3</span>),</span>
<span id="cb323-15"><a href="simulace2shift.html#cb323-15" tabindex="-1"></a>  <span class="at">GCV =</span> gcv</span>
<span id="cb323-16"><a href="simulace2shift.html#cb323-16" tabindex="-1"></a>)</span>
<span id="cb323-17"><a href="simulace2shift.html#cb323-17" tabindex="-1"></a></span>
<span id="cb323-18"><a href="simulace2shift.html#cb323-18" tabindex="-1"></a><span class="co"># najdeme hodnotu minima</span></span>
<span id="cb323-19"><a href="simulace2shift.html#cb323-19" tabindex="-1"></a>lambda.opt <span class="ot">&lt;-</span> lambda.vect[<span class="fu">which.min</span>(gcv)]</span></code></pre></div>
</details>
<p>Pro lepší znázornění si vykreslíme průběh <span class="math inline">\(GCV(\lambda)\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="simulace2shift.html#cb324-1" tabindex="-1"></a>GCV <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lambda, <span class="at">y =</span> GCV)) <span class="sc">+</span> </span>
<span id="cb324-2"><a href="simulace2shift.html#cb324-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb324-3"><a href="simulace2shift.html#cb324-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span> </span>
<span id="cb324-4"><a href="simulace2shift.html#cb324-4" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb324-5"><a href="simulace2shift.html#cb324-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(log[<span class="dv">10</span>](lambda), <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb324-6"><a href="simulace2shift.html#cb324-6" tabindex="-1"></a>                        lambda[optimal] <span class="sc">==</span> .(<span class="fu">round</span>(lambda.opt, <span class="dv">4</span>)))),</span>
<span id="cb324-7"><a href="simulace2shift.html#cb324-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">GCV</span>(lambda))) <span class="sc">+</span> </span>
<span id="cb324-8"><a href="simulace2shift.html#cb324-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(lambda.opt), <span class="at">y =</span> <span class="fu">min</span>(gcv)), <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-11"></span>
<img src="04-Simulace_2_shift_files/figure-html/unnamed-chunk-11-1.png" alt="Průběh $GCV(\lambda)$ pro zvolený vektor $\boldsymbol\lambda$. Na ose $x$ jsou hodnoty vyneseny v logaritmické škále. Červeně je znázorněna optimální hodnota vyhlazovacího parametru $\lambda_{optimal}$." width="672" />
<p class="caption">
Obrázek 1.5: Průběh <span class="math inline">\(GCV(\lambda)\)</span> pro zvolený vektor <span class="math inline">\(\boldsymbol\lambda\)</span>. Na ose <span class="math inline">\(x\)</span> jsou hodnoty vyneseny v logaritmické škále. Červeně je znázorněna optimální hodnota vyhlazovacího parametru <span class="math inline">\(\lambda_{optimal}\)</span>.
</p>
</div>
<p>S touto optimální volbou vyhlazovacího parametru <span class="math inline">\(\lambda\)</span> nyní vyhladíme všechny funkce a opět znázorníme graficky prvních 10 pozorovaných křivek z každé klasifikační třídy.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="simulace2shift.html#cb325-1" tabindex="-1"></a>curv.fdPar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(fbasis, harmLfd, lambda.opt)</span>
<span id="cb325-2"><a href="simulace2shift.html#cb325-2" tabindex="-1"></a>FSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.fdPar)</span>
<span id="cb325-3"><a href="simulace2shift.html#cb325-3" tabindex="-1"></a>XXfd <span class="ot">&lt;-</span> FSmooth<span class="sc">$</span>fd</span>
<span id="cb325-4"><a href="simulace2shift.html#cb325-4" tabindex="-1"></a></span>
<span id="cb325-5"><a href="simulace2shift.html#cb325-5" tabindex="-1"></a>fdobjSmootheval <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> XXfd, <span class="at">evalarg =</span> t)</span>
<span id="cb325-6"><a href="simulace2shift.html#cb325-6" tabindex="-1"></a>DF<span class="sc">$</span>Vsmooth <span class="ot">&lt;-</span> <span class="fu">c</span>(fdobjSmootheval[, <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">:</span> n_curves_plot, </span>
<span id="cb325-7"><a href="simulace2shift.html#cb325-7" tabindex="-1"></a>                                    (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (n <span class="sc">+</span> n_curves_plot))])</span>
<span id="cb325-8"><a href="simulace2shift.html#cb325-8" tabindex="-1"></a></span>
<span id="cb325-9"><a href="simulace2shift.html#cb325-9" tabindex="-1"></a>DF <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Vsmooth, <span class="at">group =</span> <span class="fu">interaction</span>(time, group), </span>
<span id="cb325-10"><a href="simulace2shift.html#cb325-10" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb325-11"><a href="simulace2shift.html#cb325-11" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb325-12"><a href="simulace2shift.html#cb325-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb325-13"><a href="simulace2shift.html#cb325-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Time&#39;</span>,</span>
<span id="cb325-14"><a href="simulace2shift.html#cb325-14" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Function&#39;</span>,</span>
<span id="cb325-15"><a href="simulace2shift.html#cb325-15" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Klasifikační</span><span class="sc">\n</span><span class="st">      třída&#39;</span>) <span class="sc">+</span></span>
<span id="cb325-16"><a href="simulace2shift.html#cb325-16" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-12"></span>
<img src="04-Simulace_2_shift_files/figure-html/unnamed-chunk-12-1.png" alt="Prvních 10 vyhlazených křivek z každé klasifikační třídy." width="672" />
<p class="caption">
Obrázek 2.1: Prvních 10 vyhlazených křivek z každé klasifikační třídy.
</p>
</div>
<p>Ještě znázorněme všechny křivky včetně průměru zvlášť pro každou třídu.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="simulace2shift.html#cb326-1" tabindex="-1"></a>DFsmooth <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb326-2"><a href="simulace2shift.html#cb326-2" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span> <span class="sc">*</span> n),</span>
<span id="cb326-3"><a href="simulace2shift.html#cb326-3" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">each =</span> <span class="fu">length</span>(t)), <span class="dv">2</span>),</span>
<span id="cb326-4"><a href="simulace2shift.html#cb326-4" tabindex="-1"></a>  <span class="at">Smooth =</span> <span class="fu">c</span>(fdobjSmootheval),</span>
<span id="cb326-5"><a href="simulace2shift.html#cb326-5" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">apply</span>(fdobjSmootheval[ , <span class="dv">1</span> <span class="sc">:</span> n], <span class="dv">1</span>, mean), n),</span>
<span id="cb326-6"><a href="simulace2shift.html#cb326-6" tabindex="-1"></a>            <span class="fu">rep</span>(<span class="fu">apply</span>(fdobjSmootheval[ , (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="dv">2</span> <span class="sc">*</span> n)], <span class="dv">1</span>, mean), n)),</span>
<span id="cb326-7"><a href="simulace2shift.html#cb326-7" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n <span class="sc">*</span> <span class="fu">length</span>(t)))</span>
<span id="cb326-8"><a href="simulace2shift.html#cb326-8" tabindex="-1"></a>)</span>
<span id="cb326-9"><a href="simulace2shift.html#cb326-9" tabindex="-1"></a></span>
<span id="cb326-10"><a href="simulace2shift.html#cb326-10" tabindex="-1"></a>DFmean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb326-11"><a href="simulace2shift.html#cb326-11" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span>),</span>
<span id="cb326-12"><a href="simulace2shift.html#cb326-12" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">apply</span>(fdobjSmootheval[ , <span class="dv">1</span> <span class="sc">:</span> n], <span class="dv">1</span>, mean), </span>
<span id="cb326-13"><a href="simulace2shift.html#cb326-13" tabindex="-1"></a>            <span class="fu">apply</span>(fdobjSmootheval[ , (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="dv">2</span> <span class="sc">*</span> n)], <span class="dv">1</span>, mean)),</span>
<span id="cb326-14"><a href="simulace2shift.html#cb326-14" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> <span class="fu">length</span>(t)))</span>
<span id="cb326-15"><a href="simulace2shift.html#cb326-15" tabindex="-1"></a>)</span>
<span id="cb326-16"><a href="simulace2shift.html#cb326-16" tabindex="-1"></a></span>
<span id="cb326-17"><a href="simulace2shift.html#cb326-17" tabindex="-1"></a>DFsmooth <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Smooth, <span class="at">group =</span> <span class="fu">interaction</span>(time, group), </span>
<span id="cb326-18"><a href="simulace2shift.html#cb326-18" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb326-19"><a href="simulace2shift.html#cb326-19" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb326-20"><a href="simulace2shift.html#cb326-20" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb326-21"><a href="simulace2shift.html#cb326-21" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Time&#39;</span>,</span>
<span id="cb326-22"><a href="simulace2shift.html#cb326-22" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Function&#39;</span>,</span>
<span id="cb326-23"><a href="simulace2shift.html#cb326-23" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Klasifikační</span><span class="sc">\n</span><span class="st">      třída&#39;</span>) <span class="sc">+</span></span>
<span id="cb326-24"><a href="simulace2shift.html#cb326-24" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb326-25"><a href="simulace2shift.html#cb326-25" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Mean), </span>
<span id="cb326-26"><a href="simulace2shift.html#cb326-26" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&#39;twodash&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-13"></span>
<img src="04-Simulace_2_shift_files/figure-html/unnamed-chunk-13-1.png" alt="Vykreslení všech vyhlazených pozorovaných křivek, barevně jsou odlišeny křivky podle příslušnosti do klasifikační třídy. Černou čerchovanou čarou je zakreslen průměr pro každou třídu." width="672" />
<p class="caption">
Obrázek 2.2: Vykreslení všech vyhlazených pozorovaných křivek, barevně jsou odlišeny křivky podle příslušnosti do klasifikační třídy. Černou čerchovanou čarou je zakreslen průměr pro každou třídu.
</p>
</div>
</div>
<div id="klasifikace-křivek-3" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Klasifikace křivek<a href="simulace2shift.html#klasifikace-křivek-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Nejprve načteme potřebné knihovny pro klasifikaci.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="simulace2shift.html#cb327-1" tabindex="-1"></a><span class="fu">library</span>(caTools) <span class="co"># pro rozdeleni na testovaci a trenovaci</span></span>
<span id="cb327-2"><a href="simulace2shift.html#cb327-2" tabindex="-1"></a><span class="fu">library</span>(caret) <span class="co"># pro k-fold CV</span></span>
<span id="cb327-3"><a href="simulace2shift.html#cb327-3" tabindex="-1"></a><span class="fu">library</span>(fda.usc) <span class="co"># pro KNN, fLR</span></span>
<span id="cb327-4"><a href="simulace2shift.html#cb327-4" tabindex="-1"></a><span class="fu">library</span>(MASS) <span class="co"># pro LDA</span></span>
<span id="cb327-5"><a href="simulace2shift.html#cb327-5" tabindex="-1"></a><span class="fu">library</span>(fdapace)</span>
<span id="cb327-6"><a href="simulace2shift.html#cb327-6" tabindex="-1"></a><span class="fu">library</span>(pracma)</span>
<span id="cb327-7"><a href="simulace2shift.html#cb327-7" tabindex="-1"></a><span class="fu">library</span>(refund) <span class="co"># pro LR na skorech</span></span>
<span id="cb327-8"><a href="simulace2shift.html#cb327-8" tabindex="-1"></a><span class="fu">library</span>(nnet) <span class="co"># pro LR na skorech</span></span>
<span id="cb327-9"><a href="simulace2shift.html#cb327-9" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb327-10"><a href="simulace2shift.html#cb327-10" tabindex="-1"></a><span class="fu">library</span>(rpart) <span class="co"># stromy</span></span>
<span id="cb327-11"><a href="simulace2shift.html#cb327-11" tabindex="-1"></a><span class="fu">library</span>(rattle) <span class="co"># grafika</span></span>
<span id="cb327-12"><a href="simulace2shift.html#cb327-12" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb327-13"><a href="simulace2shift.html#cb327-13" tabindex="-1"></a><span class="fu">library</span>(randomForest) <span class="co"># nahodny les</span></span></code></pre></div>
</details>
<p>Abychom mohli jednotlivé klasifikátory porovnat, rozdělíme množinu vygenerovaných pozorování na dvě části v poměru 70:30, a to na trénovací a testovací (validační) část.
Trénovací část použijeme při konstrukci klasifikátoru a testovací na výpočet chyby klasifikace a případně dalších charakteristik našeho modelu.
Výsledné klasifikátory podle těchto spočtených charakteristik můžeme následně porovnat mezi sebou z pohledu jejich úspěnosti klasifikace.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="simulace2shift.html#cb328-1" tabindex="-1"></a><span class="co"># rozdeleni na testovaci a trenovaci cast</span></span>
<span id="cb328-2"><a href="simulace2shift.html#cb328-2" tabindex="-1"></a>split <span class="ot">&lt;-</span> <span class="fu">sample.split</span>(XXfd<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb328-3"><a href="simulace2shift.html#cb328-3" tabindex="-1"></a></span>
<span id="cb328-4"><a href="simulace2shift.html#cb328-4" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n)</span>
<span id="cb328-5"><a href="simulace2shift.html#cb328-5" tabindex="-1"></a></span>
<span id="cb328-6"><a href="simulace2shift.html#cb328-6" tabindex="-1"></a>X.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb328-7"><a href="simulace2shift.html#cb328-7" tabindex="-1"></a>X.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb328-8"><a href="simulace2shift.html#cb328-8" tabindex="-1"></a></span>
<span id="cb328-9"><a href="simulace2shift.html#cb328-9" tabindex="-1"></a>Y.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb328-10"><a href="simulace2shift.html#cb328-10" tabindex="-1"></a>Y.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</details>
<p>Ještě se podíváme na zastoupení jednotlivých skupin v testovací a trénovací části dat.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="simulace2shift.html#cb329-1" tabindex="-1"></a><span class="co"># absolutni zastoupeni</span></span>
<span id="cb329-2"><a href="simulace2shift.html#cb329-2" tabindex="-1"></a><span class="fu">table</span>(Y.train)</span></code></pre></div>
</details>
<pre><code>## Y.train
##  0  1 
## 71 69</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="simulace2shift.html#cb331-1" tabindex="-1"></a><span class="fu">table</span>(Y.test)</span></code></pre></div>
</details>
<pre><code>## Y.test
##  0  1 
## 29 31</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="simulace2shift.html#cb333-1" tabindex="-1"></a><span class="co"># relativni zastoupeni</span></span>
<span id="cb333-2"><a href="simulace2shift.html#cb333-2" tabindex="-1"></a><span class="fu">table</span>(Y.train) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">table</span>(Y.train))</span></code></pre></div>
</details>
<pre><code>## Y.train
##         0         1 
## 0.5071429 0.4928571</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="simulace2shift.html#cb335-1" tabindex="-1"></a><span class="fu">table</span>(Y.test) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">table</span>(Y.test))</span></code></pre></div>
</details>
<pre><code>## Y.test
##         0         1 
## 0.4833333 0.5166667</code></pre>
<div id="k-nejbližších-sousedů-3" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> <span class="math inline">\(K\)</span> nejbližších sousedů<a href="simulace2shift.html#k-nejbližších-sousedů-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Začněme neparametrickou klasifikační metodou, a to metodou <span class="math inline">\(K\)</span> nejbližších sousedů.
Nejprve si vytvoříme potřebné objekty tak, abychom s nimi mohli pomocí funkce <code>classif.knn()</code> z knihovny <code>fda.usc</code> dále pracovat.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="simulace2shift.html#cb337-1" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb337-2"><a href="simulace2shift.html#cb337-2" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.train))</span></code></pre></div>
</details>
<p>Nyní můžeme definovat model a podívat se na jeho úspěšnost klasifikace.
Poslední otázkou však zůstává, jak volit optimální počet sousedů <span class="math inline">\(K\)</span>.
Mohli bychom tento počet volit jako takové <span class="math inline">\(K\)</span>, při kterém nastává minimální chybovost na trénovacích datech.
To by ale mohlo vést k přeučení modelu, proto využijeme cross-validaci.
Vzhledem k výpočetní náročnosti a rozsahu souboru zvolíme <span class="math inline">\(k\)</span>-násobnou CV, my zvolíme například hodnotu <span class="math inline">\(k = {10}\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="simulace2shift.html#cb338-1" tabindex="-1"></a><span class="co"># model pro vsechna trenovaci data pro K = 1, 2, ..., sqrt(n_train)</span></span>
<span id="cb338-2"><a href="simulace2shift.html#cb338-2" tabindex="-1"></a>neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, </span>
<span id="cb338-3"><a href="simulace2shift.html#cb338-3" tabindex="-1"></a>                            <span class="at">fdataobj =</span> x.train, </span>
<span id="cb338-4"><a href="simulace2shift.html#cb338-4" tabindex="-1"></a>                            <span class="at">knn =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">round</span>(<span class="fu">sqrt</span>(<span class="fu">length</span>(y.train))))) </span>
<span id="cb338-5"><a href="simulace2shift.html#cb338-5" tabindex="-1"></a></span>
<span id="cb338-6"><a href="simulace2shift.html#cb338-6" tabindex="-1"></a><span class="fu">summary</span>(neighb.model) <span class="co"># shrnuti modelu</span></span></code></pre></div>
</details>
<pre><code>##      - SUMMARY - 
## 
## -Probability of correct classification by group (prob.classification):
## y
##         1         2 
## 0.7746479 0.7246377 
## 
## -Confusion matrix between the theoretical groups (by rows)
##   and estimated groups (by column) 
##    
##      1  2
##   1 55 16
##   2 19 50
## 
## -Vector of probability of correct classification
##    by number of neighbors (knn):
##      1      2      3      4      5      6      7      8      9     10     11 
## 0.7286 0.7429 0.7357 0.7214 0.7500 0.7214 0.7000 0.6857 0.7429 0.7286 0.6929 
##     12 
## 0.6714 
## 
## -Optimal number of neighbors: knn.opt= 5 
## with highest probability of correct classification max.prob=  0.75 
## 
## -Probability of correct classification:  0.75</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="simulace2shift.html#cb340-1" tabindex="-1"></a><span class="fu">plot</span>(neighb.model<span class="sc">$</span>gcv, <span class="at">pch =</span> <span class="dv">16</span>) <span class="co"># vykresleni zavislosti GCV na poctu sousedu K</span></span></code></pre></div>
</details>
<p><img src="04-Simulace_2_shift_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="simulace2shift.html#cb341-1" tabindex="-1"></a>neighb.model<span class="sc">$</span>max.prob <span class="co"># maximalni presnost</span></span></code></pre></div>
</details>
<pre><code>## [1] 0.75</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="simulace2shift.html#cb343-1" tabindex="-1"></a>(K.opt <span class="ot">&lt;-</span> neighb.model<span class="sc">$</span>h.opt) <span class="co"># optimalni hodnota K</span></span></code></pre></div>
</details>
<pre><code>## [1] 5</code></pre>
<p>Proveďme předchozí postup pro trénovací data, která rozdělíme na <span class="math inline">\(k\)</span> částí a tedy zopakujeme tuto část kódu <span class="math inline">\(k\)</span>-krát.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="simulace2shift.html#cb345-1" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb345-2"><a href="simulace2shift.html#cb345-2" tabindex="-1"></a>neighbours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">ceiling</span>(<span class="fu">sqrt</span>(<span class="fu">length</span>(y.train))))) <span class="co"># pocet sousedu </span></span>
<span id="cb345-3"><a href="simulace2shift.html#cb345-3" tabindex="-1"></a></span>
<span id="cb345-4"><a href="simulace2shift.html#cb345-4" tabindex="-1"></a><span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb345-5"><a href="simulace2shift.html#cb345-5" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb345-6"><a href="simulace2shift.html#cb345-6" tabindex="-1"></a></span>
<span id="cb345-7"><a href="simulace2shift.html#cb345-7" tabindex="-1"></a><span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb345-8"><a href="simulace2shift.html#cb345-8" tabindex="-1"></a><span class="co"># ve sloupcich budou hodnoty presnosti pro danou cast trenovaci mnoziny</span></span>
<span id="cb345-9"><a href="simulace2shift.html#cb345-9" tabindex="-1"></a><span class="co"># v radcich budou hodnoty pro danou hodnotu K sousedu</span></span>
<span id="cb345-10"><a href="simulace2shift.html#cb345-10" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(neighbours), <span class="at">ncol =</span> k_cv)</span>
<span id="cb345-11"><a href="simulace2shift.html#cb345-11" tabindex="-1"></a></span>
<span id="cb345-12"><a href="simulace2shift.html#cb345-12" tabindex="-1"></a><span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb345-13"><a href="simulace2shift.html#cb345-13" tabindex="-1"></a>  <span class="co"># definujeme danou indexovou mnozinu</span></span>
<span id="cb345-14"><a href="simulace2shift.html#cb345-14" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb345-15"><a href="simulace2shift.html#cb345-15" tabindex="-1"></a>    </span>
<span id="cb345-16"><a href="simulace2shift.html#cb345-16" tabindex="-1"></a>  x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb345-17"><a href="simulace2shift.html#cb345-17" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb345-18"><a href="simulace2shift.html#cb345-18" tabindex="-1"></a>  y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb345-19"><a href="simulace2shift.html#cb345-19" tabindex="-1"></a>    <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb345-20"><a href="simulace2shift.html#cb345-20" tabindex="-1"></a>  </span>
<span id="cb345-21"><a href="simulace2shift.html#cb345-21" tabindex="-1"></a>  x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb345-22"><a href="simulace2shift.html#cb345-22" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb345-23"><a href="simulace2shift.html#cb345-23" tabindex="-1"></a>  y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb345-24"><a href="simulace2shift.html#cb345-24" tabindex="-1"></a>    <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb345-25"><a href="simulace2shift.html#cb345-25" tabindex="-1"></a>  </span>
<span id="cb345-26"><a href="simulace2shift.html#cb345-26" tabindex="-1"></a>  <span class="co"># projdeme kazdou cast ... k-krat zopakujeme</span></span>
<span id="cb345-27"><a href="simulace2shift.html#cb345-27" tabindex="-1"></a>  <span class="cf">for</span>(neighbour <span class="cf">in</span> neighbours) {</span>
<span id="cb345-28"><a href="simulace2shift.html#cb345-28" tabindex="-1"></a>    <span class="co"># model pro konkretni volbu K</span></span>
<span id="cb345-29"><a href="simulace2shift.html#cb345-29" tabindex="-1"></a>    neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train.cv, </span>
<span id="cb345-30"><a href="simulace2shift.html#cb345-30" tabindex="-1"></a>                              <span class="at">fdataobj =</span> x.train.cv, </span>
<span id="cb345-31"><a href="simulace2shift.html#cb345-31" tabindex="-1"></a>                              <span class="at">knn =</span> neighbour) </span>
<span id="cb345-32"><a href="simulace2shift.html#cb345-32" tabindex="-1"></a>    <span class="co"># predikce na validacni casti</span></span>
<span id="cb345-33"><a href="simulace2shift.html#cb345-33" tabindex="-1"></a>    model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb345-34"><a href="simulace2shift.html#cb345-34" tabindex="-1"></a>                                    <span class="at">new.fdataobj =</span> x.test.cv)</span>
<span id="cb345-35"><a href="simulace2shift.html#cb345-35" tabindex="-1"></a>    <span class="co"># presnost na validacni casti</span></span>
<span id="cb345-36"><a href="simulace2shift.html#cb345-36" tabindex="-1"></a>    presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, model.neighb.predict) <span class="sc">|&gt;</span> </span>
<span id="cb345-37"><a href="simulace2shift.html#cb345-37" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb345-38"><a href="simulace2shift.html#cb345-38" tabindex="-1"></a>    </span>
<span id="cb345-39"><a href="simulace2shift.html#cb345-39" tabindex="-1"></a>    <span class="co"># presnost vlozime na pozici pro dane K a fold</span></span>
<span id="cb345-40"><a href="simulace2shift.html#cb345-40" tabindex="-1"></a>    CV.results[neighbour, index] <span class="ot">&lt;-</span> presnost</span>
<span id="cb345-41"><a href="simulace2shift.html#cb345-41" tabindex="-1"></a>  }</span>
<span id="cb345-42"><a href="simulace2shift.html#cb345-42" tabindex="-1"></a>}</span>
<span id="cb345-43"><a href="simulace2shift.html#cb345-43" tabindex="-1"></a></span>
<span id="cb345-44"><a href="simulace2shift.html#cb345-44" tabindex="-1"></a><span class="co"># spocitame prumerne presnosti pro jednotliva K pres folds</span></span>
<span id="cb345-45"><a href="simulace2shift.html#cb345-45" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb345-46"><a href="simulace2shift.html#cb345-46" tabindex="-1"></a>K.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(CV.results)</span>
<span id="cb345-47"><a href="simulace2shift.html#cb345-47" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb345-48"><a href="simulace2shift.html#cb345-48" tabindex="-1"></a>CV.results</span></code></pre></div>
</details>
<pre><code>##  [1] 0.6887997 0.7483437 0.7368816 0.7384620 0.7559592 0.7304458 0.7198493
##  [8] 0.7059212 0.7511321 0.7249606 0.6868431 0.6916845 0.6723656 0.6802993
## [15] 0.6909588 0.6829584 0.6737427 0.6955291 0.6705774 0.6768249 0.6776039
## [22] 0.6602983 0.6613755 0.6606879</code></pre>
<p>Vidíme, že nejlépe vychází hodnota parametru <span class="math inline">\(K\)</span> jako 5 s hodnotou přesnosti spočtenou pomocí 10-násobné CV 0.756.
Pro přehlednost si ještě vykresleme průběh validační chybovosti v závislosti na počtu sousedů <span class="math inline">\(K\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="simulace2shift.html#cb347-1" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">K =</span> neighbours, <span class="at">CV =</span> CV.results)</span>
<span id="cb347-2"><a href="simulace2shift.html#cb347-2" tabindex="-1"></a>CV.results <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> K, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> CV)) <span class="sc">+</span> </span>
<span id="cb347-3"><a href="simulace2shift.html#cb347-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span> </span>
<span id="cb347-4"><a href="simulace2shift.html#cb347-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb347-5"><a href="simulace2shift.html#cb347-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> K.opt, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv), <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb347-6"><a href="simulace2shift.html#cb347-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb347-7"><a href="simulace2shift.html#cb347-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(K, <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb347-8"><a href="simulace2shift.html#cb347-8" tabindex="-1"></a>                        K[optimal] <span class="sc">==</span> .(K.opt))),</span>
<span id="cb347-9"><a href="simulace2shift.html#cb347-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Validační chybovost&#39;</span>) <span class="sc">+</span> </span>
<span id="cb347-10"><a href="simulace2shift.html#cb347-10" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> neighbours)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-20"></span>
<img src="04-Simulace_2_shift_files/figure-html/unnamed-chunk-20-1.png" alt="Závislost validační chybovosti na hodnotě $K$, tedy na počtu sousedů." width="672" />
<p class="caption">
Obrázek 3.3: Závislost validační chybovosti na hodnotě <span class="math inline">\(K\)</span>, tedy na počtu sousedů.
</p>
</div>
<p>Nyní známe optimální hodnotu parametru <span class="math inline">\(K\)</span> a tudíž můžeme sestavit finální model.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="simulace2shift.html#cb348-1" tabindex="-1"></a>neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, <span class="at">fdataobj =</span> x.train, <span class="at">knn =</span> K.opt)</span>
<span id="cb348-2"><a href="simulace2shift.html#cb348-2" tabindex="-1"></a></span>
<span id="cb348-3"><a href="simulace2shift.html#cb348-3" tabindex="-1"></a><span class="co"># predikce</span></span>
<span id="cb348-4"><a href="simulace2shift.html#cb348-4" tabindex="-1"></a>model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb348-5"><a href="simulace2shift.html#cb348-5" tabindex="-1"></a>                                <span class="at">new.fdataobj =</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb348-6"><a href="simulace2shift.html#cb348-6" tabindex="-1"></a></span>
<span id="cb348-7"><a href="simulace2shift.html#cb348-7" tabindex="-1"></a><span class="fu">summary</span>(neighb.model)</span></code></pre></div>
</details>
<pre><code>##      - SUMMARY - 
## 
## -Probability of correct classification by group (prob.classification):
## y
##         1         2 
## 0.7746479 0.7246377 
## 
## -Confusion matrix between the theoretical groups (by rows)
##   and estimated groups (by column) 
##    
##      1  2
##   1 55 16
##   2 19 50
## 
## -Vector of probability of correct classification
##    by number of neighbors (knn):
##    5 
## 0.75 
## 
## -Optimal number of neighbors: knn.opt= 5 
## with highest probability of correct classification max.prob=  0.75 
## 
## -Probability of correct classification:  0.75</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="simulace2shift.html#cb350-1" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb350-2"><a href="simulace2shift.html#cb350-2" tabindex="-1"></a>presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.test)), model.neighb.predict) <span class="sc">|&gt;</span></span>
<span id="cb350-3"><a href="simulace2shift.html#cb350-3" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span></span>
<span id="cb350-4"><a href="simulace2shift.html#cb350-4" tabindex="-1"></a>  <span class="fu">diag</span>() <span class="sc">|&gt;</span></span>
<span id="cb350-5"><a href="simulace2shift.html#cb350-5" tabindex="-1"></a>  <span class="fu">sum</span>()</span>
<span id="cb350-6"><a href="simulace2shift.html#cb350-6" tabindex="-1"></a><span class="co"># chybovost</span></span>
<span id="cb350-7"><a href="simulace2shift.html#cb350-7" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> presnost</span></code></pre></div>
</details>
<pre><code>## [1] 0.2166667</code></pre>
<p>Vidíme tedy, že přesnost modelu sestrojeného pomocí metody <span class="math inline">\(K\)</span> nejbližších sousedů s optimální volbou <span class="math inline">\(K_{optimal}\)</span> rovnou 5, kterou jsme určili cross-validací, je na trénovacích datech rovna 0.25 a na testovacích datech 0.2167.</p>
<p>K porovnání jendotlivých modelů můžeme použít oba typy chybovostí, pro přehlednost si je budeme ukládat do tabulky.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="simulace2shift.html#cb352-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;KNN&#39;</span>, </span>
<span id="cb352-2"><a href="simulace2shift.html#cb352-2" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> neighb.model<span class="sc">$</span>max.prob,</span>
<span id="cb352-3"><a href="simulace2shift.html#cb352-3" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost)</span></code></pre></div>
</details>
</div>
<div id="lineární-diskriminační-analýza-3" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Lineární diskriminační analýza<a href="simulace2shift.html#lineární-diskriminační-analýza-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Jako druhou metodu pro sestrojení klasifikátoru budeme uvažovat lineární diskriminační analýzu (LDA).
Jelikož tato metoda nelze aplikovat na funkcionální data, musíme je nejprve diskretizovat, což provedeme pomocí funkcionální analýzy hlavních komponent.
Klasifikační algoritmus následně provedeme na skórech prvních <span class="math inline">\(p\)</span> hlavních komponent.
Počet komponent <span class="math inline">\(p\)</span> zvolíme tak, aby prvních <span class="math inline">\(p\)</span> hlavních komponent dohromady vysvětlovalo alespoň 90 % variability v datech.</p>
<p>Proveďme tedy nejprve funkcionální analýzu hlavních komponent a určeme počet <span class="math inline">\(p\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="simulace2shift.html#cb353-1" tabindex="-1"></a><span class="co"># analyza hlavnich komponent</span></span>
<span id="cb353-2"><a href="simulace2shift.html#cb353-2" tabindex="-1"></a>data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> <span class="dv">10</span>) <span class="co"># nharm - maximalni pocet HK</span></span>
<span id="cb353-3"><a href="simulace2shift.html#cb353-3" tabindex="-1"></a>nharm <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">cumsum</span>(data.PCA<span class="sc">$</span>varprop) <span class="sc">&gt;=</span> <span class="fl">0.9</span>)[<span class="dv">1</span>] <span class="co"># urceni p</span></span>
<span id="cb353-4"><a href="simulace2shift.html#cb353-4" tabindex="-1"></a><span class="cf">if</span>(nharm <span class="sc">==</span> <span class="dv">1</span>) nharm <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb353-5"><a href="simulace2shift.html#cb353-5" tabindex="-1"></a></span>
<span id="cb353-6"><a href="simulace2shift.html#cb353-6" tabindex="-1"></a>data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> nharm) </span>
<span id="cb353-7"><a href="simulace2shift.html#cb353-7" tabindex="-1"></a>data.PCA.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA<span class="sc">$</span>scores) <span class="co"># skore prvnich p HK</span></span>
<span id="cb353-8"><a href="simulace2shift.html#cb353-8" tabindex="-1"></a>data.PCA.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train) <span class="co"># prislusnost do trid</span></span></code></pre></div>
</details>
<p>V tomto konkrétním případě jsme za počet hlavních komponent vzali <span class="math inline">\(p\)</span> = 2, které dohromady vysvětlují 98.3 % variability v datech.
První hlavní komponenta potom vysvětluje 97.06 % a druhá 1.24 % variability.
Graficky si můžeme zobrazit hodnoty skórů prvních dvou hlavních komponent, barevně odlišených podle příslušnosti do klasifikační třídy.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="simulace2shift.html#cb354-1" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb354-2"><a href="simulace2shift.html#cb354-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb354-3"><a href="simulace2shift.html#cb354-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1. hlavní komponenta (vysvětlená variabilita&#39;</span>, </span>
<span id="cb354-4"><a href="simulace2shift.html#cb354-4" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb354-5"><a href="simulace2shift.html#cb354-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2. hlavní komponenta (&#39;</span>, </span>
<span id="cb354-6"><a href="simulace2shift.html#cb354-6" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb354-7"><a href="simulace2shift.html#cb354-7" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Group&#39;</span>) <span class="sc">+</span></span>
<span id="cb354-8"><a href="simulace2shift.html#cb354-8" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span></span>
<span id="cb354-9"><a href="simulace2shift.html#cb354-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-24"></span>
<img src="04-Simulace_2_shift_files/figure-html/unnamed-chunk-24-1.png" alt="Hodnoty skórů prvních dvou hlavních komponent pro trénovací data. Barevně jsou odlišeny body podle příslušnosti do klasifikační třídy." width="672" />
<p class="caption">
Obrázek 3.4: Hodnoty skórů prvních dvou hlavních komponent pro trénovací data. Barevně jsou odlišeny body podle příslušnosti do klasifikační třídy.
</p>
</div>
<p>Abychom mohli určit přesnost klasifikace na testovacích datech, potřebujeme spočítat skóre pro první 2 hlavní komponenty pro testovací data.
Tato skóre určíme pomocí vzorce:</p>
<p><span class="math display">\[
\xi_{i, j} = \int \left( X_i(t) - \mu(t)\right) \cdot \rho_j(t)\text dt,
\]</span> kde <span class="math inline">\(\mu(t)\)</span> je střední hodnota (průměrná funkce) a <span class="math inline">\(\rho_j(t)\)</span> vlastní fukce (funkcionální hlavní komponenty).</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="simulace2shift.html#cb355-1" tabindex="-1"></a><span class="co"># vypocet skoru testovacich funkci</span></span>
<span id="cb355-2"><a href="simulace2shift.html#cb355-2" tabindex="-1"></a>scores <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> nharm, <span class="at">nrow =</span> <span class="fu">length</span>(Y.test)) <span class="co"># prazdna matice </span></span>
<span id="cb355-3"><a href="simulace2shift.html#cb355-3" tabindex="-1"></a></span>
<span id="cb355-4"><a href="simulace2shift.html#cb355-4" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(scores)[<span class="dv">1</span>]) {</span>
<span id="cb355-5"><a href="simulace2shift.html#cb355-5" tabindex="-1"></a>  xfd <span class="ot">=</span> X.test[k] <span class="sc">-</span> data.PCA<span class="sc">$</span>meanfd[<span class="dv">1</span>] <span class="co"># k-te pozorovani - prumerna funkce</span></span>
<span id="cb355-6"><a href="simulace2shift.html#cb355-6" tabindex="-1"></a>  scores[k, ] <span class="ot">=</span> <span class="fu">inprod</span>(xfd, data.PCA<span class="sc">$</span>harmonics) </span>
<span id="cb355-7"><a href="simulace2shift.html#cb355-7" tabindex="-1"></a>  <span class="co"># skalarni soucin rezidua a vlastnich funkci rho (funkcionalni hlavni komponenty)</span></span>
<span id="cb355-8"><a href="simulace2shift.html#cb355-8" tabindex="-1"></a>}</span>
<span id="cb355-9"><a href="simulace2shift.html#cb355-9" tabindex="-1"></a></span>
<span id="cb355-10"><a href="simulace2shift.html#cb355-10" tabindex="-1"></a>data.PCA.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(scores)</span>
<span id="cb355-11"><a href="simulace2shift.html#cb355-11" tabindex="-1"></a>data.PCA.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb355-12"><a href="simulace2shift.html#cb355-12" tabindex="-1"></a><span class="fu">colnames</span>(data.PCA.test) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data.PCA.train) </span></code></pre></div>
</details>
<p>Nyní již můžeme sestrojit klasifikátor na trénovací části dat.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="simulace2shift.html#cb356-1" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb356-2"><a href="simulace2shift.html#cb356-2" tabindex="-1"></a>clf.LDA <span class="ot">&lt;-</span> <span class="fu">lda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb356-3"><a href="simulace2shift.html#cb356-3" tabindex="-1"></a></span>
<span id="cb356-4"><a href="simulace2shift.html#cb356-4" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb356-5"><a href="simulace2shift.html#cb356-5" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb356-6"><a href="simulace2shift.html#cb356-6" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb356-7"><a href="simulace2shift.html#cb356-7" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb356-8"><a href="simulace2shift.html#cb356-8" tabindex="-1"></a>  </span>
<span id="cb356-9"><a href="simulace2shift.html#cb356-9" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb356-10"><a href="simulace2shift.html#cb356-10" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb356-11"><a href="simulace2shift.html#cb356-11" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb356-12"><a href="simulace2shift.html#cb356-12" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Spočítali jsme jednak přesnost klasifikátoru na trénovacích (88.57 %), tak i na testovacích datech (85 %).</p>
<p>Pro grafické znázornění metody můžeme zaznačit dělící hranici do grafu skórů prvních dvou hlavních komponent.
Tuto hranici spočítáme na husté síti bodů a zobrazíme ji pomocí funkce <code>geom_contour()</code>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="simulace2shift.html#cb357-1" tabindex="-1"></a><span class="co"># pridame diskriminacni hranici</span></span>
<span id="cb357-2"><a href="simulace2shift.html#cb357-2" tabindex="-1"></a>np <span class="ot">&lt;-</span> <span class="dv">1001</span> <span class="co"># pocet bodu site</span></span>
<span id="cb357-3"><a href="simulace2shift.html#cb357-3" tabindex="-1"></a><span class="co"># x-ova osa ... 1. HK</span></span>
<span id="cb357-4"><a href="simulace2shift.html#cb357-4" tabindex="-1"></a>nd.x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(data.PCA.train<span class="sc">$</span>V1), </span>
<span id="cb357-5"><a href="simulace2shift.html#cb357-5" tabindex="-1"></a>            <span class="at">to =</span> <span class="fu">max</span>(data.PCA.train<span class="sc">$</span>V1), <span class="at">length.out =</span> np)</span>
<span id="cb357-6"><a href="simulace2shift.html#cb357-6" tabindex="-1"></a><span class="co"># y-ova osa ... 2. HK</span></span>
<span id="cb357-7"><a href="simulace2shift.html#cb357-7" tabindex="-1"></a>nd.y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(data.PCA.train<span class="sc">$</span>V2), </span>
<span id="cb357-8"><a href="simulace2shift.html#cb357-8" tabindex="-1"></a>            <span class="at">to =</span> <span class="fu">max</span>(data.PCA.train<span class="sc">$</span>V2), <span class="at">length.out =</span> np)</span>
<span id="cb357-9"><a href="simulace2shift.html#cb357-9" tabindex="-1"></a><span class="co"># pripad pro 2 HK ... p = 2</span></span>
<span id="cb357-10"><a href="simulace2shift.html#cb357-10" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y)</span>
<span id="cb357-11"><a href="simulace2shift.html#cb357-11" tabindex="-1"></a><span class="co"># pokud p = 3</span></span>
<span id="cb357-12"><a href="simulace2shift.html#cb357-12" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(data.PCA.train)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">4</span>) {</span>
<span id="cb357-13"><a href="simulace2shift.html#cb357-13" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y, <span class="at">V3 =</span> data.PCA.train<span class="sc">$</span>V3[<span class="dv">1</span>])}</span>
<span id="cb357-14"><a href="simulace2shift.html#cb357-14" tabindex="-1"></a><span class="co"># pokud p = 4</span></span>
<span id="cb357-15"><a href="simulace2shift.html#cb357-15" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(data.PCA.train)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">5</span>) {</span>
<span id="cb357-16"><a href="simulace2shift.html#cb357-16" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y, <span class="at">V3 =</span> data.PCA.train<span class="sc">$</span>V3[<span class="dv">1</span>],</span>
<span id="cb357-17"><a href="simulace2shift.html#cb357-17" tabindex="-1"></a>                    <span class="at">V4 =</span> data.PCA.train<span class="sc">$</span>V4[<span class="dv">1</span>])}</span>
<span id="cb357-18"><a href="simulace2shift.html#cb357-18" tabindex="-1"></a><span class="co"># pokud p = 5</span></span>
<span id="cb357-19"><a href="simulace2shift.html#cb357-19" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(data.PCA.train)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">6</span>) {</span>
<span id="cb357-20"><a href="simulace2shift.html#cb357-20" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y, <span class="at">V3 =</span> data.PCA.train<span class="sc">$</span>V3[<span class="dv">1</span>],</span>
<span id="cb357-21"><a href="simulace2shift.html#cb357-21" tabindex="-1"></a>                    <span class="at">V4 =</span> data.PCA.train<span class="sc">$</span>V4[<span class="dv">1</span>], <span class="at">V5 =</span> data.PCA.train<span class="sc">$</span>V5[<span class="dv">1</span>])}</span>
<span id="cb357-22"><a href="simulace2shift.html#cb357-22" tabindex="-1"></a></span>
<span id="cb357-23"><a href="simulace2shift.html#cb357-23" tabindex="-1"></a><span class="co"># pridame Y = 0, 1</span></span>
<span id="cb357-24"><a href="simulace2shift.html#cb357-24" tabindex="-1"></a>nd <span class="ot">&lt;-</span> nd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">prd =</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> nd)<span class="sc">$</span>class))</span>
<span id="cb357-25"><a href="simulace2shift.html#cb357-25" tabindex="-1"></a></span>
<span id="cb357-26"><a href="simulace2shift.html#cb357-26" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb357-27"><a href="simulace2shift.html#cb357-27" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb357-28"><a href="simulace2shift.html#cb357-28" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1. hlavní komponenta (vysvětlená variabilita&#39;</span>, </span>
<span id="cb357-29"><a href="simulace2shift.html#cb357-29" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb357-30"><a href="simulace2shift.html#cb357-30" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2. hlavní komponenta (&#39;</span>, </span>
<span id="cb357-31"><a href="simulace2shift.html#cb357-31" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb357-32"><a href="simulace2shift.html#cb357-32" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Group&#39;</span>) <span class="sc">+</span></span>
<span id="cb357-33"><a href="simulace2shift.html#cb357-33" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span></span>
<span id="cb357-34"><a href="simulace2shift.html#cb357-34" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb357-35"><a href="simulace2shift.html#cb357-35" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-27"></span>
<img src="04-Simulace_2_shift_files/figure-html/unnamed-chunk-27-1.png" alt="Skóre prvních dvou hlavních komponent, barevně odlišené podle příslušnosti do klasifikační třídy. Černě je vyznačena dělící hranice (přímka v rovině prvních dvou hlavních komponent) mezi třídami sestrojená pomocí LDA." width="672" />
<p class="caption">
Obrázek 3.5: Skóre prvních dvou hlavních komponent, barevně odlišené podle příslušnosti do klasifikační třídy. Černě je vyznačena dělící hranice (přímka v rovině prvních dvou hlavních komponent) mezi třídami sestrojená pomocí LDA.
</p>
</div>
<p>Vidíme, že dělící hranicí je přímka, lineární funkce v prostoru 2D, což jsme ostatně od LDA čekali.
Nakonec přidáme chybovosti do souhrnné tabulky.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="simulace2shift.html#cb358-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LDA&#39;</span>, </span>
<span id="cb358-2"><a href="simulace2shift.html#cb358-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb358-3"><a href="simulace2shift.html#cb358-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb358-4"><a href="simulace2shift.html#cb358-4" tabindex="-1"></a></span>
<span id="cb358-5"><a href="simulace2shift.html#cb358-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="kvadratická-diskriminační-analýza-3" class="section level3 hasAnchor" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> Kvadratická diskriminační analýza<a href="simulace2shift.html#kvadratická-diskriminační-analýza-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Jako další sestrojme klasifikátor pomocí kvadratické diskriminační analýzy (QDA).
Jedná se o analogický případ jako LDA s tím rozdílem, že nyní připouštíme pro každou ze tříd rozdílnou kovarianční matici normálního rozdělení, ze kterého pocházejí příslušné skóry.
Tento vypuštěný předpoklad o rovnosti kovariančních matic vede ke kvadratické hranici mezi třídami.</p>
<p>V <code>R</code> se provede QDA analogicky jako LDA v předchozí části, tedy opět bychom pomocí funkcionální analýzy hlavních komponent spočítali skóre pro trénovací i testovací funkce, sestrojili klasifikátor na skórech prvních <span class="math inline">\(p\)</span> hlavních komponent a pomocí něj predikovali příslušnost testovacích křivek do třídy <span class="math inline">\(Y^* \in \{0, 1\}\)</span>.</p>
<p>Funkcionální PCA provádět nemusíme, využijeme výsledků z části LDA.</p>
<p>Můžeme tedy rovnou přistoupit k sestrojení klasifikátoru, což provedeme pomocí funkce <code>qda()</code>.
Následně spočítáme přesnost klasifikátoru na testovacích a trénovacích datech.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="simulace2shift.html#cb359-1" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb359-2"><a href="simulace2shift.html#cb359-2" tabindex="-1"></a>clf.QDA <span class="ot">&lt;-</span> <span class="fu">qda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb359-3"><a href="simulace2shift.html#cb359-3" tabindex="-1"></a></span>
<span id="cb359-4"><a href="simulace2shift.html#cb359-4" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb359-5"><a href="simulace2shift.html#cb359-5" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb359-6"><a href="simulace2shift.html#cb359-6" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb359-7"><a href="simulace2shift.html#cb359-7" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb359-8"><a href="simulace2shift.html#cb359-8" tabindex="-1"></a>  </span>
<span id="cb359-9"><a href="simulace2shift.html#cb359-9" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb359-10"><a href="simulace2shift.html#cb359-10" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb359-11"><a href="simulace2shift.html#cb359-11" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb359-12"><a href="simulace2shift.html#cb359-12" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Spočítali jsme tedy jednak přesnost klasifikátoru na trénovacích (87.14 %), tak i na testovacích datech (85 %).</p>
<p>Pro grafické znázornění metody můžeme zaznačit dělící hranici do grafu skórů prvních dvou hlavních komponent.
Tuto hranici spočítáme na husté síti bodů a zobrazíme ji pomocí funkce <code>geom_contour()</code> stejně jako v případě LDA.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="simulace2shift.html#cb360-1" tabindex="-1"></a>nd <span class="ot">&lt;-</span> nd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">prd =</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> nd)<span class="sc">$</span>class))</span>
<span id="cb360-2"><a href="simulace2shift.html#cb360-2" tabindex="-1"></a></span>
<span id="cb360-3"><a href="simulace2shift.html#cb360-3" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb360-4"><a href="simulace2shift.html#cb360-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb360-5"><a href="simulace2shift.html#cb360-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1. hlavní komponenta (vysvětlená variabilita&#39;</span>, </span>
<span id="cb360-6"><a href="simulace2shift.html#cb360-6" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb360-7"><a href="simulace2shift.html#cb360-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2. hlavní komponenta (&#39;</span>, </span>
<span id="cb360-8"><a href="simulace2shift.html#cb360-8" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb360-9"><a href="simulace2shift.html#cb360-9" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Group&#39;</span>) <span class="sc">+</span></span>
<span id="cb360-10"><a href="simulace2shift.html#cb360-10" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span></span>
<span id="cb360-11"><a href="simulace2shift.html#cb360-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb360-12"><a href="simulace2shift.html#cb360-12" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-33"></span>
<img src="04-Simulace_2_shift_files/figure-html/unnamed-chunk-33-1.png" alt="Skóre prvních dvou hlavních komponent, barevně odlišené podle příslušnosti do klasifikační třídy. Černě je vyznačena dělící hranice (parabola v rovině prvních dvou hlavních komponent) mezi třídami sestrojená pomocí QDA." width="672" />
<p class="caption">
Obrázek 3.6: Skóre prvních dvou hlavních komponent, barevně odlišené podle příslušnosti do klasifikační třídy. Černě je vyznačena dělící hranice (parabola v rovině prvních dvou hlavních komponent) mezi třídami sestrojená pomocí QDA.
</p>
</div>
<p>Všimněme si, že dělící hranicí mezi klasifikačními třídami je nyní parabola.</p>
<p>Nakonec ještě doplníme chybovosti do souhrnné tabulky.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="simulace2shift.html#cb361-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;QDA&#39;</span>, </span>
<span id="cb361-2"><a href="simulace2shift.html#cb361-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb361-3"><a href="simulace2shift.html#cb361-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb361-4"><a href="simulace2shift.html#cb361-4" tabindex="-1"></a></span>
<span id="cb361-5"><a href="simulace2shift.html#cb361-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="support-vector-machines-3" class="section level3 hasAnchor" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> Support Vector Machines<a href="simulace2shift.html#support-vector-machines-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Definujeme pro další metody data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="simulace2shift.html#cb362-1" tabindex="-1"></a><span class="co"># posloupnost bodu, ve kterych funkce vyhodnotime</span></span>
<span id="cb362-2"><a href="simulace2shift.html#cb362-2" tabindex="-1"></a>t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">12</span>, <span class="at">length =</span> <span class="dv">101</span>)</span>
<span id="cb362-3"><a href="simulace2shift.html#cb362-3" tabindex="-1"></a>   </span>
<span id="cb362-4"><a href="simulace2shift.html#cb362-4" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb362-5"><a href="simulace2shift.html#cb362-5" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) <span class="co"># transpozice kvuli funkcim v radku</span></span>
<span id="cb362-6"><a href="simulace2shift.html#cb362-6" tabindex="-1"></a>grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb362-7"><a href="simulace2shift.html#cb362-7" tabindex="-1"></a></span>
<span id="cb362-8"><a href="simulace2shift.html#cb362-8" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb362-9"><a href="simulace2shift.html#cb362-9" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb362-10"><a href="simulace2shift.html#cb362-10" tabindex="-1"></a>grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span></code></pre></div>
</details>
<p>Nejprve si definujme potřebné datové soubory s koeficienty.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="simulace2shift.html#cb363-1" tabindex="-1"></a><span class="co"># trenovaci dataset</span></span>
<span id="cb363-2"><a href="simulace2shift.html#cb363-2" tabindex="-1"></a>data.Bbasis.train <span class="ot">&lt;-</span> <span class="fu">t</span>(X.train<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb363-3"><a href="simulace2shift.html#cb363-3" tabindex="-1"></a>data.Bbasis.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb363-4"><a href="simulace2shift.html#cb363-4" tabindex="-1"></a></span>
<span id="cb363-5"><a href="simulace2shift.html#cb363-5" tabindex="-1"></a><span class="co"># testovaci dataset</span></span>
<span id="cb363-6"><a href="simulace2shift.html#cb363-6" tabindex="-1"></a>data.Bbasis.test <span class="ot">&lt;-</span> <span class="fu">t</span>(X.test<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb363-7"><a href="simulace2shift.html#cb363-7" tabindex="-1"></a>data.Bbasis.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span></code></pre></div>
</details>
<p>Nyní se podívejme na klasifikaci našich nasimulovaných křivek pomocí metody podpůrných vektorů (ang. Support Vector Machines, SVM).
Výhodou této klasifikační metody je její výpočetní nenáročnost, neboť pro definici hraniční křivky mezi třídami využívá pouze několik (často málo) pozorování.</p>
<p>Hlavní výhodou SVM je použití tzv.
<em>jádrového triku</em> (kernel trick), pomocí kterého nahradíme obyčejný skalární součin jiným skalárním součinem transformovaných dat, aniž bychom tuto transformaci museli přímo definovat.
Tím dostaneme obecně nelineární dělící hranici mezi klasifikačními třídami.
<em>Jádro</em> (jádrová funkce, ang. kernel, kernel function) <span class="math inline">\(K\)</span> je taková funkce, která splňuje</p>
<p><span class="math display">\[
K(x_i, x_j) = \langle \phi(x_i), \phi(x_j) \rangle_{\mathcal H},
\]</span> kde <span class="math inline">\(\phi\)</span> je nějaká (neznámá) transformace (ang. feature map), <span class="math inline">\(\mathcal H\)</span> je Hilbertův prostor a <span class="math inline">\(\langle \cdot, \cdot \rangle_{\mathcal H}\)</span> je nějaký skalární součin na tomto Hilbertově prostoru.</p>
<p>Nejčastěji se v praxi volí tři typy jádrových funkcí:</p>
<ul>
<li>lineární jádro – <span class="math inline">\(K(x_i, x_j) = \langle x_i, x_j \rangle\)</span>,</li>
<li>polynomiální jádro – <span class="math inline">\(K(x_i, x_j) = \big(\alpha_0 + \gamma \langle x_i, x_j \rangle \big)^d\)</span>,</li>
<li>radiální (gaussovské) jádro – <span class="math inline">\(\displaystyle{K(x_i, x_j) = \text e^{-\gamma \|x_i - x_j \|^2}}\)</span>.</li>
</ul>
<p>U všech výše zmíněných jader musíme zvolit konstantu <span class="math inline">\(C &gt; 0\)</span>, která udává míru penalizace za překročení dělící hranice mezi třídami (ang. inverse regularization parameter).
S rostoucí hodnotou <span class="math inline">\(C\)</span> bude metoda více penalizovat špatně klasifikovaná data a méně tvar hranice, naopak pro malé hodnoty <span class="math inline">\(C\)</span> metoda nedává takový význam špatně klasifikovaným datům, ale zaměřuje se více na penalizaci tvaru hranice.
Tato konstanta <span class="math inline">\(C\)</span> se defaultně volí rovna 1, můžeme ji určit i přímo například pomocí cross-validace.</p>
<p>Využitím cross-validace můžeme také určit optimální hodnoty ostatních hyperparametrů, které nyní závisí na naší volbě jádrové funkce.
V případě lineárního jádra nevolíme žádný další parametr kromě konstanty <span class="math inline">\(C\)</span>, u polynomiálního jádra musíme určit hodnoty hyperparametrů <span class="math inline">\(\alpha_0, \gamma \text{ a } d\)</span>, jejichž defaultní hodnoty v <code>R</code> jsou postupně <span class="math inline">\(\alpha_0^{default} = 0, \gamma^{default} = \frac{1}{dim(\texttt{data})} \text{ a } d^{default} = 3\)</span>.
Při volbě radiálního jádra máme pouze jeden další hyperparametr <span class="math inline">\(\gamma\)</span>, jehož defaultní hodnota v <code>R</code> je totožná jako u polynomiálního jádra.
Opět bychom mohli hodnoty hyperparametrů určit jako optimální pro naše data, avšak vzhledem k relativní výpočetní náročnosti necháme hodnoty příslušných hyperparametrů na jejich defaultních hodnotách.</p>
<p>V případě funkcionálních dat máme několik možností, jak použít metodu SVM.
Nejjednodušší variantou je použít tuto klasifikační metodu přímo na diskretizovanou funkci (sekce <a href="simulace2.html#diskr2">2.3.7.1</a>).
Další možností je opět využít skóre hlavních komponent a klasifikovat křivky pomocí jejich reprezentace <a href="simulace2.html#PCA-SVM2">2.3.7.2</a>.
Další přímočarou variantou je využít vyjádření křivek pomocí Fourierovy báze a klasifikovat křivky na základě koeficientů jejich vyjádření v této bázi (sekce <a href="simulace2.html#basis-SVM2">2.3.7.3</a>).</p>
<p>Složitější úvahou můžeme dospět k několika dalším možnostem, které využívají funkcionální podstatu dat.
Jednak můžeme místo klasifikace původní křivky využít její derivaci (případně druhou derivaci, třetí, …), druhak můžeme využít projekce funkcí na podprostor generovaný, např. B-splinovými nebo Fourierovými, funkcemi (sekce <a href="simulace2.html#projection-SVM2">2.3.7.4</a>). Poslední metoda, kterou použijeme pro klasifikaci funkcionálních dat, spočívá v kombinaci projekce na určitý podprostor generovaný funkcemi (Reproducing Kernel Hilbert Space, RKHS) a klasifikace příslušné reprezentace. Tato metoda využívá kromě klasického SVM i SVM pro regresi, více uvádíme v sekci RKHS + SVM <a href="simulace2.html#RKHS-SVM2">2.3.7.5</a>.</p>
<div id="diskretizace-intervalu-5" class="section level4 hasAnchor" number="4.3.4.1">
<h4><span class="header-section-number">4.3.4.1</span> Diskretizace intervalu<a href="simulace2shift.html#diskretizace-intervalu-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Začněme nejprve aplikací metody podpůrných vektorů přímo na diskretizovaná data (vyhodnocení funkce na dané síti bodů na intervalu <span class="math inline">\(I = [0, 1]\)</span>), přičemž budeme uvažovat všech tři výše zmíněné jádrové funkce.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="simulace2shift.html#cb364-1" tabindex="-1"></a><span class="co"># sestrojeni modelu</span></span>
<span id="cb364-2"><a href="simulace2shift.html#cb364-2" tabindex="-1"></a>clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb364-3"><a href="simulace2shift.html#cb364-3" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb364-4"><a href="simulace2shift.html#cb364-4" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb364-5"><a href="simulace2shift.html#cb364-5" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb364-6"><a href="simulace2shift.html#cb364-6" tabindex="-1"></a></span>
<span id="cb364-7"><a href="simulace2shift.html#cb364-7" tabindex="-1"></a>clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb364-8"><a href="simulace2shift.html#cb364-8" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb364-9"><a href="simulace2shift.html#cb364-9" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb364-10"><a href="simulace2shift.html#cb364-10" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb364-11"><a href="simulace2shift.html#cb364-11" tabindex="-1"></a></span>
<span id="cb364-12"><a href="simulace2shift.html#cb364-12" tabindex="-1"></a>clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb364-13"><a href="simulace2shift.html#cb364-13" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb364-14"><a href="simulace2shift.html#cb364-14" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb364-15"><a href="simulace2shift.html#cb364-15" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb364-16"><a href="simulace2shift.html#cb364-16" tabindex="-1"></a></span>
<span id="cb364-17"><a href="simulace2shift.html#cb364-17" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb364-18"><a href="simulace2shift.html#cb364-18" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data)</span>
<span id="cb364-19"><a href="simulace2shift.html#cb364-19" tabindex="-1"></a>presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb364-20"><a href="simulace2shift.html#cb364-20" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb364-21"><a href="simulace2shift.html#cb364-21" tabindex="-1"></a></span>
<span id="cb364-22"><a href="simulace2shift.html#cb364-22" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data)</span>
<span id="cb364-23"><a href="simulace2shift.html#cb364-23" tabindex="-1"></a>presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb364-24"><a href="simulace2shift.html#cb364-24" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb364-25"><a href="simulace2shift.html#cb364-25" tabindex="-1"></a></span>
<span id="cb364-26"><a href="simulace2shift.html#cb364-26" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data)</span>
<span id="cb364-27"><a href="simulace2shift.html#cb364-27" tabindex="-1"></a>presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb364-28"><a href="simulace2shift.html#cb364-28" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb364-29"><a href="simulace2shift.html#cb364-29" tabindex="-1"></a></span>
<span id="cb364-30"><a href="simulace2shift.html#cb364-30" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb364-31"><a href="simulace2shift.html#cb364-31" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb364-32"><a href="simulace2shift.html#cb364-32" tabindex="-1"></a>presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb364-33"><a href="simulace2shift.html#cb364-33" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb364-34"><a href="simulace2shift.html#cb364-34" tabindex="-1"></a></span>
<span id="cb364-35"><a href="simulace2shift.html#cb364-35" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb364-36"><a href="simulace2shift.html#cb364-36" tabindex="-1"></a>presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb364-37"><a href="simulace2shift.html#cb364-37" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb364-38"><a href="simulace2shift.html#cb364-38" tabindex="-1"></a></span>
<span id="cb364-39"><a href="simulace2shift.html#cb364-39" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb364-40"><a href="simulace2shift.html#cb364-40" tabindex="-1"></a>presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb364-41"><a href="simulace2shift.html#cb364-41" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Přesnost metody SVM na trénovacích datech je tedy 91.43 % pro lineární jádro, 67.86 % pro polynomiální jádro a 87.14 % pro gaussovské jádro.
Na testovacích datech je potom přesnost metody 88.33 % pro lineární jádro, 70 % pro polynomiální jádro a 75 % pro radiální jádro.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="simulace2shift.html#cb365-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - diskr&#39;</span>, </span>
<span id="cb365-2"><a href="simulace2shift.html#cb365-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - diskr&#39;</span>, </span>
<span id="cb365-3"><a href="simulace2shift.html#cb365-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - diskr&#39;</span>), </span>
<span id="cb365-4"><a href="simulace2shift.html#cb365-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb365-5"><a href="simulace2shift.html#cb365-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb365-6"><a href="simulace2shift.html#cb365-6" tabindex="-1"></a></span>
<span id="cb365-7"><a href="simulace2shift.html#cb365-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="skóre-hlavních-komponent-5" class="section level4 hasAnchor" number="4.3.4.2">
<h4><span class="header-section-number">4.3.4.2</span> Skóre hlavních komponent<a href="simulace2shift.html#skóre-hlavních-komponent-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>V tomto případě využijeme skóre prvních <span class="math inline">\(p =\)</span> 2 hlavních komponent.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="simulace2shift.html#cb366-1" tabindex="-1"></a><span class="co"># sestrojeni modelu</span></span>
<span id="cb366-2"><a href="simulace2shift.html#cb366-2" tabindex="-1"></a>clf.SVM.l.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb366-3"><a href="simulace2shift.html#cb366-3" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb366-4"><a href="simulace2shift.html#cb366-4" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb366-5"><a href="simulace2shift.html#cb366-5" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb366-6"><a href="simulace2shift.html#cb366-6" tabindex="-1"></a></span>
<span id="cb366-7"><a href="simulace2shift.html#cb366-7" tabindex="-1"></a>clf.SVM.p.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb366-8"><a href="simulace2shift.html#cb366-8" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb366-9"><a href="simulace2shift.html#cb366-9" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb366-10"><a href="simulace2shift.html#cb366-10" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb366-11"><a href="simulace2shift.html#cb366-11" tabindex="-1"></a></span>
<span id="cb366-12"><a href="simulace2shift.html#cb366-12" tabindex="-1"></a>clf.SVM.r.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb366-13"><a href="simulace2shift.html#cb366-13" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb366-14"><a href="simulace2shift.html#cb366-14" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb366-15"><a href="simulace2shift.html#cb366-15" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb366-16"><a href="simulace2shift.html#cb366-16" tabindex="-1"></a></span>
<span id="cb366-17"><a href="simulace2shift.html#cb366-17" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb366-18"><a href="simulace2shift.html#cb366-18" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb366-19"><a href="simulace2shift.html#cb366-19" tabindex="-1"></a>presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb366-20"><a href="simulace2shift.html#cb366-20" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb366-21"><a href="simulace2shift.html#cb366-21" tabindex="-1"></a></span>
<span id="cb366-22"><a href="simulace2shift.html#cb366-22" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb366-23"><a href="simulace2shift.html#cb366-23" tabindex="-1"></a>presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb366-24"><a href="simulace2shift.html#cb366-24" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb366-25"><a href="simulace2shift.html#cb366-25" tabindex="-1"></a></span>
<span id="cb366-26"><a href="simulace2shift.html#cb366-26" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb366-27"><a href="simulace2shift.html#cb366-27" tabindex="-1"></a>presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb366-28"><a href="simulace2shift.html#cb366-28" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb366-29"><a href="simulace2shift.html#cb366-29" tabindex="-1"></a>  </span>
<span id="cb366-30"><a href="simulace2shift.html#cb366-30" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb366-31"><a href="simulace2shift.html#cb366-31" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb366-32"><a href="simulace2shift.html#cb366-32" tabindex="-1"></a>presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb366-33"><a href="simulace2shift.html#cb366-33" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb366-34"><a href="simulace2shift.html#cb366-34" tabindex="-1"></a></span>
<span id="cb366-35"><a href="simulace2shift.html#cb366-35" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb366-36"><a href="simulace2shift.html#cb366-36" tabindex="-1"></a>presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb366-37"><a href="simulace2shift.html#cb366-37" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb366-38"><a href="simulace2shift.html#cb366-38" tabindex="-1"></a></span>
<span id="cb366-39"><a href="simulace2shift.html#cb366-39" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb366-40"><a href="simulace2shift.html#cb366-40" tabindex="-1"></a>presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb366-41"><a href="simulace2shift.html#cb366-41" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Přesnost metody SVM aplikované na skóre hlavních komponent na trénovacích datech je tedy 88.57 % pro lineární jádro, 83.57 % pro polynomiální jádro a 87.86 % pro gaussovské jádro.
Na testovacích datech je potom přesnost metody 81.67 % pro lineární jádro, 83.33 % pro polynomiální jádro a 81.67 % pro radiální jádro.</p>
<p>Pro grafické znázornění metody můžeme zaznačit dělící hranici do grafu skórů prvních dvou hlavních komponent.
Tuto hranici spočítáme na husté síti bodů a zobrazíme ji pomocí funkce <code>geom_contour()</code> stejně jako v předchozích případech, kdy jsme také vykreslovali klasifikační hranici.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="simulace2shift.html#cb367-1" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">rbind</span>(nd, nd, nd) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb367-2"><a href="simulace2shift.html#cb367-2" tabindex="-1"></a>   <span class="at">prd =</span> <span class="fu">c</span>(<span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)),</span>
<span id="cb367-3"><a href="simulace2shift.html#cb367-3" tabindex="-1"></a>           <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)),</span>
<span id="cb367-4"><a href="simulace2shift.html#cb367-4" tabindex="-1"></a>           <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>))),</span>
<span id="cb367-5"><a href="simulace2shift.html#cb367-5" tabindex="-1"></a>   <span class="at">kernel =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>),</span>
<span id="cb367-6"><a href="simulace2shift.html#cb367-6" tabindex="-1"></a>                <span class="at">each =</span> <span class="fu">length</span>(<span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.l.PCA, </span>
<span id="cb367-7"><a href="simulace2shift.html#cb367-7" tabindex="-1"></a>                                                 <span class="at">newdata =</span> nd,</span>
<span id="cb367-8"><a href="simulace2shift.html#cb367-8" tabindex="-1"></a>                                                 <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)))))</span>
<span id="cb367-9"><a href="simulace2shift.html#cb367-9" tabindex="-1"></a></span>
<span id="cb367-10"><a href="simulace2shift.html#cb367-10" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb367-11"><a href="simulace2shift.html#cb367-11" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb367-12"><a href="simulace2shift.html#cb367-12" tabindex="-1"></a> <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1. hlavní komponenta (vysvětlená variabilita&#39;</span>, </span>
<span id="cb367-13"><a href="simulace2shift.html#cb367-13" tabindex="-1"></a>                <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb367-14"><a href="simulace2shift.html#cb367-14" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2. hlavní komponenta (&#39;</span>, </span>
<span id="cb367-15"><a href="simulace2shift.html#cb367-15" tabindex="-1"></a>                <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb367-16"><a href="simulace2shift.html#cb367-16" tabindex="-1"></a>      <span class="at">colour =</span> <span class="st">&#39;Group&#39;</span>, </span>
<span id="cb367-17"><a href="simulace2shift.html#cb367-17" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="st">&#39;Kernel type&#39;</span>) <span class="sc">+</span></span>
<span id="cb367-18"><a href="simulace2shift.html#cb367-18" tabindex="-1"></a> <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span></span>
<span id="cb367-19"><a href="simulace2shift.html#cb367-19" tabindex="-1"></a> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb367-20"><a href="simulace2shift.html#cb367-20" tabindex="-1"></a> <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd, <span class="at">linetype =</span> kernel), </span>
<span id="cb367-21"><a href="simulace2shift.html#cb367-21" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb367-22"><a href="simulace2shift.html#cb367-22" tabindex="-1"></a> <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd, <span class="at">linetype =</span> kernel),</span>
<span id="cb367-23"><a href="simulace2shift.html#cb367-23" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb367-24"><a href="simulace2shift.html#cb367-24" tabindex="-1"></a> <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd, <span class="at">linetype =</span> kernel),</span>
<span id="cb367-25"><a href="simulace2shift.html#cb367-25" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-43"></span>
<img src="04-Simulace_2_shift_files/figure-html/unnamed-chunk-43-1.png" alt="Skóre prvních dvou hlavních komponent, barevně odlišené podle příslušnosti do klasifikační třídy. Černě je vyznačena dělící hranice (přímka, resp. křivky v rovině prvních dvou hlavních komponent) mezi třídami sestrojená pomocí metody SVM." width="672" />
<p class="caption">
Obrázek 3.7: Skóre prvních dvou hlavních komponent, barevně odlišené podle příslušnosti do klasifikační třídy. Černě je vyznačena dělící hranice (přímka, resp. křivky v rovině prvních dvou hlavních komponent) mezi třídami sestrojená pomocí metody SVM.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="simulace2shift.html#cb368-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - PCA&#39;</span>, </span>
<span id="cb368-2"><a href="simulace2shift.html#cb368-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - PCA&#39;</span>, </span>
<span id="cb368-3"><a href="simulace2shift.html#cb368-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - PCA&#39;</span>), </span>
<span id="cb368-4"><a href="simulace2shift.html#cb368-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb368-5"><a href="simulace2shift.html#cb368-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb368-6"><a href="simulace2shift.html#cb368-6" tabindex="-1"></a></span>
<span id="cb368-7"><a href="simulace2shift.html#cb368-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="bázové-koeficienty-5" class="section level4 hasAnchor" number="4.3.4.3">
<h4><span class="header-section-number">4.3.4.3</span> Bázové koeficienty<a href="simulace2shift.html#bázové-koeficienty-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Nakonec použijeme vyjádření funkcí pomocí Fourierovy báze.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="simulace2shift.html#cb369-1" tabindex="-1"></a><span class="co"># sestrojeni modelu</span></span>
<span id="cb369-2"><a href="simulace2shift.html#cb369-2" tabindex="-1"></a>clf.SVM.l.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb369-3"><a href="simulace2shift.html#cb369-3" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb369-4"><a href="simulace2shift.html#cb369-4" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb369-5"><a href="simulace2shift.html#cb369-5" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb369-6"><a href="simulace2shift.html#cb369-6" tabindex="-1"></a></span>
<span id="cb369-7"><a href="simulace2shift.html#cb369-7" tabindex="-1"></a>clf.SVM.p.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb369-8"><a href="simulace2shift.html#cb369-8" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb369-9"><a href="simulace2shift.html#cb369-9" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb369-10"><a href="simulace2shift.html#cb369-10" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb369-11"><a href="simulace2shift.html#cb369-11" tabindex="-1"></a></span>
<span id="cb369-12"><a href="simulace2shift.html#cb369-12" tabindex="-1"></a>clf.SVM.r.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb369-13"><a href="simulace2shift.html#cb369-13" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb369-14"><a href="simulace2shift.html#cb369-14" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb369-15"><a href="simulace2shift.html#cb369-15" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb369-16"><a href="simulace2shift.html#cb369-16" tabindex="-1"></a></span>
<span id="cb369-17"><a href="simulace2shift.html#cb369-17" tabindex="-1"></a><span class="co"># presnost na trenovacich datech</span></span>
<span id="cb369-18"><a href="simulace2shift.html#cb369-18" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb369-19"><a href="simulace2shift.html#cb369-19" tabindex="-1"></a>presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb369-20"><a href="simulace2shift.html#cb369-20" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb369-21"><a href="simulace2shift.html#cb369-21" tabindex="-1"></a></span>
<span id="cb369-22"><a href="simulace2shift.html#cb369-22" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb369-23"><a href="simulace2shift.html#cb369-23" tabindex="-1"></a>presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb369-24"><a href="simulace2shift.html#cb369-24" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb369-25"><a href="simulace2shift.html#cb369-25" tabindex="-1"></a></span>
<span id="cb369-26"><a href="simulace2shift.html#cb369-26" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb369-27"><a href="simulace2shift.html#cb369-27" tabindex="-1"></a>presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb369-28"><a href="simulace2shift.html#cb369-28" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb369-29"><a href="simulace2shift.html#cb369-29" tabindex="-1"></a>  </span>
<span id="cb369-30"><a href="simulace2shift.html#cb369-30" tabindex="-1"></a><span class="co"># presnost na testovacich datech</span></span>
<span id="cb369-31"><a href="simulace2shift.html#cb369-31" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb369-32"><a href="simulace2shift.html#cb369-32" tabindex="-1"></a>presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb369-33"><a href="simulace2shift.html#cb369-33" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb369-34"><a href="simulace2shift.html#cb369-34" tabindex="-1"></a></span>
<span id="cb369-35"><a href="simulace2shift.html#cb369-35" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb369-36"><a href="simulace2shift.html#cb369-36" tabindex="-1"></a>presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb369-37"><a href="simulace2shift.html#cb369-37" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb369-38"><a href="simulace2shift.html#cb369-38" tabindex="-1"></a></span>
<span id="cb369-39"><a href="simulace2shift.html#cb369-39" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb369-40"><a href="simulace2shift.html#cb369-40" tabindex="-1"></a>presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb369-41"><a href="simulace2shift.html#cb369-41" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Přesnost metody SVM aplikované na bázové koeficienty na trénovacích datech je tedy 100 % pro lineární jádro, 100 % pro polynomiální jádro a 100 % pro gaussovské jádro.
Na testovacích datech je potom přesnost metody 86.67 % pro lineární jádro, 75 % pro polynomiální jádro a 73.33 % pro radiální jádro.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="simulace2shift.html#cb370-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - Fbasis&#39;</span>, </span>
<span id="cb370-2"><a href="simulace2shift.html#cb370-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - Fbasis&#39;</span>, </span>
<span id="cb370-3"><a href="simulace2shift.html#cb370-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - Fbasis&#39;</span>), </span>
<span id="cb370-4"><a href="simulace2shift.html#cb370-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb370-5"><a href="simulace2shift.html#cb370-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb370-6"><a href="simulace2shift.html#cb370-6" tabindex="-1"></a></span>
<span id="cb370-7"><a href="simulace2shift.html#cb370-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="projekce-na-fourierovu-bázi-1" class="section level4 hasAnchor" number="4.3.4.4">
<h4><span class="header-section-number">4.3.4.4</span> Projekce na Fourierovu bázi<a href="simulace2shift.html#projekce-na-fourierovu-bázi-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Další možností, jak použít klasickou metodu SVM pro funkcionální data, je projektovat původní data na nějaký <span class="math inline">\(d\)</span>-dimenzionální podprostor našeho Hilbertova prostoru <span class="math inline">\(\mathcal H\)</span>, označme jej <span class="math inline">\(V_d\)</span>.
Předpokládejme, že tento podprostor <span class="math inline">\(V_d\)</span> má ortonormální bázi <span class="math inline">\(\{\Psi_j\}_{j = 1, \dots, d}\)</span>.
Definujeme transformaci <span class="math inline">\(P_{V_d}\)</span> jakožto ortogonální projekci na podprostor <span class="math inline">\(V_d\)</span>, tedy můžeme psát</p>
<p><span class="math display">\[
P_{V_d} (x) = \sum_{j = 1}^d \langle x, \Psi_j \rangle \Psi_j.
\]</span></p>
<p>Nyní můžeme pro klasifikaci použít koeficienty z ortogonální projekce, tedy aplikujeme standardní SVM na vektory <span class="math inline">\(\left( \langle x, \Psi_1 \rangle, \dots, \langle x, \Psi_d \rangle\right)^\top\)</span>.
Využitím této transformace jsme tedy definovali nové, tzv.
adaptované jádro, které je složené z ortogonální projekce <span class="math inline">\(P_{V_d}\)</span> a jádrové funkce standardní metody podpůrných vektorů.
Máme tedy (adaptované) jádro <span class="math inline">\(Q(x_i, x_j) = K(P_{V_d}(x_i), P_{V_d}(x_j))\)</span>.
Jde tedy o metodu redukce dimenze, kterou můžeme nazvat <em>filtrace</em>.</p>
<p>Pro samotnou projekci použijeme v <code>R</code> funkci <code>project.basis()</code> z knihovny <code>fda</code>.
Na jejím vstupu bude matice původních diskrétních (nevyhlazených) dat, hodnoty, ve kterých měříme hodnoty v matici původních dat a bázový objekt, na který chceme data projektovat.
My zvolíme projekci na Fourierovu bázi, protože využití B-splinové báze není pro naše periodická data vhodné.
Další možností je využít <em>wavelet basis</em>.</p>
<p>Dimenzi <span class="math inline">\(d\)</span> volíme buď z nějaké předchozí expertní znalosti, nebo pomocí cross-validace.
V našem případě určíme optimální dimenzi podprostoru <span class="math inline">\(V_d\)</span> pomocí <span class="math inline">\(k\)</span>-násobné cross-validace (volíme <span class="math inline">\(k \ll n\)</span> kvůli výpočetní náročnosti metody, často se volí <span class="math inline">\(k = 5\)</span> nebo <span class="math inline">\(k = 10\)</span>).</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="simulace2shift.html#cb371-1" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb371-2"><a href="simulace2shift.html#cb371-2" tabindex="-1"></a></span>
<span id="cb371-3"><a href="simulace2shift.html#cb371-3" tabindex="-1"></a><span class="co"># hodnoty pro Fourierovu bazi</span></span>
<span id="cb371-4"><a href="simulace2shift.html#cb371-4" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb371-5"><a href="simulace2shift.html#cb371-5" tabindex="-1"></a>n_basis_min <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb371-6"><a href="simulace2shift.html#cb371-6" tabindex="-1"></a>n_basis_max <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb371-7"><a href="simulace2shift.html#cb371-7" tabindex="-1"></a></span>
<span id="cb371-8"><a href="simulace2shift.html#cb371-8" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> n_basis_min<span class="sc">:</span>n_basis_max <span class="co"># vsechny dimenze, ktere chceme vyzkouset</span></span>
<span id="cb371-9"><a href="simulace2shift.html#cb371-9" tabindex="-1"></a></span>
<span id="cb371-10"><a href="simulace2shift.html#cb371-10" tabindex="-1"></a><span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb371-11"><a href="simulace2shift.html#cb371-11" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb371-12"><a href="simulace2shift.html#cb371-12" tabindex="-1"></a></span>
<span id="cb371-13"><a href="simulace2shift.html#cb371-13" tabindex="-1"></a><span class="co"># list se tremi slozkami ... maticemi pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb371-14"><a href="simulace2shift.html#cb371-14" tabindex="-1"></a><span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb371-15"><a href="simulace2shift.html#cb371-15" tabindex="-1"></a><span class="co"># ve sloupcich budou hodnoty presnosti pro danou cast trenovaci mnoziny</span></span>
<span id="cb371-16"><a href="simulace2shift.html#cb371-16" tabindex="-1"></a><span class="co"># v radcich budou hodnoty pro danou hodnotu dimenze</span></span>
<span id="cb371-17"><a href="simulace2shift.html#cb371-17" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">SVM.l =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb371-18"><a href="simulace2shift.html#cb371-18" tabindex="-1"></a>                   <span class="at">SVM.p =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb371-19"><a href="simulace2shift.html#cb371-19" tabindex="-1"></a>                   <span class="at">SVM.r =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv))</span>
<span id="cb371-20"><a href="simulace2shift.html#cb371-20" tabindex="-1"></a></span>
<span id="cb371-21"><a href="simulace2shift.html#cb371-21" tabindex="-1"></a><span class="cf">for</span> (d <span class="cf">in</span> dimensions) {</span>
<span id="cb371-22"><a href="simulace2shift.html#cb371-22" tabindex="-1"></a>  <span class="co"># bazovy objekt</span></span>
<span id="cb371-23"><a href="simulace2shift.html#cb371-23" tabindex="-1"></a>  fbasis <span class="ot">&lt;-</span> <span class="fu">create.fourier.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb371-24"><a href="simulace2shift.html#cb371-24" tabindex="-1"></a>                                 <span class="at">nbasis =</span> d)</span>
<span id="cb371-25"><a href="simulace2shift.html#cb371-25" tabindex="-1"></a>  </span>
<span id="cb371-26"><a href="simulace2shift.html#cb371-26" tabindex="-1"></a>  <span class="co"># projekce diskretnich dat na Fourierovu bazi o dimenzi d</span></span>
<span id="cb371-27"><a href="simulace2shift.html#cb371-27" tabindex="-1"></a>  Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="co"># matice diskretnich dat</span></span>
<span id="cb371-28"><a href="simulace2shift.html#cb371-28" tabindex="-1"></a>                              <span class="at">argvals =</span> t, <span class="co"># vektor argumentu</span></span>
<span id="cb371-29"><a href="simulace2shift.html#cb371-29" tabindex="-1"></a>                              <span class="at">basisobj =</span> fbasis) <span class="co"># bazovy objekt</span></span>
<span id="cb371-30"><a href="simulace2shift.html#cb371-30" tabindex="-1"></a>  </span>
<span id="cb371-31"><a href="simulace2shift.html#cb371-31" tabindex="-1"></a>  <span class="co"># rozdeleni na trenovaci a testovaci data v ramci CV</span></span>
<span id="cb371-32"><a href="simulace2shift.html#cb371-32" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb371-33"><a href="simulace2shift.html#cb371-33" tabindex="-1"></a>  </span>
<span id="cb371-34"><a href="simulace2shift.html#cb371-34" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb371-35"><a href="simulace2shift.html#cb371-35" tabindex="-1"></a>    <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb371-36"><a href="simulace2shift.html#cb371-36" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb371-37"><a href="simulace2shift.html#cb371-37" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XX.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb371-38"><a href="simulace2shift.html#cb371-38" tabindex="-1"></a>    </span>
<span id="cb371-39"><a href="simulace2shift.html#cb371-39" tabindex="-1"></a>    data.projection.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[cv_sample, ])</span>
<span id="cb371-40"><a href="simulace2shift.html#cb371-40" tabindex="-1"></a>    data.projection.train.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[cv_sample])</span>
<span id="cb371-41"><a href="simulace2shift.html#cb371-41" tabindex="-1"></a>    </span>
<span id="cb371-42"><a href="simulace2shift.html#cb371-42" tabindex="-1"></a>    data.projection.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb371-43"><a href="simulace2shift.html#cb371-43" tabindex="-1"></a>    Y.test.cv <span class="ot">&lt;-</span> Y.train[<span class="sc">!</span>cv_sample]</span>
<span id="cb371-44"><a href="simulace2shift.html#cb371-44" tabindex="-1"></a>    data.projection.test.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test.cv)</span>
<span id="cb371-45"><a href="simulace2shift.html#cb371-45" tabindex="-1"></a>  </span>
<span id="cb371-46"><a href="simulace2shift.html#cb371-46" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb371-47"><a href="simulace2shift.html#cb371-47" tabindex="-1"></a>    clf.SVM.l.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb371-48"><a href="simulace2shift.html#cb371-48" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb371-49"><a href="simulace2shift.html#cb371-49" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb371-50"><a href="simulace2shift.html#cb371-50" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb371-51"><a href="simulace2shift.html#cb371-51" tabindex="-1"></a>    </span>
<span id="cb371-52"><a href="simulace2shift.html#cb371-52" tabindex="-1"></a>    clf.SVM.p.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb371-53"><a href="simulace2shift.html#cb371-53" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb371-54"><a href="simulace2shift.html#cb371-54" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb371-55"><a href="simulace2shift.html#cb371-55" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb371-56"><a href="simulace2shift.html#cb371-56" tabindex="-1"></a>    </span>
<span id="cb371-57"><a href="simulace2shift.html#cb371-57" tabindex="-1"></a>    clf.SVM.r.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb371-58"><a href="simulace2shift.html#cb371-58" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb371-59"><a href="simulace2shift.html#cb371-59" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb371-60"><a href="simulace2shift.html#cb371-60" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb371-61"><a href="simulace2shift.html#cb371-61" tabindex="-1"></a>      </span>
<span id="cb371-62"><a href="simulace2shift.html#cb371-62" tabindex="-1"></a>    <span class="co"># presnost na validacnich datech</span></span>
<span id="cb371-63"><a href="simulace2shift.html#cb371-63" tabindex="-1"></a>    <span class="do">## linear kernel</span></span>
<span id="cb371-64"><a href="simulace2shift.html#cb371-64" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.projection,</span>
<span id="cb371-65"><a href="simulace2shift.html#cb371-65" tabindex="-1"></a>                                  <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb371-66"><a href="simulace2shift.html#cb371-66" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb371-67"><a href="simulace2shift.html#cb371-67" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb371-68"><a href="simulace2shift.html#cb371-68" tabindex="-1"></a>    <span class="do">## polynomial kernel</span></span>
<span id="cb371-69"><a href="simulace2shift.html#cb371-69" tabindex="-1"></a>    predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.projection, </span>
<span id="cb371-70"><a href="simulace2shift.html#cb371-70" tabindex="-1"></a>                                  <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb371-71"><a href="simulace2shift.html#cb371-71" tabindex="-1"></a>    presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb371-72"><a href="simulace2shift.html#cb371-72" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb371-73"><a href="simulace2shift.html#cb371-73" tabindex="-1"></a>    <span class="do">## radial kernel</span></span>
<span id="cb371-74"><a href="simulace2shift.html#cb371-74" tabindex="-1"></a>    predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.projection,</span>
<span id="cb371-75"><a href="simulace2shift.html#cb371-75" tabindex="-1"></a>                                  <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb371-76"><a href="simulace2shift.html#cb371-76" tabindex="-1"></a>    presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb371-77"><a href="simulace2shift.html#cb371-77" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb371-78"><a href="simulace2shift.html#cb371-78" tabindex="-1"></a>    </span>
<span id="cb371-79"><a href="simulace2shift.html#cb371-79" tabindex="-1"></a>    <span class="co"># presnosti vlozime na pozice pro dane d a fold</span></span>
<span id="cb371-80"><a href="simulace2shift.html#cb371-80" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb371-81"><a href="simulace2shift.html#cb371-81" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.p[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb371-82"><a href="simulace2shift.html#cb371-82" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.r[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb371-83"><a href="simulace2shift.html#cb371-83" tabindex="-1"></a>  }</span>
<span id="cb371-84"><a href="simulace2shift.html#cb371-84" tabindex="-1"></a>}</span>
<span id="cb371-85"><a href="simulace2shift.html#cb371-85" tabindex="-1"></a>  </span>
<span id="cb371-86"><a href="simulace2shift.html#cb371-86" tabindex="-1"></a><span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb371-87"><a href="simulace2shift.html#cb371-87" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb371-88"><a href="simulace2shift.html#cb371-88" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb371-89"><a href="simulace2shift.html#cb371-89" tabindex="-1"></a>}</span>
<span id="cb371-90"><a href="simulace2shift.html#cb371-90" tabindex="-1"></a></span>
<span id="cb371-91"><a href="simulace2shift.html#cb371-91" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb371-92"><a href="simulace2shift.html#cb371-92" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb371-93"><a href="simulace2shift.html#cb371-93" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb371-94"><a href="simulace2shift.html#cb371-94" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb371-95"><a href="simulace2shift.html#cb371-95" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb371-96"><a href="simulace2shift.html#cb371-96" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb371-97"><a href="simulace2shift.html#cb371-97" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">d_opt =</span> d.opt, <span class="at">ERR =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv,</span>
<span id="cb371-98"><a href="simulace2shift.html#cb371-98" tabindex="-1"></a>           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<pre><code>##        d_opt        ERR
## linear    34 0.09638278
## poly      10 0.14627747
## radial     4 0.12418040</code></pre>
<p>Vidíme, že nejlépe vychází hodnota parametru <span class="math inline">\(d\)</span> jako 34 pro lineární jádro s hodnotou přesnosti spočtenou pomocí 10-násobné CV 0.9036, 10 pro polynomiální jádro s hodnotou přesnosti spočtenou pomocí 10-násobné CV 0.8537 a 4 pro radiální jádro s hodnotou přesnosti 0.8758.
Pro přehlednost si ještě vykresleme průběh validačních chybovostí v závislosti na dimenzi <span class="math inline">\(d\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="simulace2shift.html#cb373-1" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> dimensions <span class="sc">|&gt;</span> <span class="fu">rep</span>(<span class="dv">3</span>), </span>
<span id="cb373-2"><a href="simulace2shift.html#cb373-2" tabindex="-1"></a>                         <span class="at">CV =</span> <span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.l, </span>
<span id="cb373-3"><a href="simulace2shift.html#cb373-3" tabindex="-1"></a>                                CV.results<span class="sc">$</span>SVM.p, </span>
<span id="cb373-4"><a href="simulace2shift.html#cb373-4" tabindex="-1"></a>                                CV.results<span class="sc">$</span>SVM.r),</span>
<span id="cb373-5"><a href="simulace2shift.html#cb373-5" tabindex="-1"></a>                         <span class="at">Kernel =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>), </span>
<span id="cb373-6"><a href="simulace2shift.html#cb373-6" tabindex="-1"></a>                                      <span class="at">each =</span> <span class="fu">length</span>(dimensions)) <span class="sc">|&gt;</span> <span class="fu">factor</span>())</span>
<span id="cb373-7"><a href="simulace2shift.html#cb373-7" tabindex="-1"></a>CV.results <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> CV, <span class="at">colour =</span> Kernel)) <span class="sc">+</span> </span>
<span id="cb373-8"><a href="simulace2shift.html#cb373-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb373-9"><a href="simulace2shift.html#cb373-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb373-10"><a href="simulace2shift.html#cb373-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(d.opt,</span>
<span id="cb373-11"><a href="simulace2shift.html#cb373-11" tabindex="-1"></a>                               presnost.opt.cv),</span>
<span id="cb373-12"><a href="simulace2shift.html#cb373-12" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> d.opt, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb373-13"><a href="simulace2shift.html#cb373-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb373-14"><a href="simulace2shift.html#cb373-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(d)),</span>
<span id="cb373-15"><a href="simulace2shift.html#cb373-15" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Validační chybovost&#39;</span>) <span class="sc">+</span> </span>
<span id="cb373-16"><a href="simulace2shift.html#cb373-16" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span> </span>
<span id="cb373-17"><a href="simulace2shift.html#cb373-17" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> dimensions)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-48"></span>
<img src="04-Simulace_2_shift_files/figure-html/unnamed-chunk-48-1.png" alt="Závislost validační chybovosti na dimenzi podprostoru $V_d$, zvlášť pro všechna tři uvažovaná jádra v metodě SVM. Černými body jsou vyznačeny optimální hodnoty dimenze $V_d$ pro jednotlivé jádrové funkce." width="672" />
<p class="caption">
Obrázek 1.14: Závislost validační chybovosti na dimenzi podprostoru <span class="math inline">\(V_d\)</span>, zvlášť pro všechna tři uvažovaná jádra v metodě SVM. Černými body jsou vyznačeny optimální hodnoty dimenze <span class="math inline">\(V_d\)</span> pro jednotlivé jádrové funkce.
</p>
</div>
<p>Nyní již můžeme natrénovat jednotlivé klasifikátory na všech trénovacích datech a podívat se na jejich úspěšnost na testovacích datech.
Pro každou jádrovou funkci volíme dimenzi podprostoru, na který projektujeme, podle výsledků cross-validace.</p>
<p>V proměnné <code>Projection</code> máme uloženou matici koeficientů ortogonální projekce, tedy</p>
<p><span class="math display">\[
\texttt{Projection} = \begin{pmatrix}
\langle x_1, \Psi_1 \rangle &amp; \langle x_2, \Psi_1 \rangle &amp; \cdots &amp; \langle x_n, \Psi_1 \rangle\\
\langle x_1, \Psi_2 \rangle &amp; \langle x_2, \Psi_2 \rangle &amp; \cdots &amp; \langle x_n, \Psi_2 \rangle\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\langle x_1, \Psi_d \rangle &amp; \langle x_2, \Psi_d \rangle &amp; \dots &amp; \langle x_n, \Psi_d \rangle
\end{pmatrix}_{d \times n}.
\]</span></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="simulace2shift.html#cb374-1" tabindex="-1"></a><span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb374-2"><a href="simulace2shift.html#cb374-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - projection&#39;</span>, </span>
<span id="cb374-3"><a href="simulace2shift.html#cb374-3" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb374-4"><a href="simulace2shift.html#cb374-4" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - projection&#39;</span>), </span>
<span id="cb374-5"><a href="simulace2shift.html#cb374-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb374-6"><a href="simulace2shift.html#cb374-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb374-7"><a href="simulace2shift.html#cb374-7" tabindex="-1"></a></span>
<span id="cb374-8"><a href="simulace2shift.html#cb374-8" tabindex="-1"></a><span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb374-9"><a href="simulace2shift.html#cb374-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb374-10"><a href="simulace2shift.html#cb374-10" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb374-11"><a href="simulace2shift.html#cb374-11" tabindex="-1"></a>  <span class="co"># bazovy objekt</span></span>
<span id="cb374-12"><a href="simulace2shift.html#cb374-12" tabindex="-1"></a>  fbasis <span class="ot">&lt;-</span> <span class="fu">create.fourier.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb374-13"><a href="simulace2shift.html#cb374-13" tabindex="-1"></a>                                 <span class="at">nbasis =</span> d.opt[kernel_number])</span>
<span id="cb374-14"><a href="simulace2shift.html#cb374-14" tabindex="-1"></a>  </span>
<span id="cb374-15"><a href="simulace2shift.html#cb374-15" tabindex="-1"></a>  <span class="co"># projekce diskretnich dat na Fourierovu bazi</span></span>
<span id="cb374-16"><a href="simulace2shift.html#cb374-16" tabindex="-1"></a>  Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="co"># matice diskretnich dat</span></span>
<span id="cb374-17"><a href="simulace2shift.html#cb374-17" tabindex="-1"></a>                              <span class="at">argvals =</span> t, <span class="co"># vektor argumentu</span></span>
<span id="cb374-18"><a href="simulace2shift.html#cb374-18" tabindex="-1"></a>                              <span class="at">basisobj =</span> fbasis) <span class="co"># bazovy objekt</span></span>
<span id="cb374-19"><a href="simulace2shift.html#cb374-19" tabindex="-1"></a>  </span>
<span id="cb374-20"><a href="simulace2shift.html#cb374-20" tabindex="-1"></a>  <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb374-21"><a href="simulace2shift.html#cb374-21" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb374-22"><a href="simulace2shift.html#cb374-22" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb374-23"><a href="simulace2shift.html#cb374-23" tabindex="-1"></a>  </span>
<span id="cb374-24"><a href="simulace2shift.html#cb374-24" tabindex="-1"></a>  data.projection.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train)</span>
<span id="cb374-25"><a href="simulace2shift.html#cb374-25" tabindex="-1"></a>  data.projection.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb374-26"><a href="simulace2shift.html#cb374-26" tabindex="-1"></a>  </span>
<span id="cb374-27"><a href="simulace2shift.html#cb374-27" tabindex="-1"></a>  data.projection.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.test)</span>
<span id="cb374-28"><a href="simulace2shift.html#cb374-28" tabindex="-1"></a>  data.projection.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb374-29"><a href="simulace2shift.html#cb374-29" tabindex="-1"></a>  </span>
<span id="cb374-30"><a href="simulace2shift.html#cb374-30" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb374-31"><a href="simulace2shift.html#cb374-31" tabindex="-1"></a>  clf.SVM.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train,</span>
<span id="cb374-32"><a href="simulace2shift.html#cb374-32" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb374-33"><a href="simulace2shift.html#cb374-33" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb374-34"><a href="simulace2shift.html#cb374-34" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb374-35"><a href="simulace2shift.html#cb374-35" tabindex="-1"></a>  </span>
<span id="cb374-36"><a href="simulace2shift.html#cb374-36" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb374-37"><a href="simulace2shift.html#cb374-37" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.train)</span>
<span id="cb374-38"><a href="simulace2shift.html#cb374-38" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb374-39"><a href="simulace2shift.html#cb374-39" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb374-40"><a href="simulace2shift.html#cb374-40" tabindex="-1"></a>    </span>
<span id="cb374-41"><a href="simulace2shift.html#cb374-41" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb374-42"><a href="simulace2shift.html#cb374-42" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.test)</span>
<span id="cb374-43"><a href="simulace2shift.html#cb374-43" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb374-44"><a href="simulace2shift.html#cb374-44" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb374-45"><a href="simulace2shift.html#cb374-45" tabindex="-1"></a>  </span>
<span id="cb374-46"><a href="simulace2shift.html#cb374-46" tabindex="-1"></a>  <span class="co"># ulozeni vysledku</span></span>
<span id="cb374-47"><a href="simulace2shift.html#cb374-47" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb374-48"><a href="simulace2shift.html#cb374-48" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Přesnost metody SVM aplikované na bázové koeficienty na trénovacích datech je tedy 0 % pro lineární jádro, 5.71 % pro polynomiální jádro a 7.86 % pro gaussovské jádro.
Na testovacích datech je potom přesnost metody 21.67 % pro lineární jádro, 16.67 % pro polynomiální jádro a 15 % pro radiální jádro.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="simulace2shift.html#cb375-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
</div>
<div id="tabulka-výsledků-3" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Tabulka výsledků<a href="simulace2shift.html#tabulka-výsledků-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<table>
<caption><span id="tab:unnamed-chunk-51">Tabulka 3.1: </span>Souhrnné výsledky použitých metod na simulovaných datech. <span class="math inline">\(\widehat{Err}_{train}\)</span> značí odhad trénovací chybovosti a <span class="math inline">\(\widehat{Err}_{test}\)</span> testovací chybovosti.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">KNN</td>
<td align="center">0.2500</td>
<td align="center">0.2167</td>
</tr>
<tr class="even">
<td align="left">LDA</td>
<td align="center">0.1143</td>
<td align="center">0.1500</td>
</tr>
<tr class="odd">
<td align="left">QDA</td>
<td align="center">0.1286</td>
<td align="center">0.1500</td>
</tr>
<tr class="even">
<td align="left">SVM linear - diskr</td>
<td align="center">0.0857</td>
<td align="center">0.1167</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - diskr</td>
<td align="center">0.3214</td>
<td align="center">0.3000</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - diskr</td>
<td align="center">0.1286</td>
<td align="center">0.2500</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - PCA</td>
<td align="center">0.1143</td>
<td align="center">0.1833</td>
</tr>
<tr class="even">
<td align="left">SVM poly - PCA</td>
<td align="center">0.1643</td>
<td align="center">0.1667</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - PCA</td>
<td align="center">0.1214</td>
<td align="center">0.1833</td>
</tr>
<tr class="even">
<td align="left">SVM linear - Fbasis</td>
<td align="center">0.0000</td>
<td align="center">0.1333</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - Fbasis</td>
<td align="center">0.0000</td>
<td align="center">0.2500</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - Fbasis</td>
<td align="center">0.0000</td>
<td align="center">0.2667</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - projection</td>
<td align="center">0.0000</td>
<td align="center">0.2167</td>
</tr>
<tr class="even">
<td align="left">SVM poly - projection</td>
<td align="center">0.0571</td>
<td align="center">0.1667</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - projection</td>
<td align="center">0.0786</td>
<td align="center">0.1500</td>
</tr>
</tbody>
</table>
</div>
<div id="simulační-studie-3" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Simulační studie<a href="simulace2shift.html#simulační-studie-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>V celé předchozí části jsme se zabývali pouze jedním náhodně vygenerovaným souborem funkcí ze dvou klasifikačních tříd, který jsme následně opět náhodně rozdělili na testovací a trénovací část.
Poté jsme jednotlivé klasifikátory získané pomocí uvažovaných metod ohodnotili na základě testovací a trénovací chybovosti.</p>
<p>Jelikož se vygenerovaná data (a jejich rozdělení na dvě části) mohou při každém zopakování výrazně lišit, budou se i chybovosti jednotlivých klasifikačních algoritmů výrazně lišit.
Proto dělat jakékoli závěry o metodách a porovnávat je mezi sebou může být na základě jednoho vygenerovaného datového souboru velmi zavádějící.</p>
<p>Z tohoto důvodu se v této části zaměříme na opakování celého předchozího postupu pro různé vygenerované soubory.
Výsledky si budeme ukládat do tabulky a nakonec spočítáme průměrné charakteristiky modelů přes jednotlivá opakování.
Aby byly naše závěry dostatečně obecné, zvolíme počet opakování <span class="math inline">\(n_{sim} = 10\)</span>.</p>
<p>Nyní zopakujeme celou předchozí část <code>n.sim</code>-krát a hodnoty chybovostí si budeme ukládat to objektu <code>SIMUL_params</code>. Přitom budeme měnit hodnotu parametru <span class="math inline">\(\sigma_{shift}\)</span> a podíváme se, jak se mění výsledky jednotlivých vybraných klasifikačních metod v závislosti na této hodnotě.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="simulace2shift.html#cb376-1" tabindex="-1"></a><span class="co"># nastaveni generatoru pseudonahodnych cisel</span></span>
<span id="cb376-2"><a href="simulace2shift.html#cb376-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb376-3"><a href="simulace2shift.html#cb376-3" tabindex="-1"></a></span>
<span id="cb376-4"><a href="simulace2shift.html#cb376-4" tabindex="-1"></a><span class="co"># pocet simulaci pro kazdou hodnotu simulacniho parametru</span></span>
<span id="cb376-5"><a href="simulace2shift.html#cb376-5" tabindex="-1"></a>n.sim <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb376-6"><a href="simulace2shift.html#cb376-6" tabindex="-1"></a></span>
<span id="cb376-7"><a href="simulace2shift.html#cb376-7" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;KNN&#39;</span>, <span class="st">&#39;LDA&#39;</span>, <span class="st">&#39;QDA&#39;</span>, </span>
<span id="cb376-8"><a href="simulace2shift.html#cb376-8" tabindex="-1"></a>             <span class="st">&#39;SVM linear - diskr&#39;</span>, <span class="st">&#39;SVM poly - diskr&#39;</span>, <span class="st">&#39;SVM rbf - diskr&#39;</span>, </span>
<span id="cb376-9"><a href="simulace2shift.html#cb376-9" tabindex="-1"></a>             <span class="st">&#39;SVM linear - PCA&#39;</span>, <span class="st">&#39;SVM poly - PCA&#39;</span>, <span class="st">&#39;SVM rbf - PCA&#39;</span>, </span>
<span id="cb376-10"><a href="simulace2shift.html#cb376-10" tabindex="-1"></a>             <span class="st">&#39;SVM linear - Fbasis&#39;</span>, <span class="st">&#39;SVM poly - Fbasis&#39;</span>, </span>
<span id="cb376-11"><a href="simulace2shift.html#cb376-11" tabindex="-1"></a>             <span class="st">&#39;SVM rbf - Fbasis&#39;</span>, <span class="st">&#39;SVM linear - projection&#39;</span>,</span>
<span id="cb376-12"><a href="simulace2shift.html#cb376-12" tabindex="-1"></a>             <span class="st">&#39;SVM poly - projection&#39;</span>, <span class="st">&#39;SVM rbf - projection&#39;</span>)</span>
<span id="cb376-13"><a href="simulace2shift.html#cb376-13" tabindex="-1"></a></span>
<span id="cb376-14"><a href="simulace2shift.html#cb376-14" tabindex="-1"></a><span class="co"># vektor smerodatnych odchylek definujicich posunuti generovanych krivek</span></span>
<span id="cb376-15"><a href="simulace2shift.html#cb376-15" tabindex="-1"></a>shift_vector <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length =</span> <span class="dv">21</span>)</span>
<span id="cb376-16"><a href="simulace2shift.html#cb376-16" tabindex="-1"></a></span>
<span id="cb376-17"><a href="simulace2shift.html#cb376-17" tabindex="-1"></a><span class="co"># vysledny objekt, do nehoz ukladame vysledky simulaci</span></span>
<span id="cb376-18"><a href="simulace2shift.html#cb376-18" tabindex="-1"></a>SIMUL_params <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data =</span> <span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(methods), <span class="dv">4</span>, <span class="fu">length</span>(shift_vector)),</span>
<span id="cb376-19"><a href="simulace2shift.html#cb376-19" tabindex="-1"></a>                      <span class="at">dimnames =</span> <span class="fu">list</span>(</span>
<span id="cb376-20"><a href="simulace2shift.html#cb376-20" tabindex="-1"></a>                        <span class="at">method =</span> methods,</span>
<span id="cb376-21"><a href="simulace2shift.html#cb376-21" tabindex="-1"></a>                        <span class="at">metric =</span> <span class="fu">c</span>(<span class="st">&#39;ERRtrain&#39;</span>, <span class="st">&#39;Errtest&#39;</span>, <span class="st">&#39;SDtrain&#39;</span>, <span class="st">&#39;SDtest&#39;</span>), </span>
<span id="cb376-22"><a href="simulace2shift.html#cb376-22" tabindex="-1"></a>                        <span class="at">sigma =</span> <span class="fu">paste0</span>(shift_vector)))</span>
<span id="cb376-23"><a href="simulace2shift.html#cb376-23" tabindex="-1"></a></span>
<span id="cb376-24"><a href="simulace2shift.html#cb376-24" tabindex="-1"></a><span class="cf">for</span> (n_shift <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(shift_vector)) {</span>
<span id="cb376-25"><a href="simulace2shift.html#cb376-25" tabindex="-1"></a>  <span class="do">## list, do ktereho budeme ukladat hodnoty chybovosti</span></span>
<span id="cb376-26"><a href="simulace2shift.html#cb376-26" tabindex="-1"></a>  <span class="co"># ve sloupcich budou metody</span></span>
<span id="cb376-27"><a href="simulace2shift.html#cb376-27" tabindex="-1"></a>  <span class="co"># v radcich budou jednotliva opakovani</span></span>
<span id="cb376-28"><a href="simulace2shift.html#cb376-28" tabindex="-1"></a>  <span class="co"># list ma dve polozky ... train a test</span></span>
<span id="cb376-29"><a href="simulace2shift.html#cb376-29" tabindex="-1"></a>  SIMULACE <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">train =</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(methods), </span>
<span id="cb376-30"><a href="simulace2shift.html#cb376-30" tabindex="-1"></a>                                               <span class="at">nrow =</span> n.sim,</span>
<span id="cb376-31"><a href="simulace2shift.html#cb376-31" tabindex="-1"></a>                                               <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n.sim, methods))), </span>
<span id="cb376-32"><a href="simulace2shift.html#cb376-32" tabindex="-1"></a>                   <span class="at">test =</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(methods), </span>
<span id="cb376-33"><a href="simulace2shift.html#cb376-33" tabindex="-1"></a>                                               <span class="at">nrow =</span> n.sim,</span>
<span id="cb376-34"><a href="simulace2shift.html#cb376-34" tabindex="-1"></a>                                               <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n.sim, methods))))</span>
<span id="cb376-35"><a href="simulace2shift.html#cb376-35" tabindex="-1"></a>  </span>
<span id="cb376-36"><a href="simulace2shift.html#cb376-36" tabindex="-1"></a>  <span class="co"># objekt na ulozeni optimalnich hodnot hyperparametru, ktere se urcuji pomoci CV</span></span>
<span id="cb376-37"><a href="simulace2shift.html#cb376-37" tabindex="-1"></a>  CV_RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">KNN_K =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n.sim), </span>
<span id="cb376-38"><a href="simulace2shift.html#cb376-38" tabindex="-1"></a>                           <span class="at">nharm =</span> <span class="cn">NA</span>, </span>
<span id="cb376-39"><a href="simulace2shift.html#cb376-39" tabindex="-1"></a>                           <span class="at">LR_func_n_basis =</span> <span class="cn">NA</span>,</span>
<span id="cb376-40"><a href="simulace2shift.html#cb376-40" tabindex="-1"></a>                           <span class="at">SVM_d_Linear =</span> <span class="cn">NA</span>,</span>
<span id="cb376-41"><a href="simulace2shift.html#cb376-41" tabindex="-1"></a>                           <span class="at">SVM_d_Poly =</span> <span class="cn">NA</span>,</span>
<span id="cb376-42"><a href="simulace2shift.html#cb376-42" tabindex="-1"></a>                           <span class="at">SVM_d_Radial =</span> <span class="cn">NA</span>)</span>
<span id="cb376-43"><a href="simulace2shift.html#cb376-43" tabindex="-1"></a>  </span>
<span id="cb376-44"><a href="simulace2shift.html#cb376-44" tabindex="-1"></a>  <span class="do">## SIMULACE</span></span>
<span id="cb376-45"><a href="simulace2shift.html#cb376-45" tabindex="-1"></a>  </span>
<span id="cb376-46"><a href="simulace2shift.html#cb376-46" tabindex="-1"></a>  <span class="cf">for</span>(sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.sim) {</span>
<span id="cb376-47"><a href="simulace2shift.html#cb376-47" tabindex="-1"></a>    <span class="co"># pocet vygenerovanych pozorovani pro kazdou tridu</span></span>
<span id="cb376-48"><a href="simulace2shift.html#cb376-48" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb376-49"><a href="simulace2shift.html#cb376-49" tabindex="-1"></a>    <span class="co"># vektor casu ekvidistantni na intervalu [0, 12]</span></span>
<span id="cb376-50"><a href="simulace2shift.html#cb376-50" tabindex="-1"></a>    t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">12</span>, <span class="at">length =</span> <span class="dv">51</span>)</span>
<span id="cb376-51"><a href="simulace2shift.html#cb376-51" tabindex="-1"></a>    </span>
<span id="cb376-52"><a href="simulace2shift.html#cb376-52" tabindex="-1"></a>    <span class="co"># pro Y = 0</span></span>
<span id="cb376-53"><a href="simulace2shift.html#cb376-53" tabindex="-1"></a>    X0 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_0, n, <span class="dv">1</span>, shift_vector[n_shift])</span>
<span id="cb376-54"><a href="simulace2shift.html#cb376-54" tabindex="-1"></a>    <span class="co"># pro Y = 1</span></span>
<span id="cb376-55"><a href="simulace2shift.html#cb376-55" tabindex="-1"></a>    X1 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_1, n, <span class="dv">1</span>, shift_vector[n_shift])</span>
<span id="cb376-56"><a href="simulace2shift.html#cb376-56" tabindex="-1"></a>    </span>
<span id="cb376-57"><a href="simulace2shift.html#cb376-57" tabindex="-1"></a>    rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb376-58"><a href="simulace2shift.html#cb376-58" tabindex="-1"></a></span>
<span id="cb376-59"><a href="simulace2shift.html#cb376-59" tabindex="-1"></a>    fbasis <span class="ot">&lt;-</span> <span class="fu">create.fourier.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb376-60"><a href="simulace2shift.html#cb376-60" tabindex="-1"></a>                                   <span class="at">nbasis =</span> <span class="fu">length</span>(t))</span>
<span id="cb376-61"><a href="simulace2shift.html#cb376-61" tabindex="-1"></a>    </span>
<span id="cb376-62"><a href="simulace2shift.html#cb376-62" tabindex="-1"></a>    omega <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">/</span> <span class="fu">diff</span>(rangeval)</span>
<span id="cb376-63"><a href="simulace2shift.html#cb376-63" tabindex="-1"></a>    acvec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, omega<span class="sc">^</span><span class="dv">2</span>, <span class="dv">0</span>)</span>
<span id="cb376-64"><a href="simulace2shift.html#cb376-64" tabindex="-1"></a>    harmLfd <span class="ot">&lt;-</span> <span class="fu">vec2Lfd</span>(<span class="at">bwtvec =</span> acvec, <span class="at">rangeval =</span> rangeval)</span>
<span id="cb376-65"><a href="simulace2shift.html#cb376-65" tabindex="-1"></a>  </span>
<span id="cb376-66"><a href="simulace2shift.html#cb376-66" tabindex="-1"></a>    <span class="co"># spojeni pozorovani do jedne matice</span></span>
<span id="cb376-67"><a href="simulace2shift.html#cb376-67" tabindex="-1"></a>    XX <span class="ot">&lt;-</span> <span class="fu">cbind</span>(X0, X1)</span>
<span id="cb376-68"><a href="simulace2shift.html#cb376-68" tabindex="-1"></a>    </span>
<span id="cb376-69"><a href="simulace2shift.html#cb376-69" tabindex="-1"></a>    lambda.vect <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">length.out =</span> <span class="dv">25</span>) <span class="co"># vektor lambd</span></span>
<span id="cb376-70"><a href="simulace2shift.html#cb376-70" tabindex="-1"></a>    gcv <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="at">length =</span> <span class="fu">length</span>(lambda.vect)) <span class="co"># prazdny vektor pro ulozebi GCV</span></span>
<span id="cb376-71"><a href="simulace2shift.html#cb376-71" tabindex="-1"></a>    </span>
<span id="cb376-72"><a href="simulace2shift.html#cb376-72" tabindex="-1"></a>    <span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambda.vect)) {</span>
<span id="cb376-73"><a href="simulace2shift.html#cb376-73" tabindex="-1"></a>      curv.Fdpar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(fbasis, harmLfd, lambda.vect[index])</span>
<span id="cb376-74"><a href="simulace2shift.html#cb376-74" tabindex="-1"></a>      FSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.Fdpar) <span class="co"># vyhlazeni</span></span>
<span id="cb376-75"><a href="simulace2shift.html#cb376-75" tabindex="-1"></a>      gcv[index] <span class="ot">&lt;-</span> <span class="fu">mean</span>(FSmooth<span class="sc">$</span>gcv) <span class="co"># prumer pres vsechny pozorovane krivky</span></span>
<span id="cb376-76"><a href="simulace2shift.html#cb376-76" tabindex="-1"></a>    }</span>
<span id="cb376-77"><a href="simulace2shift.html#cb376-77" tabindex="-1"></a>    </span>
<span id="cb376-78"><a href="simulace2shift.html#cb376-78" tabindex="-1"></a>    GCV <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb376-79"><a href="simulace2shift.html#cb376-79" tabindex="-1"></a>      <span class="at">lambda =</span> <span class="fu">round</span>(<span class="fu">log10</span>(lambda.vect), <span class="dv">3</span>),</span>
<span id="cb376-80"><a href="simulace2shift.html#cb376-80" tabindex="-1"></a>      <span class="at">GCV =</span> gcv</span>
<span id="cb376-81"><a href="simulace2shift.html#cb376-81" tabindex="-1"></a>    )</span>
<span id="cb376-82"><a href="simulace2shift.html#cb376-82" tabindex="-1"></a>    </span>
<span id="cb376-83"><a href="simulace2shift.html#cb376-83" tabindex="-1"></a>    <span class="co"># najdeme hodnotu minima</span></span>
<span id="cb376-84"><a href="simulace2shift.html#cb376-84" tabindex="-1"></a>    lambda.opt <span class="ot">&lt;-</span> lambda.vect[<span class="fu">which.min</span>(gcv)]</span>
<span id="cb376-85"><a href="simulace2shift.html#cb376-85" tabindex="-1"></a>    </span>
<span id="cb376-86"><a href="simulace2shift.html#cb376-86" tabindex="-1"></a>    curv.fdPar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(fbasis, harmLfd, lambda.opt)</span>
<span id="cb376-87"><a href="simulace2shift.html#cb376-87" tabindex="-1"></a>    BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.fdPar)</span>
<span id="cb376-88"><a href="simulace2shift.html#cb376-88" tabindex="-1"></a>    XXfd <span class="ot">&lt;-</span> BSmooth<span class="sc">$</span>fd</span>
<span id="cb376-89"><a href="simulace2shift.html#cb376-89" tabindex="-1"></a>    </span>
<span id="cb376-90"><a href="simulace2shift.html#cb376-90" tabindex="-1"></a>    fdobjSmootheval <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> XXfd, <span class="at">evalarg =</span> t)</span>
<span id="cb376-91"><a href="simulace2shift.html#cb376-91" tabindex="-1"></a>    </span>
<span id="cb376-92"><a href="simulace2shift.html#cb376-92" tabindex="-1"></a>    <span class="co"># rozdeleni na testovaci a trenovaci cast</span></span>
<span id="cb376-93"><a href="simulace2shift.html#cb376-93" tabindex="-1"></a>    split <span class="ot">&lt;-</span> <span class="fu">sample.split</span>(XXfd<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb376-94"><a href="simulace2shift.html#cb376-94" tabindex="-1"></a>    </span>
<span id="cb376-95"><a href="simulace2shift.html#cb376-95" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n)</span>
<span id="cb376-96"><a href="simulace2shift.html#cb376-96" tabindex="-1"></a>    </span>
<span id="cb376-97"><a href="simulace2shift.html#cb376-97" tabindex="-1"></a>    X.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb376-98"><a href="simulace2shift.html#cb376-98" tabindex="-1"></a>    X.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb376-99"><a href="simulace2shift.html#cb376-99" tabindex="-1"></a>    </span>
<span id="cb376-100"><a href="simulace2shift.html#cb376-100" tabindex="-1"></a>    Y.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb376-101"><a href="simulace2shift.html#cb376-101" tabindex="-1"></a>    Y.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb376-102"><a href="simulace2shift.html#cb376-102" tabindex="-1"></a>    </span>
<span id="cb376-103"><a href="simulace2shift.html#cb376-103" tabindex="-1"></a>    x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb376-104"><a href="simulace2shift.html#cb376-104" tabindex="-1"></a>    y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.train))</span>
<span id="cb376-105"><a href="simulace2shift.html#cb376-105" tabindex="-1"></a>    </span>
<span id="cb376-106"><a href="simulace2shift.html#cb376-106" tabindex="-1"></a>    <span class="do">## 1) K nejbližších sousedů</span></span>
<span id="cb376-107"><a href="simulace2shift.html#cb376-107" tabindex="-1"></a>    </span>
<span id="cb376-108"><a href="simulace2shift.html#cb376-108" tabindex="-1"></a>    k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb376-109"><a href="simulace2shift.html#cb376-109" tabindex="-1"></a>    neighbours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">ceiling</span>(<span class="fu">sqrt</span>(<span class="fu">length</span>(y.train))))) <span class="co"># pocet sousedu </span></span>
<span id="cb376-110"><a href="simulace2shift.html#cb376-110" tabindex="-1"></a>    </span>
<span id="cb376-111"><a href="simulace2shift.html#cb376-111" tabindex="-1"></a>    <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb376-112"><a href="simulace2shift.html#cb376-112" tabindex="-1"></a>    folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb376-113"><a href="simulace2shift.html#cb376-113" tabindex="-1"></a>    </span>
<span id="cb376-114"><a href="simulace2shift.html#cb376-114" tabindex="-1"></a>    CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(neighbours), <span class="at">ncol =</span> k_cv)</span>
<span id="cb376-115"><a href="simulace2shift.html#cb376-115" tabindex="-1"></a>    </span>
<span id="cb376-116"><a href="simulace2shift.html#cb376-116" tabindex="-1"></a>    <span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb376-117"><a href="simulace2shift.html#cb376-117" tabindex="-1"></a>      <span class="co"># definujeme danou indexovou mnozinu</span></span>
<span id="cb376-118"><a href="simulace2shift.html#cb376-118" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb376-119"><a href="simulace2shift.html#cb376-119" tabindex="-1"></a>        </span>
<span id="cb376-120"><a href="simulace2shift.html#cb376-120" tabindex="-1"></a>      x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb376-121"><a href="simulace2shift.html#cb376-121" tabindex="-1"></a>        <span class="fu">fdata</span>()</span>
<span id="cb376-122"><a href="simulace2shift.html#cb376-122" tabindex="-1"></a>      y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb376-123"><a href="simulace2shift.html#cb376-123" tabindex="-1"></a>        <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb376-124"><a href="simulace2shift.html#cb376-124" tabindex="-1"></a>      </span>
<span id="cb376-125"><a href="simulace2shift.html#cb376-125" tabindex="-1"></a>      x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb376-126"><a href="simulace2shift.html#cb376-126" tabindex="-1"></a>        <span class="fu">fdata</span>()</span>
<span id="cb376-127"><a href="simulace2shift.html#cb376-127" tabindex="-1"></a>      y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb376-128"><a href="simulace2shift.html#cb376-128" tabindex="-1"></a>        <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb376-129"><a href="simulace2shift.html#cb376-129" tabindex="-1"></a>      </span>
<span id="cb376-130"><a href="simulace2shift.html#cb376-130" tabindex="-1"></a>      <span class="co"># projdeme kazdou cast ... k-krat zopakujeme</span></span>
<span id="cb376-131"><a href="simulace2shift.html#cb376-131" tabindex="-1"></a>      <span class="cf">for</span>(neighbour <span class="cf">in</span> neighbours) {</span>
<span id="cb376-132"><a href="simulace2shift.html#cb376-132" tabindex="-1"></a>        <span class="co"># model pro konkretni volbu K</span></span>
<span id="cb376-133"><a href="simulace2shift.html#cb376-133" tabindex="-1"></a>        neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train.cv, </span>
<span id="cb376-134"><a href="simulace2shift.html#cb376-134" tabindex="-1"></a>                                  <span class="at">fdataobj =</span> x.train.cv, </span>
<span id="cb376-135"><a href="simulace2shift.html#cb376-135" tabindex="-1"></a>                                  <span class="at">knn =</span> neighbour) </span>
<span id="cb376-136"><a href="simulace2shift.html#cb376-136" tabindex="-1"></a>        <span class="co"># predikce na validacni casti</span></span>
<span id="cb376-137"><a href="simulace2shift.html#cb376-137" tabindex="-1"></a>        model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb376-138"><a href="simulace2shift.html#cb376-138" tabindex="-1"></a>                                        <span class="at">new.fdataobj =</span> x.test.cv)</span>
<span id="cb376-139"><a href="simulace2shift.html#cb376-139" tabindex="-1"></a>        <span class="co"># presnost na validacni casti</span></span>
<span id="cb376-140"><a href="simulace2shift.html#cb376-140" tabindex="-1"></a>        presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, model.neighb.predict) <span class="sc">|&gt;</span> </span>
<span id="cb376-141"><a href="simulace2shift.html#cb376-141" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb376-142"><a href="simulace2shift.html#cb376-142" tabindex="-1"></a>        </span>
<span id="cb376-143"><a href="simulace2shift.html#cb376-143" tabindex="-1"></a>        <span class="co"># presnost vlozime na pozici pro dane K a fold</span></span>
<span id="cb376-144"><a href="simulace2shift.html#cb376-144" tabindex="-1"></a>        CV.results[neighbour, index] <span class="ot">&lt;-</span> presnost</span>
<span id="cb376-145"><a href="simulace2shift.html#cb376-145" tabindex="-1"></a>      }</span>
<span id="cb376-146"><a href="simulace2shift.html#cb376-146" tabindex="-1"></a>    }</span>
<span id="cb376-147"><a href="simulace2shift.html#cb376-147" tabindex="-1"></a>    </span>
<span id="cb376-148"><a href="simulace2shift.html#cb376-148" tabindex="-1"></a>    <span class="co"># spocitame prumerne presnosti pro jednotliva K pres folds</span></span>
<span id="cb376-149"><a href="simulace2shift.html#cb376-149" tabindex="-1"></a>    CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb376-150"><a href="simulace2shift.html#cb376-150" tabindex="-1"></a>    K.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(CV.results)</span>
<span id="cb376-151"><a href="simulace2shift.html#cb376-151" tabindex="-1"></a>    CV_RESULTS<span class="sc">$</span>KNN_K[sim] <span class="ot">&lt;-</span> K.opt</span>
<span id="cb376-152"><a href="simulace2shift.html#cb376-152" tabindex="-1"></a>    presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb376-153"><a href="simulace2shift.html#cb376-153" tabindex="-1"></a>    CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">K =</span> neighbours, <span class="at">CV =</span> CV.results)</span>
<span id="cb376-154"><a href="simulace2shift.html#cb376-154" tabindex="-1"></a>    </span>
<span id="cb376-155"><a href="simulace2shift.html#cb376-155" tabindex="-1"></a>    neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, <span class="at">fdataobj =</span> x.train, <span class="at">knn =</span> K.opt)</span>
<span id="cb376-156"><a href="simulace2shift.html#cb376-156" tabindex="-1"></a>    </span>
<span id="cb376-157"><a href="simulace2shift.html#cb376-157" tabindex="-1"></a>    <span class="co"># predikce</span></span>
<span id="cb376-158"><a href="simulace2shift.html#cb376-158" tabindex="-1"></a>    model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb376-159"><a href="simulace2shift.html#cb376-159" tabindex="-1"></a>                                    <span class="at">new.fdataobj =</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb376-160"><a href="simulace2shift.html#cb376-160" tabindex="-1"></a>    </span>
<span id="cb376-161"><a href="simulace2shift.html#cb376-161" tabindex="-1"></a>    presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.test)), model.neighb.predict) <span class="sc">|&gt;</span></span>
<span id="cb376-162"><a href="simulace2shift.html#cb376-162" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span></span>
<span id="cb376-163"><a href="simulace2shift.html#cb376-163" tabindex="-1"></a>      <span class="fu">diag</span>() <span class="sc">|&gt;</span></span>
<span id="cb376-164"><a href="simulace2shift.html#cb376-164" tabindex="-1"></a>      <span class="fu">sum</span>()</span>
<span id="cb376-165"><a href="simulace2shift.html#cb376-165" tabindex="-1"></a>    </span>
<span id="cb376-166"><a href="simulace2shift.html#cb376-166" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;KNN&#39;</span>, </span>
<span id="cb376-167"><a href="simulace2shift.html#cb376-167" tabindex="-1"></a>                          <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> neighb.model<span class="sc">$</span>max.prob,</span>
<span id="cb376-168"><a href="simulace2shift.html#cb376-168" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost)</span>
<span id="cb376-169"><a href="simulace2shift.html#cb376-169" tabindex="-1"></a>    </span>
<span id="cb376-170"><a href="simulace2shift.html#cb376-170" tabindex="-1"></a>    <span class="do">## 2) Lineární diskriminační analýza</span></span>
<span id="cb376-171"><a href="simulace2shift.html#cb376-171" tabindex="-1"></a>    </span>
<span id="cb376-172"><a href="simulace2shift.html#cb376-172" tabindex="-1"></a>    <span class="co"># analyza hlavnich komponent</span></span>
<span id="cb376-173"><a href="simulace2shift.html#cb376-173" tabindex="-1"></a>    data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> <span class="dv">10</span>) <span class="co"># nharm - maximalni pocet HK</span></span>
<span id="cb376-174"><a href="simulace2shift.html#cb376-174" tabindex="-1"></a>    nharm <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">cumsum</span>(data.PCA<span class="sc">$</span>varprop) <span class="sc">&gt;=</span> <span class="fl">0.9</span>)[<span class="dv">1</span>] <span class="co"># urceni p</span></span>
<span id="cb376-175"><a href="simulace2shift.html#cb376-175" tabindex="-1"></a>    CV_RESULTS<span class="sc">$</span>nharm[sim] <span class="ot">&lt;-</span> nharm</span>
<span id="cb376-176"><a href="simulace2shift.html#cb376-176" tabindex="-1"></a>    <span class="cf">if</span>(nharm <span class="sc">==</span> <span class="dv">1</span>) nharm <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb376-177"><a href="simulace2shift.html#cb376-177" tabindex="-1"></a>    </span>
<span id="cb376-178"><a href="simulace2shift.html#cb376-178" tabindex="-1"></a>    data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> nharm) </span>
<span id="cb376-179"><a href="simulace2shift.html#cb376-179" tabindex="-1"></a>    data.PCA.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA<span class="sc">$</span>scores) <span class="co"># skore prvnich p HK</span></span>
<span id="cb376-180"><a href="simulace2shift.html#cb376-180" tabindex="-1"></a>    data.PCA.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train) <span class="co"># prislusnost do trid</span></span>
<span id="cb376-181"><a href="simulace2shift.html#cb376-181" tabindex="-1"></a>    </span>
<span id="cb376-182"><a href="simulace2shift.html#cb376-182" tabindex="-1"></a>    <span class="co"># vypocet skoru testovacich funkci</span></span>
<span id="cb376-183"><a href="simulace2shift.html#cb376-183" tabindex="-1"></a>    scores <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> nharm, <span class="at">nrow =</span> <span class="fu">length</span>(Y.test)) <span class="co"># prazdna matice </span></span>
<span id="cb376-184"><a href="simulace2shift.html#cb376-184" tabindex="-1"></a>    </span>
<span id="cb376-185"><a href="simulace2shift.html#cb376-185" tabindex="-1"></a>    <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(scores)[<span class="dv">1</span>]) {</span>
<span id="cb376-186"><a href="simulace2shift.html#cb376-186" tabindex="-1"></a>      xfd <span class="ot">=</span> X.test[k] <span class="sc">-</span> data.PCA<span class="sc">$</span>meanfd[<span class="dv">1</span>] <span class="co"># k-te pozorovani - prumerna funkce</span></span>
<span id="cb376-187"><a href="simulace2shift.html#cb376-187" tabindex="-1"></a>      scores[k, ] <span class="ot">=</span> <span class="fu">inprod</span>(xfd, data.PCA<span class="sc">$</span>harmonics) </span>
<span id="cb376-188"><a href="simulace2shift.html#cb376-188" tabindex="-1"></a>      <span class="co"># skalarni soucin rezidua a vlastnich funkci rho (funkcionalni hlavni komponenty)</span></span>
<span id="cb376-189"><a href="simulace2shift.html#cb376-189" tabindex="-1"></a>    }</span>
<span id="cb376-190"><a href="simulace2shift.html#cb376-190" tabindex="-1"></a>    </span>
<span id="cb376-191"><a href="simulace2shift.html#cb376-191" tabindex="-1"></a>    data.PCA.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(scores)</span>
<span id="cb376-192"><a href="simulace2shift.html#cb376-192" tabindex="-1"></a>    data.PCA.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb376-193"><a href="simulace2shift.html#cb376-193" tabindex="-1"></a>    <span class="fu">colnames</span>(data.PCA.test) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data.PCA.train) </span>
<span id="cb376-194"><a href="simulace2shift.html#cb376-194" tabindex="-1"></a>    </span>
<span id="cb376-195"><a href="simulace2shift.html#cb376-195" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb376-196"><a href="simulace2shift.html#cb376-196" tabindex="-1"></a>    clf.LDA <span class="ot">&lt;-</span> <span class="fu">lda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb376-197"><a href="simulace2shift.html#cb376-197" tabindex="-1"></a>    </span>
<span id="cb376-198"><a href="simulace2shift.html#cb376-198" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb376-199"><a href="simulace2shift.html#cb376-199" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb376-200"><a href="simulace2shift.html#cb376-200" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb376-201"><a href="simulace2shift.html#cb376-201" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb376-202"><a href="simulace2shift.html#cb376-202" tabindex="-1"></a>      </span>
<span id="cb376-203"><a href="simulace2shift.html#cb376-203" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb376-204"><a href="simulace2shift.html#cb376-204" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb376-205"><a href="simulace2shift.html#cb376-205" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb376-206"><a href="simulace2shift.html#cb376-206" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb376-207"><a href="simulace2shift.html#cb376-207" tabindex="-1"></a>    </span>
<span id="cb376-208"><a href="simulace2shift.html#cb376-208" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LDA&#39;</span>, </span>
<span id="cb376-209"><a href="simulace2shift.html#cb376-209" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb376-210"><a href="simulace2shift.html#cb376-210" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb376-211"><a href="simulace2shift.html#cb376-211" tabindex="-1"></a>    </span>
<span id="cb376-212"><a href="simulace2shift.html#cb376-212" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb376-213"><a href="simulace2shift.html#cb376-213" tabindex="-1"></a>    </span>
<span id="cb376-214"><a href="simulace2shift.html#cb376-214" tabindex="-1"></a>    <span class="do">## 3) Kvadratická diskriminační analýza</span></span>
<span id="cb376-215"><a href="simulace2shift.html#cb376-215" tabindex="-1"></a>    </span>
<span id="cb376-216"><a href="simulace2shift.html#cb376-216" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb376-217"><a href="simulace2shift.html#cb376-217" tabindex="-1"></a>    clf.QDA <span class="ot">&lt;-</span> <span class="fu">qda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb376-218"><a href="simulace2shift.html#cb376-218" tabindex="-1"></a>    </span>
<span id="cb376-219"><a href="simulace2shift.html#cb376-219" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb376-220"><a href="simulace2shift.html#cb376-220" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb376-221"><a href="simulace2shift.html#cb376-221" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb376-222"><a href="simulace2shift.html#cb376-222" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb376-223"><a href="simulace2shift.html#cb376-223" tabindex="-1"></a>      </span>
<span id="cb376-224"><a href="simulace2shift.html#cb376-224" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb376-225"><a href="simulace2shift.html#cb376-225" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb376-226"><a href="simulace2shift.html#cb376-226" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb376-227"><a href="simulace2shift.html#cb376-227" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb376-228"><a href="simulace2shift.html#cb376-228" tabindex="-1"></a>    </span>
<span id="cb376-229"><a href="simulace2shift.html#cb376-229" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;QDA&#39;</span>, </span>
<span id="cb376-230"><a href="simulace2shift.html#cb376-230" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb376-231"><a href="simulace2shift.html#cb376-231" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb376-232"><a href="simulace2shift.html#cb376-232" tabindex="-1"></a>    </span>
<span id="cb376-233"><a href="simulace2shift.html#cb376-233" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb376-234"><a href="simulace2shift.html#cb376-234" tabindex="-1"></a>    </span>
<span id="cb376-235"><a href="simulace2shift.html#cb376-235" tabindex="-1"></a>    <span class="do">## 7) SVM</span></span>
<span id="cb376-236"><a href="simulace2shift.html#cb376-236" tabindex="-1"></a>    </span>
<span id="cb376-237"><a href="simulace2shift.html#cb376-237" tabindex="-1"></a>    <span class="do">### 7.1) Diskretizace intervalu</span></span>
<span id="cb376-238"><a href="simulace2shift.html#cb376-238" tabindex="-1"></a>    </span>
<span id="cb376-239"><a href="simulace2shift.html#cb376-239" tabindex="-1"></a>    <span class="co"># posloupnost bodu, ve kterych funkce vyhodnotime</span></span>
<span id="cb376-240"><a href="simulace2shift.html#cb376-240" tabindex="-1"></a>    t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">12</span>, <span class="at">length =</span> <span class="dv">101</span>)</span>
<span id="cb376-241"><a href="simulace2shift.html#cb376-241" tabindex="-1"></a>       </span>
<span id="cb376-242"><a href="simulace2shift.html#cb376-242" tabindex="-1"></a>    grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb376-243"><a href="simulace2shift.html#cb376-243" tabindex="-1"></a>    grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) <span class="co"># transpozice kvuli funkcim v radku</span></span>
<span id="cb376-244"><a href="simulace2shift.html#cb376-244" tabindex="-1"></a>    grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb376-245"><a href="simulace2shift.html#cb376-245" tabindex="-1"></a>    </span>
<span id="cb376-246"><a href="simulace2shift.html#cb376-246" tabindex="-1"></a>    grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb376-247"><a href="simulace2shift.html#cb376-247" tabindex="-1"></a>    grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb376-248"><a href="simulace2shift.html#cb376-248" tabindex="-1"></a>    grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb376-249"><a href="simulace2shift.html#cb376-249" tabindex="-1"></a>    </span>
<span id="cb376-250"><a href="simulace2shift.html#cb376-250" tabindex="-1"></a>    <span class="co"># trenovaci dataset</span></span>
<span id="cb376-251"><a href="simulace2shift.html#cb376-251" tabindex="-1"></a>    data.Bbasis.train <span class="ot">&lt;-</span> <span class="fu">t</span>(X.train<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb376-252"><a href="simulace2shift.html#cb376-252" tabindex="-1"></a>    data.Bbasis.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb376-253"><a href="simulace2shift.html#cb376-253" tabindex="-1"></a>    </span>
<span id="cb376-254"><a href="simulace2shift.html#cb376-254" tabindex="-1"></a>    <span class="co"># testovaci dataset</span></span>
<span id="cb376-255"><a href="simulace2shift.html#cb376-255" tabindex="-1"></a>    data.Bbasis.test <span class="ot">&lt;-</span> <span class="fu">t</span>(X.test<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb376-256"><a href="simulace2shift.html#cb376-256" tabindex="-1"></a>    data.Bbasis.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb376-257"><a href="simulace2shift.html#cb376-257" tabindex="-1"></a>    </span>
<span id="cb376-258"><a href="simulace2shift.html#cb376-258" tabindex="-1"></a>    clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb376-259"><a href="simulace2shift.html#cb376-259" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb376-260"><a href="simulace2shift.html#cb376-260" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb376-261"><a href="simulace2shift.html#cb376-261" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb376-262"><a href="simulace2shift.html#cb376-262" tabindex="-1"></a>    </span>
<span id="cb376-263"><a href="simulace2shift.html#cb376-263" tabindex="-1"></a>    clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb376-264"><a href="simulace2shift.html#cb376-264" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb376-265"><a href="simulace2shift.html#cb376-265" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb376-266"><a href="simulace2shift.html#cb376-266" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb376-267"><a href="simulace2shift.html#cb376-267" tabindex="-1"></a>    </span>
<span id="cb376-268"><a href="simulace2shift.html#cb376-268" tabindex="-1"></a>    clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb376-269"><a href="simulace2shift.html#cb376-269" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb376-270"><a href="simulace2shift.html#cb376-270" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb376-271"><a href="simulace2shift.html#cb376-271" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb376-272"><a href="simulace2shift.html#cb376-272" tabindex="-1"></a>    </span>
<span id="cb376-273"><a href="simulace2shift.html#cb376-273" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb376-274"><a href="simulace2shift.html#cb376-274" tabindex="-1"></a>    predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data)</span>
<span id="cb376-275"><a href="simulace2shift.html#cb376-275" tabindex="-1"></a>    presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb376-276"><a href="simulace2shift.html#cb376-276" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb376-277"><a href="simulace2shift.html#cb376-277" tabindex="-1"></a>    </span>
<span id="cb376-278"><a href="simulace2shift.html#cb376-278" tabindex="-1"></a>    predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data)</span>
<span id="cb376-279"><a href="simulace2shift.html#cb376-279" tabindex="-1"></a>    presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb376-280"><a href="simulace2shift.html#cb376-280" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb376-281"><a href="simulace2shift.html#cb376-281" tabindex="-1"></a>    </span>
<span id="cb376-282"><a href="simulace2shift.html#cb376-282" tabindex="-1"></a>    predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data)</span>
<span id="cb376-283"><a href="simulace2shift.html#cb376-283" tabindex="-1"></a>    presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb376-284"><a href="simulace2shift.html#cb376-284" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb376-285"><a href="simulace2shift.html#cb376-285" tabindex="-1"></a>    </span>
<span id="cb376-286"><a href="simulace2shift.html#cb376-286" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb376-287"><a href="simulace2shift.html#cb376-287" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb376-288"><a href="simulace2shift.html#cb376-288" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb376-289"><a href="simulace2shift.html#cb376-289" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb376-290"><a href="simulace2shift.html#cb376-290" tabindex="-1"></a>    </span>
<span id="cb376-291"><a href="simulace2shift.html#cb376-291" tabindex="-1"></a>    predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb376-292"><a href="simulace2shift.html#cb376-292" tabindex="-1"></a>    presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb376-293"><a href="simulace2shift.html#cb376-293" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb376-294"><a href="simulace2shift.html#cb376-294" tabindex="-1"></a>    </span>
<span id="cb376-295"><a href="simulace2shift.html#cb376-295" tabindex="-1"></a>    predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb376-296"><a href="simulace2shift.html#cb376-296" tabindex="-1"></a>    presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb376-297"><a href="simulace2shift.html#cb376-297" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb376-298"><a href="simulace2shift.html#cb376-298" tabindex="-1"></a>    </span>
<span id="cb376-299"><a href="simulace2shift.html#cb376-299" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - diskr&#39;</span>, </span>
<span id="cb376-300"><a href="simulace2shift.html#cb376-300" tabindex="-1"></a>                                <span class="st">&#39;SVM poly - diskr&#39;</span>, </span>
<span id="cb376-301"><a href="simulace2shift.html#cb376-301" tabindex="-1"></a>                                <span class="st">&#39;SVM rbf - diskr&#39;</span>), </span>
<span id="cb376-302"><a href="simulace2shift.html#cb376-302" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l,</span>
<span id="cb376-303"><a href="simulace2shift.html#cb376-303" tabindex="-1"></a>                                        presnost.train.p, presnost.train.r),</span>
<span id="cb376-304"><a href="simulace2shift.html#cb376-304" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb376-305"><a href="simulace2shift.html#cb376-305" tabindex="-1"></a>                                       presnost.test.p, presnost.test.r))</span>
<span id="cb376-306"><a href="simulace2shift.html#cb376-306" tabindex="-1"></a>    </span>
<span id="cb376-307"><a href="simulace2shift.html#cb376-307" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb376-308"><a href="simulace2shift.html#cb376-308" tabindex="-1"></a>    </span>
<span id="cb376-309"><a href="simulace2shift.html#cb376-309" tabindex="-1"></a>    <span class="do">### 7.2) Skóre hlavních komponent</span></span>
<span id="cb376-310"><a href="simulace2shift.html#cb376-310" tabindex="-1"></a>    </span>
<span id="cb376-311"><a href="simulace2shift.html#cb376-311" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb376-312"><a href="simulace2shift.html#cb376-312" tabindex="-1"></a>    clf.SVM.l.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb376-313"><a href="simulace2shift.html#cb376-313" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb376-314"><a href="simulace2shift.html#cb376-314" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb376-315"><a href="simulace2shift.html#cb376-315" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb376-316"><a href="simulace2shift.html#cb376-316" tabindex="-1"></a>    </span>
<span id="cb376-317"><a href="simulace2shift.html#cb376-317" tabindex="-1"></a>    clf.SVM.p.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb376-318"><a href="simulace2shift.html#cb376-318" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb376-319"><a href="simulace2shift.html#cb376-319" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb376-320"><a href="simulace2shift.html#cb376-320" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb376-321"><a href="simulace2shift.html#cb376-321" tabindex="-1"></a>    </span>
<span id="cb376-322"><a href="simulace2shift.html#cb376-322" tabindex="-1"></a>    clf.SVM.r.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb376-323"><a href="simulace2shift.html#cb376-323" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb376-324"><a href="simulace2shift.html#cb376-324" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb376-325"><a href="simulace2shift.html#cb376-325" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb376-326"><a href="simulace2shift.html#cb376-326" tabindex="-1"></a>    </span>
<span id="cb376-327"><a href="simulace2shift.html#cb376-327" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb376-328"><a href="simulace2shift.html#cb376-328" tabindex="-1"></a>    predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb376-329"><a href="simulace2shift.html#cb376-329" tabindex="-1"></a>    presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb376-330"><a href="simulace2shift.html#cb376-330" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb376-331"><a href="simulace2shift.html#cb376-331" tabindex="-1"></a>    </span>
<span id="cb376-332"><a href="simulace2shift.html#cb376-332" tabindex="-1"></a>    predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb376-333"><a href="simulace2shift.html#cb376-333" tabindex="-1"></a>    presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb376-334"><a href="simulace2shift.html#cb376-334" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb376-335"><a href="simulace2shift.html#cb376-335" tabindex="-1"></a>    </span>
<span id="cb376-336"><a href="simulace2shift.html#cb376-336" tabindex="-1"></a>    predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb376-337"><a href="simulace2shift.html#cb376-337" tabindex="-1"></a>    presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb376-338"><a href="simulace2shift.html#cb376-338" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb376-339"><a href="simulace2shift.html#cb376-339" tabindex="-1"></a>      </span>
<span id="cb376-340"><a href="simulace2shift.html#cb376-340" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb376-341"><a href="simulace2shift.html#cb376-341" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb376-342"><a href="simulace2shift.html#cb376-342" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb376-343"><a href="simulace2shift.html#cb376-343" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb376-344"><a href="simulace2shift.html#cb376-344" tabindex="-1"></a>    </span>
<span id="cb376-345"><a href="simulace2shift.html#cb376-345" tabindex="-1"></a>    predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb376-346"><a href="simulace2shift.html#cb376-346" tabindex="-1"></a>    presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb376-347"><a href="simulace2shift.html#cb376-347" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb376-348"><a href="simulace2shift.html#cb376-348" tabindex="-1"></a>    </span>
<span id="cb376-349"><a href="simulace2shift.html#cb376-349" tabindex="-1"></a>    predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb376-350"><a href="simulace2shift.html#cb376-350" tabindex="-1"></a>    presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb376-351"><a href="simulace2shift.html#cb376-351" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb376-352"><a href="simulace2shift.html#cb376-352" tabindex="-1"></a>    </span>
<span id="cb376-353"><a href="simulace2shift.html#cb376-353" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - PCA&#39;</span>, </span>
<span id="cb376-354"><a href="simulace2shift.html#cb376-354" tabindex="-1"></a>                                <span class="st">&#39;SVM poly - PCA&#39;</span>, </span>
<span id="cb376-355"><a href="simulace2shift.html#cb376-355" tabindex="-1"></a>                                <span class="st">&#39;SVM rbf - PCA&#39;</span>), </span>
<span id="cb376-356"><a href="simulace2shift.html#cb376-356" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, </span>
<span id="cb376-357"><a href="simulace2shift.html#cb376-357" tabindex="-1"></a>                                        presnost.train.p, presnost.train.r),</span>
<span id="cb376-358"><a href="simulace2shift.html#cb376-358" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb376-359"><a href="simulace2shift.html#cb376-359" tabindex="-1"></a>                                       presnost.test.p, presnost.test.r))</span>
<span id="cb376-360"><a href="simulace2shift.html#cb376-360" tabindex="-1"></a>    </span>
<span id="cb376-361"><a href="simulace2shift.html#cb376-361" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb376-362"><a href="simulace2shift.html#cb376-362" tabindex="-1"></a>    </span>
<span id="cb376-363"><a href="simulace2shift.html#cb376-363" tabindex="-1"></a>    <span class="do">### 7.3) Bázové koeficienty</span></span>
<span id="cb376-364"><a href="simulace2shift.html#cb376-364" tabindex="-1"></a>    </span>
<span id="cb376-365"><a href="simulace2shift.html#cb376-365" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb376-366"><a href="simulace2shift.html#cb376-366" tabindex="-1"></a>    clf.SVM.l.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb376-367"><a href="simulace2shift.html#cb376-367" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb376-368"><a href="simulace2shift.html#cb376-368" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb376-369"><a href="simulace2shift.html#cb376-369" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb376-370"><a href="simulace2shift.html#cb376-370" tabindex="-1"></a>    </span>
<span id="cb376-371"><a href="simulace2shift.html#cb376-371" tabindex="-1"></a>    clf.SVM.p.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb376-372"><a href="simulace2shift.html#cb376-372" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb376-373"><a href="simulace2shift.html#cb376-373" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb376-374"><a href="simulace2shift.html#cb376-374" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb376-375"><a href="simulace2shift.html#cb376-375" tabindex="-1"></a>    </span>
<span id="cb376-376"><a href="simulace2shift.html#cb376-376" tabindex="-1"></a>    clf.SVM.r.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb376-377"><a href="simulace2shift.html#cb376-377" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb376-378"><a href="simulace2shift.html#cb376-378" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb376-379"><a href="simulace2shift.html#cb376-379" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb376-380"><a href="simulace2shift.html#cb376-380" tabindex="-1"></a>    </span>
<span id="cb376-381"><a href="simulace2shift.html#cb376-381" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb376-382"><a href="simulace2shift.html#cb376-382" tabindex="-1"></a>    predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb376-383"><a href="simulace2shift.html#cb376-383" tabindex="-1"></a>    presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb376-384"><a href="simulace2shift.html#cb376-384" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb376-385"><a href="simulace2shift.html#cb376-385" tabindex="-1"></a>    </span>
<span id="cb376-386"><a href="simulace2shift.html#cb376-386" tabindex="-1"></a>    predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb376-387"><a href="simulace2shift.html#cb376-387" tabindex="-1"></a>    presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb376-388"><a href="simulace2shift.html#cb376-388" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb376-389"><a href="simulace2shift.html#cb376-389" tabindex="-1"></a>    </span>
<span id="cb376-390"><a href="simulace2shift.html#cb376-390" tabindex="-1"></a>    predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb376-391"><a href="simulace2shift.html#cb376-391" tabindex="-1"></a>    presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb376-392"><a href="simulace2shift.html#cb376-392" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb376-393"><a href="simulace2shift.html#cb376-393" tabindex="-1"></a>      </span>
<span id="cb376-394"><a href="simulace2shift.html#cb376-394" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb376-395"><a href="simulace2shift.html#cb376-395" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb376-396"><a href="simulace2shift.html#cb376-396" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb376-397"><a href="simulace2shift.html#cb376-397" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb376-398"><a href="simulace2shift.html#cb376-398" tabindex="-1"></a>    </span>
<span id="cb376-399"><a href="simulace2shift.html#cb376-399" tabindex="-1"></a>    predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb376-400"><a href="simulace2shift.html#cb376-400" tabindex="-1"></a>    presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb376-401"><a href="simulace2shift.html#cb376-401" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb376-402"><a href="simulace2shift.html#cb376-402" tabindex="-1"></a>    </span>
<span id="cb376-403"><a href="simulace2shift.html#cb376-403" tabindex="-1"></a>    predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb376-404"><a href="simulace2shift.html#cb376-404" tabindex="-1"></a>    presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb376-405"><a href="simulace2shift.html#cb376-405" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb376-406"><a href="simulace2shift.html#cb376-406" tabindex="-1"></a>    </span>
<span id="cb376-407"><a href="simulace2shift.html#cb376-407" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - Fbasis&#39;</span>, </span>
<span id="cb376-408"><a href="simulace2shift.html#cb376-408" tabindex="-1"></a>                                <span class="st">&#39;SVM poly - Fbasis&#39;</span>, </span>
<span id="cb376-409"><a href="simulace2shift.html#cb376-409" tabindex="-1"></a>                                <span class="st">&#39;SVM rbf - Fbasis&#39;</span>), </span>
<span id="cb376-410"><a href="simulace2shift.html#cb376-410" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, </span>
<span id="cb376-411"><a href="simulace2shift.html#cb376-411" tabindex="-1"></a>                                        presnost.train.p, presnost.train.r),</span>
<span id="cb376-412"><a href="simulace2shift.html#cb376-412" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb376-413"><a href="simulace2shift.html#cb376-413" tabindex="-1"></a>                                       presnost.test.p, presnost.test.r))</span>
<span id="cb376-414"><a href="simulace2shift.html#cb376-414" tabindex="-1"></a>  </span>
<span id="cb376-415"><a href="simulace2shift.html#cb376-415" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb376-416"><a href="simulace2shift.html#cb376-416" tabindex="-1"></a>    </span>
<span id="cb376-417"><a href="simulace2shift.html#cb376-417" tabindex="-1"></a>    <span class="do">### 7.4) Projekce na Fourierovu bázi</span></span>
<span id="cb376-418"><a href="simulace2shift.html#cb376-418" tabindex="-1"></a>    </span>
<span id="cb376-419"><a href="simulace2shift.html#cb376-419" tabindex="-1"></a>    <span class="co"># hodnoty pro Fourierovu bazi</span></span>
<span id="cb376-420"><a href="simulace2shift.html#cb376-420" tabindex="-1"></a>    rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb376-421"><a href="simulace2shift.html#cb376-421" tabindex="-1"></a>    n_basis_min <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb376-422"><a href="simulace2shift.html#cb376-422" tabindex="-1"></a>    n_basis_max <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb376-423"><a href="simulace2shift.html#cb376-423" tabindex="-1"></a>    </span>
<span id="cb376-424"><a href="simulace2shift.html#cb376-424" tabindex="-1"></a>    dimensions <span class="ot">&lt;-</span> n_basis_min<span class="sc">:</span>n_basis_max</span>
<span id="cb376-425"><a href="simulace2shift.html#cb376-425" tabindex="-1"></a>    </span>
<span id="cb376-426"><a href="simulace2shift.html#cb376-426" tabindex="-1"></a>    folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb376-427"><a href="simulace2shift.html#cb376-427" tabindex="-1"></a>    CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">SVM.l =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb376-428"><a href="simulace2shift.html#cb376-428" tabindex="-1"></a>                       <span class="at">SVM.p =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb376-429"><a href="simulace2shift.html#cb376-429" tabindex="-1"></a>                       <span class="at">SVM.r =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv))</span>
<span id="cb376-430"><a href="simulace2shift.html#cb376-430" tabindex="-1"></a>    </span>
<span id="cb376-431"><a href="simulace2shift.html#cb376-431" tabindex="-1"></a>    <span class="cf">for</span> (d <span class="cf">in</span> dimensions) {</span>
<span id="cb376-432"><a href="simulace2shift.html#cb376-432" tabindex="-1"></a>      fbasis <span class="ot">&lt;-</span> <span class="fu">create.fourier.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb376-433"><a href="simulace2shift.html#cb376-433" tabindex="-1"></a>                                     <span class="at">nbasis =</span> d)</span>
<span id="cb376-434"><a href="simulace2shift.html#cb376-434" tabindex="-1"></a>      Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="at">argvals =</span> t, <span class="at">basisobj =</span> fbasis) </span>
<span id="cb376-435"><a href="simulace2shift.html#cb376-435" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb376-436"><a href="simulace2shift.html#cb376-436" tabindex="-1"></a>      </span>
<span id="cb376-437"><a href="simulace2shift.html#cb376-437" tabindex="-1"></a>      <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb376-438"><a href="simulace2shift.html#cb376-438" tabindex="-1"></a>        fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb376-439"><a href="simulace2shift.html#cb376-439" tabindex="-1"></a>        cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XX.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb376-440"><a href="simulace2shift.html#cb376-440" tabindex="-1"></a>        </span>
<span id="cb376-441"><a href="simulace2shift.html#cb376-441" tabindex="-1"></a>        data.projection.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[cv_sample, ])</span>
<span id="cb376-442"><a href="simulace2shift.html#cb376-442" tabindex="-1"></a>        data.projection.train.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[cv_sample])</span>
<span id="cb376-443"><a href="simulace2shift.html#cb376-443" tabindex="-1"></a>        data.projection.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb376-444"><a href="simulace2shift.html#cb376-444" tabindex="-1"></a>        Y.test.cv <span class="ot">&lt;-</span> Y.train[<span class="sc">!</span>cv_sample]</span>
<span id="cb376-445"><a href="simulace2shift.html#cb376-445" tabindex="-1"></a>        data.projection.test.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test.cv)</span>
<span id="cb376-446"><a href="simulace2shift.html#cb376-446" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb376-447"><a href="simulace2shift.html#cb376-447" tabindex="-1"></a>        clf.SVM.l.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb376-448"><a href="simulace2shift.html#cb376-448" tabindex="-1"></a>                                <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb376-449"><a href="simulace2shift.html#cb376-449" tabindex="-1"></a>                                <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb376-450"><a href="simulace2shift.html#cb376-450" tabindex="-1"></a>                                <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb376-451"><a href="simulace2shift.html#cb376-451" tabindex="-1"></a>        </span>
<span id="cb376-452"><a href="simulace2shift.html#cb376-452" tabindex="-1"></a>        clf.SVM.p.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb376-453"><a href="simulace2shift.html#cb376-453" tabindex="-1"></a>                                <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb376-454"><a href="simulace2shift.html#cb376-454" tabindex="-1"></a>                                <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb376-455"><a href="simulace2shift.html#cb376-455" tabindex="-1"></a>                                <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb376-456"><a href="simulace2shift.html#cb376-456" tabindex="-1"></a>        </span>
<span id="cb376-457"><a href="simulace2shift.html#cb376-457" tabindex="-1"></a>        clf.SVM.r.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb376-458"><a href="simulace2shift.html#cb376-458" tabindex="-1"></a>                                <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb376-459"><a href="simulace2shift.html#cb376-459" tabindex="-1"></a>                                <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb376-460"><a href="simulace2shift.html#cb376-460" tabindex="-1"></a>                                <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb376-461"><a href="simulace2shift.html#cb376-461" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb376-462"><a href="simulace2shift.html#cb376-462" tabindex="-1"></a>        <span class="do">## linear kernel</span></span>
<span id="cb376-463"><a href="simulace2shift.html#cb376-463" tabindex="-1"></a>        predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.projection,</span>
<span id="cb376-464"><a href="simulace2shift.html#cb376-464" tabindex="-1"></a>                                      <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb376-465"><a href="simulace2shift.html#cb376-465" tabindex="-1"></a>        presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb376-466"><a href="simulace2shift.html#cb376-466" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb376-467"><a href="simulace2shift.html#cb376-467" tabindex="-1"></a>        <span class="do">## polynomial kernel</span></span>
<span id="cb376-468"><a href="simulace2shift.html#cb376-468" tabindex="-1"></a>        predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.projection, </span>
<span id="cb376-469"><a href="simulace2shift.html#cb376-469" tabindex="-1"></a>                                      <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb376-470"><a href="simulace2shift.html#cb376-470" tabindex="-1"></a>        presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb376-471"><a href="simulace2shift.html#cb376-471" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb376-472"><a href="simulace2shift.html#cb376-472" tabindex="-1"></a>        <span class="do">## radial kernel</span></span>
<span id="cb376-473"><a href="simulace2shift.html#cb376-473" tabindex="-1"></a>        predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.projection,</span>
<span id="cb376-474"><a href="simulace2shift.html#cb376-474" tabindex="-1"></a>                                      <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb376-475"><a href="simulace2shift.html#cb376-475" tabindex="-1"></a>        presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb376-476"><a href="simulace2shift.html#cb376-476" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb376-477"><a href="simulace2shift.html#cb376-477" tabindex="-1"></a>        </span>
<span id="cb376-478"><a href="simulace2shift.html#cb376-478" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane d a fold</span></span>
<span id="cb376-479"><a href="simulace2shift.html#cb376-479" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.l[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb376-480"><a href="simulace2shift.html#cb376-480" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb376-481"><a href="simulace2shift.html#cb376-481" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb376-482"><a href="simulace2shift.html#cb376-482" tabindex="-1"></a>      }</span>
<span id="cb376-483"><a href="simulace2shift.html#cb376-483" tabindex="-1"></a>    }</span>
<span id="cb376-484"><a href="simulace2shift.html#cb376-484" tabindex="-1"></a>    </span>
<span id="cb376-485"><a href="simulace2shift.html#cb376-485" tabindex="-1"></a>    <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb376-486"><a href="simulace2shift.html#cb376-486" tabindex="-1"></a>    <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb376-487"><a href="simulace2shift.html#cb376-487" tabindex="-1"></a>      CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb376-488"><a href="simulace2shift.html#cb376-488" tabindex="-1"></a>    }</span>
<span id="cb376-489"><a href="simulace2shift.html#cb376-489" tabindex="-1"></a>    </span>
<span id="cb376-490"><a href="simulace2shift.html#cb376-490" tabindex="-1"></a>    d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb376-491"><a href="simulace2shift.html#cb376-491" tabindex="-1"></a>               <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb376-492"><a href="simulace2shift.html#cb376-492" tabindex="-1"></a>               <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb376-493"><a href="simulace2shift.html#cb376-493" tabindex="-1"></a>    </span>
<span id="cb376-494"><a href="simulace2shift.html#cb376-494" tabindex="-1"></a>    <span class="co"># ulozime optimalni d do datove tabulky</span></span>
<span id="cb376-495"><a href="simulace2shift.html#cb376-495" tabindex="-1"></a>    CV_RESULTS[sim, <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb376-496"><a href="simulace2shift.html#cb376-496" tabindex="-1"></a>    </span>
<span id="cb376-497"><a href="simulace2shift.html#cb376-497" tabindex="-1"></a>    <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb376-498"><a href="simulace2shift.html#cb376-498" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - projection&#39;</span>, </span>
<span id="cb376-499"><a href="simulace2shift.html#cb376-499" tabindex="-1"></a>                                <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb376-500"><a href="simulace2shift.html#cb376-500" tabindex="-1"></a>                                <span class="st">&#39;SVM rbf - projection&#39;</span>), </span>
<span id="cb376-501"><a href="simulace2shift.html#cb376-501" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb376-502"><a href="simulace2shift.html#cb376-502" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb376-503"><a href="simulace2shift.html#cb376-503" tabindex="-1"></a>    </span>
<span id="cb376-504"><a href="simulace2shift.html#cb376-504" tabindex="-1"></a>    <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb376-505"><a href="simulace2shift.html#cb376-505" tabindex="-1"></a>      kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb376-506"><a href="simulace2shift.html#cb376-506" tabindex="-1"></a>      fbasis <span class="ot">&lt;-</span> <span class="fu">create.fourier.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb376-507"><a href="simulace2shift.html#cb376-507" tabindex="-1"></a>                                     <span class="at">nbasis =</span> d.opt[kernel_number])</span>
<span id="cb376-508"><a href="simulace2shift.html#cb376-508" tabindex="-1"></a>      Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="at">argvals =</span> t, <span class="at">basisobj =</span> fbasis) </span>
<span id="cb376-509"><a href="simulace2shift.html#cb376-509" tabindex="-1"></a>      </span>
<span id="cb376-510"><a href="simulace2shift.html#cb376-510" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb376-511"><a href="simulace2shift.html#cb376-511" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb376-512"><a href="simulace2shift.html#cb376-512" tabindex="-1"></a>      </span>
<span id="cb376-513"><a href="simulace2shift.html#cb376-513" tabindex="-1"></a>      data.projection.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train)</span>
<span id="cb376-514"><a href="simulace2shift.html#cb376-514" tabindex="-1"></a>      data.projection.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb376-515"><a href="simulace2shift.html#cb376-515" tabindex="-1"></a>      </span>
<span id="cb376-516"><a href="simulace2shift.html#cb376-516" tabindex="-1"></a>      data.projection.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.test)</span>
<span id="cb376-517"><a href="simulace2shift.html#cb376-517" tabindex="-1"></a>      data.projection.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb376-518"><a href="simulace2shift.html#cb376-518" tabindex="-1"></a>      </span>
<span id="cb376-519"><a href="simulace2shift.html#cb376-519" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb376-520"><a href="simulace2shift.html#cb376-520" tabindex="-1"></a>      clf.SVM.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train,</span>
<span id="cb376-521"><a href="simulace2shift.html#cb376-521" tabindex="-1"></a>                                <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb376-522"><a href="simulace2shift.html#cb376-522" tabindex="-1"></a>                                <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb376-523"><a href="simulace2shift.html#cb376-523" tabindex="-1"></a>                                <span class="at">kernel =</span> kernel_type)</span>
<span id="cb376-524"><a href="simulace2shift.html#cb376-524" tabindex="-1"></a>      </span>
<span id="cb376-525"><a href="simulace2shift.html#cb376-525" tabindex="-1"></a>      <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb376-526"><a href="simulace2shift.html#cb376-526" tabindex="-1"></a>      predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.train)</span>
<span id="cb376-527"><a href="simulace2shift.html#cb376-527" tabindex="-1"></a>      presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb376-528"><a href="simulace2shift.html#cb376-528" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb376-529"><a href="simulace2shift.html#cb376-529" tabindex="-1"></a>        </span>
<span id="cb376-530"><a href="simulace2shift.html#cb376-530" tabindex="-1"></a>      <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb376-531"><a href="simulace2shift.html#cb376-531" tabindex="-1"></a>      predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.test)</span>
<span id="cb376-532"><a href="simulace2shift.html#cb376-532" tabindex="-1"></a>      presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb376-533"><a href="simulace2shift.html#cb376-533" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb376-534"><a href="simulace2shift.html#cb376-534" tabindex="-1"></a>      </span>
<span id="cb376-535"><a href="simulace2shift.html#cb376-535" tabindex="-1"></a>      <span class="co"># ulozeni vysledku</span></span>
<span id="cb376-536"><a href="simulace2shift.html#cb376-536" tabindex="-1"></a>      Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb376-537"><a href="simulace2shift.html#cb376-537" tabindex="-1"></a>    }</span>
<span id="cb376-538"><a href="simulace2shift.html#cb376-538" tabindex="-1"></a>    </span>
<span id="cb376-539"><a href="simulace2shift.html#cb376-539" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb376-540"><a href="simulace2shift.html#cb376-540" tabindex="-1"></a>    </span>
<span id="cb376-541"><a href="simulace2shift.html#cb376-541" tabindex="-1"></a>    <span class="do">## pridame vysledky do objektu SIMULACE</span></span>
<span id="cb376-542"><a href="simulace2shift.html#cb376-542" tabindex="-1"></a>    </span>
<span id="cb376-543"><a href="simulace2shift.html#cb376-543" tabindex="-1"></a>    SIMULACE<span class="sc">$</span>train[sim, ] <span class="ot">&lt;-</span> RESULTS<span class="sc">$</span>Err.train</span>
<span id="cb376-544"><a href="simulace2shift.html#cb376-544" tabindex="-1"></a>    SIMULACE<span class="sc">$</span>test[sim, ] <span class="ot">&lt;-</span> RESULTS<span class="sc">$</span>Err.test</span>
<span id="cb376-545"><a href="simulace2shift.html#cb376-545" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&#39;</span><span class="sc">\r</span><span class="st">&#39;</span>, <span class="fu">paste0</span>(n_shift, <span class="st">&#39;: &#39;</span>, sim))</span>
<span id="cb376-546"><a href="simulace2shift.html#cb376-546" tabindex="-1"></a>  }</span>
<span id="cb376-547"><a href="simulace2shift.html#cb376-547" tabindex="-1"></a>  </span>
<span id="cb376-548"><a href="simulace2shift.html#cb376-548" tabindex="-1"></a>  <span class="co"># Nyní spočítáme průměrné testovací a trénovací chybovosti pro jednotlivé klasifikační metody.</span></span>
<span id="cb376-549"><a href="simulace2shift.html#cb376-549" tabindex="-1"></a>  </span>
<span id="cb376-550"><a href="simulace2shift.html#cb376-550" tabindex="-1"></a>  <span class="co"># dame do vysledne tabulky</span></span>
<span id="cb376-551"><a href="simulace2shift.html#cb376-551" tabindex="-1"></a>  </span>
<span id="cb376-552"><a href="simulace2shift.html#cb376-552" tabindex="-1"></a>  SIMULACE.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Err.train =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>train, <span class="dv">2</span>, mean),</span>
<span id="cb376-553"><a href="simulace2shift.html#cb376-553" tabindex="-1"></a>                            <span class="at">Err.test =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>test, <span class="dv">2</span>, mean),</span>
<span id="cb376-554"><a href="simulace2shift.html#cb376-554" tabindex="-1"></a>                            <span class="at">SD.train =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>train, <span class="dv">2</span>, sd),</span>
<span id="cb376-555"><a href="simulace2shift.html#cb376-555" tabindex="-1"></a>                            <span class="at">SD.test =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>test, <span class="dv">2</span>, sd))</span>
<span id="cb376-556"><a href="simulace2shift.html#cb376-556" tabindex="-1"></a>  </span>
<span id="cb376-557"><a href="simulace2shift.html#cb376-557" tabindex="-1"></a>  SIMUL_params[, , n_shift] <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(SIMULACE.df)</span>
<span id="cb376-558"><a href="simulace2shift.html#cb376-558" tabindex="-1"></a>}</span>
<span id="cb376-559"><a href="simulace2shift.html#cb376-559" tabindex="-1"></a></span>
<span id="cb376-560"><a href="simulace2shift.html#cb376-560" tabindex="-1"></a><span class="co"># ulozime vysledne hodnoty </span></span>
<span id="cb376-561"><a href="simulace2shift.html#cb376-561" tabindex="-1"></a><span class="fu">save</span>(SIMUL_params, <span class="at">file =</span> <span class="st">&#39;RData/simulace_parametry_shift_02b.RData&#39;</span>)</span></code></pre></div>
</details>
<div id="grafický-výstup-1" class="section level3 hasAnchor" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Grafický výstup<a href="simulace2shift.html#grafický-výstup-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Podívejme se na závislost simulovaných výsledků na hodnotě parametru směrodatné odchylky vertikálního posunu.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="simulace2shift.html#cb377-1" tabindex="-1"></a><span class="co"># pro testovaci data</span></span>
<span id="cb377-2"><a href="simulace2shift.html#cb377-2" tabindex="-1"></a>SIMUL_params[, <span class="dv">2</span>, ] <span class="sc">|&gt;</span> </span>
<span id="cb377-3"><a href="simulace2shift.html#cb377-3" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb377-4"><a href="simulace2shift.html#cb377-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> methods) <span class="sc">|&gt;</span></span>
<span id="cb377-5"><a href="simulace2shift.html#cb377-5" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">as.character</span>(shift_vector), </span>
<span id="cb377-6"><a href="simulace2shift.html#cb377-6" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&#39;shift&#39;</span>, </span>
<span id="cb377-7"><a href="simulace2shift.html#cb377-7" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb377-8"><a href="simulace2shift.html#cb377-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>), </span>
<span id="cb377-9"><a href="simulace2shift.html#cb377-9" tabindex="-1"></a>         <span class="at">shift =</span> <span class="fu">as.numeric</span>(shift)) <span class="sc">|&gt;</span> </span>
<span id="cb377-10"><a href="simulace2shift.html#cb377-10" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;KNN&#39;</span>, <span class="st">&#39;LDA&#39;</span>, <span class="st">&#39;SVM linear - diskr&#39;</span>,</span>
<span id="cb377-11"><a href="simulace2shift.html#cb377-11" tabindex="-1"></a>                       <span class="st">&#39;SVM linear - PCA&#39;</span>, <span class="st">&#39;SVM linear - Fbasis&#39;</span>,</span>
<span id="cb377-12"><a href="simulace2shift.html#cb377-12" tabindex="-1"></a>                       <span class="st">&#39;SVM linear - projection&#39;</span>, <span class="st">&#39;SVM rbf - projection&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb377-13"><a href="simulace2shift.html#cb377-13" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> shift, <span class="at">y =</span> Err, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb377-14"><a href="simulace2shift.html#cb377-14" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb377-15"><a href="simulace2shift.html#cb377-15" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb377-16"><a href="simulace2shift.html#cb377-16" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(sigma[shift]),</span>
<span id="cb377-17"><a href="simulace2shift.html#cb377-17" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(Err)[test]),</span>
<span id="cb377-18"><a href="simulace2shift.html#cb377-18" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Klasifikační metoda&#39;</span>) <span class="sc">+</span> </span>
<span id="cb377-19"><a href="simulace2shift.html#cb377-19" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;bottom&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-55"></span>
<img src="04-Simulace_2_shift_files/figure-html/unnamed-chunk-55-1.png" alt="Graf závislosti testovací chybovosti pro jednotlivé klasifikační metody na hodnotě parametru $\sigma_{shift}$, který definuje směrodatnou odchylku pro generování vertikálního posunutí simulovaných křivek." width="672" />
<p class="caption">
Obrázek 3.8: Graf závislosti testovací chybovosti pro jednotlivé klasifikační metody na hodnotě parametru <span class="math inline">\(\sigma_{shift}\)</span>, který definuje směrodatnou odchylku pro generování vertikálního posunutí simulovaných křivek.
</p>
</div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simulace2sigma.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="simulace3.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": null,
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/Tomas-Pompa/MastersThesis/blob/main/04-Simulace_2_shift.Rmd",
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
