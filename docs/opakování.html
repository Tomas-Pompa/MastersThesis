<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Kapitola 5 Opakování | Diplomová práce</title>
  <meta name="description" content="Kapitola 5 Opakování | Diplomová práce" />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="Kapitola 5 Opakování | Diplomová práce" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Kapitola 5 Opakování | Diplomová práce" />
  
  
  

<meta name="author" content="Tomáš Pompa" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tabulka-výsledků-2.html"/>
<link rel="next" href="vlastnosti-metody-rkhs-svm.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/codefolding-lua-1.1/codefolding-lua.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="sci-lg-eng-rgb.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Metoda podpůrných vektorů pro funkcionální data</a></li>
<li class="chapter" data-level="2" data-path="simulace-1.html"><a href="simulace-1.html"><i class="fa fa-check"></i><b>2</b> Simulace 1</a>
<ul>
<li class="chapter" data-level="2.1" data-path="simulace-funkcionálních-dat.html"><a href="simulace-funkcionálních-dat.html"><i class="fa fa-check"></i><b>2.1</b> Simulace funkcionálních dat</a></li>
<li class="chapter" data-level="2.2" data-path="vyhlazení-pozorovaných-křivek.html"><a href="vyhlazení-pozorovaných-křivek.html"><i class="fa fa-check"></i><b>2.2</b> Vyhlazení pozorovaných křivek</a></li>
<li class="chapter" data-level="2.3" data-path="klasifikace-křivek.html"><a href="klasifikace-křivek.html"><i class="fa fa-check"></i><b>2.3</b> Klasifikace křivek</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="klasifikace-křivek.html"><a href="klasifikace-křivek.html#k-nejbližších-sousedů"><i class="fa fa-check"></i><b>2.3.1</b> 1) <span class="math inline">\(K\)</span> nejbližších sousedů</a></li>
<li class="chapter" data-level="2.3.2" data-path="klasifikace-křivek.html"><a href="klasifikace-křivek.html#lineární-diskriminační-analýza"><i class="fa fa-check"></i><b>2.3.2</b> 2) Lineární diskriminační analýza</a></li>
<li class="chapter" data-level="2.3.3" data-path="klasifikace-křivek.html"><a href="klasifikace-křivek.html#kvadratická-diskriminační-analýza"><i class="fa fa-check"></i><b>2.3.3</b> 3) Kvadratická diskriminační analýza</a></li>
<li class="chapter" data-level="2.3.4" data-path="klasifikace-křivek.html"><a href="klasifikace-křivek.html#logistická-regrese"><i class="fa fa-check"></i><b>2.3.4</b> 4) Logistická regrese</a></li>
<li class="chapter" data-level="2.3.5" data-path="klasifikace-křivek.html"><a href="klasifikace-křivek.html#rozhodovací-stromy"><i class="fa fa-check"></i><b>2.3.5</b> 5) Rozhodovací stromy</a></li>
<li class="chapter" data-level="2.3.6" data-path="klasifikace-křivek.html"><a href="klasifikace-křivek.html#náhodné-lesy"><i class="fa fa-check"></i><b>2.3.6</b> 6) Náhodné lesy</a></li>
<li class="chapter" data-level="2.3.7" data-path="klasifikace-křivek.html"><a href="klasifikace-křivek.html#support-vector-machines"><i class="fa fa-check"></i><b>2.3.7</b> 7) Support Vector Machines</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="tabulka-výsledků.html"><a href="tabulka-výsledků.html"><i class="fa fa-check"></i><b>2.4</b> Tabulka výsledků</a></li>
<li class="chapter" data-level="2.5" data-path="simulační-studie.html"><a href="simulační-studie.html"><i class="fa fa-check"></i><b>2.5</b> Simulační studie</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="simulační-studie.html"><a href="simulační-studie.html#výsledky"><i class="fa fa-check"></i><b>2.5.1</b> Výsledky</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="simulace-2.html"><a href="simulace-2.html"><i class="fa fa-check"></i><b>3</b> Simulace 2</a>
<ul>
<li class="chapter" data-level="3.1" data-path="simulace-funkcionálních-dat-1.html"><a href="simulace-funkcionálních-dat-1.html"><i class="fa fa-check"></i><b>3.1</b> Simulace funkcionálních dat</a></li>
<li class="chapter" data-level="3.2" data-path="vyhlazení-pozorovaných-křivek-1.html"><a href="vyhlazení-pozorovaných-křivek-1.html"><i class="fa fa-check"></i><b>3.2</b> Vyhlazení pozorovaných křivek</a></li>
<li class="chapter" data-level="3.3" data-path="klasifikace-křivek-1.html"><a href="klasifikace-křivek-1.html"><i class="fa fa-check"></i><b>3.3</b> Klasifikace křivek</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="klasifikace-křivek-1.html"><a href="klasifikace-křivek-1.html#k-nejbližších-sousedů-1"><i class="fa fa-check"></i><b>3.3.1</b> 1) <span class="math inline">\(K\)</span> nejbližších sousedů</a></li>
<li class="chapter" data-level="3.3.2" data-path="klasifikace-křivek-1.html"><a href="klasifikace-křivek-1.html#lineární-diskriminační-analýza-1"><i class="fa fa-check"></i><b>3.3.2</b> 2) Lineární diskriminační analýza</a></li>
<li class="chapter" data-level="3.3.3" data-path="klasifikace-křivek-1.html"><a href="klasifikace-křivek-1.html#kvadratická-diskriminační-analýza-1"><i class="fa fa-check"></i><b>3.3.3</b> 3) Kvadratická diskriminační analýza</a></li>
<li class="chapter" data-level="3.3.4" data-path="klasifikace-křivek-1.html"><a href="klasifikace-křivek-1.html#logistická-regrese-1"><i class="fa fa-check"></i><b>3.3.4</b> 4) Logistická regrese</a></li>
<li class="chapter" data-level="3.3.5" data-path="klasifikace-křivek-1.html"><a href="klasifikace-křivek-1.html#rozhodovací-stromy-1"><i class="fa fa-check"></i><b>3.3.5</b> 5) Rozhodovací stromy</a></li>
<li class="chapter" data-level="3.3.6" data-path="klasifikace-křivek-1.html"><a href="klasifikace-křivek-1.html#náhodné-lesy-1"><i class="fa fa-check"></i><b>3.3.6</b> 6) Náhodné lesy</a></li>
<li class="chapter" data-level="3.3.7" data-path="klasifikace-křivek-1.html"><a href="klasifikace-křivek-1.html#support-vector-machines-1"><i class="fa fa-check"></i><b>3.3.7</b> 7) Support Vector Machines</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="tabulka-výsledků-1.html"><a href="tabulka-výsledků-1.html"><i class="fa fa-check"></i><b>3.4</b> Tabulka výsledků</a></li>
<li class="chapter" data-level="3.5" data-path="simulační-studie-1.html"><a href="simulační-studie-1.html"><i class="fa fa-check"></i><b>3.5</b> Simulační studie</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="simulační-studie-1.html"><a href="simulační-studie-1.html#výsledky-1"><i class="fa fa-check"></i><b>3.5.1</b> Výsledky</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="aplikace-na-reálných-datech-1.html"><a href="aplikace-na-reálných-datech-1.html"><i class="fa fa-check"></i><b>4</b> Aplikace na reálných datech 1</a>
<ul>
<li class="chapter" data-level="4.1" data-path="vyhlazení-pozorovaných-křivek-2.html"><a href="vyhlazení-pozorovaných-křivek-2.html"><i class="fa fa-check"></i><b>4.1</b> Vyhlazení pozorovaných křivek</a></li>
<li class="chapter" data-level="4.2" data-path="klasifikace-křivek-2.html"><a href="klasifikace-křivek-2.html"><i class="fa fa-check"></i><b>4.2</b> Klasifikace křivek</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="klasifikace-křivek-2.html"><a href="klasifikace-křivek-2.html#k-nejbližších-sousedů-2"><i class="fa fa-check"></i><b>4.2.1</b> <span class="math inline">\(K\)</span> nejbližších sousedů</a></li>
<li class="chapter" data-level="4.2.2" data-path="klasifikace-křivek-2.html"><a href="klasifikace-křivek-2.html#lineární-diskriminační-analýza-2"><i class="fa fa-check"></i><b>4.2.2</b> Lineární diskriminační analýza</a></li>
<li class="chapter" data-level="4.2.3" data-path="klasifikace-křivek-2.html"><a href="klasifikace-křivek-2.html#kvadratická-diskriminační-analýza-2"><i class="fa fa-check"></i><b>4.2.3</b> Kvadratická diskriminační analýza</a></li>
<li class="chapter" data-level="4.2.4" data-path="klasifikace-křivek-2.html"><a href="klasifikace-křivek-2.html#logistická-regrese-2"><i class="fa fa-check"></i><b>4.2.4</b> Logistická regrese</a></li>
<li class="chapter" data-level="4.2.5" data-path="klasifikace-křivek-2.html"><a href="klasifikace-křivek-2.html#rozhodovací-stromy-2"><i class="fa fa-check"></i><b>4.2.5</b> Rozhodovací stromy</a></li>
<li class="chapter" data-level="4.2.6" data-path="klasifikace-křivek-2.html"><a href="klasifikace-křivek-2.html#náhodné-lesy-2"><i class="fa fa-check"></i><b>4.2.6</b> Náhodné lesy</a></li>
<li class="chapter" data-level="4.2.7" data-path="klasifikace-křivek-2.html"><a href="klasifikace-křivek-2.html#support-vector-machines-2"><i class="fa fa-check"></i><b>4.2.7</b> Support Vector Machines</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="tabulka-výsledků-2.html"><a href="tabulka-výsledků-2.html"><i class="fa fa-check"></i><b>4.3</b> Tabulka výsledků</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="opakování.html"><a href="opakování.html"><i class="fa fa-check"></i><b>5</b> Opakování</a>
<ul>
<li class="chapter" data-level="5.0.1" data-path="opakování.html"><a href="opakování.html#výsledky-2"><i class="fa fa-check"></i><b>5.0.1</b> Výsledky</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="vlastnosti-metody-rkhs-svm.html"><a href="vlastnosti-metody-rkhs-svm.html"><i class="fa fa-check"></i><b>6</b> Vlastnosti metody RKHS + SVM</a>
<ul>
<li class="chapter" data-level="6.1" data-path="handwrit-data.html"><a href="handwrit-data.html"><i class="fa fa-check"></i><b>6.1</b> <em>handwrit</em> data</a></li>
<li class="chapter" data-level="6.2" data-path="growth-data.html"><a href="growth-data.html"><i class="fa fa-check"></i><b>6.2</b> <code>growth</code> data</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Diplomová práce</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="opakování" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Kapitola 5</span> Opakování<a href="opakování.html#opakování" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="opakování.html#cb118-1" tabindex="-1"></a><span class="co"># pocet simulaci</span></span>
<span id="cb118-2"><a href="opakování.html#cb118-2" tabindex="-1"></a>n.sim <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb118-3"><a href="opakování.html#cb118-3" tabindex="-1"></a></span>
<span id="cb118-4"><a href="opakování.html#cb118-4" tabindex="-1"></a><span class="do">## list, do ktereho budeme ukladat hodnoty chybovosti</span></span>
<span id="cb118-5"><a href="opakování.html#cb118-5" tabindex="-1"></a><span class="co"># ve sloupcich budou metody</span></span>
<span id="cb118-6"><a href="opakování.html#cb118-6" tabindex="-1"></a><span class="co"># v radcich budou jednotliva opakovani</span></span>
<span id="cb118-7"><a href="opakování.html#cb118-7" tabindex="-1"></a><span class="co"># list ma dve polozky ... train a test</span></span>
<span id="cb118-8"><a href="opakování.html#cb118-8" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;KNN&#39;</span>, <span class="st">&#39;LDA&#39;</span>, <span class="st">&#39;QDA&#39;</span>, <span class="st">&#39;LR_score&#39;</span>, <span class="st">&#39;Tree_discr&#39;</span>,</span>
<span id="cb118-9"><a href="opakování.html#cb118-9" tabindex="-1"></a>             <span class="st">&#39;Tree_score&#39;</span>, <span class="st">&#39;Tree_Bbasis&#39;</span>, <span class="st">&#39;RF_discr&#39;</span>, <span class="st">&#39;RF_score&#39;</span>, <span class="st">&#39;RF_Bbasis&#39;</span>, </span>
<span id="cb118-10"><a href="opakování.html#cb118-10" tabindex="-1"></a>             <span class="st">&#39;SVM linear - diskr&#39;</span>, <span class="st">&#39;SVM poly - diskr&#39;</span>, <span class="st">&#39;SVM rbf - diskr&#39;</span>, </span>
<span id="cb118-11"><a href="opakování.html#cb118-11" tabindex="-1"></a>             <span class="st">&#39;SVM linear - PCA&#39;</span>, <span class="st">&#39;SVM poly - PCA&#39;</span>, <span class="st">&#39;SVM rbf - PCA&#39;</span>, </span>
<span id="cb118-12"><a href="opakování.html#cb118-12" tabindex="-1"></a>             <span class="st">&#39;SVM linear - Bbasis&#39;</span>, <span class="st">&#39;SVM poly - Bbasis&#39;</span>, <span class="st">&#39;SVM rbf - Bbasis&#39;</span>,</span>
<span id="cb118-13"><a href="opakování.html#cb118-13" tabindex="-1"></a>             <span class="st">&#39;SVM linear - projection&#39;</span>, <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb118-14"><a href="opakování.html#cb118-14" tabindex="-1"></a>             <span class="st">&#39;SVM rbf - projection&#39;</span>, <span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>, <span class="st">&#39;SVM linear - RKHS - linear&#39;</span>, <span class="st">&#39;SVM poly - RKHS - linear&#39;</span>, <span class="st">&#39;SVM rbf - RKHS - linear&#39;</span>)</span>
<span id="cb118-15"><a href="opakování.html#cb118-15" tabindex="-1"></a></span>
<span id="cb118-16"><a href="opakování.html#cb118-16" tabindex="-1"></a>SIMULACE <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">train =</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(methods), </span>
<span id="cb118-17"><a href="opakování.html#cb118-17" tabindex="-1"></a>                                             <span class="at">nrow =</span> n.sim,</span>
<span id="cb118-18"><a href="opakování.html#cb118-18" tabindex="-1"></a>                                             <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n.sim, methods))), </span>
<span id="cb118-19"><a href="opakování.html#cb118-19" tabindex="-1"></a>                 <span class="at">test =</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(methods), </span>
<span id="cb118-20"><a href="opakování.html#cb118-20" tabindex="-1"></a>                                             <span class="at">nrow =</span> n.sim,</span>
<span id="cb118-21"><a href="opakování.html#cb118-21" tabindex="-1"></a>                                             <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n.sim, methods))))</span>
<span id="cb118-22"><a href="opakování.html#cb118-22" tabindex="-1"></a></span>
<span id="cb118-23"><a href="opakování.html#cb118-23" tabindex="-1"></a><span class="co"># objekt na ulozeni optimalnich hodnot hyperparametru, ktere se urcuji pomoci CV</span></span>
<span id="cb118-24"><a href="opakování.html#cb118-24" tabindex="-1"></a>CV_RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">KNN_K =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n.sim),</span>
<span id="cb118-25"><a href="opakování.html#cb118-25" tabindex="-1"></a>                         <span class="at">SVM_d_Linear =</span> <span class="cn">NA</span>,</span>
<span id="cb118-26"><a href="opakování.html#cb118-26" tabindex="-1"></a>                         <span class="at">SVM_d_Poly =</span> <span class="cn">NA</span>,</span>
<span id="cb118-27"><a href="opakování.html#cb118-27" tabindex="-1"></a>                         <span class="at">SVM_d_Radial =</span> <span class="cn">NA</span>)</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="opakování.html#cb119-1" tabindex="-1"></a><span class="do">## SIMULACE</span></span>
<span id="cb119-2"><a href="opakování.html#cb119-2" tabindex="-1"></a></span>
<span id="cb119-3"><a href="opakování.html#cb119-3" tabindex="-1"></a><span class="cf">for</span>(sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.sim) {</span>
<span id="cb119-4"><a href="opakování.html#cb119-4" tabindex="-1"></a>  t <span class="ot">&lt;-</span> data.gr<span class="sc">$</span>age</span>
<span id="cb119-5"><a href="opakování.html#cb119-5" tabindex="-1"></a>  rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb119-6"><a href="opakování.html#cb119-6" tabindex="-1"></a>  breaks <span class="ot">&lt;-</span> t</span>
<span id="cb119-7"><a href="opakování.html#cb119-7" tabindex="-1"></a>  norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb119-8"><a href="opakování.html#cb119-8" tabindex="-1"></a>  bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb119-9"><a href="opakování.html#cb119-9" tabindex="-1"></a>                                 <span class="at">norder =</span> norder, </span>
<span id="cb119-10"><a href="opakování.html#cb119-10" tabindex="-1"></a>                                 <span class="at">breaks =</span> breaks)</span>
<span id="cb119-11"><a href="opakování.html#cb119-11" tabindex="-1"></a>  curv.Lfd <span class="ot">&lt;-</span> <span class="fu">int2Lfd</span>(<span class="dv">2</span>) <span class="co"># penalizujeme 2. derivaci</span></span>
<span id="cb119-12"><a href="opakování.html#cb119-12" tabindex="-1"></a>  </span>
<span id="cb119-13"><a href="opakování.html#cb119-13" tabindex="-1"></a>  <span class="co"># spojeni pozorovani do jedne matice</span></span>
<span id="cb119-14"><a href="opakování.html#cb119-14" tabindex="-1"></a>  XX <span class="ot">&lt;-</span> data.gr[, <span class="sc">-</span><span class="dv">1</span>] <span class="sc">|&gt;</span> <span class="fu">as.matrix</span>()</span>
<span id="cb119-15"><a href="opakování.html#cb119-15" tabindex="-1"></a>  </span>
<span id="cb119-16"><a href="opakování.html#cb119-16" tabindex="-1"></a>  lambda.vect <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">7</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">25</span>) <span class="co"># vektor lambd</span></span>
<span id="cb119-17"><a href="opakování.html#cb119-17" tabindex="-1"></a>  gcv <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="at">length =</span> <span class="fu">length</span>(lambda.vect)) <span class="co"># prazdny vektor pro ulozebi GCV</span></span>
<span id="cb119-18"><a href="opakování.html#cb119-18" tabindex="-1"></a>  </span>
<span id="cb119-19"><a href="opakování.html#cb119-19" tabindex="-1"></a>  <span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambda.vect)) {</span>
<span id="cb119-20"><a href="opakování.html#cb119-20" tabindex="-1"></a>    curv.Fdpar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.vect[index])</span>
<span id="cb119-21"><a href="opakování.html#cb119-21" tabindex="-1"></a>    BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.Fdpar) <span class="co"># vyhlazeni</span></span>
<span id="cb119-22"><a href="opakování.html#cb119-22" tabindex="-1"></a>    gcv[index] <span class="ot">&lt;-</span> <span class="fu">mean</span>(BSmooth<span class="sc">$</span>gcv) <span class="co"># prumer pres vsechny pozorovane krivky</span></span>
<span id="cb119-23"><a href="opakování.html#cb119-23" tabindex="-1"></a>  }</span>
<span id="cb119-24"><a href="opakování.html#cb119-24" tabindex="-1"></a>  </span>
<span id="cb119-25"><a href="opakování.html#cb119-25" tabindex="-1"></a>  GCV <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb119-26"><a href="opakování.html#cb119-26" tabindex="-1"></a>    <span class="at">lambda =</span> <span class="fu">round</span>(<span class="fu">log10</span>(lambda.vect), <span class="dv">3</span>),</span>
<span id="cb119-27"><a href="opakování.html#cb119-27" tabindex="-1"></a>    <span class="at">GCV =</span> gcv</span>
<span id="cb119-28"><a href="opakování.html#cb119-28" tabindex="-1"></a>  )</span>
<span id="cb119-29"><a href="opakování.html#cb119-29" tabindex="-1"></a>  </span>
<span id="cb119-30"><a href="opakování.html#cb119-30" tabindex="-1"></a>  <span class="co"># najdeme hodnotu minima</span></span>
<span id="cb119-31"><a href="opakování.html#cb119-31" tabindex="-1"></a>  lambda.opt <span class="ot">&lt;-</span> lambda.vect[<span class="fu">which.min</span>(gcv)]</span>
<span id="cb119-32"><a href="opakování.html#cb119-32" tabindex="-1"></a></span>
<span id="cb119-33"><a href="opakování.html#cb119-33" tabindex="-1"></a>  curv.fdPar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.opt)</span>
<span id="cb119-34"><a href="opakování.html#cb119-34" tabindex="-1"></a>  BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.fdPar)</span>
<span id="cb119-35"><a href="opakování.html#cb119-35" tabindex="-1"></a>  XXfd <span class="ot">&lt;-</span> BSmooth<span class="sc">$</span>fd</span>
<span id="cb119-36"><a href="opakování.html#cb119-36" tabindex="-1"></a>  </span>
<span id="cb119-37"><a href="opakování.html#cb119-37" tabindex="-1"></a>  fdobjSmootheval <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> XXfd, <span class="at">evalarg =</span> t)</span>
<span id="cb119-38"><a href="opakování.html#cb119-38" tabindex="-1"></a>  </span>
<span id="cb119-39"><a href="opakování.html#cb119-39" tabindex="-1"></a>  <span class="co"># rozdeleni na testovaci a trenovaci cast</span></span>
<span id="cb119-40"><a href="opakování.html#cb119-40" tabindex="-1"></a>  split <span class="ot">&lt;-</span> <span class="fu">sample.split</span>(XXfd<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb119-41"><a href="opakování.html#cb119-41" tabindex="-1"></a>  </span>
<span id="cb119-42"><a href="opakování.html#cb119-42" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(n_girls, n_boys))</span>
<span id="cb119-43"><a href="opakování.html#cb119-43" tabindex="-1"></a>  </span>
<span id="cb119-44"><a href="opakování.html#cb119-44" tabindex="-1"></a>  X.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb119-45"><a href="opakování.html#cb119-45" tabindex="-1"></a>  X.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb119-46"><a href="opakování.html#cb119-46" tabindex="-1"></a>  </span>
<span id="cb119-47"><a href="opakování.html#cb119-47" tabindex="-1"></a>  Y.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb119-48"><a href="opakování.html#cb119-48" tabindex="-1"></a>  Y.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb119-49"><a href="opakování.html#cb119-49" tabindex="-1"></a>  </span>
<span id="cb119-50"><a href="opakování.html#cb119-50" tabindex="-1"></a>  <span class="do">## 1) K nejbližších sousedů</span></span>
<span id="cb119-51"><a href="opakování.html#cb119-51" tabindex="-1"></a>  </span>
<span id="cb119-52"><a href="opakování.html#cb119-52" tabindex="-1"></a>  k_cv <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># k-fold CV</span></span>
<span id="cb119-53"><a href="opakování.html#cb119-53" tabindex="-1"></a>  neighbours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">ceiling</span>(<span class="fu">sqrt</span>(<span class="fu">length</span>(y.train))))) <span class="co"># pocet sousedu </span></span>
<span id="cb119-54"><a href="opakování.html#cb119-54" tabindex="-1"></a>  </span>
<span id="cb119-55"><a href="opakování.html#cb119-55" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb119-56"><a href="opakování.html#cb119-56" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb119-57"><a href="opakování.html#cb119-57" tabindex="-1"></a>  </span>
<span id="cb119-58"><a href="opakování.html#cb119-58" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(neighbours), <span class="at">ncol =</span> k_cv)</span>
<span id="cb119-59"><a href="opakování.html#cb119-59" tabindex="-1"></a>  </span>
<span id="cb119-60"><a href="opakování.html#cb119-60" tabindex="-1"></a>  <span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb119-61"><a href="opakování.html#cb119-61" tabindex="-1"></a>    <span class="co"># definujeme danou indexovou mnozinu</span></span>
<span id="cb119-62"><a href="opakování.html#cb119-62" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb119-63"><a href="opakování.html#cb119-63" tabindex="-1"></a>      </span>
<span id="cb119-64"><a href="opakování.html#cb119-64" tabindex="-1"></a>    x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb119-65"><a href="opakování.html#cb119-65" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb119-66"><a href="opakování.html#cb119-66" tabindex="-1"></a>    y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb119-67"><a href="opakování.html#cb119-67" tabindex="-1"></a>      <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb119-68"><a href="opakování.html#cb119-68" tabindex="-1"></a>    </span>
<span id="cb119-69"><a href="opakování.html#cb119-69" tabindex="-1"></a>    x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb119-70"><a href="opakování.html#cb119-70" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb119-71"><a href="opakování.html#cb119-71" tabindex="-1"></a>    y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb119-72"><a href="opakování.html#cb119-72" tabindex="-1"></a>      <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb119-73"><a href="opakování.html#cb119-73" tabindex="-1"></a>    </span>
<span id="cb119-74"><a href="opakování.html#cb119-74" tabindex="-1"></a>    <span class="co"># projdeme kazdou cast ... k-krat zopakujeme</span></span>
<span id="cb119-75"><a href="opakování.html#cb119-75" tabindex="-1"></a>    <span class="cf">for</span>(neighbour <span class="cf">in</span> neighbours) {</span>
<span id="cb119-76"><a href="opakování.html#cb119-76" tabindex="-1"></a>      <span class="co"># model pro konkretni volbu K</span></span>
<span id="cb119-77"><a href="opakování.html#cb119-77" tabindex="-1"></a>      neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train.cv, </span>
<span id="cb119-78"><a href="opakování.html#cb119-78" tabindex="-1"></a>                                <span class="at">fdataobj =</span> x.train.cv, </span>
<span id="cb119-79"><a href="opakování.html#cb119-79" tabindex="-1"></a>                                <span class="at">knn =</span> neighbour) </span>
<span id="cb119-80"><a href="opakování.html#cb119-80" tabindex="-1"></a>      <span class="co"># predikce na validacni casti</span></span>
<span id="cb119-81"><a href="opakování.html#cb119-81" tabindex="-1"></a>      model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb119-82"><a href="opakování.html#cb119-82" tabindex="-1"></a>                                      <span class="at">new.fdataobj =</span> x.test.cv)</span>
<span id="cb119-83"><a href="opakování.html#cb119-83" tabindex="-1"></a>      <span class="co"># presnost na validacni casti</span></span>
<span id="cb119-84"><a href="opakování.html#cb119-84" tabindex="-1"></a>      presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, model.neighb.predict) <span class="sc">|&gt;</span> </span>
<span id="cb119-85"><a href="opakování.html#cb119-85" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-86"><a href="opakování.html#cb119-86" tabindex="-1"></a>      </span>
<span id="cb119-87"><a href="opakování.html#cb119-87" tabindex="-1"></a>      <span class="co"># presnost vlozime na pozici pro dane K a fold</span></span>
<span id="cb119-88"><a href="opakování.html#cb119-88" tabindex="-1"></a>      CV.results[neighbour, index] <span class="ot">&lt;-</span> presnost</span>
<span id="cb119-89"><a href="opakování.html#cb119-89" tabindex="-1"></a>    }</span>
<span id="cb119-90"><a href="opakování.html#cb119-90" tabindex="-1"></a>  }</span>
<span id="cb119-91"><a href="opakování.html#cb119-91" tabindex="-1"></a>  </span>
<span id="cb119-92"><a href="opakování.html#cb119-92" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva K pres folds</span></span>
<span id="cb119-93"><a href="opakování.html#cb119-93" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb119-94"><a href="opakování.html#cb119-94" tabindex="-1"></a>  K.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(CV.results)</span>
<span id="cb119-95"><a href="opakování.html#cb119-95" tabindex="-1"></a>  CV_RESULTS<span class="sc">$</span>KNN_K[sim] <span class="ot">&lt;-</span> K.opt</span>
<span id="cb119-96"><a href="opakování.html#cb119-96" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb119-97"><a href="opakování.html#cb119-97" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">K =</span> neighbours, <span class="at">CV =</span> CV.results)</span>
<span id="cb119-98"><a href="opakování.html#cb119-98" tabindex="-1"></a>  </span>
<span id="cb119-99"><a href="opakování.html#cb119-99" tabindex="-1"></a>  neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, <span class="at">fdataobj =</span> x.train, <span class="at">knn =</span> K.opt)</span>
<span id="cb119-100"><a href="opakování.html#cb119-100" tabindex="-1"></a>  </span>
<span id="cb119-101"><a href="opakování.html#cb119-101" tabindex="-1"></a>  <span class="co"># predikce</span></span>
<span id="cb119-102"><a href="opakování.html#cb119-102" tabindex="-1"></a>  model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb119-103"><a href="opakování.html#cb119-103" tabindex="-1"></a>                                  <span class="at">new.fdataobj =</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb119-104"><a href="opakování.html#cb119-104" tabindex="-1"></a>  </span>
<span id="cb119-105"><a href="opakování.html#cb119-105" tabindex="-1"></a>  presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.test)), model.neighb.predict) <span class="sc">|&gt;</span></span>
<span id="cb119-106"><a href="opakování.html#cb119-106" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span></span>
<span id="cb119-107"><a href="opakování.html#cb119-107" tabindex="-1"></a>    <span class="fu">diag</span>() <span class="sc">|&gt;</span></span>
<span id="cb119-108"><a href="opakování.html#cb119-108" tabindex="-1"></a>    <span class="fu">sum</span>()</span>
<span id="cb119-109"><a href="opakování.html#cb119-109" tabindex="-1"></a>  </span>
<span id="cb119-110"><a href="opakování.html#cb119-110" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;KNN&#39;</span>, </span>
<span id="cb119-111"><a href="opakování.html#cb119-111" tabindex="-1"></a>                        <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> neighb.model<span class="sc">$</span>max.prob,</span>
<span id="cb119-112"><a href="opakování.html#cb119-112" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost)</span>
<span id="cb119-113"><a href="opakování.html#cb119-113" tabindex="-1"></a>  </span>
<span id="cb119-114"><a href="opakování.html#cb119-114" tabindex="-1"></a>  <span class="do">## 2) Lineární diskriminační analýza</span></span>
<span id="cb119-115"><a href="opakování.html#cb119-115" tabindex="-1"></a>  </span>
<span id="cb119-116"><a href="opakování.html#cb119-116" tabindex="-1"></a>  <span class="co"># analyza hlavnich komponent</span></span>
<span id="cb119-117"><a href="opakování.html#cb119-117" tabindex="-1"></a>  data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> <span class="dv">10</span>) <span class="co"># nharm - maximalni pocet HK</span></span>
<span id="cb119-118"><a href="opakování.html#cb119-118" tabindex="-1"></a>  nharm <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">cumsum</span>(data.PCA<span class="sc">$</span>varprop) <span class="sc">&gt;=</span> <span class="fl">0.9</span>)[<span class="dv">1</span>] <span class="co"># urceni p</span></span>
<span id="cb119-119"><a href="opakování.html#cb119-119" tabindex="-1"></a>  </span>
<span id="cb119-120"><a href="opakování.html#cb119-120" tabindex="-1"></a>  data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> nharm) </span>
<span id="cb119-121"><a href="opakování.html#cb119-121" tabindex="-1"></a>  data.PCA.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA<span class="sc">$</span>scores) <span class="co"># skore prvnich p HK</span></span>
<span id="cb119-122"><a href="opakování.html#cb119-122" tabindex="-1"></a>  data.PCA.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train) <span class="co"># prislusnost do trid</span></span>
<span id="cb119-123"><a href="opakování.html#cb119-123" tabindex="-1"></a>  </span>
<span id="cb119-124"><a href="opakování.html#cb119-124" tabindex="-1"></a>  <span class="co"># vypocet skoru testovacich funkci</span></span>
<span id="cb119-125"><a href="opakování.html#cb119-125" tabindex="-1"></a>  scores <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> nharm, <span class="at">nrow =</span> <span class="fu">length</span>(Y.test)) <span class="co"># prazdna matice </span></span>
<span id="cb119-126"><a href="opakování.html#cb119-126" tabindex="-1"></a>  </span>
<span id="cb119-127"><a href="opakování.html#cb119-127" tabindex="-1"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(scores)[<span class="dv">1</span>]) {</span>
<span id="cb119-128"><a href="opakování.html#cb119-128" tabindex="-1"></a>    xfd <span class="ot">=</span> X.test[k] <span class="sc">-</span> data.PCA<span class="sc">$</span>meanfd[<span class="dv">1</span>] <span class="co"># k-te pozorovani - prumerna funkce</span></span>
<span id="cb119-129"><a href="opakování.html#cb119-129" tabindex="-1"></a>    scores[k, ] <span class="ot">=</span> <span class="fu">inprod</span>(xfd, data.PCA<span class="sc">$</span>harmonics) </span>
<span id="cb119-130"><a href="opakování.html#cb119-130" tabindex="-1"></a>    <span class="co"># skalarni soucin rezidua a vlastnich funkci rho (funkcionalni hlavni komponenty)</span></span>
<span id="cb119-131"><a href="opakování.html#cb119-131" tabindex="-1"></a>  }</span>
<span id="cb119-132"><a href="opakování.html#cb119-132" tabindex="-1"></a>  </span>
<span id="cb119-133"><a href="opakování.html#cb119-133" tabindex="-1"></a>  data.PCA.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(scores)</span>
<span id="cb119-134"><a href="opakování.html#cb119-134" tabindex="-1"></a>  data.PCA.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb119-135"><a href="opakování.html#cb119-135" tabindex="-1"></a>  <span class="fu">colnames</span>(data.PCA.test) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data.PCA.train) </span>
<span id="cb119-136"><a href="opakování.html#cb119-136" tabindex="-1"></a>  </span>
<span id="cb119-137"><a href="opakování.html#cb119-137" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb119-138"><a href="opakování.html#cb119-138" tabindex="-1"></a>  clf.LDA <span class="ot">&lt;-</span> <span class="fu">lda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb119-139"><a href="opakování.html#cb119-139" tabindex="-1"></a>  </span>
<span id="cb119-140"><a href="opakování.html#cb119-140" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb119-141"><a href="opakování.html#cb119-141" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb119-142"><a href="opakování.html#cb119-142" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb119-143"><a href="opakování.html#cb119-143" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-144"><a href="opakování.html#cb119-144" tabindex="-1"></a>    </span>
<span id="cb119-145"><a href="opakování.html#cb119-145" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb119-146"><a href="opakování.html#cb119-146" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb119-147"><a href="opakování.html#cb119-147" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb119-148"><a href="opakování.html#cb119-148" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-149"><a href="opakování.html#cb119-149" tabindex="-1"></a>  </span>
<span id="cb119-150"><a href="opakování.html#cb119-150" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LDA&#39;</span>, </span>
<span id="cb119-151"><a href="opakování.html#cb119-151" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb119-152"><a href="opakování.html#cb119-152" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb119-153"><a href="opakování.html#cb119-153" tabindex="-1"></a>  </span>
<span id="cb119-154"><a href="opakování.html#cb119-154" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb119-155"><a href="opakování.html#cb119-155" tabindex="-1"></a>  </span>
<span id="cb119-156"><a href="opakování.html#cb119-156" tabindex="-1"></a>  <span class="do">## 3) Kvadratická diskriminační analýza</span></span>
<span id="cb119-157"><a href="opakování.html#cb119-157" tabindex="-1"></a>  </span>
<span id="cb119-158"><a href="opakování.html#cb119-158" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb119-159"><a href="opakování.html#cb119-159" tabindex="-1"></a>  clf.QDA <span class="ot">&lt;-</span> <span class="fu">qda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb119-160"><a href="opakování.html#cb119-160" tabindex="-1"></a>  </span>
<span id="cb119-161"><a href="opakování.html#cb119-161" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb119-162"><a href="opakování.html#cb119-162" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb119-163"><a href="opakování.html#cb119-163" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb119-164"><a href="opakování.html#cb119-164" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-165"><a href="opakování.html#cb119-165" tabindex="-1"></a>    </span>
<span id="cb119-166"><a href="opakování.html#cb119-166" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb119-167"><a href="opakování.html#cb119-167" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb119-168"><a href="opakování.html#cb119-168" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb119-169"><a href="opakování.html#cb119-169" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-170"><a href="opakování.html#cb119-170" tabindex="-1"></a>  </span>
<span id="cb119-171"><a href="opakování.html#cb119-171" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;QDA&#39;</span>, </span>
<span id="cb119-172"><a href="opakování.html#cb119-172" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb119-173"><a href="opakování.html#cb119-173" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb119-174"><a href="opakování.html#cb119-174" tabindex="-1"></a>  </span>
<span id="cb119-175"><a href="opakování.html#cb119-175" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb119-176"><a href="opakování.html#cb119-176" tabindex="-1"></a>  </span>
<span id="cb119-177"><a href="opakování.html#cb119-177" tabindex="-1"></a>  <span class="do">## 4) Logistická regrese</span></span>
<span id="cb119-178"><a href="opakování.html#cb119-178" tabindex="-1"></a>  <span class="do">### 4.1) Funkcionální logistická regrese</span></span>
<span id="cb119-179"><a href="opakování.html#cb119-179" tabindex="-1"></a>  </span>
<span id="cb119-180"><a href="opakování.html#cb119-180" tabindex="-1"></a>  <span class="co"># vytvorime vhodne objekty</span></span>
<span id="cb119-181"><a href="opakování.html#cb119-181" tabindex="-1"></a>  x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb119-182"><a href="opakování.html#cb119-182" tabindex="-1"></a>  y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Y.train)</span>
<span id="cb119-183"><a href="opakování.html#cb119-183" tabindex="-1"></a>  </span>
<span id="cb119-184"><a href="opakování.html#cb119-184" tabindex="-1"></a>  <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb119-185"><a href="opakování.html#cb119-185" tabindex="-1"></a>  tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb119-186"><a href="opakování.html#cb119-186" tabindex="-1"></a>  </span>
<span id="cb119-187"><a href="opakování.html#cb119-187" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb119-188"><a href="opakování.html#cb119-188" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb119-189"><a href="opakování.html#cb119-189" tabindex="-1"></a>  <span class="co"># B-spline baze </span></span>
<span id="cb119-190"><a href="opakování.html#cb119-190" tabindex="-1"></a>  basis1 <span class="ot">&lt;-</span> X.train<span class="sc">$</span>basis</span>
<span id="cb119-191"><a href="opakování.html#cb119-191" tabindex="-1"></a>  </span>
<span id="cb119-192"><a href="opakování.html#cb119-192" tabindex="-1"></a>  <span class="co"># </span><span class="al">###</span><span class="co"> 10-fold cross-validation</span></span>
<span id="cb119-193"><a href="opakování.html#cb119-193" tabindex="-1"></a>  <span class="co"># n.basis.max &lt;- 25</span></span>
<span id="cb119-194"><a href="opakování.html#cb119-194" tabindex="-1"></a>  <span class="co"># n.basis &lt;- 4:n.basis.max</span></span>
<span id="cb119-195"><a href="opakování.html#cb119-195" tabindex="-1"></a>  <span class="co"># k_cv &lt;- 10 # k-fold CV</span></span>
<span id="cb119-196"><a href="opakování.html#cb119-196" tabindex="-1"></a>  <span class="co"># # rozdelime trenovaci data na k casti</span></span>
<span id="cb119-197"><a href="opakování.html#cb119-197" tabindex="-1"></a>  <span class="co"># folds &lt;- createMultiFolds(X.train$fdnames$reps, k = k_cv, time = 1)</span></span>
<span id="cb119-198"><a href="opakování.html#cb119-198" tabindex="-1"></a>  <span class="co"># ## prvky, ktere se behem cyklu nemeni</span></span>
<span id="cb119-199"><a href="opakování.html#cb119-199" tabindex="-1"></a>  <span class="co"># # body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb119-200"><a href="opakování.html#cb119-200" tabindex="-1"></a>  <span class="co"># tt &lt;- x.train[[&quot;argvals&quot;]]</span></span>
<span id="cb119-201"><a href="opakování.html#cb119-201" tabindex="-1"></a>  <span class="co"># rangeval &lt;- range(tt)</span></span>
<span id="cb119-202"><a href="opakování.html#cb119-202" tabindex="-1"></a>  <span class="co"># # B-spline baze </span></span>
<span id="cb119-203"><a href="opakování.html#cb119-203" tabindex="-1"></a>  <span class="co"># basis1 &lt;- X.train$basis</span></span>
<span id="cb119-204"><a href="opakování.html#cb119-204" tabindex="-1"></a>  <span class="co"># # vztah</span></span>
<span id="cb119-205"><a href="opakování.html#cb119-205" tabindex="-1"></a>  <span class="co"># f &lt;- Y ~ x</span></span>
<span id="cb119-206"><a href="opakování.html#cb119-206" tabindex="-1"></a>  <span class="co"># # baze pro x</span></span>
<span id="cb119-207"><a href="opakování.html#cb119-207" tabindex="-1"></a>  <span class="co"># basis.x &lt;- list(&quot;x&quot; = basis1)</span></span>
<span id="cb119-208"><a href="opakování.html#cb119-208" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb119-209"><a href="opakování.html#cb119-209" tabindex="-1"></a>  <span class="co"># CV.results &lt;- matrix(NA, nrow = length(n.basis), ncol = k_cv, </span></span>
<span id="cb119-210"><a href="opakování.html#cb119-210" tabindex="-1"></a>  <span class="co">#                      dimnames = list(n.basis, 1:k_cv))</span></span>
<span id="cb119-211"><a href="opakování.html#cb119-211" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb119-212"><a href="opakování.html#cb119-212" tabindex="-1"></a>  <span class="co"># for (index in 1:k_cv) {</span></span>
<span id="cb119-213"><a href="opakování.html#cb119-213" tabindex="-1"></a>  <span class="co">#   # definujeme danou indexovou mnozinu</span></span>
<span id="cb119-214"><a href="opakování.html#cb119-214" tabindex="-1"></a>  <span class="co">#   fold &lt;- folds[[index]]</span></span>
<span id="cb119-215"><a href="opakování.html#cb119-215" tabindex="-1"></a>  <span class="co">#     </span></span>
<span id="cb119-216"><a href="opakování.html#cb119-216" tabindex="-1"></a>  <span class="co">#   x.train.cv &lt;- subset(X.train, c(1:length(X.train$fdnames$reps)) %in% fold) |&gt;</span></span>
<span id="cb119-217"><a href="opakování.html#cb119-217" tabindex="-1"></a>  <span class="co">#     fdata()</span></span>
<span id="cb119-218"><a href="opakování.html#cb119-218" tabindex="-1"></a>  <span class="co">#   y.train.cv &lt;- subset(Y.train, c(1:length(X.train$fdnames$reps)) %in% fold) |&gt;</span></span>
<span id="cb119-219"><a href="opakování.html#cb119-219" tabindex="-1"></a>  <span class="co">#     as.numeric()</span></span>
<span id="cb119-220"><a href="opakování.html#cb119-220" tabindex="-1"></a>  <span class="co">#   </span></span>
<span id="cb119-221"><a href="opakování.html#cb119-221" tabindex="-1"></a>  <span class="co">#   x.test.cv &lt;- subset(X.train, !c(1:length(X.train$fdnames$reps)) %in% fold) |&gt;</span></span>
<span id="cb119-222"><a href="opakování.html#cb119-222" tabindex="-1"></a>  <span class="co">#     fdata()</span></span>
<span id="cb119-223"><a href="opakování.html#cb119-223" tabindex="-1"></a>  <span class="co">#   y.test.cv &lt;- subset(Y.train, !c(1:length(X.train$fdnames$reps)) %in% fold) |&gt;</span></span>
<span id="cb119-224"><a href="opakování.html#cb119-224" tabindex="-1"></a>  <span class="co">#     as.numeric()</span></span>
<span id="cb119-225"><a href="opakování.html#cb119-225" tabindex="-1"></a>  <span class="co">#   </span></span>
<span id="cb119-226"><a href="opakování.html#cb119-226" tabindex="-1"></a>  <span class="co">#   dataf &lt;- as.data.frame(y.train.cv) </span></span>
<span id="cb119-227"><a href="opakování.html#cb119-227" tabindex="-1"></a>  <span class="co">#   colnames(dataf) &lt;- &quot;Y&quot;</span></span>
<span id="cb119-228"><a href="opakování.html#cb119-228" tabindex="-1"></a>  <span class="co">#   </span></span>
<span id="cb119-229"><a href="opakování.html#cb119-229" tabindex="-1"></a>  <span class="co">#   for (i in n.basis) {</span></span>
<span id="cb119-230"><a href="opakování.html#cb119-230" tabindex="-1"></a>  <span class="co">#     # baze pro bety</span></span>
<span id="cb119-231"><a href="opakování.html#cb119-231" tabindex="-1"></a>  <span class="co">#     basis2 &lt;- create.bspline.basis(rangeval = rangeval, nbasis = i)</span></span>
<span id="cb119-232"><a href="opakování.html#cb119-232" tabindex="-1"></a>  <span class="co">#     </span></span>
<span id="cb119-233"><a href="opakování.html#cb119-233" tabindex="-1"></a>  <span class="co">#     basis.b &lt;- list(&quot;x&quot; = basis2)</span></span>
<span id="cb119-234"><a href="opakování.html#cb119-234" tabindex="-1"></a>  <span class="co">#     # vstupni data do modelu</span></span>
<span id="cb119-235"><a href="opakování.html#cb119-235" tabindex="-1"></a>  <span class="co">#     ldata &lt;- list(&quot;df&quot; = dataf, &quot;x&quot; = x.train.cv)</span></span>
<span id="cb119-236"><a href="opakování.html#cb119-236" tabindex="-1"></a>  <span class="co">#     # binomicky model ... model logisticke regrese</span></span>
<span id="cb119-237"><a href="opakování.html#cb119-237" tabindex="-1"></a>  <span class="co">#     model.glm &lt;- fregre.glm(f, family = binomial(), data = ldata,</span></span>
<span id="cb119-238"><a href="opakování.html#cb119-238" tabindex="-1"></a>  <span class="co">#                             basis.x = basis.x, basis.b = basis.b)</span></span>
<span id="cb119-239"><a href="opakování.html#cb119-239" tabindex="-1"></a>  <span class="co">#     </span></span>
<span id="cb119-240"><a href="opakování.html#cb119-240" tabindex="-1"></a>  <span class="co">#     # presnost na validacni casti </span></span>
<span id="cb119-241"><a href="opakování.html#cb119-241" tabindex="-1"></a>  <span class="co">#     newldata = list(&quot;df&quot; = as.data.frame(y.test.cv), &quot;x&quot; = x.test.cv)</span></span>
<span id="cb119-242"><a href="opakování.html#cb119-242" tabindex="-1"></a>  <span class="co">#     predictions.valid &lt;- predict(model.glm, newx = newldata)</span></span>
<span id="cb119-243"><a href="opakování.html#cb119-243" tabindex="-1"></a>  <span class="co">#     predictions.valid &lt;- data.frame(Y.pred = ifelse(predictions.valid &lt; 1/2, 0, 1))</span></span>
<span id="cb119-244"><a href="opakování.html#cb119-244" tabindex="-1"></a>  <span class="co">#     presnost.valid &lt;- table(y.test.cv, predictions.valid$Y.pred) |&gt;</span></span>
<span id="cb119-245"><a href="opakování.html#cb119-245" tabindex="-1"></a>  <span class="co">#       prop.table() |&gt; diag() |&gt; sum()</span></span>
<span id="cb119-246"><a href="opakování.html#cb119-246" tabindex="-1"></a>  <span class="co">#     </span></span>
<span id="cb119-247"><a href="opakování.html#cb119-247" tabindex="-1"></a>  <span class="co">#     # vlozime do matice</span></span>
<span id="cb119-248"><a href="opakování.html#cb119-248" tabindex="-1"></a>  <span class="co">#     CV.results[as.character(i), as.character(index)] &lt;- presnost.valid</span></span>
<span id="cb119-249"><a href="opakování.html#cb119-249" tabindex="-1"></a>  <span class="co">#   } </span></span>
<span id="cb119-250"><a href="opakování.html#cb119-250" tabindex="-1"></a>  <span class="co"># }</span></span>
<span id="cb119-251"><a href="opakování.html#cb119-251" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb119-252"><a href="opakování.html#cb119-252" tabindex="-1"></a>  <span class="co"># # spocitame prumerne presnosti pro jednotliva n pres folds</span></span>
<span id="cb119-253"><a href="opakování.html#cb119-253" tabindex="-1"></a>  <span class="co"># CV.results &lt;- apply(CV.results, 1, mean)</span></span>
<span id="cb119-254"><a href="opakování.html#cb119-254" tabindex="-1"></a>  <span class="co"># n.basis.opt &lt;- n.basis[which.max(CV.results)]</span></span>
<span id="cb119-255"><a href="opakování.html#cb119-255" tabindex="-1"></a>  <span class="co"># presnost.opt.cv &lt;- max(CV.results)</span></span>
<span id="cb119-256"><a href="opakování.html#cb119-256" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb119-257"><a href="opakování.html#cb119-257" tabindex="-1"></a>  <span class="co"># # optimalni model</span></span>
<span id="cb119-258"><a href="opakování.html#cb119-258" tabindex="-1"></a>  <span class="co"># basis2 &lt;- create.bspline.basis(rangeval = range(tt), nbasis = n.basis.opt)</span></span>
<span id="cb119-259"><a href="opakování.html#cb119-259" tabindex="-1"></a>  <span class="co"># f &lt;- Y ~ x</span></span>
<span id="cb119-260"><a href="opakování.html#cb119-260" tabindex="-1"></a>  <span class="co"># # baze pro x a bety</span></span>
<span id="cb119-261"><a href="opakování.html#cb119-261" tabindex="-1"></a>  <span class="co"># basis.x &lt;- list(&quot;x&quot; = basis1) </span></span>
<span id="cb119-262"><a href="opakování.html#cb119-262" tabindex="-1"></a>  <span class="co"># basis.b &lt;- list(&quot;x&quot; = basis2)</span></span>
<span id="cb119-263"><a href="opakování.html#cb119-263" tabindex="-1"></a>  <span class="co"># # vstupni data do modelu</span></span>
<span id="cb119-264"><a href="opakování.html#cb119-264" tabindex="-1"></a>  <span class="co"># dataf &lt;- as.data.frame(y.train) </span></span>
<span id="cb119-265"><a href="opakování.html#cb119-265" tabindex="-1"></a>  <span class="co"># colnames(dataf) &lt;- &quot;Y&quot;</span></span>
<span id="cb119-266"><a href="opakování.html#cb119-266" tabindex="-1"></a>  <span class="co"># ldata &lt;- list(&quot;df&quot; = dataf, &quot;x&quot; = x.train)</span></span>
<span id="cb119-267"><a href="opakování.html#cb119-267" tabindex="-1"></a>  <span class="co"># # binomicky model ... model logisticke regrese</span></span>
<span id="cb119-268"><a href="opakování.html#cb119-268" tabindex="-1"></a>  <span class="co"># model.glm &lt;- fregre.glm(f, family = binomial(), data = ldata,</span></span>
<span id="cb119-269"><a href="opakování.html#cb119-269" tabindex="-1"></a>  <span class="co">#                         basis.x = basis.x, basis.b = basis.b)</span></span>
<span id="cb119-270"><a href="opakování.html#cb119-270" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb119-271"><a href="opakování.html#cb119-271" tabindex="-1"></a>  <span class="co"># # presnost na trenovacich datech</span></span>
<span id="cb119-272"><a href="opakování.html#cb119-272" tabindex="-1"></a>  <span class="co"># predictions.train &lt;- predict(model.glm, newx = ldata)</span></span>
<span id="cb119-273"><a href="opakování.html#cb119-273" tabindex="-1"></a>  <span class="co"># predictions.train &lt;- data.frame(Y.pred = ifelse(predictions.train &lt; 1/2, 0, 1))</span></span>
<span id="cb119-274"><a href="opakování.html#cb119-274" tabindex="-1"></a>  <span class="co"># presnost.train &lt;- table(Y.train, predictions.train$Y.pred) |&gt;</span></span>
<span id="cb119-275"><a href="opakování.html#cb119-275" tabindex="-1"></a>  <span class="co">#   prop.table() |&gt; diag() |&gt; sum()</span></span>
<span id="cb119-276"><a href="opakování.html#cb119-276" tabindex="-1"></a>  <span class="co">#   </span></span>
<span id="cb119-277"><a href="opakování.html#cb119-277" tabindex="-1"></a>  <span class="co"># # presnost na trenovacich datech</span></span>
<span id="cb119-278"><a href="opakování.html#cb119-278" tabindex="-1"></a>  <span class="co"># newldata = list(&quot;df&quot; = as.data.frame(Y.test), &quot;x&quot; = fdata(X.test))</span></span>
<span id="cb119-279"><a href="opakování.html#cb119-279" tabindex="-1"></a>  <span class="co"># predictions.test &lt;- predict(model.glm, newx = newldata)</span></span>
<span id="cb119-280"><a href="opakování.html#cb119-280" tabindex="-1"></a>  <span class="co"># predictions.test &lt;- data.frame(Y.pred = ifelse(predictions.test &lt; 1/2, 0, 1))</span></span>
<span id="cb119-281"><a href="opakování.html#cb119-281" tabindex="-1"></a>  <span class="co"># presnost.test &lt;- table(Y.test, predictions.test$Y.pred) |&gt;</span></span>
<span id="cb119-282"><a href="opakování.html#cb119-282" tabindex="-1"></a>  <span class="co">#   prop.table() |&gt; diag() |&gt; sum()</span></span>
<span id="cb119-283"><a href="opakování.html#cb119-283" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb119-284"><a href="opakování.html#cb119-284" tabindex="-1"></a>  <span class="co"># Res &lt;- data.frame(model = &#39;LR_functional&#39;, </span></span>
<span id="cb119-285"><a href="opakování.html#cb119-285" tabindex="-1"></a>  <span class="co">#                   Err.train = 1 - presnost.train,</span></span>
<span id="cb119-286"><a href="opakování.html#cb119-286" tabindex="-1"></a>  <span class="co">#                   Err.test = 1 - presnost.test)</span></span>
<span id="cb119-287"><a href="opakování.html#cb119-287" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb119-288"><a href="opakování.html#cb119-288" tabindex="-1"></a>  <span class="co"># RESULTS &lt;- rbind(RESULTS, Res)</span></span>
<span id="cb119-289"><a href="opakování.html#cb119-289" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb119-290"><a href="opakování.html#cb119-290" tabindex="-1"></a>  <span class="do">### 4.2) Logistická regrese s analýzou hlavních komponent</span></span>
<span id="cb119-291"><a href="opakování.html#cb119-291" tabindex="-1"></a>  </span>
<span id="cb119-292"><a href="opakování.html#cb119-292" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb119-293"><a href="opakování.html#cb119-293" tabindex="-1"></a>  clf.LR <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span>  ., <span class="at">data =</span> data.PCA.train, <span class="at">family =</span> binomial)</span>
<span id="cb119-294"><a href="opakování.html#cb119-294" tabindex="-1"></a>  </span>
<span id="cb119-295"><a href="opakování.html#cb119-295" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb119-296"><a href="opakování.html#cb119-296" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.train, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb119-297"><a href="opakování.html#cb119-297" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb119-298"><a href="opakování.html#cb119-298" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb119-299"><a href="opakování.html#cb119-299" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-300"><a href="opakování.html#cb119-300" tabindex="-1"></a>    </span>
<span id="cb119-301"><a href="opakování.html#cb119-301" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb119-302"><a href="opakování.html#cb119-302" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.test, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb119-303"><a href="opakování.html#cb119-303" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb119-304"><a href="opakování.html#cb119-304" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb119-305"><a href="opakování.html#cb119-305" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-306"><a href="opakování.html#cb119-306" tabindex="-1"></a>  </span>
<span id="cb119-307"><a href="opakování.html#cb119-307" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR_score&#39;</span>, </span>
<span id="cb119-308"><a href="opakování.html#cb119-308" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb119-309"><a href="opakování.html#cb119-309" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb119-310"><a href="opakování.html#cb119-310" tabindex="-1"></a>  </span>
<span id="cb119-311"><a href="opakování.html#cb119-311" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb119-312"><a href="opakování.html#cb119-312" tabindex="-1"></a>  </span>
<span id="cb119-313"><a href="opakování.html#cb119-313" tabindex="-1"></a>  <span class="do">## 5) Rozhodovací stromy</span></span>
<span id="cb119-314"><a href="opakování.html#cb119-314" tabindex="-1"></a>  <span class="do">### 5.1) Diskretizace intervalu</span></span>
<span id="cb119-315"><a href="opakování.html#cb119-315" tabindex="-1"></a>  </span>
<span id="cb119-316"><a href="opakování.html#cb119-316" tabindex="-1"></a>  <span class="co"># posloupnost bodu, ve kterych funkce vyhodnotime</span></span>
<span id="cb119-317"><a href="opakování.html#cb119-317" tabindex="-1"></a>  t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(rangeval[<span class="dv">1</span>], rangeval[<span class="dv">2</span>], <span class="at">length =</span> <span class="dv">51</span>)</span>
<span id="cb119-318"><a href="opakování.html#cb119-318" tabindex="-1"></a>     </span>
<span id="cb119-319"><a href="opakování.html#cb119-319" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb119-320"><a href="opakování.html#cb119-320" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) <span class="co"># transpozice kvuli funkcim v radku</span></span>
<span id="cb119-321"><a href="opakování.html#cb119-321" tabindex="-1"></a>  grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb119-322"><a href="opakování.html#cb119-322" tabindex="-1"></a>  </span>
<span id="cb119-323"><a href="opakování.html#cb119-323" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb119-324"><a href="opakování.html#cb119-324" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb119-325"><a href="opakování.html#cb119-325" tabindex="-1"></a>  grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb119-326"><a href="opakování.html#cb119-326" tabindex="-1"></a>  </span>
<span id="cb119-327"><a href="opakování.html#cb119-327" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb119-328"><a href="opakování.html#cb119-328" tabindex="-1"></a>  clf.tree <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb119-329"><a href="opakování.html#cb119-329" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb119-330"><a href="opakování.html#cb119-330" tabindex="-1"></a>                   <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb119-331"><a href="opakování.html#cb119-331" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb119-332"><a href="opakování.html#cb119-332" tabindex="-1"></a>  </span>
<span id="cb119-333"><a href="opakování.html#cb119-333" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb119-334"><a href="opakování.html#cb119-334" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data)</span>
<span id="cb119-335"><a href="opakování.html#cb119-335" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb119-336"><a href="opakování.html#cb119-336" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-337"><a href="opakování.html#cb119-337" tabindex="-1"></a>    </span>
<span id="cb119-338"><a href="opakování.html#cb119-338" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb119-339"><a href="opakování.html#cb119-339" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb119-340"><a href="opakování.html#cb119-340" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb119-341"><a href="opakování.html#cb119-341" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-342"><a href="opakování.html#cb119-342" tabindex="-1"></a>  </span>
<span id="cb119-343"><a href="opakování.html#cb119-343" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree_discr&#39;</span>, </span>
<span id="cb119-344"><a href="opakování.html#cb119-344" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb119-345"><a href="opakování.html#cb119-345" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb119-346"><a href="opakování.html#cb119-346" tabindex="-1"></a>  </span>
<span id="cb119-347"><a href="opakování.html#cb119-347" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb119-348"><a href="opakování.html#cb119-348" tabindex="-1"></a>  </span>
<span id="cb119-349"><a href="opakování.html#cb119-349" tabindex="-1"></a>  <span class="do">### 5.2) Skóre hlavních komponent</span></span>
<span id="cb119-350"><a href="opakování.html#cb119-350" tabindex="-1"></a>  </span>
<span id="cb119-351"><a href="opakování.html#cb119-351" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb119-352"><a href="opakování.html#cb119-352" tabindex="-1"></a>  clf.tree.PCA <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb119-353"><a href="opakování.html#cb119-353" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb119-354"><a href="opakování.html#cb119-354" tabindex="-1"></a>                   <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb119-355"><a href="opakování.html#cb119-355" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb119-356"><a href="opakování.html#cb119-356" tabindex="-1"></a>  </span>
<span id="cb119-357"><a href="opakování.html#cb119-357" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb119-358"><a href="opakování.html#cb119-358" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb119-359"><a href="opakování.html#cb119-359" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb119-360"><a href="opakování.html#cb119-360" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-361"><a href="opakování.html#cb119-361" tabindex="-1"></a>    </span>
<span id="cb119-362"><a href="opakování.html#cb119-362" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb119-363"><a href="opakování.html#cb119-363" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb119-364"><a href="opakování.html#cb119-364" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb119-365"><a href="opakování.html#cb119-365" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-366"><a href="opakování.html#cb119-366" tabindex="-1"></a>  </span>
<span id="cb119-367"><a href="opakování.html#cb119-367" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree_score&#39;</span>, </span>
<span id="cb119-368"><a href="opakování.html#cb119-368" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb119-369"><a href="opakování.html#cb119-369" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb119-370"><a href="opakování.html#cb119-370" tabindex="-1"></a>  </span>
<span id="cb119-371"><a href="opakování.html#cb119-371" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb119-372"><a href="opakování.html#cb119-372" tabindex="-1"></a>  </span>
<span id="cb119-373"><a href="opakování.html#cb119-373" tabindex="-1"></a>  <span class="do">### 5.3) Bázové koeficienty</span></span>
<span id="cb119-374"><a href="opakování.html#cb119-374" tabindex="-1"></a>  </span>
<span id="cb119-375"><a href="opakování.html#cb119-375" tabindex="-1"></a>  <span class="co"># trenovaci dataset</span></span>
<span id="cb119-376"><a href="opakování.html#cb119-376" tabindex="-1"></a>  data.Bbasis.train <span class="ot">&lt;-</span> <span class="fu">t</span>(X.train<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb119-377"><a href="opakování.html#cb119-377" tabindex="-1"></a>  data.Bbasis.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb119-378"><a href="opakování.html#cb119-378" tabindex="-1"></a>  </span>
<span id="cb119-379"><a href="opakování.html#cb119-379" tabindex="-1"></a>  <span class="co"># testovaci dataset</span></span>
<span id="cb119-380"><a href="opakování.html#cb119-380" tabindex="-1"></a>  data.Bbasis.test <span class="ot">&lt;-</span> <span class="fu">t</span>(X.test<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb119-381"><a href="opakování.html#cb119-381" tabindex="-1"></a>  data.Bbasis.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb119-382"><a href="opakování.html#cb119-382" tabindex="-1"></a>  </span>
<span id="cb119-383"><a href="opakování.html#cb119-383" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb119-384"><a href="opakování.html#cb119-384" tabindex="-1"></a>  clf.tree.Bbasis <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb119-385"><a href="opakování.html#cb119-385" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb119-386"><a href="opakování.html#cb119-386" tabindex="-1"></a>                   <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb119-387"><a href="opakování.html#cb119-387" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb119-388"><a href="opakování.html#cb119-388" tabindex="-1"></a>  </span>
<span id="cb119-389"><a href="opakování.html#cb119-389" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb119-390"><a href="opakování.html#cb119-390" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb119-391"><a href="opakování.html#cb119-391" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb119-392"><a href="opakování.html#cb119-392" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-393"><a href="opakování.html#cb119-393" tabindex="-1"></a>    </span>
<span id="cb119-394"><a href="opakování.html#cb119-394" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb119-395"><a href="opakování.html#cb119-395" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb119-396"><a href="opakování.html#cb119-396" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb119-397"><a href="opakování.html#cb119-397" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-398"><a href="opakování.html#cb119-398" tabindex="-1"></a>  </span>
<span id="cb119-399"><a href="opakování.html#cb119-399" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree_Bbasis&#39;</span>, </span>
<span id="cb119-400"><a href="opakování.html#cb119-400" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb119-401"><a href="opakování.html#cb119-401" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb119-402"><a href="opakování.html#cb119-402" tabindex="-1"></a>  </span>
<span id="cb119-403"><a href="opakování.html#cb119-403" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb119-404"><a href="opakování.html#cb119-404" tabindex="-1"></a>  </span>
<span id="cb119-405"><a href="opakování.html#cb119-405" tabindex="-1"></a>  <span class="do">## 6) Náhodné lesy</span></span>
<span id="cb119-406"><a href="opakování.html#cb119-406" tabindex="-1"></a>  </span>
<span id="cb119-407"><a href="opakování.html#cb119-407" tabindex="-1"></a>  <span class="do">### 6.1) Diskretizace intervalu</span></span>
<span id="cb119-408"><a href="opakování.html#cb119-408" tabindex="-1"></a>  </span>
<span id="cb119-409"><a href="opakování.html#cb119-409" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb119-410"><a href="opakování.html#cb119-410" tabindex="-1"></a>  clf.RF <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb119-411"><a href="opakování.html#cb119-411" tabindex="-1"></a>                         <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb119-412"><a href="opakování.html#cb119-412" tabindex="-1"></a>                         <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb119-413"><a href="opakování.html#cb119-413" tabindex="-1"></a>                         <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb119-414"><a href="opakování.html#cb119-414" tabindex="-1"></a>  </span>
<span id="cb119-415"><a href="opakování.html#cb119-415" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb119-416"><a href="opakování.html#cb119-416" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data)</span>
<span id="cb119-417"><a href="opakování.html#cb119-417" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb119-418"><a href="opakování.html#cb119-418" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-419"><a href="opakování.html#cb119-419" tabindex="-1"></a>    </span>
<span id="cb119-420"><a href="opakování.html#cb119-420" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb119-421"><a href="opakování.html#cb119-421" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb119-422"><a href="opakování.html#cb119-422" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb119-423"><a href="opakování.html#cb119-423" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-424"><a href="opakování.html#cb119-424" tabindex="-1"></a>  </span>
<span id="cb119-425"><a href="opakování.html#cb119-425" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_discr&#39;</span>, </span>
<span id="cb119-426"><a href="opakování.html#cb119-426" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb119-427"><a href="opakování.html#cb119-427" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb119-428"><a href="opakování.html#cb119-428" tabindex="-1"></a>  </span>
<span id="cb119-429"><a href="opakování.html#cb119-429" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb119-430"><a href="opakování.html#cb119-430" tabindex="-1"></a>  </span>
<span id="cb119-431"><a href="opakování.html#cb119-431" tabindex="-1"></a>  <span class="do">### 6.2) Skóre hlavních komponent</span></span>
<span id="cb119-432"><a href="opakování.html#cb119-432" tabindex="-1"></a>  </span>
<span id="cb119-433"><a href="opakování.html#cb119-433" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb119-434"><a href="opakování.html#cb119-434" tabindex="-1"></a>  clf.RF.PCA <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb119-435"><a href="opakování.html#cb119-435" tabindex="-1"></a>                             <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb119-436"><a href="opakování.html#cb119-436" tabindex="-1"></a>                             <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb119-437"><a href="opakování.html#cb119-437" tabindex="-1"></a>                             <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb119-438"><a href="opakování.html#cb119-438" tabindex="-1"></a>  </span>
<span id="cb119-439"><a href="opakování.html#cb119-439" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb119-440"><a href="opakování.html#cb119-440" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb119-441"><a href="opakování.html#cb119-441" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb119-442"><a href="opakování.html#cb119-442" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-443"><a href="opakování.html#cb119-443" tabindex="-1"></a>    </span>
<span id="cb119-444"><a href="opakování.html#cb119-444" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb119-445"><a href="opakování.html#cb119-445" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb119-446"><a href="opakování.html#cb119-446" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb119-447"><a href="opakování.html#cb119-447" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-448"><a href="opakování.html#cb119-448" tabindex="-1"></a>  </span>
<span id="cb119-449"><a href="opakování.html#cb119-449" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_score&#39;</span>, </span>
<span id="cb119-450"><a href="opakování.html#cb119-450" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb119-451"><a href="opakování.html#cb119-451" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb119-452"><a href="opakování.html#cb119-452" tabindex="-1"></a>  </span>
<span id="cb119-453"><a href="opakování.html#cb119-453" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb119-454"><a href="opakování.html#cb119-454" tabindex="-1"></a>  </span>
<span id="cb119-455"><a href="opakování.html#cb119-455" tabindex="-1"></a>  <span class="do">### 6.3) Bázové koeficienty</span></span>
<span id="cb119-456"><a href="opakování.html#cb119-456" tabindex="-1"></a>  </span>
<span id="cb119-457"><a href="opakování.html#cb119-457" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb119-458"><a href="opakování.html#cb119-458" tabindex="-1"></a>  clf.RF.Bbasis <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb119-459"><a href="opakování.html#cb119-459" tabindex="-1"></a>                                <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb119-460"><a href="opakování.html#cb119-460" tabindex="-1"></a>                                <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb119-461"><a href="opakování.html#cb119-461" tabindex="-1"></a>                                <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb119-462"><a href="opakování.html#cb119-462" tabindex="-1"></a>  </span>
<span id="cb119-463"><a href="opakování.html#cb119-463" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb119-464"><a href="opakování.html#cb119-464" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb119-465"><a href="opakování.html#cb119-465" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb119-466"><a href="opakování.html#cb119-466" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-467"><a href="opakování.html#cb119-467" tabindex="-1"></a>    </span>
<span id="cb119-468"><a href="opakování.html#cb119-468" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb119-469"><a href="opakování.html#cb119-469" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb119-470"><a href="opakování.html#cb119-470" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb119-471"><a href="opakování.html#cb119-471" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-472"><a href="opakování.html#cb119-472" tabindex="-1"></a>  </span>
<span id="cb119-473"><a href="opakování.html#cb119-473" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_Bbasis&#39;</span>, </span>
<span id="cb119-474"><a href="opakování.html#cb119-474" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb119-475"><a href="opakování.html#cb119-475" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb119-476"><a href="opakování.html#cb119-476" tabindex="-1"></a>  </span>
<span id="cb119-477"><a href="opakování.html#cb119-477" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb119-478"><a href="opakování.html#cb119-478" tabindex="-1"></a>  </span>
<span id="cb119-479"><a href="opakování.html#cb119-479" tabindex="-1"></a>  <span class="do">## 7) SVM</span></span>
<span id="cb119-480"><a href="opakování.html#cb119-480" tabindex="-1"></a>  </span>
<span id="cb119-481"><a href="opakování.html#cb119-481" tabindex="-1"></a>  <span class="do">### 7.1) Diskretizace intervalu</span></span>
<span id="cb119-482"><a href="opakování.html#cb119-482" tabindex="-1"></a>  </span>
<span id="cb119-483"><a href="opakování.html#cb119-483" tabindex="-1"></a>  clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb119-484"><a href="opakování.html#cb119-484" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb119-485"><a href="opakování.html#cb119-485" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb119-486"><a href="opakování.html#cb119-486" tabindex="-1"></a>                   <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb119-487"><a href="opakování.html#cb119-487" tabindex="-1"></a>  </span>
<span id="cb119-488"><a href="opakování.html#cb119-488" tabindex="-1"></a>  clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb119-489"><a href="opakování.html#cb119-489" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb119-490"><a href="opakování.html#cb119-490" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb119-491"><a href="opakování.html#cb119-491" tabindex="-1"></a>                   <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb119-492"><a href="opakování.html#cb119-492" tabindex="-1"></a>  </span>
<span id="cb119-493"><a href="opakování.html#cb119-493" tabindex="-1"></a>  clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb119-494"><a href="opakování.html#cb119-494" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb119-495"><a href="opakování.html#cb119-495" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb119-496"><a href="opakování.html#cb119-496" tabindex="-1"></a>                   <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb119-497"><a href="opakování.html#cb119-497" tabindex="-1"></a>  </span>
<span id="cb119-498"><a href="opakování.html#cb119-498" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb119-499"><a href="opakování.html#cb119-499" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data)</span>
<span id="cb119-500"><a href="opakování.html#cb119-500" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb119-501"><a href="opakování.html#cb119-501" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-502"><a href="opakování.html#cb119-502" tabindex="-1"></a>  </span>
<span id="cb119-503"><a href="opakování.html#cb119-503" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data)</span>
<span id="cb119-504"><a href="opakování.html#cb119-504" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb119-505"><a href="opakování.html#cb119-505" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-506"><a href="opakování.html#cb119-506" tabindex="-1"></a>  </span>
<span id="cb119-507"><a href="opakování.html#cb119-507" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data)</span>
<span id="cb119-508"><a href="opakování.html#cb119-508" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb119-509"><a href="opakování.html#cb119-509" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-510"><a href="opakování.html#cb119-510" tabindex="-1"></a>  </span>
<span id="cb119-511"><a href="opakování.html#cb119-511" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb119-512"><a href="opakování.html#cb119-512" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb119-513"><a href="opakování.html#cb119-513" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb119-514"><a href="opakování.html#cb119-514" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-515"><a href="opakování.html#cb119-515" tabindex="-1"></a>  </span>
<span id="cb119-516"><a href="opakování.html#cb119-516" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb119-517"><a href="opakování.html#cb119-517" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb119-518"><a href="opakování.html#cb119-518" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-519"><a href="opakování.html#cb119-519" tabindex="-1"></a>  </span>
<span id="cb119-520"><a href="opakování.html#cb119-520" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb119-521"><a href="opakování.html#cb119-521" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb119-522"><a href="opakování.html#cb119-522" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-523"><a href="opakování.html#cb119-523" tabindex="-1"></a>  </span>
<span id="cb119-524"><a href="opakování.html#cb119-524" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - diskr&#39;</span>, </span>
<span id="cb119-525"><a href="opakování.html#cb119-525" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - diskr&#39;</span>, </span>
<span id="cb119-526"><a href="opakování.html#cb119-526" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - diskr&#39;</span>), </span>
<span id="cb119-527"><a href="opakování.html#cb119-527" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l,</span>
<span id="cb119-528"><a href="opakování.html#cb119-528" tabindex="-1"></a>                                      presnost.train.p, presnost.train.r),</span>
<span id="cb119-529"><a href="opakování.html#cb119-529" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb119-530"><a href="opakování.html#cb119-530" tabindex="-1"></a>                                     presnost.test.p, presnost.test.r))</span>
<span id="cb119-531"><a href="opakování.html#cb119-531" tabindex="-1"></a>  </span>
<span id="cb119-532"><a href="opakování.html#cb119-532" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb119-533"><a href="opakování.html#cb119-533" tabindex="-1"></a>  </span>
<span id="cb119-534"><a href="opakování.html#cb119-534" tabindex="-1"></a>  <span class="do">### 7.2) Skóre hlavních komponent</span></span>
<span id="cb119-535"><a href="opakování.html#cb119-535" tabindex="-1"></a>  </span>
<span id="cb119-536"><a href="opakování.html#cb119-536" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb119-537"><a href="opakování.html#cb119-537" tabindex="-1"></a>  clf.SVM.l.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb119-538"><a href="opakování.html#cb119-538" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb119-539"><a href="opakování.html#cb119-539" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb119-540"><a href="opakování.html#cb119-540" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb119-541"><a href="opakování.html#cb119-541" tabindex="-1"></a>  </span>
<span id="cb119-542"><a href="opakování.html#cb119-542" tabindex="-1"></a>  clf.SVM.p.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb119-543"><a href="opakování.html#cb119-543" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb119-544"><a href="opakování.html#cb119-544" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb119-545"><a href="opakování.html#cb119-545" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb119-546"><a href="opakování.html#cb119-546" tabindex="-1"></a>  </span>
<span id="cb119-547"><a href="opakování.html#cb119-547" tabindex="-1"></a>  clf.SVM.r.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb119-548"><a href="opakování.html#cb119-548" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb119-549"><a href="opakování.html#cb119-549" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb119-550"><a href="opakování.html#cb119-550" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb119-551"><a href="opakování.html#cb119-551" tabindex="-1"></a>  </span>
<span id="cb119-552"><a href="opakování.html#cb119-552" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb119-553"><a href="opakování.html#cb119-553" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb119-554"><a href="opakování.html#cb119-554" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb119-555"><a href="opakování.html#cb119-555" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-556"><a href="opakování.html#cb119-556" tabindex="-1"></a>  </span>
<span id="cb119-557"><a href="opakování.html#cb119-557" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb119-558"><a href="opakování.html#cb119-558" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb119-559"><a href="opakování.html#cb119-559" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-560"><a href="opakování.html#cb119-560" tabindex="-1"></a>  </span>
<span id="cb119-561"><a href="opakování.html#cb119-561" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb119-562"><a href="opakování.html#cb119-562" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb119-563"><a href="opakování.html#cb119-563" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-564"><a href="opakování.html#cb119-564" tabindex="-1"></a>    </span>
<span id="cb119-565"><a href="opakování.html#cb119-565" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb119-566"><a href="opakování.html#cb119-566" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb119-567"><a href="opakování.html#cb119-567" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb119-568"><a href="opakování.html#cb119-568" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-569"><a href="opakování.html#cb119-569" tabindex="-1"></a>  </span>
<span id="cb119-570"><a href="opakování.html#cb119-570" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb119-571"><a href="opakování.html#cb119-571" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb119-572"><a href="opakování.html#cb119-572" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-573"><a href="opakování.html#cb119-573" tabindex="-1"></a>  </span>
<span id="cb119-574"><a href="opakování.html#cb119-574" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb119-575"><a href="opakování.html#cb119-575" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb119-576"><a href="opakování.html#cb119-576" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-577"><a href="opakování.html#cb119-577" tabindex="-1"></a>  </span>
<span id="cb119-578"><a href="opakování.html#cb119-578" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - PCA&#39;</span>, </span>
<span id="cb119-579"><a href="opakování.html#cb119-579" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - PCA&#39;</span>, </span>
<span id="cb119-580"><a href="opakování.html#cb119-580" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - PCA&#39;</span>), </span>
<span id="cb119-581"><a href="opakování.html#cb119-581" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, </span>
<span id="cb119-582"><a href="opakování.html#cb119-582" tabindex="-1"></a>                                      presnost.train.p, presnost.train.r),</span>
<span id="cb119-583"><a href="opakování.html#cb119-583" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb119-584"><a href="opakování.html#cb119-584" tabindex="-1"></a>                                     presnost.test.p, presnost.test.r))</span>
<span id="cb119-585"><a href="opakování.html#cb119-585" tabindex="-1"></a>  </span>
<span id="cb119-586"><a href="opakování.html#cb119-586" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb119-587"><a href="opakování.html#cb119-587" tabindex="-1"></a>  </span>
<span id="cb119-588"><a href="opakování.html#cb119-588" tabindex="-1"></a>  <span class="do">### 7.3) Bázové koeficienty</span></span>
<span id="cb119-589"><a href="opakování.html#cb119-589" tabindex="-1"></a>  </span>
<span id="cb119-590"><a href="opakování.html#cb119-590" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb119-591"><a href="opakování.html#cb119-591" tabindex="-1"></a>  clf.SVM.l.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb119-592"><a href="opakování.html#cb119-592" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb119-593"><a href="opakování.html#cb119-593" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb119-594"><a href="opakování.html#cb119-594" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb119-595"><a href="opakování.html#cb119-595" tabindex="-1"></a>  </span>
<span id="cb119-596"><a href="opakování.html#cb119-596" tabindex="-1"></a>  clf.SVM.p.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb119-597"><a href="opakování.html#cb119-597" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb119-598"><a href="opakování.html#cb119-598" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb119-599"><a href="opakování.html#cb119-599" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb119-600"><a href="opakování.html#cb119-600" tabindex="-1"></a>  </span>
<span id="cb119-601"><a href="opakování.html#cb119-601" tabindex="-1"></a>  clf.SVM.r.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb119-602"><a href="opakování.html#cb119-602" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb119-603"><a href="opakování.html#cb119-603" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb119-604"><a href="opakování.html#cb119-604" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb119-605"><a href="opakování.html#cb119-605" tabindex="-1"></a>  </span>
<span id="cb119-606"><a href="opakování.html#cb119-606" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb119-607"><a href="opakování.html#cb119-607" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb119-608"><a href="opakování.html#cb119-608" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb119-609"><a href="opakování.html#cb119-609" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-610"><a href="opakování.html#cb119-610" tabindex="-1"></a>  </span>
<span id="cb119-611"><a href="opakování.html#cb119-611" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb119-612"><a href="opakování.html#cb119-612" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb119-613"><a href="opakování.html#cb119-613" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-614"><a href="opakování.html#cb119-614" tabindex="-1"></a>  </span>
<span id="cb119-615"><a href="opakování.html#cb119-615" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb119-616"><a href="opakování.html#cb119-616" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb119-617"><a href="opakování.html#cb119-617" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-618"><a href="opakování.html#cb119-618" tabindex="-1"></a>    </span>
<span id="cb119-619"><a href="opakování.html#cb119-619" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb119-620"><a href="opakování.html#cb119-620" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb119-621"><a href="opakování.html#cb119-621" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb119-622"><a href="opakování.html#cb119-622" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-623"><a href="opakování.html#cb119-623" tabindex="-1"></a>  </span>
<span id="cb119-624"><a href="opakování.html#cb119-624" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb119-625"><a href="opakování.html#cb119-625" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb119-626"><a href="opakování.html#cb119-626" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-627"><a href="opakování.html#cb119-627" tabindex="-1"></a>  </span>
<span id="cb119-628"><a href="opakování.html#cb119-628" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb119-629"><a href="opakování.html#cb119-629" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb119-630"><a href="opakování.html#cb119-630" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-631"><a href="opakování.html#cb119-631" tabindex="-1"></a>  </span>
<span id="cb119-632"><a href="opakování.html#cb119-632" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - Bbasis&#39;</span>, </span>
<span id="cb119-633"><a href="opakování.html#cb119-633" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - Bbasis&#39;</span>, </span>
<span id="cb119-634"><a href="opakování.html#cb119-634" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - Bbasis&#39;</span>), </span>
<span id="cb119-635"><a href="opakování.html#cb119-635" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, </span>
<span id="cb119-636"><a href="opakování.html#cb119-636" tabindex="-1"></a>                                      presnost.train.p, presnost.train.r),</span>
<span id="cb119-637"><a href="opakování.html#cb119-637" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb119-638"><a href="opakování.html#cb119-638" tabindex="-1"></a>                                     presnost.test.p, presnost.test.r))</span>
<span id="cb119-639"><a href="opakování.html#cb119-639" tabindex="-1"></a></span>
<span id="cb119-640"><a href="opakování.html#cb119-640" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb119-641"><a href="opakování.html#cb119-641" tabindex="-1"></a>  </span>
<span id="cb119-642"><a href="opakování.html#cb119-642" tabindex="-1"></a>  <span class="do">### 7.4) Projekce na B-splinovou bázi</span></span>
<span id="cb119-643"><a href="opakování.html#cb119-643" tabindex="-1"></a>  </span>
<span id="cb119-644"><a href="opakování.html#cb119-644" tabindex="-1"></a>  <span class="co"># hodnoty pro B-splinovou bazi</span></span>
<span id="cb119-645"><a href="opakování.html#cb119-645" tabindex="-1"></a>  rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb119-646"><a href="opakování.html#cb119-646" tabindex="-1"></a>  norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb119-647"><a href="opakování.html#cb119-647" tabindex="-1"></a>  n_basis_min <span class="ot">&lt;-</span> norder</span>
<span id="cb119-648"><a href="opakování.html#cb119-648" tabindex="-1"></a>  n_basis_max <span class="ot">&lt;-</span> <span class="fu">length</span>(t) <span class="sc">+</span> norder <span class="sc">-</span> <span class="dv">2</span> <span class="sc">-</span> <span class="dv">10</span></span>
<span id="cb119-649"><a href="opakování.html#cb119-649" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> n_basis_min<span class="sc">:</span>n_basis_max </span>
<span id="cb119-650"><a href="opakování.html#cb119-650" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb119-651"><a href="opakování.html#cb119-651" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">SVM.l =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb119-652"><a href="opakování.html#cb119-652" tabindex="-1"></a>                     <span class="at">SVM.p =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb119-653"><a href="opakování.html#cb119-653" tabindex="-1"></a>                     <span class="at">SVM.r =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv))</span>
<span id="cb119-654"><a href="opakování.html#cb119-654" tabindex="-1"></a>  </span>
<span id="cb119-655"><a href="opakování.html#cb119-655" tabindex="-1"></a>  <span class="cf">for</span> (d <span class="cf">in</span> dimensions) {</span>
<span id="cb119-656"><a href="opakování.html#cb119-656" tabindex="-1"></a>    bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb119-657"><a href="opakování.html#cb119-657" tabindex="-1"></a>                                   <span class="at">nbasis =</span> d)</span>
<span id="cb119-658"><a href="opakování.html#cb119-658" tabindex="-1"></a>    Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="at">argvals =</span> t, <span class="at">basisobj =</span> bbasis) </span>
<span id="cb119-659"><a href="opakování.html#cb119-659" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb119-660"><a href="opakování.html#cb119-660" tabindex="-1"></a>    </span>
<span id="cb119-661"><a href="opakování.html#cb119-661" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb119-662"><a href="opakování.html#cb119-662" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb119-663"><a href="opakování.html#cb119-663" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XX.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb119-664"><a href="opakování.html#cb119-664" tabindex="-1"></a>      </span>
<span id="cb119-665"><a href="opakování.html#cb119-665" tabindex="-1"></a>      data.projection.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[cv_sample, ])</span>
<span id="cb119-666"><a href="opakování.html#cb119-666" tabindex="-1"></a>      data.projection.train.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[cv_sample])</span>
<span id="cb119-667"><a href="opakování.html#cb119-667" tabindex="-1"></a>      data.projection.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb119-668"><a href="opakování.html#cb119-668" tabindex="-1"></a>      Y.test.cv <span class="ot">&lt;-</span> Y.train[<span class="sc">!</span>cv_sample]</span>
<span id="cb119-669"><a href="opakování.html#cb119-669" tabindex="-1"></a>      data.projection.test.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test.cv)</span>
<span id="cb119-670"><a href="opakování.html#cb119-670" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb119-671"><a href="opakování.html#cb119-671" tabindex="-1"></a>      clf.SVM.l.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb119-672"><a href="opakování.html#cb119-672" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb119-673"><a href="opakování.html#cb119-673" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb119-674"><a href="opakování.html#cb119-674" tabindex="-1"></a>                              <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb119-675"><a href="opakování.html#cb119-675" tabindex="-1"></a>      </span>
<span id="cb119-676"><a href="opakování.html#cb119-676" tabindex="-1"></a>      clf.SVM.p.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb119-677"><a href="opakování.html#cb119-677" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb119-678"><a href="opakování.html#cb119-678" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb119-679"><a href="opakování.html#cb119-679" tabindex="-1"></a>                              <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb119-680"><a href="opakování.html#cb119-680" tabindex="-1"></a>      </span>
<span id="cb119-681"><a href="opakování.html#cb119-681" tabindex="-1"></a>      clf.SVM.r.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb119-682"><a href="opakování.html#cb119-682" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb119-683"><a href="opakování.html#cb119-683" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb119-684"><a href="opakování.html#cb119-684" tabindex="-1"></a>                              <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb119-685"><a href="opakování.html#cb119-685" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb119-686"><a href="opakování.html#cb119-686" tabindex="-1"></a>      <span class="do">## linear kernel</span></span>
<span id="cb119-687"><a href="opakování.html#cb119-687" tabindex="-1"></a>      predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.projection,</span>
<span id="cb119-688"><a href="opakování.html#cb119-688" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb119-689"><a href="opakování.html#cb119-689" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb119-690"><a href="opakování.html#cb119-690" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-691"><a href="opakování.html#cb119-691" tabindex="-1"></a>      <span class="do">## polynomial kernel</span></span>
<span id="cb119-692"><a href="opakování.html#cb119-692" tabindex="-1"></a>      predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.projection, </span>
<span id="cb119-693"><a href="opakování.html#cb119-693" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb119-694"><a href="opakování.html#cb119-694" tabindex="-1"></a>      presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb119-695"><a href="opakování.html#cb119-695" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-696"><a href="opakování.html#cb119-696" tabindex="-1"></a>      <span class="do">## radial kernel</span></span>
<span id="cb119-697"><a href="opakování.html#cb119-697" tabindex="-1"></a>      predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.projection,</span>
<span id="cb119-698"><a href="opakování.html#cb119-698" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb119-699"><a href="opakování.html#cb119-699" tabindex="-1"></a>      presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb119-700"><a href="opakování.html#cb119-700" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-701"><a href="opakování.html#cb119-701" tabindex="-1"></a>      </span>
<span id="cb119-702"><a href="opakování.html#cb119-702" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane d a fold</span></span>
<span id="cb119-703"><a href="opakování.html#cb119-703" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb119-704"><a href="opakování.html#cb119-704" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb119-705"><a href="opakování.html#cb119-705" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb119-706"><a href="opakování.html#cb119-706" tabindex="-1"></a>    }</span>
<span id="cb119-707"><a href="opakování.html#cb119-707" tabindex="-1"></a>  }</span>
<span id="cb119-708"><a href="opakování.html#cb119-708" tabindex="-1"></a>  </span>
<span id="cb119-709"><a href="opakování.html#cb119-709" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb119-710"><a href="opakování.html#cb119-710" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb119-711"><a href="opakování.html#cb119-711" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb119-712"><a href="opakování.html#cb119-712" tabindex="-1"></a>  }</span>
<span id="cb119-713"><a href="opakování.html#cb119-713" tabindex="-1"></a>  </span>
<span id="cb119-714"><a href="opakování.html#cb119-714" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb119-715"><a href="opakování.html#cb119-715" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb119-716"><a href="opakování.html#cb119-716" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb119-717"><a href="opakování.html#cb119-717" tabindex="-1"></a>  </span>
<span id="cb119-718"><a href="opakování.html#cb119-718" tabindex="-1"></a>  <span class="co"># ulozime optimalni d do datove tabulky</span></span>
<span id="cb119-719"><a href="opakování.html#cb119-719" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb119-720"><a href="opakování.html#cb119-720" tabindex="-1"></a>  </span>
<span id="cb119-721"><a href="opakování.html#cb119-721" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb119-722"><a href="opakování.html#cb119-722" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - projection&#39;</span>, </span>
<span id="cb119-723"><a href="opakování.html#cb119-723" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb119-724"><a href="opakování.html#cb119-724" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - projection&#39;</span>), </span>
<span id="cb119-725"><a href="opakování.html#cb119-725" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb119-726"><a href="opakování.html#cb119-726" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb119-727"><a href="opakování.html#cb119-727" tabindex="-1"></a>  </span>
<span id="cb119-728"><a href="opakování.html#cb119-728" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb119-729"><a href="opakování.html#cb119-729" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb119-730"><a href="opakování.html#cb119-730" tabindex="-1"></a>    bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb119-731"><a href="opakování.html#cb119-731" tabindex="-1"></a>                                   <span class="at">nbasis =</span> d.opt[kernel_number])</span>
<span id="cb119-732"><a href="opakování.html#cb119-732" tabindex="-1"></a>    Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="at">argvals =</span> t, <span class="at">basisobj =</span> bbasis) </span>
<span id="cb119-733"><a href="opakování.html#cb119-733" tabindex="-1"></a>    </span>
<span id="cb119-734"><a href="opakování.html#cb119-734" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb119-735"><a href="opakování.html#cb119-735" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb119-736"><a href="opakování.html#cb119-736" tabindex="-1"></a>    </span>
<span id="cb119-737"><a href="opakování.html#cb119-737" tabindex="-1"></a>    data.projection.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train)</span>
<span id="cb119-738"><a href="opakování.html#cb119-738" tabindex="-1"></a>    data.projection.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb119-739"><a href="opakování.html#cb119-739" tabindex="-1"></a>    </span>
<span id="cb119-740"><a href="opakování.html#cb119-740" tabindex="-1"></a>    data.projection.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.test)</span>
<span id="cb119-741"><a href="opakování.html#cb119-741" tabindex="-1"></a>    data.projection.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb119-742"><a href="opakování.html#cb119-742" tabindex="-1"></a>    </span>
<span id="cb119-743"><a href="opakování.html#cb119-743" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb119-744"><a href="opakování.html#cb119-744" tabindex="-1"></a>    clf.SVM.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train,</span>
<span id="cb119-745"><a href="opakování.html#cb119-745" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb119-746"><a href="opakování.html#cb119-746" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb119-747"><a href="opakování.html#cb119-747" tabindex="-1"></a>                              <span class="at">kernel =</span> kernel_type)</span>
<span id="cb119-748"><a href="opakování.html#cb119-748" tabindex="-1"></a>    </span>
<span id="cb119-749"><a href="opakování.html#cb119-749" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb119-750"><a href="opakování.html#cb119-750" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.train)</span>
<span id="cb119-751"><a href="opakování.html#cb119-751" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb119-752"><a href="opakování.html#cb119-752" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-753"><a href="opakování.html#cb119-753" tabindex="-1"></a>      </span>
<span id="cb119-754"><a href="opakování.html#cb119-754" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb119-755"><a href="opakování.html#cb119-755" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.test)</span>
<span id="cb119-756"><a href="opakování.html#cb119-756" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb119-757"><a href="opakování.html#cb119-757" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-758"><a href="opakování.html#cb119-758" tabindex="-1"></a>    </span>
<span id="cb119-759"><a href="opakování.html#cb119-759" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb119-760"><a href="opakování.html#cb119-760" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb119-761"><a href="opakování.html#cb119-761" tabindex="-1"></a>  }</span>
<span id="cb119-762"><a href="opakování.html#cb119-762" tabindex="-1"></a>  </span>
<span id="cb119-763"><a href="opakování.html#cb119-763" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb119-764"><a href="opakování.html#cb119-764" tabindex="-1"></a>  </span>
<span id="cb119-765"><a href="opakování.html#cb119-765" tabindex="-1"></a>  <span class="do">## 7.5) SVM + RKHS</span></span>
<span id="cb119-766"><a href="opakování.html#cb119-766" tabindex="-1"></a>  </span>
<span id="cb119-767"><a href="opakování.html#cb119-767" tabindex="-1"></a>  <span class="do">### Gaussovo jadro</span></span>
<span id="cb119-768"><a href="opakování.html#cb119-768" tabindex="-1"></a>  </span>
<span id="cb119-769"><a href="opakování.html#cb119-769" tabindex="-1"></a>  <span class="co"># jadro a jadrova matice ... Gaussovske s parametrem gamma</span></span>
<span id="cb119-770"><a href="opakování.html#cb119-770" tabindex="-1"></a>  Gauss.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, gamma) {</span>
<span id="cb119-771"><a href="opakování.html#cb119-771" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>gamma <span class="sc">*</span> <span class="fu">norm</span>(<span class="fu">c</span>(x <span class="sc">-</span> y) <span class="sc">|&gt;</span> <span class="fu">t</span>(), <span class="at">type =</span> <span class="st">&#39;F&#39;</span>)))</span>
<span id="cb119-772"><a href="opakování.html#cb119-772" tabindex="-1"></a>  }</span>
<span id="cb119-773"><a href="opakování.html#cb119-773" tabindex="-1"></a>  </span>
<span id="cb119-774"><a href="opakování.html#cb119-774" tabindex="-1"></a>  Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, gamma) {</span>
<span id="cb119-775"><a href="opakování.html#cb119-775" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb119-776"><a href="opakování.html#cb119-776" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb119-777"><a href="opakování.html#cb119-777" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb119-778"><a href="opakování.html#cb119-778" tabindex="-1"></a>        K[i, j] <span class="ot">&lt;-</span> <span class="fu">Gauss.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], <span class="at">gamma =</span> gamma)</span>
<span id="cb119-779"><a href="opakování.html#cb119-779" tabindex="-1"></a>      }</span>
<span id="cb119-780"><a href="opakování.html#cb119-780" tabindex="-1"></a>    }</span>
<span id="cb119-781"><a href="opakování.html#cb119-781" tabindex="-1"></a>    <span class="fu">return</span>(K)</span>
<span id="cb119-782"><a href="opakování.html#cb119-782" tabindex="-1"></a>  }</span>
<span id="cb119-783"><a href="opakování.html#cb119-783" tabindex="-1"></a>  </span>
<span id="cb119-784"><a href="opakování.html#cb119-784" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb119-785"><a href="opakování.html#cb119-785" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb119-786"><a href="opakování.html#cb119-786" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb119-787"><a href="opakování.html#cb119-787" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb119-788"><a href="opakování.html#cb119-788" tabindex="-1"></a>  </span>
<span id="cb119-789"><a href="opakování.html#cb119-789" tabindex="-1"></a>  <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb119-790"><a href="opakování.html#cb119-790" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">20</span>, <span class="at">by =</span><span class="dv">2</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb119-791"><a href="opakování.html#cb119-791" tabindex="-1"></a>  gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">15</span>)</span>
<span id="cb119-792"><a href="opakování.html#cb119-792" tabindex="-1"></a>  </span>
<span id="cb119-793"><a href="opakování.html#cb119-793" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb119-794"><a href="opakování.html#cb119-794" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb119-795"><a href="opakování.html#cb119-795" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb119-796"><a href="opakování.html#cb119-796" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb119-797"><a href="opakování.html#cb119-797" tabindex="-1"></a>  dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">gamma =</span> <span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma.cv, <span class="dv">3</span>)),</span>
<span id="cb119-798"><a href="opakování.html#cb119-798" tabindex="-1"></a>                    <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb119-799"><a href="opakování.html#cb119-799" tabindex="-1"></a>                    <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb119-800"><a href="opakování.html#cb119-800" tabindex="-1"></a>  </span>
<span id="cb119-801"><a href="opakování.html#cb119-801" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb119-802"><a href="opakování.html#cb119-802" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb119-803"><a href="opakování.html#cb119-803" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb119-804"><a href="opakování.html#cb119-804" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb119-805"><a href="opakování.html#cb119-805" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb119-806"><a href="opakování.html#cb119-806" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb119-807"><a href="opakování.html#cb119-807" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names))</span>
<span id="cb119-808"><a href="opakování.html#cb119-808" tabindex="-1"></a>  </span>
<span id="cb119-809"><a href="opakování.html#cb119-809" tabindex="-1"></a>  <span class="co"># samotna CV</span></span>
<span id="cb119-810"><a href="opakování.html#cb119-810" tabindex="-1"></a>  <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb119-811"><a href="opakování.html#cb119-811" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb119-812"><a href="opakování.html#cb119-812" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb119-813"><a href="opakování.html#cb119-813" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb119-814"><a href="opakování.html#cb119-814" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb119-815"><a href="opakování.html#cb119-815" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb119-816"><a href="opakování.html#cb119-816" tabindex="-1"></a>    </span>
<span id="cb119-817"><a href="opakování.html#cb119-817" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb119-818"><a href="opakování.html#cb119-818" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb119-819"><a href="opakování.html#cb119-819" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb119-820"><a href="opakování.html#cb119-820" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb119-821"><a href="opakování.html#cb119-821" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb119-822"><a href="opakování.html#cb119-822" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb119-823"><a href="opakování.html#cb119-823" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb119-824"><a href="opakování.html#cb119-824" tabindex="-1"></a>                      <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb119-825"><a href="opakování.html#cb119-825" tabindex="-1"></a>                      <span class="at">gamma =</span> gamma)</span>
<span id="cb119-826"><a href="opakování.html#cb119-826" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb119-827"><a href="opakování.html#cb119-827" tabindex="-1"></a>    }</span>
<span id="cb119-828"><a href="opakování.html#cb119-828" tabindex="-1"></a>    </span>
<span id="cb119-829"><a href="opakování.html#cb119-829" tabindex="-1"></a>    <span class="co"># projdeme dimenze</span></span>
<span id="cb119-830"><a href="opakování.html#cb119-830" tabindex="-1"></a>    <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb119-831"><a href="opakování.html#cb119-831" tabindex="-1"></a>      Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb119-832"><a href="opakování.html#cb119-832" tabindex="-1"></a>                            <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb119-833"><a href="opakování.html#cb119-833" tabindex="-1"></a>                            <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb119-834"><a href="opakování.html#cb119-834" tabindex="-1"></a>      <span class="co"># vypocet reprezentace</span></span>
<span id="cb119-835"><a href="opakování.html#cb119-835" tabindex="-1"></a>      <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb119-836"><a href="opakování.html#cb119-836" tabindex="-1"></a>        Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb119-837"><a href="opakování.html#cb119-837" tabindex="-1"></a>                               alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb119-838"><a href="opakování.html#cb119-838" tabindex="-1"></a>      }</span>
<span id="cb119-839"><a href="opakování.html#cb119-839" tabindex="-1"></a>      <span class="co"># projdeme folds</span></span>
<span id="cb119-840"><a href="opakování.html#cb119-840" tabindex="-1"></a>      <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb119-841"><a href="opakování.html#cb119-841" tabindex="-1"></a>        <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb119-842"><a href="opakování.html#cb119-842" tabindex="-1"></a>        fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb119-843"><a href="opakování.html#cb119-843" tabindex="-1"></a>        <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb119-844"><a href="opakování.html#cb119-844" tabindex="-1"></a>        XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb119-845"><a href="opakování.html#cb119-845" tabindex="-1"></a>        XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb119-846"><a href="opakování.html#cb119-846" tabindex="-1"></a>        <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb119-847"><a href="opakování.html#cb119-847" tabindex="-1"></a>        Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb119-848"><a href="opakování.html#cb119-848" tabindex="-1"></a>                                    <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb119-849"><a href="opakování.html#cb119-849" tabindex="-1"></a>                                    <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb119-850"><a href="opakování.html#cb119-850" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb119-851"><a href="opakování.html#cb119-851" tabindex="-1"></a>        <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb119-852"><a href="opakování.html#cb119-852" tabindex="-1"></a>        <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb119-853"><a href="opakování.html#cb119-853" tabindex="-1"></a>          kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb119-854"><a href="opakování.html#cb119-854" tabindex="-1"></a>        </span>
<span id="cb119-855"><a href="opakování.html#cb119-855" tabindex="-1"></a>          data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb119-856"><a href="opakování.html#cb119-856" tabindex="-1"></a>          data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb119-857"><a href="opakování.html#cb119-857" tabindex="-1"></a>          </span>
<span id="cb119-858"><a href="opakování.html#cb119-858" tabindex="-1"></a>          data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb119-859"><a href="opakování.html#cb119-859" tabindex="-1"></a>          data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb119-860"><a href="opakování.html#cb119-860" tabindex="-1"></a>          </span>
<span id="cb119-861"><a href="opakování.html#cb119-861" tabindex="-1"></a>          <span class="co"># sestrojeni modelu</span></span>
<span id="cb119-862"><a href="opakování.html#cb119-862" tabindex="-1"></a>          clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb119-863"><a href="opakování.html#cb119-863" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb119-864"><a href="opakování.html#cb119-864" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb119-865"><a href="opakování.html#cb119-865" tabindex="-1"></a>                              <span class="at">kernel =</span> kernel_type)</span>
<span id="cb119-866"><a href="opakování.html#cb119-866" tabindex="-1"></a>          </span>
<span id="cb119-867"><a href="opakování.html#cb119-867" tabindex="-1"></a>          <span class="co"># presnost na validacnich datech</span></span>
<span id="cb119-868"><a href="opakování.html#cb119-868" tabindex="-1"></a>          predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb119-869"><a href="opakování.html#cb119-869" tabindex="-1"></a>          presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb119-870"><a href="opakování.html#cb119-870" tabindex="-1"></a>            <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-871"><a href="opakování.html#cb119-871" tabindex="-1"></a>          </span>
<span id="cb119-872"><a href="opakování.html#cb119-872" tabindex="-1"></a>          <span class="co"># ulozeni vysledku</span></span>
<span id="cb119-873"><a href="opakování.html#cb119-873" tabindex="-1"></a>          Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb119-874"><a href="opakování.html#cb119-874" tabindex="-1"></a>        }</span>
<span id="cb119-875"><a href="opakování.html#cb119-875" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb119-876"><a href="opakování.html#cb119-876" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb119-877"><a href="opakování.html#cb119-877" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb119-878"><a href="opakování.html#cb119-878" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb119-879"><a href="opakování.html#cb119-879" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb119-880"><a href="opakování.html#cb119-880" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb119-881"><a href="opakování.html#cb119-881" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb119-882"><a href="opakování.html#cb119-882" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb119-883"><a href="opakování.html#cb119-883" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb119-884"><a href="opakování.html#cb119-884" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb119-885"><a href="opakování.html#cb119-885" tabindex="-1"></a>      }</span>
<span id="cb119-886"><a href="opakování.html#cb119-886" tabindex="-1"></a>    }</span>
<span id="cb119-887"><a href="opakování.html#cb119-887" tabindex="-1"></a>  }</span>
<span id="cb119-888"><a href="opakování.html#cb119-888" tabindex="-1"></a>  </span>
<span id="cb119-889"><a href="opakování.html#cb119-889" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb119-890"><a href="opakování.html#cb119-890" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb119-891"><a href="opakování.html#cb119-891" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean,</span>
<span id="cb119-892"><a href="opakování.html#cb119-892" tabindex="-1"></a>                                    <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb119-893"><a href="opakování.html#cb119-893" tabindex="-1"></a>  }</span>
<span id="cb119-894"><a href="opakování.html#cb119-894" tabindex="-1"></a>  </span>
<span id="cb119-895"><a href="opakování.html#cb119-895" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb119-896"><a href="opakování.html#cb119-896" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb119-897"><a href="opakování.html#cb119-897" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv))</span>
<span id="cb119-898"><a href="opakování.html#cb119-898" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb119-899"><a href="opakování.html#cb119-899" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb119-900"><a href="opakování.html#cb119-900" tabindex="-1"></a>  </span>
<span id="cb119-901"><a href="opakování.html#cb119-901" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb119-902"><a href="opakování.html#cb119-902" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb119-903"><a href="opakování.html#cb119-903" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb119-904"><a href="opakování.html#cb119-904" tabindex="-1"></a>  d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb119-905"><a href="opakování.html#cb119-905" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb119-906"><a href="opakování.html#cb119-906" tabindex="-1"></a>  </span>
<span id="cb119-907"><a href="opakování.html#cb119-907" tabindex="-1"></a>  err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb119-908"><a href="opakování.html#cb119-908" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb119-909"><a href="opakování.html#cb119-909" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb119-910"><a href="opakování.html#cb119-910" tabindex="-1"></a>  df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">gamma =</span> gamma.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb119-911"><a href="opakování.html#cb119-911" tabindex="-1"></a>             <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb119-912"><a href="opakování.html#cb119-912" tabindex="-1"></a>             <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb119-913"><a href="opakování.html#cb119-913" tabindex="-1"></a>  </span>
<span id="cb119-914"><a href="opakování.html#cb119-914" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb119-915"><a href="opakování.html#cb119-915" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb119-916"><a href="opakování.html#cb119-916" tabindex="-1"></a>  <span class="co"># pridame i testovaci data</span></span>
<span id="cb119-917"><a href="opakování.html#cb119-917" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb119-918"><a href="opakování.html#cb119-918" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb119-919"><a href="opakování.html#cb119-919" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, </span>
<span id="cb119-920"><a href="opakování.html#cb119-920" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, </span>
<span id="cb119-921"><a href="opakování.html#cb119-921" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>), </span>
<span id="cb119-922"><a href="opakování.html#cb119-922" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb119-923"><a href="opakování.html#cb119-923" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb119-924"><a href="opakování.html#cb119-924" tabindex="-1"></a>  </span>
<span id="cb119-925"><a href="opakování.html#cb119-925" tabindex="-1"></a>  <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb119-926"><a href="opakování.html#cb119-926" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb119-927"><a href="opakování.html#cb119-927" tabindex="-1"></a>    <span class="co"># spocitame matici K</span></span>
<span id="cb119-928"><a href="opakování.html#cb119-928" tabindex="-1"></a>    gamma <span class="ot">&lt;-</span> gamma.opt[kernel_number] <span class="co"># hodnota gamma pomoci CV</span></span>
<span id="cb119-929"><a href="opakování.html#cb119-929" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb119-930"><a href="opakování.html#cb119-930" tabindex="-1"></a>    </span>
<span id="cb119-931"><a href="opakování.html#cb119-931" tabindex="-1"></a>    <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb119-932"><a href="opakování.html#cb119-932" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb119-933"><a href="opakování.html#cb119-933" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb119-934"><a href="opakování.html#cb119-934" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb119-935"><a href="opakování.html#cb119-935" tabindex="-1"></a>    <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb119-936"><a href="opakování.html#cb119-936" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb119-937"><a href="opakování.html#cb119-937" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb119-938"><a href="opakování.html#cb119-938" tabindex="-1"></a>    </span>
<span id="cb119-939"><a href="opakování.html#cb119-939" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb119-940"><a href="opakování.html#cb119-940" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb119-941"><a href="opakování.html#cb119-941" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb119-942"><a href="opakování.html#cb119-942" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb119-943"><a href="opakování.html#cb119-943" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb119-944"><a href="opakování.html#cb119-944" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb119-945"><a href="opakování.html#cb119-945" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb119-946"><a href="opakování.html#cb119-946" tabindex="-1"></a>                      <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb119-947"><a href="opakování.html#cb119-947" tabindex="-1"></a>                      <span class="at">gamma =</span> gamma)</span>
<span id="cb119-948"><a href="opakování.html#cb119-948" tabindex="-1"></a>      <span class="co"># urceni alpha</span></span>
<span id="cb119-949"><a href="opakování.html#cb119-949" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb119-950"><a href="opakování.html#cb119-950" tabindex="-1"></a>    }</span>
<span id="cb119-951"><a href="opakování.html#cb119-951" tabindex="-1"></a>    <span class="co"># d</span></span>
<span id="cb119-952"><a href="opakování.html#cb119-952" tabindex="-1"></a>    d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb119-953"><a href="opakování.html#cb119-953" tabindex="-1"></a>    </span>
<span id="cb119-954"><a href="opakování.html#cb119-954" tabindex="-1"></a>    <span class="co"># urceni vektoru lambda</span></span>
<span id="cb119-955"><a href="opakování.html#cb119-955" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb119-956"><a href="opakování.html#cb119-956" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb119-957"><a href="opakování.html#cb119-957" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb119-958"><a href="opakování.html#cb119-958" tabindex="-1"></a>    </span>
<span id="cb119-959"><a href="opakování.html#cb119-959" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb119-960"><a href="opakování.html#cb119-960" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb119-961"><a href="opakování.html#cb119-961" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb119-962"><a href="opakování.html#cb119-962" tabindex="-1"></a>    }</span>
<span id="cb119-963"><a href="opakování.html#cb119-963" tabindex="-1"></a>    </span>
<span id="cb119-964"><a href="opakování.html#cb119-964" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb119-965"><a href="opakování.html#cb119-965" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb119-966"><a href="opakování.html#cb119-966" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb119-967"><a href="opakování.html#cb119-967" tabindex="-1"></a>  </span>
<span id="cb119-968"><a href="opakování.html#cb119-968" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb119-969"><a href="opakování.html#cb119-969" tabindex="-1"></a>  </span>
<span id="cb119-970"><a href="opakování.html#cb119-970" tabindex="-1"></a>    data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb119-971"><a href="opakování.html#cb119-971" tabindex="-1"></a>    data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb119-972"><a href="opakování.html#cb119-972" tabindex="-1"></a>    </span>
<span id="cb119-973"><a href="opakování.html#cb119-973" tabindex="-1"></a>    data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb119-974"><a href="opakování.html#cb119-974" tabindex="-1"></a>    data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb119-975"><a href="opakování.html#cb119-975" tabindex="-1"></a>    </span>
<span id="cb119-976"><a href="opakování.html#cb119-976" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb119-977"><a href="opakování.html#cb119-977" tabindex="-1"></a>    clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb119-978"><a href="opakování.html#cb119-978" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb119-979"><a href="opakování.html#cb119-979" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb119-980"><a href="opakování.html#cb119-980" tabindex="-1"></a>                        <span class="at">kernel =</span> kernel_type)</span>
<span id="cb119-981"><a href="opakování.html#cb119-981" tabindex="-1"></a>    </span>
<span id="cb119-982"><a href="opakování.html#cb119-982" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb119-983"><a href="opakování.html#cb119-983" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb119-984"><a href="opakování.html#cb119-984" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb119-985"><a href="opakování.html#cb119-985" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-986"><a href="opakování.html#cb119-986" tabindex="-1"></a>      </span>
<span id="cb119-987"><a href="opakování.html#cb119-987" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb119-988"><a href="opakování.html#cb119-988" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb119-989"><a href="opakování.html#cb119-989" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb119-990"><a href="opakování.html#cb119-990" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-991"><a href="opakování.html#cb119-991" tabindex="-1"></a>    </span>
<span id="cb119-992"><a href="opakování.html#cb119-992" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb119-993"><a href="opakování.html#cb119-993" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb119-994"><a href="opakování.html#cb119-994" tabindex="-1"></a>  }</span>
<span id="cb119-995"><a href="opakování.html#cb119-995" tabindex="-1"></a>  </span>
<span id="cb119-996"><a href="opakování.html#cb119-996" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb119-997"><a href="opakování.html#cb119-997" tabindex="-1"></a></span>
<span id="cb119-998"><a href="opakování.html#cb119-998" tabindex="-1"></a>  <span class="do">### Polynomialni jadro</span></span>
<span id="cb119-999"><a href="opakování.html#cb119-999" tabindex="-1"></a>  </span>
<span id="cb119-1000"><a href="opakování.html#cb119-1000" tabindex="-1"></a>  <span class="co"># jadro a jadrova matice ... polynomialni s parametrem p</span></span>
<span id="cb119-1001"><a href="opakování.html#cb119-1001" tabindex="-1"></a>  <span class="co"># Poly.kernel &lt;- function(x, y, p) {</span></span>
<span id="cb119-1002"><a href="opakování.html#cb119-1002" tabindex="-1"></a>  <span class="co">#   return((1 + x * y)^p)</span></span>
<span id="cb119-1003"><a href="opakování.html#cb119-1003" tabindex="-1"></a>  <span class="co"># }</span></span>
<span id="cb119-1004"><a href="opakování.html#cb119-1004" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb119-1005"><a href="opakování.html#cb119-1005" tabindex="-1"></a>  <span class="co"># Kernel.RKHS &lt;- function(x, p) {</span></span>
<span id="cb119-1006"><a href="opakování.html#cb119-1006" tabindex="-1"></a>  <span class="co">#   K &lt;- matrix(NA, ncol = length(x), nrow = length(x))</span></span>
<span id="cb119-1007"><a href="opakování.html#cb119-1007" tabindex="-1"></a>  <span class="co">#   for(i in 1:nrow(K)) {</span></span>
<span id="cb119-1008"><a href="opakování.html#cb119-1008" tabindex="-1"></a>  <span class="co">#     for(j in 1:ncol(K)) {</span></span>
<span id="cb119-1009"><a href="opakování.html#cb119-1009" tabindex="-1"></a>  <span class="co">#       K[i, j] &lt;- Poly.kernel(x = x[i], y = x[j], p)</span></span>
<span id="cb119-1010"><a href="opakování.html#cb119-1010" tabindex="-1"></a>  <span class="co">#     }</span></span>
<span id="cb119-1011"><a href="opakování.html#cb119-1011" tabindex="-1"></a>  <span class="co">#   }</span></span>
<span id="cb119-1012"><a href="opakování.html#cb119-1012" tabindex="-1"></a>  <span class="co">#   return(K)</span></span>
<span id="cb119-1013"><a href="opakování.html#cb119-1013" tabindex="-1"></a>  <span class="co"># }</span></span>
<span id="cb119-1014"><a href="opakování.html#cb119-1014" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb119-1015"><a href="opakování.html#cb119-1015" tabindex="-1"></a>  <span class="co"># # rozdelime trenovaci data na k casti</span></span>
<span id="cb119-1016"><a href="opakování.html#cb119-1016" tabindex="-1"></a>  <span class="co"># folds &lt;- createMultiFolds(1:sum(split), k = k_cv, time = 1)</span></span>
<span id="cb119-1017"><a href="opakování.html#cb119-1017" tabindex="-1"></a>  <span class="co"># # odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb119-1018"><a href="opakování.html#cb119-1018" tabindex="-1"></a>  <span class="co"># data.RKHS &lt;- grid.data[, -dim(grid.data)[2]] |&gt; t()</span></span>
<span id="cb119-1019"><a href="opakování.html#cb119-1019" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb119-1020"><a href="opakování.html#cb119-1020" tabindex="-1"></a>  <span class="co"># # hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb119-1021"><a href="opakování.html#cb119-1021" tabindex="-1"></a>  <span class="co"># dimensions &lt;- seq(3, 40, by = 2) # rozumny rozsah hodnot d</span></span>
<span id="cb119-1022"><a href="opakování.html#cb119-1022" tabindex="-1"></a>  <span class="co"># poly.cv &lt;- 2:5</span></span>
<span id="cb119-1023"><a href="opakování.html#cb119-1023" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb119-1024"><a href="opakování.html#cb119-1024" tabindex="-1"></a>  <span class="co"># # list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb119-1025"><a href="opakování.html#cb119-1025" tabindex="-1"></a>  <span class="co"># # prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb119-1026"><a href="opakování.html#cb119-1026" tabindex="-1"></a>  <span class="co"># # ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb119-1027"><a href="opakování.html#cb119-1027" tabindex="-1"></a>  <span class="co"># # v radcich budou hodnoty pro dane p a vrstvy odpovidaji folds</span></span>
<span id="cb119-1028"><a href="opakování.html#cb119-1028" tabindex="-1"></a>  <span class="co"># dim.names &lt;- list(p = paste0(&#39;p:&#39;, poly.cv),</span></span>
<span id="cb119-1029"><a href="opakování.html#cb119-1029" tabindex="-1"></a>  <span class="co">#                   d = paste0(&#39;d:&#39;, dimensions),</span></span>
<span id="cb119-1030"><a href="opakování.html#cb119-1030" tabindex="-1"></a>  <span class="co">#                   CV = paste0(&#39;cv:&#39;, 1:k_cv))</span></span>
<span id="cb119-1031"><a href="opakování.html#cb119-1031" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb119-1032"><a href="opakování.html#cb119-1032" tabindex="-1"></a>  <span class="co"># CV.results &lt;- list(</span></span>
<span id="cb119-1033"><a href="opakování.html#cb119-1033" tabindex="-1"></a>  <span class="co">#   SVM.l = array(NA, dim = c(length(poly.cv), length(dimensions), k_cv),</span></span>
<span id="cb119-1034"><a href="opakování.html#cb119-1034" tabindex="-1"></a>  <span class="co">#                 dimnames = dim.names),</span></span>
<span id="cb119-1035"><a href="opakování.html#cb119-1035" tabindex="-1"></a>  <span class="co">#   SVM.p = array(NA, dim = c(length(poly.cv), length(dimensions), k_cv),</span></span>
<span id="cb119-1036"><a href="opakování.html#cb119-1036" tabindex="-1"></a>  <span class="co">#                 dimnames = dim.names),</span></span>
<span id="cb119-1037"><a href="opakování.html#cb119-1037" tabindex="-1"></a>  <span class="co">#   SVM.r = array(NA, dim = c(length(poly.cv), length(dimensions), k_cv),</span></span>
<span id="cb119-1038"><a href="opakování.html#cb119-1038" tabindex="-1"></a>  <span class="co">#                 dimnames = dim.names))</span></span>
<span id="cb119-1039"><a href="opakování.html#cb119-1039" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb119-1040"><a href="opakování.html#cb119-1040" tabindex="-1"></a>  <span class="co"># # samotna CV</span></span>
<span id="cb119-1041"><a href="opakování.html#cb119-1041" tabindex="-1"></a>  <span class="co"># for (p in poly.cv) {</span></span>
<span id="cb119-1042"><a href="opakování.html#cb119-1042" tabindex="-1"></a>  <span class="co">#   K &lt;- Kernel.RKHS(t.seq, p = p)</span></span>
<span id="cb119-1043"><a href="opakování.html#cb119-1043" tabindex="-1"></a>  <span class="co">#   Eig &lt;- eigen(K)</span></span>
<span id="cb119-1044"><a href="opakování.html#cb119-1044" tabindex="-1"></a>  <span class="co">#   eig.vals &lt;- Eig$values</span></span>
<span id="cb119-1045"><a href="opakování.html#cb119-1045" tabindex="-1"></a>  <span class="co">#   eig.vectors &lt;- Eig$vectors</span></span>
<span id="cb119-1046"><a href="opakování.html#cb119-1046" tabindex="-1"></a>  <span class="co">#   alpha.RKHS &lt;- matrix(0, nrow = dim(data.RKHS)[1], ncol = dim(data.RKHS)[2]) </span></span>
<span id="cb119-1047"><a href="opakování.html#cb119-1047" tabindex="-1"></a>  <span class="co">#   </span></span>
<span id="cb119-1048"><a href="opakování.html#cb119-1048" tabindex="-1"></a>  <span class="co">#   # model</span></span>
<span id="cb119-1049"><a href="opakování.html#cb119-1049" tabindex="-1"></a>  <span class="co">#   for(i in 1:dim(data.RKHS)[2]) {</span></span>
<span id="cb119-1050"><a href="opakování.html#cb119-1050" tabindex="-1"></a>  <span class="co">#     df.svm &lt;- data.frame(x = t.seq,</span></span>
<span id="cb119-1051"><a href="opakování.html#cb119-1051" tabindex="-1"></a>  <span class="co">#                          y = data.RKHS[, i])</span></span>
<span id="cb119-1052"><a href="opakování.html#cb119-1052" tabindex="-1"></a>  <span class="co">#     svm.RKHS &lt;- svm(y ~ x, data = df.svm, </span></span>
<span id="cb119-1053"><a href="opakování.html#cb119-1053" tabindex="-1"></a>  <span class="co">#                     kernel = &#39;polynomial&#39;,</span></span>
<span id="cb119-1054"><a href="opakování.html#cb119-1054" tabindex="-1"></a>  <span class="co">#                     type = &#39;eps-regression&#39;,</span></span>
<span id="cb119-1055"><a href="opakování.html#cb119-1055" tabindex="-1"></a>  <span class="co">#                     epsilon = 0.1,</span></span>
<span id="cb119-1056"><a href="opakování.html#cb119-1056" tabindex="-1"></a>  <span class="co">#                     degree = p)</span></span>
<span id="cb119-1057"><a href="opakování.html#cb119-1057" tabindex="-1"></a>  <span class="co">#     alpha.RKHS[svm.RKHS$index, i] &lt;- svm.RKHS$coefs </span></span>
<span id="cb119-1058"><a href="opakování.html#cb119-1058" tabindex="-1"></a>  <span class="co">#   }</span></span>
<span id="cb119-1059"><a href="opakování.html#cb119-1059" tabindex="-1"></a>  <span class="co">#   </span></span>
<span id="cb119-1060"><a href="opakování.html#cb119-1060" tabindex="-1"></a>  <span class="co">#   # projdeme dimenze</span></span>
<span id="cb119-1061"><a href="opakování.html#cb119-1061" tabindex="-1"></a>  <span class="co">#   for(d.RKHS in dimensions) {</span></span>
<span id="cb119-1062"><a href="opakování.html#cb119-1062" tabindex="-1"></a>  <span class="co">#     Lambda.RKHS &lt;- matrix(NA, </span></span>
<span id="cb119-1063"><a href="opakování.html#cb119-1063" tabindex="-1"></a>  <span class="co">#                           ncol = dim(data.RKHS)[2], </span></span>
<span id="cb119-1064"><a href="opakování.html#cb119-1064" tabindex="-1"></a>  <span class="co">#                           nrow = d.RKHS) </span></span>
<span id="cb119-1065"><a href="opakování.html#cb119-1065" tabindex="-1"></a>  <span class="co">#     # vypocet reprezentace</span></span>
<span id="cb119-1066"><a href="opakování.html#cb119-1066" tabindex="-1"></a>  <span class="co">#     for(l in 1:dim(data.RKHS)[2]) {</span></span>
<span id="cb119-1067"><a href="opakování.html#cb119-1067" tabindex="-1"></a>  <span class="co">#       Lambda.RKHS[, l] &lt;- (t(eig.vectors[, 1:d.RKHS]) %*% </span></span>
<span id="cb119-1068"><a href="opakování.html#cb119-1068" tabindex="-1"></a>  <span class="co">#                              alpha.RKHS[, l]) * eig.vals[1:d.RKHS]</span></span>
<span id="cb119-1069"><a href="opakování.html#cb119-1069" tabindex="-1"></a>  <span class="co">#     }</span></span>
<span id="cb119-1070"><a href="opakování.html#cb119-1070" tabindex="-1"></a>  <span class="co">#     # projdeme folds</span></span>
<span id="cb119-1071"><a href="opakování.html#cb119-1071" tabindex="-1"></a>  <span class="co">#     for (index_cv in 1:k_cv) {</span></span>
<span id="cb119-1072"><a href="opakování.html#cb119-1072" tabindex="-1"></a>  <span class="co">#       # definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb119-1073"><a href="opakování.html#cb119-1073" tabindex="-1"></a>  <span class="co">#       fold &lt;- folds[[index_cv]]</span></span>
<span id="cb119-1074"><a href="opakování.html#cb119-1074" tabindex="-1"></a>  <span class="co">#       # rozdeleni na trenovaci a validacni data</span></span>
<span id="cb119-1075"><a href="opakování.html#cb119-1075" tabindex="-1"></a>  <span class="co">#       XX.train &lt;- Lambda.RKHS[, fold]</span></span>
<span id="cb119-1076"><a href="opakování.html#cb119-1076" tabindex="-1"></a>  <span class="co">#       XX.test &lt;- Lambda.RKHS[, !(1:dim(Lambda.RKHS)[2] %in% fold)]</span></span>
<span id="cb119-1077"><a href="opakování.html#cb119-1077" tabindex="-1"></a>  <span class="co">#       # pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb119-1078"><a href="opakování.html#cb119-1078" tabindex="-1"></a>  <span class="co">#       Res &lt;- data.frame(model = c(&#39;SVM linear - RKHS&#39;, </span></span>
<span id="cb119-1079"><a href="opakování.html#cb119-1079" tabindex="-1"></a>  <span class="co">#                                   &#39;SVM poly - RKHS&#39;, </span></span>
<span id="cb119-1080"><a href="opakování.html#cb119-1080" tabindex="-1"></a>  <span class="co">#                                   &#39;SVM rbf - RKHS&#39;), </span></span>
<span id="cb119-1081"><a href="opakování.html#cb119-1081" tabindex="-1"></a>  <span class="co">#                         Err.test = NA)</span></span>
<span id="cb119-1082"><a href="opakování.html#cb119-1082" tabindex="-1"></a>  <span class="co">#       # projdeme jednotliva jadra</span></span>
<span id="cb119-1083"><a href="opakování.html#cb119-1083" tabindex="-1"></a>  <span class="co">#       for (kernel_number in 1:3) {</span></span>
<span id="cb119-1084"><a href="opakování.html#cb119-1084" tabindex="-1"></a>  <span class="co">#         kernel_type &lt;- c(&#39;linear&#39;, &#39;polynomial&#39;, &#39;radial&#39;)[kernel_number]</span></span>
<span id="cb119-1085"><a href="opakování.html#cb119-1085" tabindex="-1"></a>  <span class="co">#       </span></span>
<span id="cb119-1086"><a href="opakování.html#cb119-1086" tabindex="-1"></a>  <span class="co">#         data.RKHS.train &lt;- as.data.frame(t(XX.train))</span></span>
<span id="cb119-1087"><a href="opakování.html#cb119-1087" tabindex="-1"></a>  <span class="co">#         data.RKHS.train$Y &lt;- factor(Y.train[fold])</span></span>
<span id="cb119-1088"><a href="opakování.html#cb119-1088" tabindex="-1"></a>  <span class="co">#         </span></span>
<span id="cb119-1089"><a href="opakování.html#cb119-1089" tabindex="-1"></a>  <span class="co">#         data.RKHS.test &lt;- as.data.frame(t(XX.test))</span></span>
<span id="cb119-1090"><a href="opakování.html#cb119-1090" tabindex="-1"></a>  <span class="co">#         data.RKHS.test$Y &lt;- factor(Y.train[!(1:dim(Lambda.RKHS)[2] %in% fold)])</span></span>
<span id="cb119-1091"><a href="opakování.html#cb119-1091" tabindex="-1"></a>  <span class="co">#         </span></span>
<span id="cb119-1092"><a href="opakování.html#cb119-1092" tabindex="-1"></a>  <span class="co">#         # sestrojeni modelu</span></span>
<span id="cb119-1093"><a href="opakování.html#cb119-1093" tabindex="-1"></a>  <span class="co">#         clf.SVM.RKHS &lt;- svm(Y ~ ., data = data.RKHS.train,</span></span>
<span id="cb119-1094"><a href="opakování.html#cb119-1094" tabindex="-1"></a>  <span class="co">#                             type = &#39;C-classification&#39;,</span></span>
<span id="cb119-1095"><a href="opakování.html#cb119-1095" tabindex="-1"></a>  <span class="co">#                             scale = TRUE,</span></span>
<span id="cb119-1096"><a href="opakování.html#cb119-1096" tabindex="-1"></a>  <span class="co">#                             kernel = kernel_type)</span></span>
<span id="cb119-1097"><a href="opakování.html#cb119-1097" tabindex="-1"></a>  <span class="co">#         </span></span>
<span id="cb119-1098"><a href="opakování.html#cb119-1098" tabindex="-1"></a>  <span class="co">#         # presnost na validacnich datech</span></span>
<span id="cb119-1099"><a href="opakování.html#cb119-1099" tabindex="-1"></a>  <span class="co">#         predictions.test &lt;- predict(clf.SVM.RKHS, newdata = data.RKHS.test)</span></span>
<span id="cb119-1100"><a href="opakování.html#cb119-1100" tabindex="-1"></a>  <span class="co">#         presnost.test &lt;- table(data.RKHS.test$Y, predictions.test) |&gt;</span></span>
<span id="cb119-1101"><a href="opakování.html#cb119-1101" tabindex="-1"></a>  <span class="co">#           prop.table() |&gt; diag() |&gt; sum()</span></span>
<span id="cb119-1102"><a href="opakování.html#cb119-1102" tabindex="-1"></a>  <span class="co">#         </span></span>
<span id="cb119-1103"><a href="opakování.html#cb119-1103" tabindex="-1"></a>  <span class="co">#         # ulozeni vysledku</span></span>
<span id="cb119-1104"><a href="opakování.html#cb119-1104" tabindex="-1"></a>  <span class="co">#         Res[kernel_number, 2] &lt;- 1 - presnost.test</span></span>
<span id="cb119-1105"><a href="opakování.html#cb119-1105" tabindex="-1"></a>  <span class="co">#       }</span></span>
<span id="cb119-1106"><a href="opakování.html#cb119-1106" tabindex="-1"></a>  <span class="co">#       # presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb119-1107"><a href="opakování.html#cb119-1107" tabindex="-1"></a>  <span class="co">#       CV.results$SVM.l[paste0(&#39;p:&#39;, p), </span></span>
<span id="cb119-1108"><a href="opakování.html#cb119-1108" tabindex="-1"></a>  <span class="co">#                        paste0(&#39;d:&#39;, d.RKHS), </span></span>
<span id="cb119-1109"><a href="opakování.html#cb119-1109" tabindex="-1"></a>  <span class="co">#                        index_cv] &lt;- Res[1, 2]</span></span>
<span id="cb119-1110"><a href="opakování.html#cb119-1110" tabindex="-1"></a>  <span class="co">#       CV.results$SVM.p[paste0(&#39;p:&#39;, p), </span></span>
<span id="cb119-1111"><a href="opakování.html#cb119-1111" tabindex="-1"></a>  <span class="co">#                        paste0(&#39;d:&#39;, d.RKHS), </span></span>
<span id="cb119-1112"><a href="opakování.html#cb119-1112" tabindex="-1"></a>  <span class="co">#                        index_cv] &lt;- Res[2, 2]</span></span>
<span id="cb119-1113"><a href="opakování.html#cb119-1113" tabindex="-1"></a>  <span class="co">#       CV.results$SVM.r[paste0(&#39;p:&#39;, p), </span></span>
<span id="cb119-1114"><a href="opakování.html#cb119-1114" tabindex="-1"></a>  <span class="co">#                        paste0(&#39;d:&#39;, d.RKHS), </span></span>
<span id="cb119-1115"><a href="opakování.html#cb119-1115" tabindex="-1"></a>  <span class="co">#                        index_cv] &lt;- Res[3, 2]</span></span>
<span id="cb119-1116"><a href="opakování.html#cb119-1116" tabindex="-1"></a>  <span class="co">#     }</span></span>
<span id="cb119-1117"><a href="opakování.html#cb119-1117" tabindex="-1"></a>  <span class="co">#   }</span></span>
<span id="cb119-1118"><a href="opakování.html#cb119-1118" tabindex="-1"></a>  <span class="co"># }</span></span>
<span id="cb119-1119"><a href="opakování.html#cb119-1119" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb119-1120"><a href="opakování.html#cb119-1120" tabindex="-1"></a>  <span class="co"># # spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb119-1121"><a href="opakování.html#cb119-1121" tabindex="-1"></a>  <span class="co"># for (n_method in 1:length(CV.results)) {</span></span>
<span id="cb119-1122"><a href="opakování.html#cb119-1122" tabindex="-1"></a>  <span class="co">#   CV.results[[n_method]] &lt;- apply(CV.results[[n_method]], c(1, 2), mean)</span></span>
<span id="cb119-1123"><a href="opakování.html#cb119-1123" tabindex="-1"></a>  <span class="co"># }</span></span>
<span id="cb119-1124"><a href="opakování.html#cb119-1124" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb119-1125"><a href="opakování.html#cb119-1125" tabindex="-1"></a>  <span class="co"># poly.opt &lt;- c(which.min(CV.results$SVM.l) %% length(poly.cv), </span></span>
<span id="cb119-1126"><a href="opakování.html#cb119-1126" tabindex="-1"></a>  <span class="co">#                which.min(CV.results$SVM.p) %% length(poly.cv), </span></span>
<span id="cb119-1127"><a href="opakování.html#cb119-1127" tabindex="-1"></a>  <span class="co">#                which.min(CV.results$SVM.r) %% length(poly.cv))</span></span>
<span id="cb119-1128"><a href="opakování.html#cb119-1128" tabindex="-1"></a>  <span class="co"># poly.opt[poly.opt == 0] &lt;- length(poly.cv)</span></span>
<span id="cb119-1129"><a href="opakování.html#cb119-1129" tabindex="-1"></a>  <span class="co"># poly.opt &lt;- poly.cv[poly.opt]</span></span>
<span id="cb119-1130"><a href="opakování.html#cb119-1130" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb119-1131"><a href="opakování.html#cb119-1131" tabindex="-1"></a>  <span class="co"># d.opt &lt;- c(which.min(t(CV.results$SVM.l)) %% length(dimensions), </span></span>
<span id="cb119-1132"><a href="opakování.html#cb119-1132" tabindex="-1"></a>  <span class="co">#            which.min(t(CV.results$SVM.p)) %% length(dimensions), </span></span>
<span id="cb119-1133"><a href="opakování.html#cb119-1133" tabindex="-1"></a>  <span class="co">#            which.min(t(CV.results$SVM.r)) %% length(dimensions))</span></span>
<span id="cb119-1134"><a href="opakování.html#cb119-1134" tabindex="-1"></a>  <span class="co"># d.opt[d.opt == 0] &lt;- length(dimensions)</span></span>
<span id="cb119-1135"><a href="opakování.html#cb119-1135" tabindex="-1"></a>  <span class="co"># d.opt &lt;- dimensions[d.opt]</span></span>
<span id="cb119-1136"><a href="opakování.html#cb119-1136" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb119-1137"><a href="opakování.html#cb119-1137" tabindex="-1"></a>  <span class="co"># err.opt.cv &lt;- c(min(CV.results$SVM.l, na.rm = TRUE), </span></span>
<span id="cb119-1138"><a href="opakování.html#cb119-1138" tabindex="-1"></a>  <span class="co">#                      min(CV.results$SVM.p, na.rm = TRUE),</span></span>
<span id="cb119-1139"><a href="opakování.html#cb119-1139" tabindex="-1"></a>  <span class="co">#                      min(CV.results$SVM.r, na.rm = TRUE))</span></span>
<span id="cb119-1140"><a href="opakování.html#cb119-1140" tabindex="-1"></a>  <span class="co"># df.RKHS.res &lt;- data.frame(d = d.opt, p = poly.opt, CV = err.opt.cv,</span></span>
<span id="cb119-1141"><a href="opakování.html#cb119-1141" tabindex="-1"></a>  <span class="co">#            Kernel = c(&#39;linear&#39;, &#39;polynomial&#39;, &#39;radial&#39;) |&gt; factor(),</span></span>
<span id="cb119-1142"><a href="opakování.html#cb119-1142" tabindex="-1"></a>  <span class="co">#            row.names = c(&#39;linear&#39;, &#39;poly&#39;, &#39;radial&#39;))</span></span>
<span id="cb119-1143"><a href="opakování.html#cb119-1143" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb119-1144"><a href="opakování.html#cb119-1144" tabindex="-1"></a>  <span class="co"># # odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb119-1145"><a href="opakování.html#cb119-1145" tabindex="-1"></a>  <span class="co"># data.RKHS &lt;- grid.data[, -dim(grid.data)[2]] |&gt; t()</span></span>
<span id="cb119-1146"><a href="opakování.html#cb119-1146" tabindex="-1"></a>  <span class="co"># # pridame i testovaci data</span></span>
<span id="cb119-1147"><a href="opakování.html#cb119-1147" tabindex="-1"></a>  <span class="co"># data.RKHS &lt;- cbind(data.RKHS, grid.data.test[, -dim(grid.data.test)[2]] |&gt; t())</span></span>
<span id="cb119-1148"><a href="opakování.html#cb119-1148" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb119-1149"><a href="opakování.html#cb119-1149" tabindex="-1"></a>  <span class="co"># # pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb119-1150"><a href="opakování.html#cb119-1150" tabindex="-1"></a>  <span class="co"># Res &lt;- data.frame(model = c(&#39;SVM linear - RKHS - poly&#39;, </span></span>
<span id="cb119-1151"><a href="opakování.html#cb119-1151" tabindex="-1"></a>  <span class="co">#                             &#39;SVM poly - RKHS - poly&#39;, </span></span>
<span id="cb119-1152"><a href="opakování.html#cb119-1152" tabindex="-1"></a>  <span class="co">#                             &#39;SVM rbf - RKHS - poly&#39;), </span></span>
<span id="cb119-1153"><a href="opakování.html#cb119-1153" tabindex="-1"></a>  <span class="co">#                   Err.train = NA,</span></span>
<span id="cb119-1154"><a href="opakování.html#cb119-1154" tabindex="-1"></a>  <span class="co">#                   Err.test = NA)</span></span>
<span id="cb119-1155"><a href="opakování.html#cb119-1155" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb119-1156"><a href="opakování.html#cb119-1156" tabindex="-1"></a>  <span class="co"># # projdeme jednotliva jadra</span></span>
<span id="cb119-1157"><a href="opakování.html#cb119-1157" tabindex="-1"></a>  <span class="co"># for (kernel_number in 1:3) {</span></span>
<span id="cb119-1158"><a href="opakování.html#cb119-1158" tabindex="-1"></a>  <span class="co">#   # spocitame matici K</span></span>
<span id="cb119-1159"><a href="opakování.html#cb119-1159" tabindex="-1"></a>  <span class="co">#   p &lt;- poly.opt[kernel_number] # hodnota gamma pomoci CV</span></span>
<span id="cb119-1160"><a href="opakování.html#cb119-1160" tabindex="-1"></a>  <span class="co">#   K &lt;- Kernel.RKHS(t.seq, p = p)</span></span>
<span id="cb119-1161"><a href="opakování.html#cb119-1161" tabindex="-1"></a>  <span class="co">#   </span></span>
<span id="cb119-1162"><a href="opakování.html#cb119-1162" tabindex="-1"></a>  <span class="co">#   # urcime vlastni cisla a vektory</span></span>
<span id="cb119-1163"><a href="opakování.html#cb119-1163" tabindex="-1"></a>  <span class="co">#   Eig &lt;- eigen(K)</span></span>
<span id="cb119-1164"><a href="opakování.html#cb119-1164" tabindex="-1"></a>  <span class="co">#   eig.vals &lt;- Eig$values</span></span>
<span id="cb119-1165"><a href="opakování.html#cb119-1165" tabindex="-1"></a>  <span class="co">#   eig.vectors &lt;- Eig$vectors</span></span>
<span id="cb119-1166"><a href="opakování.html#cb119-1166" tabindex="-1"></a>  <span class="co">#   # urceni koeficientu alpha z SVM</span></span>
<span id="cb119-1167"><a href="opakování.html#cb119-1167" tabindex="-1"></a>  <span class="co">#   alpha.RKHS &lt;- matrix(0, nrow = dim(data.RKHS)[1],</span></span>
<span id="cb119-1168"><a href="opakování.html#cb119-1168" tabindex="-1"></a>  <span class="co">#                        ncol = dim(data.RKHS)[2]) # prazdny objekt</span></span>
<span id="cb119-1169"><a href="opakování.html#cb119-1169" tabindex="-1"></a>  <span class="co">#   </span></span>
<span id="cb119-1170"><a href="opakování.html#cb119-1170" tabindex="-1"></a>  <span class="co">#   # model</span></span>
<span id="cb119-1171"><a href="opakování.html#cb119-1171" tabindex="-1"></a>  <span class="co">#   for(i in 1:dim(data.RKHS)[2]) {</span></span>
<span id="cb119-1172"><a href="opakování.html#cb119-1172" tabindex="-1"></a>  <span class="co">#     df.svm &lt;- data.frame(x = t.seq,</span></span>
<span id="cb119-1173"><a href="opakování.html#cb119-1173" tabindex="-1"></a>  <span class="co">#                          y = data.RKHS[, i])</span></span>
<span id="cb119-1174"><a href="opakování.html#cb119-1174" tabindex="-1"></a>  <span class="co">#     svm.RKHS &lt;- svm(y ~ x, data = df.svm, </span></span>
<span id="cb119-1175"><a href="opakování.html#cb119-1175" tabindex="-1"></a>  <span class="co">#                     kernel = &#39;polynomial&#39;,</span></span>
<span id="cb119-1176"><a href="opakování.html#cb119-1176" tabindex="-1"></a>  <span class="co">#                     type = &#39;eps-regression&#39;,</span></span>
<span id="cb119-1177"><a href="opakování.html#cb119-1177" tabindex="-1"></a>  <span class="co">#                     epsilon = 0.1,</span></span>
<span id="cb119-1178"><a href="opakování.html#cb119-1178" tabindex="-1"></a>  <span class="co">#                     degree = p)</span></span>
<span id="cb119-1179"><a href="opakování.html#cb119-1179" tabindex="-1"></a>  <span class="co">#     # urceni alpha</span></span>
<span id="cb119-1180"><a href="opakování.html#cb119-1180" tabindex="-1"></a>  <span class="co">#     alpha.RKHS[svm.RKHS$index, i] &lt;- svm.RKHS$coefs # nahrazeni nul koeficienty</span></span>
<span id="cb119-1181"><a href="opakování.html#cb119-1181" tabindex="-1"></a>  <span class="co">#   }</span></span>
<span id="cb119-1182"><a href="opakování.html#cb119-1182" tabindex="-1"></a>  <span class="co">#   # d</span></span>
<span id="cb119-1183"><a href="opakování.html#cb119-1183" tabindex="-1"></a>  <span class="co">#   d.RKHS &lt;- d.opt[kernel_number]</span></span>
<span id="cb119-1184"><a href="opakování.html#cb119-1184" tabindex="-1"></a>  <span class="co">#   </span></span>
<span id="cb119-1185"><a href="opakování.html#cb119-1185" tabindex="-1"></a>  <span class="co">#   # urceni vektoru lambda</span></span>
<span id="cb119-1186"><a href="opakování.html#cb119-1186" tabindex="-1"></a>  <span class="co">#   Lambda.RKHS &lt;- matrix(NA, </span></span>
<span id="cb119-1187"><a href="opakování.html#cb119-1187" tabindex="-1"></a>  <span class="co">#                         ncol = dim(data.RKHS)[2], </span></span>
<span id="cb119-1188"><a href="opakování.html#cb119-1188" tabindex="-1"></a>  <span class="co">#                         nrow = d.RKHS) # vytvoreni prazdneho objektu</span></span>
<span id="cb119-1189"><a href="opakování.html#cb119-1189" tabindex="-1"></a>  <span class="co">#   </span></span>
<span id="cb119-1190"><a href="opakování.html#cb119-1190" tabindex="-1"></a>  <span class="co">#   # vypocet reprezentace</span></span>
<span id="cb119-1191"><a href="opakování.html#cb119-1191" tabindex="-1"></a>  <span class="co">#   for(l in 1:dim(data.RKHS)[2]) {</span></span>
<span id="cb119-1192"><a href="opakování.html#cb119-1192" tabindex="-1"></a>  <span class="co">#     Lambda.RKHS[, l] &lt;- (t(eig.vectors[, 1:d.RKHS]) %*% alpha.RKHS[, l]) * eig.vals[1:d.RKHS]</span></span>
<span id="cb119-1193"><a href="opakování.html#cb119-1193" tabindex="-1"></a>  <span class="co">#   }</span></span>
<span id="cb119-1194"><a href="opakování.html#cb119-1194" tabindex="-1"></a>  <span class="co">#   </span></span>
<span id="cb119-1195"><a href="opakování.html#cb119-1195" tabindex="-1"></a>  <span class="co">#   # rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb119-1196"><a href="opakování.html#cb119-1196" tabindex="-1"></a>  <span class="co">#   XX.train &lt;- Lambda.RKHS[, 1:dim(grid.data)[1]]</span></span>
<span id="cb119-1197"><a href="opakování.html#cb119-1197" tabindex="-1"></a>  <span class="co">#   XX.test &lt;- Lambda.RKHS[, (dim(grid.data)[1] + 1):dim(Lambda.RKHS)[2]]</span></span>
<span id="cb119-1198"><a href="opakování.html#cb119-1198" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb119-1199"><a href="opakování.html#cb119-1199" tabindex="-1"></a>  <span class="co">#   kernel_type &lt;- c(&#39;linear&#39;, &#39;polynomial&#39;, &#39;radial&#39;)[kernel_number]</span></span>
<span id="cb119-1200"><a href="opakování.html#cb119-1200" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb119-1201"><a href="opakování.html#cb119-1201" tabindex="-1"></a>  <span class="co">#   data.RKHS.train &lt;- as.data.frame(t(XX.train))</span></span>
<span id="cb119-1202"><a href="opakování.html#cb119-1202" tabindex="-1"></a>  <span class="co">#   data.RKHS.train$Y &lt;- factor(Y.train)</span></span>
<span id="cb119-1203"><a href="opakování.html#cb119-1203" tabindex="-1"></a>  <span class="co">#   </span></span>
<span id="cb119-1204"><a href="opakování.html#cb119-1204" tabindex="-1"></a>  <span class="co">#   data.RKHS.test &lt;- as.data.frame(t(XX.test))</span></span>
<span id="cb119-1205"><a href="opakování.html#cb119-1205" tabindex="-1"></a>  <span class="co">#   data.RKHS.test$Y &lt;- factor(Y.test)</span></span>
<span id="cb119-1206"><a href="opakování.html#cb119-1206" tabindex="-1"></a>  <span class="co">#   </span></span>
<span id="cb119-1207"><a href="opakování.html#cb119-1207" tabindex="-1"></a>  <span class="co">#   # sestrojeni modelu</span></span>
<span id="cb119-1208"><a href="opakování.html#cb119-1208" tabindex="-1"></a>  <span class="co">#   clf.SVM.RKHS &lt;- svm(Y ~ ., data = data.RKHS.train,</span></span>
<span id="cb119-1209"><a href="opakování.html#cb119-1209" tabindex="-1"></a>  <span class="co">#                       type = &#39;C-classification&#39;,</span></span>
<span id="cb119-1210"><a href="opakování.html#cb119-1210" tabindex="-1"></a>  <span class="co">#                       scale = TRUE,</span></span>
<span id="cb119-1211"><a href="opakování.html#cb119-1211" tabindex="-1"></a>  <span class="co">#                       kernel = kernel_type)</span></span>
<span id="cb119-1212"><a href="opakování.html#cb119-1212" tabindex="-1"></a>  <span class="co">#   </span></span>
<span id="cb119-1213"><a href="opakování.html#cb119-1213" tabindex="-1"></a>  <span class="co">#   # presnost na trenovacich datech</span></span>
<span id="cb119-1214"><a href="opakování.html#cb119-1214" tabindex="-1"></a>  <span class="co">#   predictions.train &lt;- predict(clf.SVM.RKHS, newdata = data.RKHS.train)</span></span>
<span id="cb119-1215"><a href="opakování.html#cb119-1215" tabindex="-1"></a>  <span class="co">#   presnost.train &lt;- table(Y.train, predictions.train) |&gt;</span></span>
<span id="cb119-1216"><a href="opakování.html#cb119-1216" tabindex="-1"></a>  <span class="co">#     prop.table() |&gt; diag() |&gt; sum()</span></span>
<span id="cb119-1217"><a href="opakování.html#cb119-1217" tabindex="-1"></a>  <span class="co">#     </span></span>
<span id="cb119-1218"><a href="opakování.html#cb119-1218" tabindex="-1"></a>  <span class="co">#   # presnost na testovacich datech</span></span>
<span id="cb119-1219"><a href="opakování.html#cb119-1219" tabindex="-1"></a>  <span class="co">#   predictions.test &lt;- predict(clf.SVM.RKHS, newdata = data.RKHS.test)</span></span>
<span id="cb119-1220"><a href="opakování.html#cb119-1220" tabindex="-1"></a>  <span class="co">#   presnost.test &lt;- table(Y.test, predictions.test) |&gt;</span></span>
<span id="cb119-1221"><a href="opakování.html#cb119-1221" tabindex="-1"></a>  <span class="co">#     prop.table() |&gt; diag() |&gt; sum()</span></span>
<span id="cb119-1222"><a href="opakování.html#cb119-1222" tabindex="-1"></a>  <span class="co">#   </span></span>
<span id="cb119-1223"><a href="opakování.html#cb119-1223" tabindex="-1"></a>  <span class="co">#   # ulozeni vysledku</span></span>
<span id="cb119-1224"><a href="opakování.html#cb119-1224" tabindex="-1"></a>  <span class="co">#   Res[kernel_number, c(2, 3)] &lt;- 1 - c(presnost.train, presnost.test)</span></span>
<span id="cb119-1225"><a href="opakování.html#cb119-1225" tabindex="-1"></a>  <span class="co"># }</span></span>
<span id="cb119-1226"><a href="opakování.html#cb119-1226" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb119-1227"><a href="opakování.html#cb119-1227" tabindex="-1"></a>  <span class="co"># RESULTS &lt;- rbind(RESULTS, Res)</span></span>
<span id="cb119-1228"><a href="opakování.html#cb119-1228" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb119-1229"><a href="opakování.html#cb119-1229" tabindex="-1"></a>  <span class="do">### Linearni jadro</span></span>
<span id="cb119-1230"><a href="opakování.html#cb119-1230" tabindex="-1"></a>  </span>
<span id="cb119-1231"><a href="opakování.html#cb119-1231" tabindex="-1"></a>  <span class="co"># jadro a jadrova matice ... polynomialni s parametrem p</span></span>
<span id="cb119-1232"><a href="opakování.html#cb119-1232" tabindex="-1"></a>  Linear.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb119-1233"><a href="opakování.html#cb119-1233" tabindex="-1"></a>    <span class="fu">return</span>(x <span class="sc">*</span> y)</span>
<span id="cb119-1234"><a href="opakování.html#cb119-1234" tabindex="-1"></a>  }</span>
<span id="cb119-1235"><a href="opakování.html#cb119-1235" tabindex="-1"></a>  </span>
<span id="cb119-1236"><a href="opakování.html#cb119-1236" tabindex="-1"></a>  Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb119-1237"><a href="opakování.html#cb119-1237" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb119-1238"><a href="opakování.html#cb119-1238" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb119-1239"><a href="opakování.html#cb119-1239" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb119-1240"><a href="opakování.html#cb119-1240" tabindex="-1"></a>        K[i, j] <span class="ot">&lt;-</span> <span class="fu">Linear.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j])</span>
<span id="cb119-1241"><a href="opakování.html#cb119-1241" tabindex="-1"></a>      }</span>
<span id="cb119-1242"><a href="opakování.html#cb119-1242" tabindex="-1"></a>    }</span>
<span id="cb119-1243"><a href="opakování.html#cb119-1243" tabindex="-1"></a>    <span class="fu">return</span>(K)</span>
<span id="cb119-1244"><a href="opakování.html#cb119-1244" tabindex="-1"></a>  }</span>
<span id="cb119-1245"><a href="opakování.html#cb119-1245" tabindex="-1"></a>  </span>
<span id="cb119-1246"><a href="opakování.html#cb119-1246" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb119-1247"><a href="opakování.html#cb119-1247" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb119-1248"><a href="opakování.html#cb119-1248" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb119-1249"><a href="opakování.html#cb119-1249" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb119-1250"><a href="opakování.html#cb119-1250" tabindex="-1"></a>  </span>
<span id="cb119-1251"><a href="opakování.html#cb119-1251" tabindex="-1"></a>  <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb119-1252"><a href="opakování.html#cb119-1252" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">20</span>, <span class="at">by =</span> <span class="dv">2</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb119-1253"><a href="opakování.html#cb119-1253" tabindex="-1"></a>  </span>
<span id="cb119-1254"><a href="opakování.html#cb119-1254" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb119-1255"><a href="opakování.html#cb119-1255" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb119-1256"><a href="opakování.html#cb119-1256" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane d</span></span>
<span id="cb119-1257"><a href="opakování.html#cb119-1257" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro vrstvy odpovidaji folds</span></span>
<span id="cb119-1258"><a href="opakování.html#cb119-1258" tabindex="-1"></a>  dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb119-1259"><a href="opakování.html#cb119-1259" tabindex="-1"></a>                    <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb119-1260"><a href="opakování.html#cb119-1260" tabindex="-1"></a>  </span>
<span id="cb119-1261"><a href="opakování.html#cb119-1261" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb119-1262"><a href="opakování.html#cb119-1262" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb119-1263"><a href="opakování.html#cb119-1263" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb119-1264"><a href="opakování.html#cb119-1264" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb119-1265"><a href="opakování.html#cb119-1265" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb119-1266"><a href="opakování.html#cb119-1266" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb119-1267"><a href="opakování.html#cb119-1267" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names))</span>
<span id="cb119-1268"><a href="opakování.html#cb119-1268" tabindex="-1"></a>  </span>
<span id="cb119-1269"><a href="opakování.html#cb119-1269" tabindex="-1"></a>  <span class="co"># samotna CV</span></span>
<span id="cb119-1270"><a href="opakování.html#cb119-1270" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb119-1271"><a href="opakování.html#cb119-1271" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb119-1272"><a href="opakování.html#cb119-1272" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb119-1273"><a href="opakování.html#cb119-1273" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb119-1274"><a href="opakování.html#cb119-1274" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb119-1275"><a href="opakování.html#cb119-1275" tabindex="-1"></a>  </span>
<span id="cb119-1276"><a href="opakování.html#cb119-1276" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb119-1277"><a href="opakování.html#cb119-1277" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb119-1278"><a href="opakování.html#cb119-1278" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb119-1279"><a href="opakování.html#cb119-1279" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb119-1280"><a href="opakování.html#cb119-1280" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb119-1281"><a href="opakování.html#cb119-1281" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb119-1282"><a href="opakování.html#cb119-1282" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb119-1283"><a href="opakování.html#cb119-1283" tabindex="-1"></a>                    <span class="at">epsilon =</span> <span class="fl">0.1</span>)</span>
<span id="cb119-1284"><a href="opakování.html#cb119-1284" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb119-1285"><a href="opakování.html#cb119-1285" tabindex="-1"></a>  }</span>
<span id="cb119-1286"><a href="opakování.html#cb119-1286" tabindex="-1"></a>  </span>
<span id="cb119-1287"><a href="opakování.html#cb119-1287" tabindex="-1"></a>  <span class="co"># projdeme dimenze</span></span>
<span id="cb119-1288"><a href="opakování.html#cb119-1288" tabindex="-1"></a>  <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb119-1289"><a href="opakování.html#cb119-1289" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb119-1290"><a href="opakování.html#cb119-1290" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb119-1291"><a href="opakování.html#cb119-1291" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb119-1292"><a href="opakování.html#cb119-1292" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb119-1293"><a href="opakování.html#cb119-1293" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb119-1294"><a href="opakování.html#cb119-1294" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb119-1295"><a href="opakování.html#cb119-1295" tabindex="-1"></a>                             alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb119-1296"><a href="opakování.html#cb119-1296" tabindex="-1"></a>    }</span>
<span id="cb119-1297"><a href="opakování.html#cb119-1297" tabindex="-1"></a>    <span class="co"># projdeme folds</span></span>
<span id="cb119-1298"><a href="opakování.html#cb119-1298" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb119-1299"><a href="opakování.html#cb119-1299" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb119-1300"><a href="opakování.html#cb119-1300" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb119-1301"><a href="opakování.html#cb119-1301" tabindex="-1"></a>      <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb119-1302"><a href="opakování.html#cb119-1302" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb119-1303"><a href="opakování.html#cb119-1303" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb119-1304"><a href="opakování.html#cb119-1304" tabindex="-1"></a>      <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb119-1305"><a href="opakování.html#cb119-1305" tabindex="-1"></a>      Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb119-1306"><a href="opakování.html#cb119-1306" tabindex="-1"></a>                                  <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb119-1307"><a href="opakování.html#cb119-1307" tabindex="-1"></a>                                  <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb119-1308"><a href="opakování.html#cb119-1308" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb119-1309"><a href="opakování.html#cb119-1309" tabindex="-1"></a>      <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb119-1310"><a href="opakování.html#cb119-1310" tabindex="-1"></a>      <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb119-1311"><a href="opakování.html#cb119-1311" tabindex="-1"></a>        kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb119-1312"><a href="opakování.html#cb119-1312" tabindex="-1"></a>      </span>
<span id="cb119-1313"><a href="opakování.html#cb119-1313" tabindex="-1"></a>        data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb119-1314"><a href="opakování.html#cb119-1314" tabindex="-1"></a>        data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb119-1315"><a href="opakování.html#cb119-1315" tabindex="-1"></a>        </span>
<span id="cb119-1316"><a href="opakování.html#cb119-1316" tabindex="-1"></a>        data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb119-1317"><a href="opakování.html#cb119-1317" tabindex="-1"></a>        data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb119-1318"><a href="opakování.html#cb119-1318" tabindex="-1"></a>        </span>
<span id="cb119-1319"><a href="opakování.html#cb119-1319" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb119-1320"><a href="opakování.html#cb119-1320" tabindex="-1"></a>        clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb119-1321"><a href="opakování.html#cb119-1321" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb119-1322"><a href="opakování.html#cb119-1322" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb119-1323"><a href="opakování.html#cb119-1323" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb119-1324"><a href="opakování.html#cb119-1324" tabindex="-1"></a>        </span>
<span id="cb119-1325"><a href="opakování.html#cb119-1325" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb119-1326"><a href="opakování.html#cb119-1326" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb119-1327"><a href="opakování.html#cb119-1327" tabindex="-1"></a>        presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb119-1328"><a href="opakování.html#cb119-1328" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-1329"><a href="opakování.html#cb119-1329" tabindex="-1"></a>        </span>
<span id="cb119-1330"><a href="opakování.html#cb119-1330" tabindex="-1"></a>        <span class="co"># ulozeni vysledku</span></span>
<span id="cb119-1331"><a href="opakování.html#cb119-1331" tabindex="-1"></a>        Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb119-1332"><a href="opakování.html#cb119-1332" tabindex="-1"></a>      }</span>
<span id="cb119-1333"><a href="opakování.html#cb119-1333" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb119-1334"><a href="opakování.html#cb119-1334" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb119-1335"><a href="opakování.html#cb119-1335" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb119-1336"><a href="opakování.html#cb119-1336" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb119-1337"><a href="opakování.html#cb119-1337" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb119-1338"><a href="opakování.html#cb119-1338" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb119-1339"><a href="opakování.html#cb119-1339" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb119-1340"><a href="opakování.html#cb119-1340" tabindex="-1"></a>    }</span>
<span id="cb119-1341"><a href="opakování.html#cb119-1341" tabindex="-1"></a>  }</span>
<span id="cb119-1342"><a href="opakování.html#cb119-1342" tabindex="-1"></a>  </span>
<span id="cb119-1343"><a href="opakování.html#cb119-1343" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb119-1344"><a href="opakování.html#cb119-1344" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb119-1345"><a href="opakování.html#cb119-1345" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean,</span>
<span id="cb119-1346"><a href="opakování.html#cb119-1346" tabindex="-1"></a>                                    <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb119-1347"><a href="opakování.html#cb119-1347" tabindex="-1"></a>  }</span>
<span id="cb119-1348"><a href="opakování.html#cb119-1348" tabindex="-1"></a>  </span>
<span id="cb119-1349"><a href="opakování.html#cb119-1349" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb119-1350"><a href="opakování.html#cb119-1350" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb119-1351"><a href="opakování.html#cb119-1351" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb119-1352"><a href="opakování.html#cb119-1352" tabindex="-1"></a>  d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb119-1353"><a href="opakování.html#cb119-1353" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb119-1354"><a href="opakování.html#cb119-1354" tabindex="-1"></a>  </span>
<span id="cb119-1355"><a href="opakování.html#cb119-1355" tabindex="-1"></a>  err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb119-1356"><a href="opakování.html#cb119-1356" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb119-1357"><a href="opakování.html#cb119-1357" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb119-1358"><a href="opakování.html#cb119-1358" tabindex="-1"></a>  df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb119-1359"><a href="opakování.html#cb119-1359" tabindex="-1"></a>             <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb119-1360"><a href="opakování.html#cb119-1360" tabindex="-1"></a>             <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb119-1361"><a href="opakování.html#cb119-1361" tabindex="-1"></a>  </span>
<span id="cb119-1362"><a href="opakování.html#cb119-1362" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb119-1363"><a href="opakování.html#cb119-1363" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb119-1364"><a href="opakování.html#cb119-1364" tabindex="-1"></a>  <span class="co"># pridame i testovaci data</span></span>
<span id="cb119-1365"><a href="opakování.html#cb119-1365" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb119-1366"><a href="opakování.html#cb119-1366" tabindex="-1"></a>  </span>
<span id="cb119-1367"><a href="opakování.html#cb119-1367" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb119-1368"><a href="opakování.html#cb119-1368" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - linear&#39;</span>, </span>
<span id="cb119-1369"><a href="opakování.html#cb119-1369" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - RKHS - linear&#39;</span>, </span>
<span id="cb119-1370"><a href="opakování.html#cb119-1370" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - RKHS - linear&#39;</span>), </span>
<span id="cb119-1371"><a href="opakování.html#cb119-1371" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb119-1372"><a href="opakování.html#cb119-1372" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb119-1373"><a href="opakování.html#cb119-1373" tabindex="-1"></a>  </span>
<span id="cb119-1374"><a href="opakování.html#cb119-1374" tabindex="-1"></a>  <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb119-1375"><a href="opakování.html#cb119-1375" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb119-1376"><a href="opakování.html#cb119-1376" tabindex="-1"></a>    <span class="co"># spocitame matici K</span></span>
<span id="cb119-1377"><a href="opakování.html#cb119-1377" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb119-1378"><a href="opakování.html#cb119-1378" tabindex="-1"></a>    </span>
<span id="cb119-1379"><a href="opakování.html#cb119-1379" tabindex="-1"></a>    <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb119-1380"><a href="opakování.html#cb119-1380" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb119-1381"><a href="opakování.html#cb119-1381" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb119-1382"><a href="opakování.html#cb119-1382" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb119-1383"><a href="opakování.html#cb119-1383" tabindex="-1"></a>    <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb119-1384"><a href="opakování.html#cb119-1384" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb119-1385"><a href="opakování.html#cb119-1385" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb119-1386"><a href="opakování.html#cb119-1386" tabindex="-1"></a>    </span>
<span id="cb119-1387"><a href="opakování.html#cb119-1387" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb119-1388"><a href="opakování.html#cb119-1388" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb119-1389"><a href="opakování.html#cb119-1389" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb119-1390"><a href="opakování.html#cb119-1390" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb119-1391"><a href="opakování.html#cb119-1391" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb119-1392"><a href="opakování.html#cb119-1392" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb119-1393"><a href="opakování.html#cb119-1393" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb119-1394"><a href="opakování.html#cb119-1394" tabindex="-1"></a>                      <span class="at">epsilon =</span> <span class="fl">0.1</span>)</span>
<span id="cb119-1395"><a href="opakování.html#cb119-1395" tabindex="-1"></a>      <span class="co"># urceni alpha</span></span>
<span id="cb119-1396"><a href="opakování.html#cb119-1396" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb119-1397"><a href="opakování.html#cb119-1397" tabindex="-1"></a>    }</span>
<span id="cb119-1398"><a href="opakování.html#cb119-1398" tabindex="-1"></a>    <span class="co"># d</span></span>
<span id="cb119-1399"><a href="opakování.html#cb119-1399" tabindex="-1"></a>    d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb119-1400"><a href="opakování.html#cb119-1400" tabindex="-1"></a>    </span>
<span id="cb119-1401"><a href="opakování.html#cb119-1401" tabindex="-1"></a>    <span class="co"># urceni vektoru lambda</span></span>
<span id="cb119-1402"><a href="opakování.html#cb119-1402" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb119-1403"><a href="opakování.html#cb119-1403" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb119-1404"><a href="opakování.html#cb119-1404" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb119-1405"><a href="opakování.html#cb119-1405" tabindex="-1"></a>    </span>
<span id="cb119-1406"><a href="opakování.html#cb119-1406" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb119-1407"><a href="opakování.html#cb119-1407" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb119-1408"><a href="opakování.html#cb119-1408" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb119-1409"><a href="opakování.html#cb119-1409" tabindex="-1"></a>    }</span>
<span id="cb119-1410"><a href="opakování.html#cb119-1410" tabindex="-1"></a>    </span>
<span id="cb119-1411"><a href="opakování.html#cb119-1411" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb119-1412"><a href="opakování.html#cb119-1412" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb119-1413"><a href="opakování.html#cb119-1413" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb119-1414"><a href="opakování.html#cb119-1414" tabindex="-1"></a>  </span>
<span id="cb119-1415"><a href="opakování.html#cb119-1415" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb119-1416"><a href="opakování.html#cb119-1416" tabindex="-1"></a>  </span>
<span id="cb119-1417"><a href="opakování.html#cb119-1417" tabindex="-1"></a>    data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb119-1418"><a href="opakování.html#cb119-1418" tabindex="-1"></a>    data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb119-1419"><a href="opakování.html#cb119-1419" tabindex="-1"></a>    </span>
<span id="cb119-1420"><a href="opakování.html#cb119-1420" tabindex="-1"></a>    data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb119-1421"><a href="opakování.html#cb119-1421" tabindex="-1"></a>    data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb119-1422"><a href="opakování.html#cb119-1422" tabindex="-1"></a>    </span>
<span id="cb119-1423"><a href="opakování.html#cb119-1423" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb119-1424"><a href="opakování.html#cb119-1424" tabindex="-1"></a>    clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb119-1425"><a href="opakování.html#cb119-1425" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb119-1426"><a href="opakování.html#cb119-1426" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb119-1427"><a href="opakování.html#cb119-1427" tabindex="-1"></a>                        <span class="at">kernel =</span> kernel_type)</span>
<span id="cb119-1428"><a href="opakování.html#cb119-1428" tabindex="-1"></a>    </span>
<span id="cb119-1429"><a href="opakování.html#cb119-1429" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb119-1430"><a href="opakování.html#cb119-1430" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb119-1431"><a href="opakování.html#cb119-1431" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb119-1432"><a href="opakování.html#cb119-1432" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-1433"><a href="opakování.html#cb119-1433" tabindex="-1"></a>      </span>
<span id="cb119-1434"><a href="opakování.html#cb119-1434" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb119-1435"><a href="opakování.html#cb119-1435" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb119-1436"><a href="opakování.html#cb119-1436" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb119-1437"><a href="opakování.html#cb119-1437" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb119-1438"><a href="opakování.html#cb119-1438" tabindex="-1"></a>    </span>
<span id="cb119-1439"><a href="opakování.html#cb119-1439" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb119-1440"><a href="opakování.html#cb119-1440" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb119-1441"><a href="opakování.html#cb119-1441" tabindex="-1"></a>  }</span>
<span id="cb119-1442"><a href="opakování.html#cb119-1442" tabindex="-1"></a>  </span>
<span id="cb119-1443"><a href="opakování.html#cb119-1443" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb119-1444"><a href="opakování.html#cb119-1444" tabindex="-1"></a>  </span>
<span id="cb119-1445"><a href="opakování.html#cb119-1445" tabindex="-1"></a>  <span class="do">## pridame vysledky do objektu SIMULACE</span></span>
<span id="cb119-1446"><a href="opakování.html#cb119-1446" tabindex="-1"></a>  </span>
<span id="cb119-1447"><a href="opakování.html#cb119-1447" tabindex="-1"></a>  SIMULACE<span class="sc">$</span>train[sim, ] <span class="ot">&lt;-</span> RESULTS<span class="sc">$</span>Err.train</span>
<span id="cb119-1448"><a href="opakování.html#cb119-1448" tabindex="-1"></a>  SIMULACE<span class="sc">$</span>test[sim, ] <span class="ot">&lt;-</span> RESULTS<span class="sc">$</span>Err.test</span>
<span id="cb119-1449"><a href="opakování.html#cb119-1449" tabindex="-1"></a>}</span></code></pre></div>
</details>
<pre><code>## Warning: glm.fit: algorithm did not converge</code></pre>
<pre><code>## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
<pre><code>## Warning: glm.fit: algorithm did not converge</code></pre>
<pre><code>## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
<pre><code>## Warning: glm.fit: algorithm did not converge</code></pre>
<pre><code>## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
<pre><code>## Warning: glm.fit: algorithm did not converge</code></pre>
<pre><code>## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
<pre><code>## Warning: glm.fit: algorithm did not converge</code></pre>
<pre><code>## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
<pre><code>## Warning: glm.fit: algorithm did not converge</code></pre>
<pre><code>## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
<pre><code>## Warning: glm.fit: algorithm did not converge</code></pre>
<pre><code>## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
<pre><code>## Warning: glm.fit: algorithm did not converge</code></pre>
<pre><code>## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
<p>Nyní spočítáme průměrné testovací a trénovací chybovosti pro jednotlivé klasifikační metody.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="opakování.html#cb136-1" tabindex="-1"></a><span class="co"># dame do vysledne tabulky</span></span>
<span id="cb136-2"><a href="opakování.html#cb136-2" tabindex="-1"></a></span>
<span id="cb136-3"><a href="opakování.html#cb136-3" tabindex="-1"></a>SIMULACE.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Err.train =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>train, <span class="dv">2</span>, mean),</span>
<span id="cb136-4"><a href="opakování.html#cb136-4" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>test, <span class="dv">2</span>, mean),</span>
<span id="cb136-5"><a href="opakování.html#cb136-5" tabindex="-1"></a>                          <span class="at">SD.train =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>train, <span class="dv">2</span>, sd),</span>
<span id="cb136-6"><a href="opakování.html#cb136-6" tabindex="-1"></a>                          <span class="at">SD.test =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>test, <span class="dv">2</span>, sd))</span></code></pre></div>
</details>
<div id="výsledky-2" class="section level3 hasAnchor" number="5.0.1">
<h3><span class="header-section-number">5.0.1</span> Výsledky<a href="opakování.html#výsledky-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<table>
<caption><span id="tab:unnamed-chunk-118">Tabulka 5.1: </span>Souhrnné výsledky použitých metod na simulovaných datech. <span class="math inline">\(\widehat{Err}_{train}\)</span> značí odhad trénovací chybovosti, <span class="math inline">\(\widehat{Err}_{test}\)</span> testovací chybovosti, <span class="math inline">\(\widehat{SD}_{train}\)</span> odhad směrodatné odchylky trénovacích chybovostí a <span class="math inline">\(\widehat{SD}_{test}\)</span> je odhad směrodatné odchylky testovacích chybovostí.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{train}\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{test}\)</span></th>
<th align="right"><span class="math inline">\(\widehat{SD}_{train}\)</span></th>
<th align="right"><span class="math inline">\(\widehat{SD}_{test}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>KNN</td>
<td align="right">0.0471</td>
<td align="right">0.0296</td>
<td align="right">0.0204</td>
<td align="right">0.0274</td>
</tr>
<tr class="even">
<td>LDA</td>
<td align="right">0.0220</td>
<td align="right">0.0229</td>
<td align="right">0.0103</td>
<td align="right">0.0224</td>
</tr>
<tr class="odd">
<td>QDA</td>
<td align="right">0.0292</td>
<td align="right">0.0364</td>
<td align="right">0.0151</td>
<td align="right">0.0321</td>
</tr>
<tr class="even">
<td>LR_score</td>
<td align="right">0.0297</td>
<td align="right">0.0404</td>
<td align="right">0.0161</td>
<td align="right">0.0389</td>
</tr>
<tr class="odd">
<td>Tree_discr</td>
<td align="right">0.1032</td>
<td align="right">0.1436</td>
<td align="right">0.0209</td>
<td align="right">0.0592</td>
</tr>
<tr class="even">
<td>Tree_score</td>
<td align="right">0.0655</td>
<td align="right">0.1246</td>
<td align="right">0.0195</td>
<td align="right">0.0584</td>
</tr>
<tr class="odd">
<td>Tree_Bbasis</td>
<td align="right">0.1032</td>
<td align="right">0.1436</td>
<td align="right">0.0209</td>
<td align="right">0.0592</td>
</tr>
<tr class="even">
<td>RF_discr</td>
<td align="right">0.0174</td>
<td align="right">0.1025</td>
<td align="right">0.0123</td>
<td align="right">0.0667</td>
</tr>
<tr class="odd">
<td>RF_score</td>
<td align="right">0.0135</td>
<td align="right">0.0768</td>
<td align="right">0.0116</td>
<td align="right">0.0548</td>
</tr>
<tr class="even">
<td>RF_Bbasis</td>
<td align="right">0.0191</td>
<td align="right">0.1004</td>
<td align="right">0.0118</td>
<td align="right">0.0635</td>
</tr>
<tr class="odd">
<td>SVM linear - diskr</td>
<td align="right">0.0202</td>
<td align="right">0.0539</td>
<td align="right">0.0136</td>
<td align="right">0.0361</td>
</tr>
<tr class="even">
<td>SVM poly - diskr</td>
<td align="right">0.1955</td>
<td align="right">0.2232</td>
<td align="right">0.0411</td>
<td align="right">0.0897</td>
</tr>
<tr class="odd">
<td>SVM rbf - diskr</td>
<td align="right">0.0217</td>
<td align="right">0.0479</td>
<td align="right">0.0107</td>
<td align="right">0.0349</td>
</tr>
<tr class="even">
<td>SVM linear - PCA</td>
<td align="right">0.0242</td>
<td align="right">0.0304</td>
<td align="right">0.0116</td>
<td align="right">0.0302</td>
</tr>
<tr class="odd">
<td>SVM poly - PCA</td>
<td align="right">0.0583</td>
<td align="right">0.0693</td>
<td align="right">0.0222</td>
<td align="right">0.0497</td>
</tr>
<tr class="even">
<td>SVM rbf - PCA</td>
<td align="right">0.0223</td>
<td align="right">0.0296</td>
<td align="right">0.0108</td>
<td align="right">0.0301</td>
</tr>
<tr class="odd">
<td>SVM linear - Bbasis</td>
<td align="right">0.0198</td>
<td align="right">0.0489</td>
<td align="right">0.0108</td>
<td align="right">0.0375</td>
</tr>
<tr class="even">
<td>SVM poly - Bbasis</td>
<td align="right">0.1506</td>
<td align="right">0.1918</td>
<td align="right">0.0561</td>
<td align="right">0.1070</td>
</tr>
<tr class="odd">
<td>SVM rbf - Bbasis</td>
<td align="right">0.0217</td>
<td align="right">0.0382</td>
<td align="right">0.0103</td>
<td align="right">0.0293</td>
</tr>
<tr class="even">
<td>SVM linear - projection</td>
<td align="right">0.0245</td>
<td align="right">0.0414</td>
<td align="right">0.0138</td>
<td align="right">0.0324</td>
</tr>
<tr class="odd">
<td>SVM poly - projection</td>
<td align="right">0.0526</td>
<td align="right">0.0814</td>
<td align="right">0.0242</td>
<td align="right">0.0572</td>
</tr>
<tr class="even">
<td>SVM rbf - projection</td>
<td align="right">0.0218</td>
<td align="right">0.0439</td>
<td align="right">0.0110</td>
<td align="right">0.0328</td>
</tr>
<tr class="odd">
<td>SVM linear - RKHS - radial</td>
<td align="right">0.0338</td>
<td align="right">0.0854</td>
<td align="right">0.0176</td>
<td align="right">0.0525</td>
</tr>
<tr class="even">
<td>SVM poly - RKHS - radial</td>
<td align="right">0.0391</td>
<td align="right">0.0993</td>
<td align="right">0.0167</td>
<td align="right">0.0615</td>
</tr>
<tr class="odd">
<td>SVM rbf - RKHS - radial</td>
<td align="right">0.0418</td>
<td align="right">0.0814</td>
<td align="right">0.0171</td>
<td align="right">0.0449</td>
</tr>
<tr class="even">
<td>SVM linear - RKHS - linear</td>
<td align="right">0.0534</td>
<td align="right">0.1543</td>
<td align="right">0.0290</td>
<td align="right">0.0638</td>
</tr>
<tr class="odd">
<td>SVM poly - RKHS - linear</td>
<td align="right">0.0632</td>
<td align="right">0.1775</td>
<td align="right">0.0226</td>
<td align="right">0.0795</td>
</tr>
<tr class="even">
<td>SVM rbf - RKHS - linear</td>
<td align="right">0.0529</td>
<td align="right">0.0950</td>
<td align="right">0.0191</td>
<td align="right">0.0535</td>
</tr>
</tbody>
</table>
<p>V tabulce výše jsou uvedeny všechny vypočtené charakteristiky.
Jsou zde uvedeny také směrodatné odchylky, abychom mohli porovnat jakousi stálost či míru variability jednotlivých metod.</p>
<p>Nakonec ještě můžeme graficky zobrazit vypočtené hodnoty ze simulace pro jednotlivé klasifikační metody pomocí krabicových diagramů, zvlášť pro testovací a trénovací chybovosti.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="opakování.html#cb137-1" tabindex="-1"></a><span class="co"># pro trenovaci data</span></span>
<span id="cb137-2"><a href="opakování.html#cb137-2" tabindex="-1"></a>SIMULACE<span class="sc">$</span>train <span class="sc">|&gt;</span> </span>
<span id="cb137-3"><a href="opakování.html#cb137-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> methods, <span class="at">names_to =</span> <span class="st">&#39;method&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb137-4"><a href="opakování.html#cb137-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb137-5"><a href="opakování.html#cb137-5" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb137-6"><a href="opakování.html#cb137-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> Err, <span class="at">fill =</span> method, <span class="at">colour =</span> method, <span class="at">alpha =</span> <span class="fl">0.3</span>)) <span class="sc">+</span> </span>
<span id="cb137-7"><a href="opakování.html#cb137-7" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">&quot;white&quot;</span>, <span class="at">outlier.shape =</span> <span class="dv">16</span>, <span class="at">outlier.size =</span> <span class="dv">0</span>, </span>
<span id="cb137-8"><a href="opakování.html#cb137-8" tabindex="-1"></a>               <span class="at">notch =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb137-9"><a href="opakování.html#cb137-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb137-10"><a href="opakování.html#cb137-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Klasifikační metoda&#39;</span>,</span>
<span id="cb137-11"><a href="opakování.html#cb137-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(Err)[train])) <span class="sc">+</span> </span>
<span id="cb137-12"><a href="opakování.html#cb137-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb137-13"><a href="opakování.html#cb137-13" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">40</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb137-14"><a href="opakování.html#cb137-14" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.15</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb137-15"><a href="opakování.html#cb137-15" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb137-16"><a href="opakování.html#cb137-16" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">shape =</span> <span class="st">&#39;+&#39;</span>,</span>
<span id="cb137-17"><a href="opakování.html#cb137-17" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>)<span class="sc">+</span> </span>
<span id="cb137-18"><a href="opakování.html#cb137-18" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">min</span>(SIMULACE.df<span class="sc">$</span>Err.train), </span>
<span id="cb137-19"><a href="opakování.html#cb137-19" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-119"></span>
<img src="03-Application_1_files/figure-html/unnamed-chunk-119-1.png" alt="Krabicové diagramy trénovacích chybovostí pro 100 simulací zvlášť pro jednotlivé klasifikační metody. Černými symboly $+$ jsou vyznačeny průměry." width="672" />
<p class="caption">
Obrázek 5.1: Krabicové diagramy trénovacích chybovostí pro 100 simulací zvlášť pro jednotlivé klasifikační metody. Černými symboly <span class="math inline">\(+\)</span> jsou vyznačeny průměry.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="opakování.html#cb138-1" tabindex="-1"></a><span class="co"># pro testovaci data</span></span>
<span id="cb138-2"><a href="opakování.html#cb138-2" tabindex="-1"></a>SIMULACE<span class="sc">$</span>test <span class="sc">|&gt;</span> </span>
<span id="cb138-3"><a href="opakování.html#cb138-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> methods, <span class="at">names_to =</span> <span class="st">&#39;method&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb138-4"><a href="opakování.html#cb138-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb138-5"><a href="opakování.html#cb138-5" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb138-6"><a href="opakování.html#cb138-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> Err, <span class="at">fill =</span> method, <span class="at">colour =</span> method, <span class="at">alpha =</span> <span class="fl">0.3</span>)) <span class="sc">+</span> </span>
<span id="cb138-7"><a href="opakování.html#cb138-7" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">&quot;white&quot;</span>, <span class="at">outlier.shape =</span> <span class="dv">16</span>, <span class="at">outlier.size =</span> <span class="dv">0</span>, </span>
<span id="cb138-8"><a href="opakování.html#cb138-8" tabindex="-1"></a>               <span class="at">notch =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb138-9"><a href="opakování.html#cb138-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb138-10"><a href="opakování.html#cb138-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Klasifikační metoda&#39;</span>,</span>
<span id="cb138-11"><a href="opakování.html#cb138-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(Err)[test])) <span class="sc">+</span> </span>
<span id="cb138-12"><a href="opakování.html#cb138-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb138-13"><a href="opakování.html#cb138-13" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">40</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb138-14"><a href="opakování.html#cb138-14" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.15</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb138-15"><a href="opakování.html#cb138-15" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb138-16"><a href="opakování.html#cb138-16" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">shape =</span> <span class="st">&#39;+&#39;</span>,</span>
<span id="cb138-17"><a href="opakování.html#cb138-17" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span> </span>
<span id="cb138-18"><a href="opakování.html#cb138-18" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">min</span>(SIMULACE.df<span class="sc">$</span>Err.test), </span>
<span id="cb138-19"><a href="opakování.html#cb138-19" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121"></span>
<img src="03-Application_1_files/figure-html/unnamed-chunk-121-1.png" alt="Krabicové diagramy testovacích chybovostí pro 100 simulací zvlášť pro jednotlivé klasifikační metody. Černými symboly $+$ jsou vyznačeny průměry." width="672" />
<p class="caption">
Obrázek 5.2: Krabicové diagramy testovacích chybovostí pro 100 simulací zvlášť pro jednotlivé klasifikační metody. Černými symboly <span class="math inline">\(+\)</span> jsou vyznačeny průměry.
</p>
</div>
<p>Nakonec se podívejme, jaké hodnoty hyperparametrů byly nejčastější volbou.</p>
<table>
<caption><span id="tab:unnamed-chunk-123">Tabulka 5.2: </span>Mediány hodnot hyperparametrů pro vybrané metody, u nichž se určoval nějaký hyperparametr pomocí cross-validace.</caption>
<thead>
<tr class="header">
<th align="center"><span class="math inline">\(K\)</span> pro KNN</th>
<th align="right"><span class="math inline">\(d\)</span> pro SVM linear</th>
<th align="center"><span class="math inline">\(d\)</span> pro SVM poly</th>
<th align="right"><span class="math inline">\(d\)</span> pro SVM radial</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">4</td>
<td align="right">6</td>
<td align="center">6</td>
<td align="right">7</td>
</tr>
</tbody>
</table>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="opakování.html#cb139-1" tabindex="-1"></a>CV_RESULTS <span class="sc">|&gt;</span> </span>
<span id="cb139-2"><a href="opakování.html#cb139-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> CV_RESULTS <span class="sc">|&gt;</span> <span class="fu">colnames</span>(), <span class="at">names_to =</span> <span class="st">&#39;method&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;hyperparameter&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb139-3"><a href="opakování.html#cb139-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, </span>
<span id="cb139-4"><a href="opakování.html#cb139-4" tabindex="-1"></a>                         <span class="at">levels =</span> CV_RESULTS <span class="sc">|&gt;</span> <span class="fu">colnames</span>(), </span>
<span id="cb139-5"><a href="opakování.html#cb139-5" tabindex="-1"></a>                         <span class="at">labels =</span> CV_RESULTS <span class="sc">|&gt;</span> <span class="fu">colnames</span>(), <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb139-6"><a href="opakování.html#cb139-6" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb139-7"><a href="opakování.html#cb139-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb139-8"><a href="opakování.html#cb139-8" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb139-9"><a href="opakování.html#cb139-9" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span> </span>
<span id="cb139-10"><a href="opakování.html#cb139-10" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb139-11"><a href="opakování.html#cb139-11" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>) <span class="sc">+</span></span>
<span id="cb139-12"><a href="opakování.html#cb139-12" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hodnoty hyperparametru&#39;</span>,</span>
<span id="cb139-13"><a href="opakování.html#cb139-13" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolutní počet&#39;</span>) <span class="sc">+</span> </span>
<span id="cb139-14"><a href="opakování.html#cb139-14" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-124"></span>
<img src="03-Application_1_files/figure-html/unnamed-chunk-124-1.png" alt="Krabicové diagramy hodnot hyperparametrů." width="672" />
<p class="caption">
Obrázek 5.3: Krabicové diagramy hodnot hyperparametrů.
</p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tabulka-výsledků-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="vlastnosti-metody-rkhs-svm.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": null,
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/Tomas-Pompa/MastersThesis/blob/main/03-Application_1.Rmd",
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
