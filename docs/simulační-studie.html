<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.5 Simulační studie | Diplomová práce</title>
  <meta name="description" content="2.5 Simulační studie | Diplomová práce" />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="2.5 Simulační studie | Diplomová práce" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.5 Simulační studie | Diplomová práce" />
  
  
  

<meta name="author" content="Tomáš Pompa" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tabulka-výsledků.html"/>
<link rel="next" href="simulace-2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/codefolding-lua-1.1/codefolding-lua.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="sci-lg-eng-rgb.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Metoda podpůrných vektorů pro funkcionální data</a></li>
<li class="chapter" data-level="2" data-path="simulace-1.html"><a href="simulace-1.html"><i class="fa fa-check"></i><b>2</b> Simulace 1</a>
<ul>
<li class="chapter" data-level="2.1" data-path="simulace-funkcionálních-dat.html"><a href="simulace-funkcionálních-dat.html"><i class="fa fa-check"></i><b>2.1</b> Simulace funkcionálních dat</a></li>
<li class="chapter" data-level="2.2" data-path="vyhlazení-pozorovaných-křivek.html"><a href="vyhlazení-pozorovaných-křivek.html"><i class="fa fa-check"></i><b>2.2</b> Vyhlazení pozorovaných křivek</a></li>
<li class="chapter" data-level="2.3" data-path="klasifikace-křivek.html"><a href="klasifikace-křivek.html"><i class="fa fa-check"></i><b>2.3</b> Klasifikace křivek</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="klasifikace-křivek.html"><a href="klasifikace-křivek.html#k-nejbližších-sousedů"><i class="fa fa-check"></i><b>2.3.1</b> 1) <span class="math inline">\(K\)</span> nejbližších sousedů</a></li>
<li class="chapter" data-level="2.3.2" data-path="klasifikace-křivek.html"><a href="klasifikace-křivek.html#lineární-diskriminační-analýza"><i class="fa fa-check"></i><b>2.3.2</b> 2) Lineární diskriminační analýza</a></li>
<li class="chapter" data-level="2.3.3" data-path="klasifikace-křivek.html"><a href="klasifikace-křivek.html#kvadratická-diskriminační-analýza"><i class="fa fa-check"></i><b>2.3.3</b> 3) Kvadratická diskriminační analýza</a></li>
<li class="chapter" data-level="2.3.4" data-path="klasifikace-křivek.html"><a href="klasifikace-křivek.html#logistická-regrese"><i class="fa fa-check"></i><b>2.3.4</b> 4) Logistická regrese</a></li>
<li class="chapter" data-level="2.3.5" data-path="klasifikace-křivek.html"><a href="klasifikace-křivek.html#rozhodovací-stromy"><i class="fa fa-check"></i><b>2.3.5</b> 5) Rozhodovací stromy</a></li>
<li class="chapter" data-level="2.3.6" data-path="klasifikace-křivek.html"><a href="klasifikace-křivek.html#náhodné-lesy"><i class="fa fa-check"></i><b>2.3.6</b> 6) Náhodné lesy</a></li>
<li class="chapter" data-level="2.3.7" data-path="klasifikace-křivek.html"><a href="klasifikace-křivek.html#support-vector-machines"><i class="fa fa-check"></i><b>2.3.7</b> 7) Support Vector Machines</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="tabulka-výsledků.html"><a href="tabulka-výsledků.html"><i class="fa fa-check"></i><b>2.4</b> Tabulka výsledků</a></li>
<li class="chapter" data-level="2.5" data-path="simulační-studie.html"><a href="simulační-studie.html"><i class="fa fa-check"></i><b>2.5</b> Simulační studie</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="simulační-studie.html"><a href="simulační-studie.html#výsledky"><i class="fa fa-check"></i><b>2.5.1</b> Výsledky</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="simulace-2.html"><a href="simulace-2.html"><i class="fa fa-check"></i><b>3</b> Simulace 2</a>
<ul>
<li class="chapter" data-level="3.1" data-path="simulace-funkcionálních-dat-1.html"><a href="simulace-funkcionálních-dat-1.html"><i class="fa fa-check"></i><b>3.1</b> Simulace funkcionálních dat</a></li>
<li class="chapter" data-level="3.2" data-path="vyhlazení-pozorovaných-křivek-1.html"><a href="vyhlazení-pozorovaných-křivek-1.html"><i class="fa fa-check"></i><b>3.2</b> Vyhlazení pozorovaných křivek</a></li>
<li class="chapter" data-level="3.3" data-path="klasifikace-křivek-1.html"><a href="klasifikace-křivek-1.html"><i class="fa fa-check"></i><b>3.3</b> Klasifikace křivek</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="klasifikace-křivek-1.html"><a href="klasifikace-křivek-1.html#k-nejbližších-sousedů-1"><i class="fa fa-check"></i><b>3.3.1</b> 1) <span class="math inline">\(K\)</span> nejbližších sousedů</a></li>
<li class="chapter" data-level="3.3.2" data-path="klasifikace-křivek-1.html"><a href="klasifikace-křivek-1.html#lineární-diskriminační-analýza-1"><i class="fa fa-check"></i><b>3.3.2</b> 2) Lineární diskriminační analýza</a></li>
<li class="chapter" data-level="3.3.3" data-path="klasifikace-křivek-1.html"><a href="klasifikace-křivek-1.html#kvadratická-diskriminační-analýza-1"><i class="fa fa-check"></i><b>3.3.3</b> 3) Kvadratická diskriminační analýza</a></li>
<li class="chapter" data-level="3.3.4" data-path="klasifikace-křivek-1.html"><a href="klasifikace-křivek-1.html#logistická-regrese-1"><i class="fa fa-check"></i><b>3.3.4</b> 4) Logistická regrese</a></li>
<li class="chapter" data-level="3.3.5" data-path="klasifikace-křivek-1.html"><a href="klasifikace-křivek-1.html#rozhodovací-stromy-1"><i class="fa fa-check"></i><b>3.3.5</b> 5) Rozhodovací stromy</a></li>
<li class="chapter" data-level="3.3.6" data-path="klasifikace-křivek-1.html"><a href="klasifikace-křivek-1.html#náhodné-lesy-1"><i class="fa fa-check"></i><b>3.3.6</b> 6) Náhodné lesy</a></li>
<li class="chapter" data-level="3.3.7" data-path="klasifikace-křivek-1.html"><a href="klasifikace-křivek-1.html#support-vector-machines-1"><i class="fa fa-check"></i><b>3.3.7</b> 7) Support Vector Machines</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="tabulka-výsledků-1.html"><a href="tabulka-výsledků-1.html"><i class="fa fa-check"></i><b>3.4</b> Tabulka výsledků</a></li>
<li class="chapter" data-level="3.5" data-path="simulační-studie-1.html"><a href="simulační-studie-1.html"><i class="fa fa-check"></i><b>3.5</b> Simulační studie</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="simulační-studie-1.html"><a href="simulační-studie-1.html#výsledky-1"><i class="fa fa-check"></i><b>3.5.1</b> Výsledky</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="aplikace-na-reálných-datech-1.html"><a href="aplikace-na-reálných-datech-1.html"><i class="fa fa-check"></i><b>4</b> Aplikace na reálných datech 1</a></li>
<li class="chapter" data-level="5" data-path="aplikace-na-reálných-datech-2.html"><a href="aplikace-na-reálných-datech-2.html"><i class="fa fa-check"></i><b>5</b> Aplikace na reálných datech 2</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Diplomová práce</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulační-studie" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Simulační studie<a href="simulační-studie.html#simulační-studie" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>V celé předchozí části jsme se zabývali pouze jedním náhodně vygenerovaným souborem funkcí ze dvou klasifikačních tříd, který jsme následně opět náhodně rozdělili na testovací a trénovací část.
Poté jsme jednotlivé klasifikátory získané pomocí uvažovaných metod ohodnotili na základě testovací a trénovací chybovosti.</p>
<p>Jelikož se vygenerovaná data (a jejich rozdělení na dvě části) mohou při každém zopakování výrazně lišit, budou se i chybovosti jednotlivých klasifikačních algoritmů výrazně lišit.
Proto dělat jakékoli závěry o metodách a porovnávat je mezi sebou může být na základě jednoho vygenerovaného datového souboru velmi zavádějící.</p>
<p>Z tohoto důvodu se v této části zaměříme na opakování celého předchozího postupu pro různé vygenerované soubory.
Výsledky si budeme ukládat do tabulky a nakonec spočítáme průměrné charakteristiky modelů přes jednotlivá opakování.
Aby byly naše závěry dostatečně obecné, zvolíme počet opakování <span class="math inline">\(n_{sim} = 50\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="simulační-studie.html#cb120-1" tabindex="-1"></a><span class="co"># pocet simulaci</span></span>
<span id="cb120-2"><a href="simulační-studie.html#cb120-2" tabindex="-1"></a>n.sim <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb120-3"><a href="simulační-studie.html#cb120-3" tabindex="-1"></a></span>
<span id="cb120-4"><a href="simulační-studie.html#cb120-4" tabindex="-1"></a><span class="do">## list, do ktereho budeme ukladat hodnoty chybovosti</span></span>
<span id="cb120-5"><a href="simulační-studie.html#cb120-5" tabindex="-1"></a><span class="co"># ve sloupcich budou metody</span></span>
<span id="cb120-6"><a href="simulační-studie.html#cb120-6" tabindex="-1"></a><span class="co"># v radcich budou jednotliva opakovani</span></span>
<span id="cb120-7"><a href="simulační-studie.html#cb120-7" tabindex="-1"></a><span class="co"># list ma dve polozky ... train a test</span></span>
<span id="cb120-8"><a href="simulační-studie.html#cb120-8" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;KNN&#39;</span>, <span class="st">&#39;LDA&#39;</span>, <span class="st">&#39;QDA&#39;</span>, <span class="st">&#39;LR_functional&#39;</span>, <span class="st">&#39;LR_score&#39;</span>, <span class="st">&#39;Tree_discr&#39;</span>,</span>
<span id="cb120-9"><a href="simulační-studie.html#cb120-9" tabindex="-1"></a>             <span class="st">&#39;Tree_score&#39;</span>, <span class="st">&#39;Tree_Bbasis&#39;</span>, <span class="st">&#39;RF_discr&#39;</span>, <span class="st">&#39;RF_score&#39;</span>, <span class="st">&#39;RF_Bbasis&#39;</span>, </span>
<span id="cb120-10"><a href="simulační-studie.html#cb120-10" tabindex="-1"></a>             <span class="st">&#39;SVM linear - diskr&#39;</span>, <span class="st">&#39;SVM poly - diskr&#39;</span>, <span class="st">&#39;SVM rbf - diskr&#39;</span>, </span>
<span id="cb120-11"><a href="simulační-studie.html#cb120-11" tabindex="-1"></a>             <span class="st">&#39;SVM linear - PCA&#39;</span>, <span class="st">&#39;SVM poly - PCA&#39;</span>, <span class="st">&#39;SVM rbf - PCA&#39;</span>, </span>
<span id="cb120-12"><a href="simulační-studie.html#cb120-12" tabindex="-1"></a>             <span class="st">&#39;SVM linear - Bbasis&#39;</span>, <span class="st">&#39;SVM poly - Bbasis&#39;</span>, <span class="st">&#39;SVM rbf - Bbasis&#39;</span>,</span>
<span id="cb120-13"><a href="simulační-studie.html#cb120-13" tabindex="-1"></a>             <span class="st">&#39;SVM linear - projection&#39;</span>, <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb120-14"><a href="simulační-studie.html#cb120-14" tabindex="-1"></a>             <span class="st">&#39;SVM rbf - projection&#39;</span>, <span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>, <span class="st">&#39;SVM linear - RKHS - poly&#39;</span>, <span class="st">&#39;SVM poly - RKHS - poly&#39;</span>, <span class="st">&#39;SVM rbf - RKHS - poly&#39;</span>, <span class="st">&#39;SVM linear - RKHS - linear&#39;</span>, <span class="st">&#39;SVM poly - RKHS - linear&#39;</span>, <span class="st">&#39;SVM rbf - RKHS - linear&#39;</span>)</span>
<span id="cb120-15"><a href="simulační-studie.html#cb120-15" tabindex="-1"></a></span>
<span id="cb120-16"><a href="simulační-studie.html#cb120-16" tabindex="-1"></a>SIMULACE <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">train =</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(methods), </span>
<span id="cb120-17"><a href="simulační-studie.html#cb120-17" tabindex="-1"></a>                                             <span class="at">nrow =</span> n.sim,</span>
<span id="cb120-18"><a href="simulační-studie.html#cb120-18" tabindex="-1"></a>                                             <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n.sim, methods))), </span>
<span id="cb120-19"><a href="simulační-studie.html#cb120-19" tabindex="-1"></a>                 <span class="at">test =</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(methods), </span>
<span id="cb120-20"><a href="simulační-studie.html#cb120-20" tabindex="-1"></a>                                             <span class="at">nrow =</span> n.sim,</span>
<span id="cb120-21"><a href="simulační-studie.html#cb120-21" tabindex="-1"></a>                                             <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n.sim, methods))))</span>
<span id="cb120-22"><a href="simulační-studie.html#cb120-22" tabindex="-1"></a></span>
<span id="cb120-23"><a href="simulační-studie.html#cb120-23" tabindex="-1"></a><span class="co"># objekt na ulozeni optimalnich hodnot hyperparametru, ktere se urcuji pomoci CV</span></span>
<span id="cb120-24"><a href="simulační-studie.html#cb120-24" tabindex="-1"></a>CV_RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">KNN_K =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n.sim),</span>
<span id="cb120-25"><a href="simulační-studie.html#cb120-25" tabindex="-1"></a>                         <span class="at">SVM_d_Linear =</span> <span class="cn">NA</span>,</span>
<span id="cb120-26"><a href="simulační-studie.html#cb120-26" tabindex="-1"></a>                         <span class="at">SVM_d_Poly =</span> <span class="cn">NA</span>,</span>
<span id="cb120-27"><a href="simulační-studie.html#cb120-27" tabindex="-1"></a>                         <span class="at">SVM_d_Radial =</span> <span class="cn">NA</span>)</span></code></pre></div>
</details>
<p>Nyní zopakujeme celou předchozí část <code>n.sim</code>-krát a hodnoty chybovostí si budeme ukládat to listu <code>SIMULACE</code>.
Do datové tabulky <code>CV_RESULTS</code> si potom budeme ukládat hodnoty optimálních hyperparametrů – pro metodu <span class="math inline">\(K\)</span> nejbližších sousedů a pro SVM hodnotu dimenze <span class="math inline">\(d\)</span> v případě projekce na B-splinovou bázi.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="simulační-studie.html#cb121-1" tabindex="-1"></a><span class="do">## SIMULACE</span></span>
<span id="cb121-2"><a href="simulační-studie.html#cb121-2" tabindex="-1"></a></span>
<span id="cb121-3"><a href="simulační-studie.html#cb121-3" tabindex="-1"></a><span class="cf">for</span>(sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.sim) {</span>
<span id="cb121-4"><a href="simulační-studie.html#cb121-4" tabindex="-1"></a>  <span class="co"># pocet vygenerovanych pozorovani pro kazdou tridu</span></span>
<span id="cb121-5"><a href="simulační-studie.html#cb121-5" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb121-6"><a href="simulační-studie.html#cb121-6" tabindex="-1"></a>  <span class="co"># vektor casu ekvidistantni na intervalu [0, 1]</span></span>
<span id="cb121-7"><a href="simulační-studie.html#cb121-7" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">51</span>)</span>
<span id="cb121-8"><a href="simulační-studie.html#cb121-8" tabindex="-1"></a>  </span>
<span id="cb121-9"><a href="simulační-studie.html#cb121-9" tabindex="-1"></a>  <span class="co"># pro Y = 0</span></span>
<span id="cb121-10"><a href="simulační-studie.html#cb121-10" tabindex="-1"></a>  X0 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_0, n, <span class="dv">1</span>)</span>
<span id="cb121-11"><a href="simulační-studie.html#cb121-11" tabindex="-1"></a>  <span class="co"># pro Y = 1</span></span>
<span id="cb121-12"><a href="simulační-studie.html#cb121-12" tabindex="-1"></a>  X1 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_1, n, <span class="dv">1</span>)</span>
<span id="cb121-13"><a href="simulační-studie.html#cb121-13" tabindex="-1"></a>  </span>
<span id="cb121-14"><a href="simulační-studie.html#cb121-14" tabindex="-1"></a>  rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb121-15"><a href="simulační-studie.html#cb121-15" tabindex="-1"></a>  breaks <span class="ot">&lt;-</span> t</span>
<span id="cb121-16"><a href="simulační-studie.html#cb121-16" tabindex="-1"></a>  norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb121-17"><a href="simulační-studie.html#cb121-17" tabindex="-1"></a>  </span>
<span id="cb121-18"><a href="simulační-studie.html#cb121-18" tabindex="-1"></a>  bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb121-19"><a href="simulační-studie.html#cb121-19" tabindex="-1"></a>                                 <span class="at">norder =</span> norder, </span>
<span id="cb121-20"><a href="simulační-studie.html#cb121-20" tabindex="-1"></a>                                 <span class="at">breaks =</span> breaks)</span>
<span id="cb121-21"><a href="simulační-studie.html#cb121-21" tabindex="-1"></a>  </span>
<span id="cb121-22"><a href="simulační-studie.html#cb121-22" tabindex="-1"></a>  curv.Lfd <span class="ot">&lt;-</span> <span class="fu">int2Lfd</span>(<span class="dv">2</span>) </span>
<span id="cb121-23"><a href="simulační-studie.html#cb121-23" tabindex="-1"></a>  <span class="co"># spojeni pozorovani do jedne matice</span></span>
<span id="cb121-24"><a href="simulační-studie.html#cb121-24" tabindex="-1"></a>  XX <span class="ot">&lt;-</span> <span class="fu">cbind</span>(X0, X1)</span>
<span id="cb121-25"><a href="simulační-studie.html#cb121-25" tabindex="-1"></a>  </span>
<span id="cb121-26"><a href="simulační-studie.html#cb121-26" tabindex="-1"></a>  lambda.vect <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">length.out =</span> <span class="dv">25</span>) <span class="co"># vektor lambd</span></span>
<span id="cb121-27"><a href="simulační-studie.html#cb121-27" tabindex="-1"></a>  gcv <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="at">length =</span> <span class="fu">length</span>(lambda.vect)) <span class="co"># prazdny vektor pro ulozebi GCV</span></span>
<span id="cb121-28"><a href="simulační-studie.html#cb121-28" tabindex="-1"></a>  </span>
<span id="cb121-29"><a href="simulační-studie.html#cb121-29" tabindex="-1"></a>  <span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambda.vect)) {</span>
<span id="cb121-30"><a href="simulační-studie.html#cb121-30" tabindex="-1"></a>    curv.Fdpar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.vect[index])</span>
<span id="cb121-31"><a href="simulační-studie.html#cb121-31" tabindex="-1"></a>    BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.Fdpar) <span class="co"># vyhlazeni</span></span>
<span id="cb121-32"><a href="simulační-studie.html#cb121-32" tabindex="-1"></a>    gcv[index] <span class="ot">&lt;-</span> <span class="fu">mean</span>(BSmooth<span class="sc">$</span>gcv) <span class="co"># prumer pres vsechny pozorovane krivky</span></span>
<span id="cb121-33"><a href="simulační-studie.html#cb121-33" tabindex="-1"></a>  }</span>
<span id="cb121-34"><a href="simulační-studie.html#cb121-34" tabindex="-1"></a>  </span>
<span id="cb121-35"><a href="simulační-studie.html#cb121-35" tabindex="-1"></a>  GCV <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb121-36"><a href="simulační-studie.html#cb121-36" tabindex="-1"></a>    <span class="at">lambda =</span> <span class="fu">round</span>(<span class="fu">log10</span>(lambda.vect), <span class="dv">3</span>),</span>
<span id="cb121-37"><a href="simulační-studie.html#cb121-37" tabindex="-1"></a>    <span class="at">GCV =</span> gcv</span>
<span id="cb121-38"><a href="simulační-studie.html#cb121-38" tabindex="-1"></a>  )</span>
<span id="cb121-39"><a href="simulační-studie.html#cb121-39" tabindex="-1"></a>  </span>
<span id="cb121-40"><a href="simulační-studie.html#cb121-40" tabindex="-1"></a>  <span class="co"># najdeme hodnotu minima</span></span>
<span id="cb121-41"><a href="simulační-studie.html#cb121-41" tabindex="-1"></a>  lambda.opt <span class="ot">&lt;-</span> lambda.vect[<span class="fu">which.min</span>(gcv)]</span>
<span id="cb121-42"><a href="simulační-studie.html#cb121-42" tabindex="-1"></a>  </span>
<span id="cb121-43"><a href="simulační-studie.html#cb121-43" tabindex="-1"></a>  curv.fdPar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.opt)</span>
<span id="cb121-44"><a href="simulační-studie.html#cb121-44" tabindex="-1"></a>  BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.fdPar)</span>
<span id="cb121-45"><a href="simulační-studie.html#cb121-45" tabindex="-1"></a>  XXfd <span class="ot">&lt;-</span> BSmooth<span class="sc">$</span>fd</span>
<span id="cb121-46"><a href="simulační-studie.html#cb121-46" tabindex="-1"></a>  </span>
<span id="cb121-47"><a href="simulační-studie.html#cb121-47" tabindex="-1"></a>  fdobjSmootheval <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> XXfd, <span class="at">evalarg =</span> t)</span>
<span id="cb121-48"><a href="simulační-studie.html#cb121-48" tabindex="-1"></a>  </span>
<span id="cb121-49"><a href="simulační-studie.html#cb121-49" tabindex="-1"></a>  <span class="co"># rozdeleni na testovaci a trenovaci cast</span></span>
<span id="cb121-50"><a href="simulační-studie.html#cb121-50" tabindex="-1"></a>  split <span class="ot">&lt;-</span> <span class="fu">sample.split</span>(XXfd<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb121-51"><a href="simulační-studie.html#cb121-51" tabindex="-1"></a>  </span>
<span id="cb121-52"><a href="simulační-studie.html#cb121-52" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n)</span>
<span id="cb121-53"><a href="simulační-studie.html#cb121-53" tabindex="-1"></a>  </span>
<span id="cb121-54"><a href="simulační-studie.html#cb121-54" tabindex="-1"></a>  X.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb121-55"><a href="simulační-studie.html#cb121-55" tabindex="-1"></a>  X.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb121-56"><a href="simulační-studie.html#cb121-56" tabindex="-1"></a>  </span>
<span id="cb121-57"><a href="simulační-studie.html#cb121-57" tabindex="-1"></a>  Y.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb121-58"><a href="simulační-studie.html#cb121-58" tabindex="-1"></a>  Y.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb121-59"><a href="simulační-studie.html#cb121-59" tabindex="-1"></a>  </span>
<span id="cb121-60"><a href="simulační-studie.html#cb121-60" tabindex="-1"></a>  x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb121-61"><a href="simulační-studie.html#cb121-61" tabindex="-1"></a>  y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.train))</span>
<span id="cb121-62"><a href="simulační-studie.html#cb121-62" tabindex="-1"></a>  </span>
<span id="cb121-63"><a href="simulační-studie.html#cb121-63" tabindex="-1"></a>  <span class="do">## 1) K nejbližších sousedů</span></span>
<span id="cb121-64"><a href="simulační-studie.html#cb121-64" tabindex="-1"></a>  </span>
<span id="cb121-65"><a href="simulační-studie.html#cb121-65" tabindex="-1"></a>  k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb121-66"><a href="simulační-studie.html#cb121-66" tabindex="-1"></a>  neighbours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">ceiling</span>(<span class="fu">sqrt</span>(<span class="fu">length</span>(y.train))))) <span class="co"># pocet sousedu </span></span>
<span id="cb121-67"><a href="simulační-studie.html#cb121-67" tabindex="-1"></a>  </span>
<span id="cb121-68"><a href="simulační-studie.html#cb121-68" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb121-69"><a href="simulační-studie.html#cb121-69" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb121-70"><a href="simulační-studie.html#cb121-70" tabindex="-1"></a>  </span>
<span id="cb121-71"><a href="simulační-studie.html#cb121-71" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(neighbours), <span class="at">ncol =</span> k_cv)</span>
<span id="cb121-72"><a href="simulační-studie.html#cb121-72" tabindex="-1"></a>  </span>
<span id="cb121-73"><a href="simulační-studie.html#cb121-73" tabindex="-1"></a>  <span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb121-74"><a href="simulační-studie.html#cb121-74" tabindex="-1"></a>    <span class="co"># definujeme danou indexovou mnozinu</span></span>
<span id="cb121-75"><a href="simulační-studie.html#cb121-75" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb121-76"><a href="simulační-studie.html#cb121-76" tabindex="-1"></a>      </span>
<span id="cb121-77"><a href="simulační-studie.html#cb121-77" tabindex="-1"></a>    x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb121-78"><a href="simulační-studie.html#cb121-78" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb121-79"><a href="simulační-studie.html#cb121-79" tabindex="-1"></a>    y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb121-80"><a href="simulační-studie.html#cb121-80" tabindex="-1"></a>      <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb121-81"><a href="simulační-studie.html#cb121-81" tabindex="-1"></a>    </span>
<span id="cb121-82"><a href="simulační-studie.html#cb121-82" tabindex="-1"></a>    x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb121-83"><a href="simulační-studie.html#cb121-83" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb121-84"><a href="simulační-studie.html#cb121-84" tabindex="-1"></a>    y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb121-85"><a href="simulační-studie.html#cb121-85" tabindex="-1"></a>      <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb121-86"><a href="simulační-studie.html#cb121-86" tabindex="-1"></a>    </span>
<span id="cb121-87"><a href="simulační-studie.html#cb121-87" tabindex="-1"></a>    <span class="co"># projdeme kazdou cast ... k-krat zopakujeme</span></span>
<span id="cb121-88"><a href="simulační-studie.html#cb121-88" tabindex="-1"></a>    <span class="cf">for</span>(neighbour <span class="cf">in</span> neighbours) {</span>
<span id="cb121-89"><a href="simulační-studie.html#cb121-89" tabindex="-1"></a>      <span class="co"># model pro konkretni volbu K</span></span>
<span id="cb121-90"><a href="simulační-studie.html#cb121-90" tabindex="-1"></a>      neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train.cv, </span>
<span id="cb121-91"><a href="simulační-studie.html#cb121-91" tabindex="-1"></a>                                <span class="at">fdataobj =</span> x.train.cv, </span>
<span id="cb121-92"><a href="simulační-studie.html#cb121-92" tabindex="-1"></a>                                <span class="at">knn =</span> neighbour) </span>
<span id="cb121-93"><a href="simulační-studie.html#cb121-93" tabindex="-1"></a>      <span class="co"># predikce na validacni casti</span></span>
<span id="cb121-94"><a href="simulační-studie.html#cb121-94" tabindex="-1"></a>      model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb121-95"><a href="simulační-studie.html#cb121-95" tabindex="-1"></a>                                      <span class="at">new.fdataobj =</span> x.test.cv)</span>
<span id="cb121-96"><a href="simulační-studie.html#cb121-96" tabindex="-1"></a>      <span class="co"># presnost na validacni casti</span></span>
<span id="cb121-97"><a href="simulační-studie.html#cb121-97" tabindex="-1"></a>      presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, model.neighb.predict) <span class="sc">|&gt;</span> </span>
<span id="cb121-98"><a href="simulační-studie.html#cb121-98" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-99"><a href="simulační-studie.html#cb121-99" tabindex="-1"></a>      </span>
<span id="cb121-100"><a href="simulační-studie.html#cb121-100" tabindex="-1"></a>      <span class="co"># presnost vlozime na pozici pro dane K a fold</span></span>
<span id="cb121-101"><a href="simulační-studie.html#cb121-101" tabindex="-1"></a>      CV.results[neighbour, index] <span class="ot">&lt;-</span> presnost</span>
<span id="cb121-102"><a href="simulační-studie.html#cb121-102" tabindex="-1"></a>    }</span>
<span id="cb121-103"><a href="simulační-studie.html#cb121-103" tabindex="-1"></a>  }</span>
<span id="cb121-104"><a href="simulační-studie.html#cb121-104" tabindex="-1"></a>  </span>
<span id="cb121-105"><a href="simulační-studie.html#cb121-105" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva K pres folds</span></span>
<span id="cb121-106"><a href="simulační-studie.html#cb121-106" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb121-107"><a href="simulační-studie.html#cb121-107" tabindex="-1"></a>  K.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(CV.results)</span>
<span id="cb121-108"><a href="simulační-studie.html#cb121-108" tabindex="-1"></a>  CV_RESULTS<span class="sc">$</span>KNN_K[sim] <span class="ot">&lt;-</span> K.opt</span>
<span id="cb121-109"><a href="simulační-studie.html#cb121-109" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb121-110"><a href="simulační-studie.html#cb121-110" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">K =</span> neighbours, <span class="at">CV =</span> CV.results)</span>
<span id="cb121-111"><a href="simulační-studie.html#cb121-111" tabindex="-1"></a>  </span>
<span id="cb121-112"><a href="simulační-studie.html#cb121-112" tabindex="-1"></a>  neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, <span class="at">fdataobj =</span> x.train, <span class="at">knn =</span> K.opt)</span>
<span id="cb121-113"><a href="simulační-studie.html#cb121-113" tabindex="-1"></a>  </span>
<span id="cb121-114"><a href="simulační-studie.html#cb121-114" tabindex="-1"></a>  <span class="co"># predikce</span></span>
<span id="cb121-115"><a href="simulační-studie.html#cb121-115" tabindex="-1"></a>  model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb121-116"><a href="simulační-studie.html#cb121-116" tabindex="-1"></a>                                  <span class="at">new.fdataobj =</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb121-117"><a href="simulační-studie.html#cb121-117" tabindex="-1"></a>  </span>
<span id="cb121-118"><a href="simulační-studie.html#cb121-118" tabindex="-1"></a>  presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.test)), model.neighb.predict) <span class="sc">|&gt;</span></span>
<span id="cb121-119"><a href="simulační-studie.html#cb121-119" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span></span>
<span id="cb121-120"><a href="simulační-studie.html#cb121-120" tabindex="-1"></a>    <span class="fu">diag</span>() <span class="sc">|&gt;</span></span>
<span id="cb121-121"><a href="simulační-studie.html#cb121-121" tabindex="-1"></a>    <span class="fu">sum</span>()</span>
<span id="cb121-122"><a href="simulační-studie.html#cb121-122" tabindex="-1"></a>  </span>
<span id="cb121-123"><a href="simulační-studie.html#cb121-123" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;KNN&#39;</span>, </span>
<span id="cb121-124"><a href="simulační-studie.html#cb121-124" tabindex="-1"></a>                        <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> neighb.model<span class="sc">$</span>max.prob,</span>
<span id="cb121-125"><a href="simulační-studie.html#cb121-125" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost)</span>
<span id="cb121-126"><a href="simulační-studie.html#cb121-126" tabindex="-1"></a>  </span>
<span id="cb121-127"><a href="simulační-studie.html#cb121-127" tabindex="-1"></a>  <span class="do">## 2) Lineární diskriminační analýza</span></span>
<span id="cb121-128"><a href="simulační-studie.html#cb121-128" tabindex="-1"></a>  </span>
<span id="cb121-129"><a href="simulační-studie.html#cb121-129" tabindex="-1"></a>  <span class="co"># analyza hlavnich komponent</span></span>
<span id="cb121-130"><a href="simulační-studie.html#cb121-130" tabindex="-1"></a>  data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> <span class="dv">10</span>) <span class="co"># nharm - maximalni pocet HK</span></span>
<span id="cb121-131"><a href="simulační-studie.html#cb121-131" tabindex="-1"></a>  nharm <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">cumsum</span>(data.PCA<span class="sc">$</span>varprop) <span class="sc">&gt;=</span> <span class="fl">0.9</span>)[<span class="dv">1</span>] <span class="co"># urceni p</span></span>
<span id="cb121-132"><a href="simulační-studie.html#cb121-132" tabindex="-1"></a>  </span>
<span id="cb121-133"><a href="simulační-studie.html#cb121-133" tabindex="-1"></a>  data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> nharm) </span>
<span id="cb121-134"><a href="simulační-studie.html#cb121-134" tabindex="-1"></a>  data.PCA.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA<span class="sc">$</span>scores) <span class="co"># skore prvnich p HK</span></span>
<span id="cb121-135"><a href="simulační-studie.html#cb121-135" tabindex="-1"></a>  data.PCA.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train) <span class="co"># prislusnost do trid</span></span>
<span id="cb121-136"><a href="simulační-studie.html#cb121-136" tabindex="-1"></a>  </span>
<span id="cb121-137"><a href="simulační-studie.html#cb121-137" tabindex="-1"></a>  <span class="co"># vypocet skoru testovacich funkci</span></span>
<span id="cb121-138"><a href="simulační-studie.html#cb121-138" tabindex="-1"></a>  scores <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> nharm, <span class="at">nrow =</span> <span class="fu">length</span>(Y.test)) <span class="co"># prazdna matice </span></span>
<span id="cb121-139"><a href="simulační-studie.html#cb121-139" tabindex="-1"></a>  </span>
<span id="cb121-140"><a href="simulační-studie.html#cb121-140" tabindex="-1"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(scores)[<span class="dv">1</span>]) {</span>
<span id="cb121-141"><a href="simulační-studie.html#cb121-141" tabindex="-1"></a>    xfd <span class="ot">=</span> X.test[k] <span class="sc">-</span> data.PCA<span class="sc">$</span>meanfd[<span class="dv">1</span>] <span class="co"># k-te pozorovani - prumerna funkce</span></span>
<span id="cb121-142"><a href="simulační-studie.html#cb121-142" tabindex="-1"></a>    scores[k, ] <span class="ot">=</span> <span class="fu">inprod</span>(xfd, data.PCA<span class="sc">$</span>harmonics) </span>
<span id="cb121-143"><a href="simulační-studie.html#cb121-143" tabindex="-1"></a>    <span class="co"># skalarni soucin rezidua a vlastnich funkci rho (funkcionalni hlavni komponenty)</span></span>
<span id="cb121-144"><a href="simulační-studie.html#cb121-144" tabindex="-1"></a>  }</span>
<span id="cb121-145"><a href="simulační-studie.html#cb121-145" tabindex="-1"></a>  </span>
<span id="cb121-146"><a href="simulační-studie.html#cb121-146" tabindex="-1"></a>  data.PCA.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(scores)</span>
<span id="cb121-147"><a href="simulační-studie.html#cb121-147" tabindex="-1"></a>  data.PCA.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb121-148"><a href="simulační-studie.html#cb121-148" tabindex="-1"></a>  <span class="fu">colnames</span>(data.PCA.test) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data.PCA.train) </span>
<span id="cb121-149"><a href="simulační-studie.html#cb121-149" tabindex="-1"></a>  </span>
<span id="cb121-150"><a href="simulační-studie.html#cb121-150" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb121-151"><a href="simulační-studie.html#cb121-151" tabindex="-1"></a>  clf.LDA <span class="ot">&lt;-</span> <span class="fu">lda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb121-152"><a href="simulační-studie.html#cb121-152" tabindex="-1"></a>  </span>
<span id="cb121-153"><a href="simulační-studie.html#cb121-153" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb121-154"><a href="simulační-studie.html#cb121-154" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb121-155"><a href="simulační-studie.html#cb121-155" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb121-156"><a href="simulační-studie.html#cb121-156" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-157"><a href="simulační-studie.html#cb121-157" tabindex="-1"></a>    </span>
<span id="cb121-158"><a href="simulační-studie.html#cb121-158" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb121-159"><a href="simulační-studie.html#cb121-159" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb121-160"><a href="simulační-studie.html#cb121-160" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb121-161"><a href="simulační-studie.html#cb121-161" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-162"><a href="simulační-studie.html#cb121-162" tabindex="-1"></a>  </span>
<span id="cb121-163"><a href="simulační-studie.html#cb121-163" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LDA&#39;</span>, </span>
<span id="cb121-164"><a href="simulační-studie.html#cb121-164" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb121-165"><a href="simulační-studie.html#cb121-165" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb121-166"><a href="simulační-studie.html#cb121-166" tabindex="-1"></a>  </span>
<span id="cb121-167"><a href="simulační-studie.html#cb121-167" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb121-168"><a href="simulační-studie.html#cb121-168" tabindex="-1"></a>  </span>
<span id="cb121-169"><a href="simulační-studie.html#cb121-169" tabindex="-1"></a>  <span class="do">## 3) Kvadratická diskriminační analýza</span></span>
<span id="cb121-170"><a href="simulační-studie.html#cb121-170" tabindex="-1"></a>  </span>
<span id="cb121-171"><a href="simulační-studie.html#cb121-171" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb121-172"><a href="simulační-studie.html#cb121-172" tabindex="-1"></a>  clf.QDA <span class="ot">&lt;-</span> <span class="fu">qda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb121-173"><a href="simulační-studie.html#cb121-173" tabindex="-1"></a>  </span>
<span id="cb121-174"><a href="simulační-studie.html#cb121-174" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb121-175"><a href="simulační-studie.html#cb121-175" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb121-176"><a href="simulační-studie.html#cb121-176" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb121-177"><a href="simulační-studie.html#cb121-177" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-178"><a href="simulační-studie.html#cb121-178" tabindex="-1"></a>    </span>
<span id="cb121-179"><a href="simulační-studie.html#cb121-179" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb121-180"><a href="simulační-studie.html#cb121-180" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb121-181"><a href="simulační-studie.html#cb121-181" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb121-182"><a href="simulační-studie.html#cb121-182" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-183"><a href="simulační-studie.html#cb121-183" tabindex="-1"></a>  </span>
<span id="cb121-184"><a href="simulační-studie.html#cb121-184" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;QDA&#39;</span>, </span>
<span id="cb121-185"><a href="simulační-studie.html#cb121-185" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb121-186"><a href="simulační-studie.html#cb121-186" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb121-187"><a href="simulační-studie.html#cb121-187" tabindex="-1"></a>  </span>
<span id="cb121-188"><a href="simulační-studie.html#cb121-188" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb121-189"><a href="simulační-studie.html#cb121-189" tabindex="-1"></a>  </span>
<span id="cb121-190"><a href="simulační-studie.html#cb121-190" tabindex="-1"></a>  <span class="do">## 4) Logistická regrese</span></span>
<span id="cb121-191"><a href="simulační-studie.html#cb121-191" tabindex="-1"></a>  <span class="do">### 4.1) Funkcionální logistická regrese</span></span>
<span id="cb121-192"><a href="simulační-studie.html#cb121-192" tabindex="-1"></a>  </span>
<span id="cb121-193"><a href="simulační-studie.html#cb121-193" tabindex="-1"></a>  <span class="co"># vytvorime vhodne objekty</span></span>
<span id="cb121-194"><a href="simulační-studie.html#cb121-194" tabindex="-1"></a>  x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb121-195"><a href="simulační-studie.html#cb121-195" tabindex="-1"></a>  y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Y.train)</span>
<span id="cb121-196"><a href="simulační-studie.html#cb121-196" tabindex="-1"></a>  </span>
<span id="cb121-197"><a href="simulační-studie.html#cb121-197" tabindex="-1"></a>  <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb121-198"><a href="simulační-studie.html#cb121-198" tabindex="-1"></a>  tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb121-199"><a href="simulační-studie.html#cb121-199" tabindex="-1"></a>  </span>
<span id="cb121-200"><a href="simulační-studie.html#cb121-200" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb121-201"><a href="simulační-studie.html#cb121-201" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb121-202"><a href="simulační-studie.html#cb121-202" tabindex="-1"></a>  <span class="co"># B-spline baze </span></span>
<span id="cb121-203"><a href="simulační-studie.html#cb121-203" tabindex="-1"></a>  basis1 <span class="ot">&lt;-</span> X.train<span class="sc">$</span>basis</span>
<span id="cb121-204"><a href="simulační-studie.html#cb121-204" tabindex="-1"></a>  </span>
<span id="cb121-205"><a href="simulační-studie.html#cb121-205" tabindex="-1"></a>  <span class="do">### 10-fold cross-validation</span></span>
<span id="cb121-206"><a href="simulační-studie.html#cb121-206" tabindex="-1"></a>  n.basis.max <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb121-207"><a href="simulační-studie.html#cb121-207" tabindex="-1"></a>  n.basis <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span>n.basis.max</span>
<span id="cb121-208"><a href="simulační-studie.html#cb121-208" tabindex="-1"></a>  k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb121-209"><a href="simulační-studie.html#cb121-209" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb121-210"><a href="simulační-studie.html#cb121-210" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb121-211"><a href="simulační-studie.html#cb121-211" tabindex="-1"></a>  <span class="do">## prvky, ktere se behem cyklu nemeni</span></span>
<span id="cb121-212"><a href="simulační-studie.html#cb121-212" tabindex="-1"></a>  <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb121-213"><a href="simulační-studie.html#cb121-213" tabindex="-1"></a>  tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb121-214"><a href="simulační-studie.html#cb121-214" tabindex="-1"></a>  rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(tt)</span>
<span id="cb121-215"><a href="simulační-studie.html#cb121-215" tabindex="-1"></a>  <span class="co"># B-spline baze </span></span>
<span id="cb121-216"><a href="simulační-studie.html#cb121-216" tabindex="-1"></a>  basis1 <span class="ot">&lt;-</span> X.train<span class="sc">$</span>basis</span>
<span id="cb121-217"><a href="simulační-studie.html#cb121-217" tabindex="-1"></a>  <span class="co"># vztah</span></span>
<span id="cb121-218"><a href="simulační-studie.html#cb121-218" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb121-219"><a href="simulační-studie.html#cb121-219" tabindex="-1"></a>  <span class="co"># baze pro x</span></span>
<span id="cb121-220"><a href="simulační-studie.html#cb121-220" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1)</span>
<span id="cb121-221"><a href="simulační-studie.html#cb121-221" tabindex="-1"></a>  </span>
<span id="cb121-222"><a href="simulační-studie.html#cb121-222" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(n.basis), <span class="at">ncol =</span> k_cv, </span>
<span id="cb121-223"><a href="simulační-studie.html#cb121-223" tabindex="-1"></a>                       <span class="at">dimnames =</span> <span class="fu">list</span>(n.basis, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb121-224"><a href="simulační-studie.html#cb121-224" tabindex="-1"></a>  </span>
<span id="cb121-225"><a href="simulační-studie.html#cb121-225" tabindex="-1"></a>  <span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb121-226"><a href="simulační-studie.html#cb121-226" tabindex="-1"></a>    <span class="co"># definujeme danou indexovou mnozinu</span></span>
<span id="cb121-227"><a href="simulační-studie.html#cb121-227" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb121-228"><a href="simulační-studie.html#cb121-228" tabindex="-1"></a>      </span>
<span id="cb121-229"><a href="simulační-studie.html#cb121-229" tabindex="-1"></a>    x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb121-230"><a href="simulační-studie.html#cb121-230" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb121-231"><a href="simulační-studie.html#cb121-231" tabindex="-1"></a>    y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb121-232"><a href="simulační-studie.html#cb121-232" tabindex="-1"></a>      <span class="fu">as.numeric</span>()</span>
<span id="cb121-233"><a href="simulační-studie.html#cb121-233" tabindex="-1"></a>    </span>
<span id="cb121-234"><a href="simulační-studie.html#cb121-234" tabindex="-1"></a>    x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb121-235"><a href="simulační-studie.html#cb121-235" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb121-236"><a href="simulační-studie.html#cb121-236" tabindex="-1"></a>    y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb121-237"><a href="simulační-studie.html#cb121-237" tabindex="-1"></a>      <span class="fu">as.numeric</span>()</span>
<span id="cb121-238"><a href="simulační-studie.html#cb121-238" tabindex="-1"></a>    </span>
<span id="cb121-239"><a href="simulační-studie.html#cb121-239" tabindex="-1"></a>    dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train.cv) </span>
<span id="cb121-240"><a href="simulační-studie.html#cb121-240" tabindex="-1"></a>    <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb121-241"><a href="simulační-studie.html#cb121-241" tabindex="-1"></a>    </span>
<span id="cb121-242"><a href="simulační-studie.html#cb121-242" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> n.basis) {</span>
<span id="cb121-243"><a href="simulační-studie.html#cb121-243" tabindex="-1"></a>      <span class="co"># baze pro bety</span></span>
<span id="cb121-244"><a href="simulační-studie.html#cb121-244" tabindex="-1"></a>      basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, <span class="at">nbasis =</span> i)</span>
<span id="cb121-245"><a href="simulační-studie.html#cb121-245" tabindex="-1"></a>      </span>
<span id="cb121-246"><a href="simulační-studie.html#cb121-246" tabindex="-1"></a>      basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb121-247"><a href="simulační-studie.html#cb121-247" tabindex="-1"></a>      <span class="co"># vstupni data do modelu</span></span>
<span id="cb121-248"><a href="simulační-studie.html#cb121-248" tabindex="-1"></a>      ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train.cv)</span>
<span id="cb121-249"><a href="simulační-studie.html#cb121-249" tabindex="-1"></a>      <span class="co"># binomicky model ... model logisticke regrese</span></span>
<span id="cb121-250"><a href="simulační-studie.html#cb121-250" tabindex="-1"></a>      model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb121-251"><a href="simulační-studie.html#cb121-251" tabindex="-1"></a>                              <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb121-252"><a href="simulační-studie.html#cb121-252" tabindex="-1"></a>      </span>
<span id="cb121-253"><a href="simulační-studie.html#cb121-253" tabindex="-1"></a>      <span class="co"># presnost na validacni casti </span></span>
<span id="cb121-254"><a href="simulační-studie.html#cb121-254" tabindex="-1"></a>      newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(y.test.cv), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb121-255"><a href="simulační-studie.html#cb121-255" tabindex="-1"></a>      predictions.valid <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb121-256"><a href="simulační-studie.html#cb121-256" tabindex="-1"></a>      predictions.valid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.valid <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb121-257"><a href="simulační-studie.html#cb121-257" tabindex="-1"></a>      presnost.valid <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, predictions.valid<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb121-258"><a href="simulační-studie.html#cb121-258" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-259"><a href="simulační-studie.html#cb121-259" tabindex="-1"></a>      </span>
<span id="cb121-260"><a href="simulační-studie.html#cb121-260" tabindex="-1"></a>      <span class="co"># vlozime do matice</span></span>
<span id="cb121-261"><a href="simulační-studie.html#cb121-261" tabindex="-1"></a>      CV.results[<span class="fu">as.character</span>(i), <span class="fu">as.character</span>(index)] <span class="ot">&lt;-</span> presnost.valid</span>
<span id="cb121-262"><a href="simulační-studie.html#cb121-262" tabindex="-1"></a>    } </span>
<span id="cb121-263"><a href="simulační-studie.html#cb121-263" tabindex="-1"></a>  }</span>
<span id="cb121-264"><a href="simulační-studie.html#cb121-264" tabindex="-1"></a>  </span>
<span id="cb121-265"><a href="simulační-studie.html#cb121-265" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva n pres folds</span></span>
<span id="cb121-266"><a href="simulační-studie.html#cb121-266" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb121-267"><a href="simulační-studie.html#cb121-267" tabindex="-1"></a>  n.basis.opt <span class="ot">&lt;-</span> n.basis[<span class="fu">which.max</span>(CV.results)]</span>
<span id="cb121-268"><a href="simulační-studie.html#cb121-268" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb121-269"><a href="simulační-studie.html#cb121-269" tabindex="-1"></a>  </span>
<span id="cb121-270"><a href="simulační-studie.html#cb121-270" tabindex="-1"></a>  <span class="co"># optimalni model</span></span>
<span id="cb121-271"><a href="simulační-studie.html#cb121-271" tabindex="-1"></a>  basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> n.basis.opt)</span>
<span id="cb121-272"><a href="simulační-studie.html#cb121-272" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb121-273"><a href="simulační-studie.html#cb121-273" tabindex="-1"></a>  <span class="co"># baze pro x a bety</span></span>
<span id="cb121-274"><a href="simulační-studie.html#cb121-274" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb121-275"><a href="simulační-studie.html#cb121-275" tabindex="-1"></a>  basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb121-276"><a href="simulační-studie.html#cb121-276" tabindex="-1"></a>  <span class="co"># vstupni data do modelu</span></span>
<span id="cb121-277"><a href="simulační-studie.html#cb121-277" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb121-278"><a href="simulační-studie.html#cb121-278" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb121-279"><a href="simulační-studie.html#cb121-279" tabindex="-1"></a>  ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb121-280"><a href="simulační-studie.html#cb121-280" tabindex="-1"></a>  <span class="co"># binomicky model ... model logisticke regrese</span></span>
<span id="cb121-281"><a href="simulační-studie.html#cb121-281" tabindex="-1"></a>  model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb121-282"><a href="simulační-studie.html#cb121-282" tabindex="-1"></a>                          <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb121-283"><a href="simulační-studie.html#cb121-283" tabindex="-1"></a>  </span>
<span id="cb121-284"><a href="simulační-studie.html#cb121-284" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb121-285"><a href="simulační-studie.html#cb121-285" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> ldata)</span>
<span id="cb121-286"><a href="simulační-studie.html#cb121-286" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb121-287"><a href="simulační-studie.html#cb121-287" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb121-288"><a href="simulační-studie.html#cb121-288" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-289"><a href="simulační-studie.html#cb121-289" tabindex="-1"></a>    </span>
<span id="cb121-290"><a href="simulační-studie.html#cb121-290" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb121-291"><a href="simulační-studie.html#cb121-291" tabindex="-1"></a>  newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(Y.test), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb121-292"><a href="simulační-studie.html#cb121-292" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb121-293"><a href="simulační-studie.html#cb121-293" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb121-294"><a href="simulační-studie.html#cb121-294" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb121-295"><a href="simulační-studie.html#cb121-295" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-296"><a href="simulační-studie.html#cb121-296" tabindex="-1"></a>  </span>
<span id="cb121-297"><a href="simulační-studie.html#cb121-297" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR_functional&#39;</span>, </span>
<span id="cb121-298"><a href="simulační-studie.html#cb121-298" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb121-299"><a href="simulační-studie.html#cb121-299" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb121-300"><a href="simulační-studie.html#cb121-300" tabindex="-1"></a>  </span>
<span id="cb121-301"><a href="simulační-studie.html#cb121-301" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb121-302"><a href="simulační-studie.html#cb121-302" tabindex="-1"></a>  </span>
<span id="cb121-303"><a href="simulační-studie.html#cb121-303" tabindex="-1"></a>  <span class="do">### 4.2) Logistická regrese s analýzou hlavních komponent</span></span>
<span id="cb121-304"><a href="simulační-studie.html#cb121-304" tabindex="-1"></a>  </span>
<span id="cb121-305"><a href="simulační-studie.html#cb121-305" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb121-306"><a href="simulační-studie.html#cb121-306" tabindex="-1"></a>  clf.LR <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span>  ., <span class="at">data =</span> data.PCA.train, <span class="at">family =</span> binomial)</span>
<span id="cb121-307"><a href="simulační-studie.html#cb121-307" tabindex="-1"></a>  </span>
<span id="cb121-308"><a href="simulační-studie.html#cb121-308" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb121-309"><a href="simulační-studie.html#cb121-309" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.train, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb121-310"><a href="simulační-studie.html#cb121-310" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb121-311"><a href="simulační-studie.html#cb121-311" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb121-312"><a href="simulační-studie.html#cb121-312" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-313"><a href="simulační-studie.html#cb121-313" tabindex="-1"></a>    </span>
<span id="cb121-314"><a href="simulační-studie.html#cb121-314" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb121-315"><a href="simulační-studie.html#cb121-315" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.test, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb121-316"><a href="simulační-studie.html#cb121-316" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb121-317"><a href="simulační-studie.html#cb121-317" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb121-318"><a href="simulační-studie.html#cb121-318" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-319"><a href="simulační-studie.html#cb121-319" tabindex="-1"></a>  </span>
<span id="cb121-320"><a href="simulační-studie.html#cb121-320" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR_score&#39;</span>, </span>
<span id="cb121-321"><a href="simulační-studie.html#cb121-321" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb121-322"><a href="simulační-studie.html#cb121-322" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb121-323"><a href="simulační-studie.html#cb121-323" tabindex="-1"></a>  </span>
<span id="cb121-324"><a href="simulační-studie.html#cb121-324" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb121-325"><a href="simulační-studie.html#cb121-325" tabindex="-1"></a>  </span>
<span id="cb121-326"><a href="simulační-studie.html#cb121-326" tabindex="-1"></a>  <span class="do">## 5) Rozhodovací stromy</span></span>
<span id="cb121-327"><a href="simulační-studie.html#cb121-327" tabindex="-1"></a>  <span class="do">### 5.1) Diskretizace intervalu</span></span>
<span id="cb121-328"><a href="simulační-studie.html#cb121-328" tabindex="-1"></a>  </span>
<span id="cb121-329"><a href="simulační-studie.html#cb121-329" tabindex="-1"></a>  <span class="co"># posloupnost bodu, ve kterych funkce vyhodnotime</span></span>
<span id="cb121-330"><a href="simulační-studie.html#cb121-330" tabindex="-1"></a>  t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">101</span>)</span>
<span id="cb121-331"><a href="simulační-studie.html#cb121-331" tabindex="-1"></a>     </span>
<span id="cb121-332"><a href="simulační-studie.html#cb121-332" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb121-333"><a href="simulační-studie.html#cb121-333" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) <span class="co"># transpozice kvuli funkcim v radku</span></span>
<span id="cb121-334"><a href="simulační-studie.html#cb121-334" tabindex="-1"></a>  grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb121-335"><a href="simulační-studie.html#cb121-335" tabindex="-1"></a>  </span>
<span id="cb121-336"><a href="simulační-studie.html#cb121-336" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb121-337"><a href="simulační-studie.html#cb121-337" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb121-338"><a href="simulační-studie.html#cb121-338" tabindex="-1"></a>  grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb121-339"><a href="simulační-studie.html#cb121-339" tabindex="-1"></a>  </span>
<span id="cb121-340"><a href="simulační-studie.html#cb121-340" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb121-341"><a href="simulační-studie.html#cb121-341" tabindex="-1"></a>  clf.tree <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb121-342"><a href="simulační-studie.html#cb121-342" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb121-343"><a href="simulační-studie.html#cb121-343" tabindex="-1"></a>                   <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb121-344"><a href="simulační-studie.html#cb121-344" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb121-345"><a href="simulační-studie.html#cb121-345" tabindex="-1"></a>  </span>
<span id="cb121-346"><a href="simulační-studie.html#cb121-346" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb121-347"><a href="simulační-studie.html#cb121-347" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data)</span>
<span id="cb121-348"><a href="simulační-studie.html#cb121-348" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb121-349"><a href="simulační-studie.html#cb121-349" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-350"><a href="simulační-studie.html#cb121-350" tabindex="-1"></a>    </span>
<span id="cb121-351"><a href="simulační-studie.html#cb121-351" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb121-352"><a href="simulační-studie.html#cb121-352" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb121-353"><a href="simulační-studie.html#cb121-353" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb121-354"><a href="simulační-studie.html#cb121-354" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-355"><a href="simulační-studie.html#cb121-355" tabindex="-1"></a>  </span>
<span id="cb121-356"><a href="simulační-studie.html#cb121-356" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree_discr&#39;</span>, </span>
<span id="cb121-357"><a href="simulační-studie.html#cb121-357" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb121-358"><a href="simulační-studie.html#cb121-358" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb121-359"><a href="simulační-studie.html#cb121-359" tabindex="-1"></a>  </span>
<span id="cb121-360"><a href="simulační-studie.html#cb121-360" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb121-361"><a href="simulační-studie.html#cb121-361" tabindex="-1"></a>  </span>
<span id="cb121-362"><a href="simulační-studie.html#cb121-362" tabindex="-1"></a>  <span class="do">### 5.2) Skóre hlavních komponent</span></span>
<span id="cb121-363"><a href="simulační-studie.html#cb121-363" tabindex="-1"></a>  </span>
<span id="cb121-364"><a href="simulační-studie.html#cb121-364" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb121-365"><a href="simulační-studie.html#cb121-365" tabindex="-1"></a>  clf.tree.PCA <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb121-366"><a href="simulační-studie.html#cb121-366" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb121-367"><a href="simulační-studie.html#cb121-367" tabindex="-1"></a>                   <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb121-368"><a href="simulační-studie.html#cb121-368" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb121-369"><a href="simulační-studie.html#cb121-369" tabindex="-1"></a>  </span>
<span id="cb121-370"><a href="simulační-studie.html#cb121-370" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb121-371"><a href="simulační-studie.html#cb121-371" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb121-372"><a href="simulační-studie.html#cb121-372" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb121-373"><a href="simulační-studie.html#cb121-373" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-374"><a href="simulační-studie.html#cb121-374" tabindex="-1"></a>    </span>
<span id="cb121-375"><a href="simulační-studie.html#cb121-375" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb121-376"><a href="simulační-studie.html#cb121-376" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb121-377"><a href="simulační-studie.html#cb121-377" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb121-378"><a href="simulační-studie.html#cb121-378" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-379"><a href="simulační-studie.html#cb121-379" tabindex="-1"></a>  </span>
<span id="cb121-380"><a href="simulační-studie.html#cb121-380" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree_score&#39;</span>, </span>
<span id="cb121-381"><a href="simulační-studie.html#cb121-381" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb121-382"><a href="simulační-studie.html#cb121-382" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb121-383"><a href="simulační-studie.html#cb121-383" tabindex="-1"></a>  </span>
<span id="cb121-384"><a href="simulační-studie.html#cb121-384" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb121-385"><a href="simulační-studie.html#cb121-385" tabindex="-1"></a>  </span>
<span id="cb121-386"><a href="simulační-studie.html#cb121-386" tabindex="-1"></a>  <span class="do">### 5.3) Bázové koeficienty</span></span>
<span id="cb121-387"><a href="simulační-studie.html#cb121-387" tabindex="-1"></a>  </span>
<span id="cb121-388"><a href="simulační-studie.html#cb121-388" tabindex="-1"></a>  <span class="co"># trenovaci dataset</span></span>
<span id="cb121-389"><a href="simulační-studie.html#cb121-389" tabindex="-1"></a>  data.Bbasis.train <span class="ot">&lt;-</span> <span class="fu">t</span>(X.train<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb121-390"><a href="simulační-studie.html#cb121-390" tabindex="-1"></a>  data.Bbasis.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb121-391"><a href="simulační-studie.html#cb121-391" tabindex="-1"></a>  </span>
<span id="cb121-392"><a href="simulační-studie.html#cb121-392" tabindex="-1"></a>  <span class="co"># testovaci dataset</span></span>
<span id="cb121-393"><a href="simulační-studie.html#cb121-393" tabindex="-1"></a>  data.Bbasis.test <span class="ot">&lt;-</span> <span class="fu">t</span>(X.test<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb121-394"><a href="simulační-studie.html#cb121-394" tabindex="-1"></a>  data.Bbasis.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb121-395"><a href="simulační-studie.html#cb121-395" tabindex="-1"></a>  </span>
<span id="cb121-396"><a href="simulační-studie.html#cb121-396" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb121-397"><a href="simulační-studie.html#cb121-397" tabindex="-1"></a>  clf.tree.Bbasis <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb121-398"><a href="simulační-studie.html#cb121-398" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb121-399"><a href="simulační-studie.html#cb121-399" tabindex="-1"></a>                   <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb121-400"><a href="simulační-studie.html#cb121-400" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb121-401"><a href="simulační-studie.html#cb121-401" tabindex="-1"></a>  </span>
<span id="cb121-402"><a href="simulační-studie.html#cb121-402" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb121-403"><a href="simulační-studie.html#cb121-403" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb121-404"><a href="simulační-studie.html#cb121-404" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb121-405"><a href="simulační-studie.html#cb121-405" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-406"><a href="simulační-studie.html#cb121-406" tabindex="-1"></a>    </span>
<span id="cb121-407"><a href="simulační-studie.html#cb121-407" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb121-408"><a href="simulační-studie.html#cb121-408" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb121-409"><a href="simulační-studie.html#cb121-409" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb121-410"><a href="simulační-studie.html#cb121-410" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-411"><a href="simulační-studie.html#cb121-411" tabindex="-1"></a>  </span>
<span id="cb121-412"><a href="simulační-studie.html#cb121-412" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree_Bbasis&#39;</span>, </span>
<span id="cb121-413"><a href="simulační-studie.html#cb121-413" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb121-414"><a href="simulační-studie.html#cb121-414" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb121-415"><a href="simulační-studie.html#cb121-415" tabindex="-1"></a>  </span>
<span id="cb121-416"><a href="simulační-studie.html#cb121-416" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb121-417"><a href="simulační-studie.html#cb121-417" tabindex="-1"></a>  </span>
<span id="cb121-418"><a href="simulační-studie.html#cb121-418" tabindex="-1"></a>  <span class="do">## 6) Náhodné lesy</span></span>
<span id="cb121-419"><a href="simulační-studie.html#cb121-419" tabindex="-1"></a>  </span>
<span id="cb121-420"><a href="simulační-studie.html#cb121-420" tabindex="-1"></a>  <span class="do">### 6.1) Diskretizace intervalu</span></span>
<span id="cb121-421"><a href="simulační-studie.html#cb121-421" tabindex="-1"></a>  </span>
<span id="cb121-422"><a href="simulační-studie.html#cb121-422" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb121-423"><a href="simulační-studie.html#cb121-423" tabindex="-1"></a>  clf.RF <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb121-424"><a href="simulační-studie.html#cb121-424" tabindex="-1"></a>                         <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb121-425"><a href="simulační-studie.html#cb121-425" tabindex="-1"></a>                         <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb121-426"><a href="simulační-studie.html#cb121-426" tabindex="-1"></a>                         <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb121-427"><a href="simulační-studie.html#cb121-427" tabindex="-1"></a>  </span>
<span id="cb121-428"><a href="simulační-studie.html#cb121-428" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb121-429"><a href="simulační-studie.html#cb121-429" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data)</span>
<span id="cb121-430"><a href="simulační-studie.html#cb121-430" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb121-431"><a href="simulační-studie.html#cb121-431" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-432"><a href="simulační-studie.html#cb121-432" tabindex="-1"></a>    </span>
<span id="cb121-433"><a href="simulační-studie.html#cb121-433" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb121-434"><a href="simulační-studie.html#cb121-434" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb121-435"><a href="simulační-studie.html#cb121-435" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb121-436"><a href="simulační-studie.html#cb121-436" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-437"><a href="simulační-studie.html#cb121-437" tabindex="-1"></a>  </span>
<span id="cb121-438"><a href="simulační-studie.html#cb121-438" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_discr&#39;</span>, </span>
<span id="cb121-439"><a href="simulační-studie.html#cb121-439" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb121-440"><a href="simulační-studie.html#cb121-440" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb121-441"><a href="simulační-studie.html#cb121-441" tabindex="-1"></a>  </span>
<span id="cb121-442"><a href="simulační-studie.html#cb121-442" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb121-443"><a href="simulační-studie.html#cb121-443" tabindex="-1"></a>  </span>
<span id="cb121-444"><a href="simulační-studie.html#cb121-444" tabindex="-1"></a>  <span class="do">### 6.2) Skóre hlavních komponent</span></span>
<span id="cb121-445"><a href="simulační-studie.html#cb121-445" tabindex="-1"></a>  </span>
<span id="cb121-446"><a href="simulační-studie.html#cb121-446" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb121-447"><a href="simulační-studie.html#cb121-447" tabindex="-1"></a>  clf.RF.PCA <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb121-448"><a href="simulační-studie.html#cb121-448" tabindex="-1"></a>                             <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb121-449"><a href="simulační-studie.html#cb121-449" tabindex="-1"></a>                             <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb121-450"><a href="simulační-studie.html#cb121-450" tabindex="-1"></a>                             <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb121-451"><a href="simulační-studie.html#cb121-451" tabindex="-1"></a>  </span>
<span id="cb121-452"><a href="simulační-studie.html#cb121-452" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb121-453"><a href="simulační-studie.html#cb121-453" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb121-454"><a href="simulační-studie.html#cb121-454" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb121-455"><a href="simulační-studie.html#cb121-455" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-456"><a href="simulační-studie.html#cb121-456" tabindex="-1"></a>    </span>
<span id="cb121-457"><a href="simulační-studie.html#cb121-457" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb121-458"><a href="simulační-studie.html#cb121-458" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb121-459"><a href="simulační-studie.html#cb121-459" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb121-460"><a href="simulační-studie.html#cb121-460" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-461"><a href="simulační-studie.html#cb121-461" tabindex="-1"></a>  </span>
<span id="cb121-462"><a href="simulační-studie.html#cb121-462" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_score&#39;</span>, </span>
<span id="cb121-463"><a href="simulační-studie.html#cb121-463" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb121-464"><a href="simulační-studie.html#cb121-464" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb121-465"><a href="simulační-studie.html#cb121-465" tabindex="-1"></a>  </span>
<span id="cb121-466"><a href="simulační-studie.html#cb121-466" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb121-467"><a href="simulační-studie.html#cb121-467" tabindex="-1"></a>  </span>
<span id="cb121-468"><a href="simulační-studie.html#cb121-468" tabindex="-1"></a>  <span class="do">### 6.3) Bázové koeficienty</span></span>
<span id="cb121-469"><a href="simulační-studie.html#cb121-469" tabindex="-1"></a>  </span>
<span id="cb121-470"><a href="simulační-studie.html#cb121-470" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb121-471"><a href="simulační-studie.html#cb121-471" tabindex="-1"></a>  clf.RF.Bbasis <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb121-472"><a href="simulační-studie.html#cb121-472" tabindex="-1"></a>                                <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb121-473"><a href="simulační-studie.html#cb121-473" tabindex="-1"></a>                                <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb121-474"><a href="simulační-studie.html#cb121-474" tabindex="-1"></a>                                <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb121-475"><a href="simulační-studie.html#cb121-475" tabindex="-1"></a>  </span>
<span id="cb121-476"><a href="simulační-studie.html#cb121-476" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb121-477"><a href="simulační-studie.html#cb121-477" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb121-478"><a href="simulační-studie.html#cb121-478" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb121-479"><a href="simulační-studie.html#cb121-479" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-480"><a href="simulační-studie.html#cb121-480" tabindex="-1"></a>    </span>
<span id="cb121-481"><a href="simulační-studie.html#cb121-481" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb121-482"><a href="simulační-studie.html#cb121-482" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb121-483"><a href="simulační-studie.html#cb121-483" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb121-484"><a href="simulační-studie.html#cb121-484" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-485"><a href="simulační-studie.html#cb121-485" tabindex="-1"></a>  </span>
<span id="cb121-486"><a href="simulační-studie.html#cb121-486" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_Bbasis&#39;</span>, </span>
<span id="cb121-487"><a href="simulační-studie.html#cb121-487" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb121-488"><a href="simulační-studie.html#cb121-488" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb121-489"><a href="simulační-studie.html#cb121-489" tabindex="-1"></a>  </span>
<span id="cb121-490"><a href="simulační-studie.html#cb121-490" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb121-491"><a href="simulační-studie.html#cb121-491" tabindex="-1"></a>  </span>
<span id="cb121-492"><a href="simulační-studie.html#cb121-492" tabindex="-1"></a>  <span class="do">## 7) SVM</span></span>
<span id="cb121-493"><a href="simulační-studie.html#cb121-493" tabindex="-1"></a>  </span>
<span id="cb121-494"><a href="simulační-studie.html#cb121-494" tabindex="-1"></a>  <span class="do">### 7.1) Diskretizace intervalu</span></span>
<span id="cb121-495"><a href="simulační-studie.html#cb121-495" tabindex="-1"></a>  </span>
<span id="cb121-496"><a href="simulační-studie.html#cb121-496" tabindex="-1"></a>  clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb121-497"><a href="simulační-studie.html#cb121-497" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb121-498"><a href="simulační-studie.html#cb121-498" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb121-499"><a href="simulační-studie.html#cb121-499" tabindex="-1"></a>                   <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb121-500"><a href="simulační-studie.html#cb121-500" tabindex="-1"></a>  </span>
<span id="cb121-501"><a href="simulační-studie.html#cb121-501" tabindex="-1"></a>  clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb121-502"><a href="simulační-studie.html#cb121-502" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb121-503"><a href="simulační-studie.html#cb121-503" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb121-504"><a href="simulační-studie.html#cb121-504" tabindex="-1"></a>                   <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb121-505"><a href="simulační-studie.html#cb121-505" tabindex="-1"></a>  </span>
<span id="cb121-506"><a href="simulační-studie.html#cb121-506" tabindex="-1"></a>  clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb121-507"><a href="simulační-studie.html#cb121-507" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb121-508"><a href="simulační-studie.html#cb121-508" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb121-509"><a href="simulační-studie.html#cb121-509" tabindex="-1"></a>                   <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb121-510"><a href="simulační-studie.html#cb121-510" tabindex="-1"></a>  </span>
<span id="cb121-511"><a href="simulační-studie.html#cb121-511" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb121-512"><a href="simulační-studie.html#cb121-512" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data)</span>
<span id="cb121-513"><a href="simulační-studie.html#cb121-513" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb121-514"><a href="simulační-studie.html#cb121-514" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-515"><a href="simulační-studie.html#cb121-515" tabindex="-1"></a>  </span>
<span id="cb121-516"><a href="simulační-studie.html#cb121-516" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data)</span>
<span id="cb121-517"><a href="simulační-studie.html#cb121-517" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb121-518"><a href="simulační-studie.html#cb121-518" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-519"><a href="simulační-studie.html#cb121-519" tabindex="-1"></a>  </span>
<span id="cb121-520"><a href="simulační-studie.html#cb121-520" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data)</span>
<span id="cb121-521"><a href="simulační-studie.html#cb121-521" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb121-522"><a href="simulační-studie.html#cb121-522" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-523"><a href="simulační-studie.html#cb121-523" tabindex="-1"></a>  </span>
<span id="cb121-524"><a href="simulační-studie.html#cb121-524" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb121-525"><a href="simulační-studie.html#cb121-525" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb121-526"><a href="simulační-studie.html#cb121-526" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb121-527"><a href="simulační-studie.html#cb121-527" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-528"><a href="simulační-studie.html#cb121-528" tabindex="-1"></a>  </span>
<span id="cb121-529"><a href="simulační-studie.html#cb121-529" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb121-530"><a href="simulační-studie.html#cb121-530" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb121-531"><a href="simulační-studie.html#cb121-531" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-532"><a href="simulační-studie.html#cb121-532" tabindex="-1"></a>  </span>
<span id="cb121-533"><a href="simulační-studie.html#cb121-533" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb121-534"><a href="simulační-studie.html#cb121-534" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb121-535"><a href="simulační-studie.html#cb121-535" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-536"><a href="simulační-studie.html#cb121-536" tabindex="-1"></a>  </span>
<span id="cb121-537"><a href="simulační-studie.html#cb121-537" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - diskr&#39;</span>, </span>
<span id="cb121-538"><a href="simulační-studie.html#cb121-538" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - diskr&#39;</span>, </span>
<span id="cb121-539"><a href="simulační-studie.html#cb121-539" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - diskr&#39;</span>), </span>
<span id="cb121-540"><a href="simulační-studie.html#cb121-540" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l,</span>
<span id="cb121-541"><a href="simulační-studie.html#cb121-541" tabindex="-1"></a>                                      presnost.train.p, presnost.train.r),</span>
<span id="cb121-542"><a href="simulační-studie.html#cb121-542" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb121-543"><a href="simulační-studie.html#cb121-543" tabindex="-1"></a>                                     presnost.test.p, presnost.test.r))</span>
<span id="cb121-544"><a href="simulační-studie.html#cb121-544" tabindex="-1"></a>  </span>
<span id="cb121-545"><a href="simulační-studie.html#cb121-545" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb121-546"><a href="simulační-studie.html#cb121-546" tabindex="-1"></a>  </span>
<span id="cb121-547"><a href="simulační-studie.html#cb121-547" tabindex="-1"></a>  <span class="do">### 7.2) Skóre hlavních komponent</span></span>
<span id="cb121-548"><a href="simulační-studie.html#cb121-548" tabindex="-1"></a>  </span>
<span id="cb121-549"><a href="simulační-studie.html#cb121-549" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb121-550"><a href="simulační-studie.html#cb121-550" tabindex="-1"></a>  clf.SVM.l.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb121-551"><a href="simulační-studie.html#cb121-551" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb121-552"><a href="simulační-studie.html#cb121-552" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb121-553"><a href="simulační-studie.html#cb121-553" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb121-554"><a href="simulační-studie.html#cb121-554" tabindex="-1"></a>  </span>
<span id="cb121-555"><a href="simulační-studie.html#cb121-555" tabindex="-1"></a>  clf.SVM.p.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb121-556"><a href="simulační-studie.html#cb121-556" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb121-557"><a href="simulační-studie.html#cb121-557" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb121-558"><a href="simulační-studie.html#cb121-558" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb121-559"><a href="simulační-studie.html#cb121-559" tabindex="-1"></a>  </span>
<span id="cb121-560"><a href="simulační-studie.html#cb121-560" tabindex="-1"></a>  clf.SVM.r.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb121-561"><a href="simulační-studie.html#cb121-561" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb121-562"><a href="simulační-studie.html#cb121-562" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb121-563"><a href="simulační-studie.html#cb121-563" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb121-564"><a href="simulační-studie.html#cb121-564" tabindex="-1"></a>  </span>
<span id="cb121-565"><a href="simulační-studie.html#cb121-565" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb121-566"><a href="simulační-studie.html#cb121-566" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb121-567"><a href="simulační-studie.html#cb121-567" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb121-568"><a href="simulační-studie.html#cb121-568" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-569"><a href="simulační-studie.html#cb121-569" tabindex="-1"></a>  </span>
<span id="cb121-570"><a href="simulační-studie.html#cb121-570" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb121-571"><a href="simulační-studie.html#cb121-571" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb121-572"><a href="simulační-studie.html#cb121-572" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-573"><a href="simulační-studie.html#cb121-573" tabindex="-1"></a>  </span>
<span id="cb121-574"><a href="simulační-studie.html#cb121-574" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb121-575"><a href="simulační-studie.html#cb121-575" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb121-576"><a href="simulační-studie.html#cb121-576" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-577"><a href="simulační-studie.html#cb121-577" tabindex="-1"></a>    </span>
<span id="cb121-578"><a href="simulační-studie.html#cb121-578" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb121-579"><a href="simulační-studie.html#cb121-579" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb121-580"><a href="simulační-studie.html#cb121-580" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb121-581"><a href="simulační-studie.html#cb121-581" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-582"><a href="simulační-studie.html#cb121-582" tabindex="-1"></a>  </span>
<span id="cb121-583"><a href="simulační-studie.html#cb121-583" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb121-584"><a href="simulační-studie.html#cb121-584" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb121-585"><a href="simulační-studie.html#cb121-585" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-586"><a href="simulační-studie.html#cb121-586" tabindex="-1"></a>  </span>
<span id="cb121-587"><a href="simulační-studie.html#cb121-587" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb121-588"><a href="simulační-studie.html#cb121-588" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb121-589"><a href="simulační-studie.html#cb121-589" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-590"><a href="simulační-studie.html#cb121-590" tabindex="-1"></a>  </span>
<span id="cb121-591"><a href="simulační-studie.html#cb121-591" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - PCA&#39;</span>, </span>
<span id="cb121-592"><a href="simulační-studie.html#cb121-592" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - PCA&#39;</span>, </span>
<span id="cb121-593"><a href="simulační-studie.html#cb121-593" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - PCA&#39;</span>), </span>
<span id="cb121-594"><a href="simulační-studie.html#cb121-594" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, </span>
<span id="cb121-595"><a href="simulační-studie.html#cb121-595" tabindex="-1"></a>                                      presnost.train.p, presnost.train.r),</span>
<span id="cb121-596"><a href="simulační-studie.html#cb121-596" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb121-597"><a href="simulační-studie.html#cb121-597" tabindex="-1"></a>                                     presnost.test.p, presnost.test.r))</span>
<span id="cb121-598"><a href="simulační-studie.html#cb121-598" tabindex="-1"></a>  </span>
<span id="cb121-599"><a href="simulační-studie.html#cb121-599" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb121-600"><a href="simulační-studie.html#cb121-600" tabindex="-1"></a>  </span>
<span id="cb121-601"><a href="simulační-studie.html#cb121-601" tabindex="-1"></a>  <span class="do">### 7.3) Bázové koeficienty</span></span>
<span id="cb121-602"><a href="simulační-studie.html#cb121-602" tabindex="-1"></a>  </span>
<span id="cb121-603"><a href="simulační-studie.html#cb121-603" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb121-604"><a href="simulační-studie.html#cb121-604" tabindex="-1"></a>  clf.SVM.l.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb121-605"><a href="simulační-studie.html#cb121-605" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb121-606"><a href="simulační-studie.html#cb121-606" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb121-607"><a href="simulační-studie.html#cb121-607" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb121-608"><a href="simulační-studie.html#cb121-608" tabindex="-1"></a>  </span>
<span id="cb121-609"><a href="simulační-studie.html#cb121-609" tabindex="-1"></a>  clf.SVM.p.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb121-610"><a href="simulační-studie.html#cb121-610" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb121-611"><a href="simulační-studie.html#cb121-611" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb121-612"><a href="simulační-studie.html#cb121-612" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb121-613"><a href="simulační-studie.html#cb121-613" tabindex="-1"></a>  </span>
<span id="cb121-614"><a href="simulační-studie.html#cb121-614" tabindex="-1"></a>  clf.SVM.r.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb121-615"><a href="simulační-studie.html#cb121-615" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb121-616"><a href="simulační-studie.html#cb121-616" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb121-617"><a href="simulační-studie.html#cb121-617" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb121-618"><a href="simulační-studie.html#cb121-618" tabindex="-1"></a>  </span>
<span id="cb121-619"><a href="simulační-studie.html#cb121-619" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb121-620"><a href="simulační-studie.html#cb121-620" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb121-621"><a href="simulační-studie.html#cb121-621" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb121-622"><a href="simulační-studie.html#cb121-622" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-623"><a href="simulační-studie.html#cb121-623" tabindex="-1"></a>  </span>
<span id="cb121-624"><a href="simulační-studie.html#cb121-624" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb121-625"><a href="simulační-studie.html#cb121-625" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb121-626"><a href="simulační-studie.html#cb121-626" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-627"><a href="simulační-studie.html#cb121-627" tabindex="-1"></a>  </span>
<span id="cb121-628"><a href="simulační-studie.html#cb121-628" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb121-629"><a href="simulační-studie.html#cb121-629" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb121-630"><a href="simulační-studie.html#cb121-630" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-631"><a href="simulační-studie.html#cb121-631" tabindex="-1"></a>    </span>
<span id="cb121-632"><a href="simulační-studie.html#cb121-632" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb121-633"><a href="simulační-studie.html#cb121-633" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb121-634"><a href="simulační-studie.html#cb121-634" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb121-635"><a href="simulační-studie.html#cb121-635" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-636"><a href="simulační-studie.html#cb121-636" tabindex="-1"></a>  </span>
<span id="cb121-637"><a href="simulační-studie.html#cb121-637" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb121-638"><a href="simulační-studie.html#cb121-638" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb121-639"><a href="simulační-studie.html#cb121-639" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-640"><a href="simulační-studie.html#cb121-640" tabindex="-1"></a>  </span>
<span id="cb121-641"><a href="simulační-studie.html#cb121-641" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb121-642"><a href="simulační-studie.html#cb121-642" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb121-643"><a href="simulační-studie.html#cb121-643" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-644"><a href="simulační-studie.html#cb121-644" tabindex="-1"></a>  </span>
<span id="cb121-645"><a href="simulační-studie.html#cb121-645" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - Bbasis&#39;</span>, </span>
<span id="cb121-646"><a href="simulační-studie.html#cb121-646" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - Bbasis&#39;</span>, </span>
<span id="cb121-647"><a href="simulační-studie.html#cb121-647" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - Bbasis&#39;</span>), </span>
<span id="cb121-648"><a href="simulační-studie.html#cb121-648" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, </span>
<span id="cb121-649"><a href="simulační-studie.html#cb121-649" tabindex="-1"></a>                                      presnost.train.p, presnost.train.r),</span>
<span id="cb121-650"><a href="simulační-studie.html#cb121-650" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb121-651"><a href="simulační-studie.html#cb121-651" tabindex="-1"></a>                                     presnost.test.p, presnost.test.r))</span>
<span id="cb121-652"><a href="simulační-studie.html#cb121-652" tabindex="-1"></a></span>
<span id="cb121-653"><a href="simulační-studie.html#cb121-653" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb121-654"><a href="simulační-studie.html#cb121-654" tabindex="-1"></a>  </span>
<span id="cb121-655"><a href="simulační-studie.html#cb121-655" tabindex="-1"></a>  <span class="do">### 7.4) Projekce na B-splinovou bázi</span></span>
<span id="cb121-656"><a href="simulační-studie.html#cb121-656" tabindex="-1"></a>  </span>
<span id="cb121-657"><a href="simulační-studie.html#cb121-657" tabindex="-1"></a>  <span class="co"># hodnoty pro B-splinovou bazi</span></span>
<span id="cb121-658"><a href="simulační-studie.html#cb121-658" tabindex="-1"></a>  rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb121-659"><a href="simulační-studie.html#cb121-659" tabindex="-1"></a>  norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb121-660"><a href="simulační-studie.html#cb121-660" tabindex="-1"></a>  n_basis_min <span class="ot">&lt;-</span> norder</span>
<span id="cb121-661"><a href="simulační-studie.html#cb121-661" tabindex="-1"></a>  n_basis_max <span class="ot">&lt;-</span> <span class="fu">length</span>(t) <span class="sc">+</span> norder <span class="sc">-</span> <span class="dv">2</span> <span class="sc">-</span> <span class="dv">10</span></span>
<span id="cb121-662"><a href="simulační-studie.html#cb121-662" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> n_basis_min<span class="sc">:</span>n_basis_max </span>
<span id="cb121-663"><a href="simulační-studie.html#cb121-663" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb121-664"><a href="simulační-studie.html#cb121-664" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">SVM.l =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb121-665"><a href="simulační-studie.html#cb121-665" tabindex="-1"></a>                     <span class="at">SVM.p =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb121-666"><a href="simulační-studie.html#cb121-666" tabindex="-1"></a>                     <span class="at">SVM.r =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv))</span>
<span id="cb121-667"><a href="simulační-studie.html#cb121-667" tabindex="-1"></a>  </span>
<span id="cb121-668"><a href="simulační-studie.html#cb121-668" tabindex="-1"></a>  <span class="cf">for</span> (d <span class="cf">in</span> dimensions) {</span>
<span id="cb121-669"><a href="simulační-studie.html#cb121-669" tabindex="-1"></a>    bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb121-670"><a href="simulační-studie.html#cb121-670" tabindex="-1"></a>                                   <span class="at">nbasis =</span> d)</span>
<span id="cb121-671"><a href="simulační-studie.html#cb121-671" tabindex="-1"></a>    Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="at">argvals =</span> t, <span class="at">basisobj =</span> bbasis) </span>
<span id="cb121-672"><a href="simulační-studie.html#cb121-672" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb121-673"><a href="simulační-studie.html#cb121-673" tabindex="-1"></a>    </span>
<span id="cb121-674"><a href="simulační-studie.html#cb121-674" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb121-675"><a href="simulační-studie.html#cb121-675" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb121-676"><a href="simulační-studie.html#cb121-676" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XX.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb121-677"><a href="simulační-studie.html#cb121-677" tabindex="-1"></a>      </span>
<span id="cb121-678"><a href="simulační-studie.html#cb121-678" tabindex="-1"></a>      data.projection.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[cv_sample, ])</span>
<span id="cb121-679"><a href="simulační-studie.html#cb121-679" tabindex="-1"></a>      data.projection.train.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[cv_sample])</span>
<span id="cb121-680"><a href="simulační-studie.html#cb121-680" tabindex="-1"></a>      data.projection.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb121-681"><a href="simulační-studie.html#cb121-681" tabindex="-1"></a>      Y.test.cv <span class="ot">&lt;-</span> Y.train[<span class="sc">!</span>cv_sample]</span>
<span id="cb121-682"><a href="simulační-studie.html#cb121-682" tabindex="-1"></a>      data.projection.test.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test.cv)</span>
<span id="cb121-683"><a href="simulační-studie.html#cb121-683" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb121-684"><a href="simulační-studie.html#cb121-684" tabindex="-1"></a>      clf.SVM.l.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb121-685"><a href="simulační-studie.html#cb121-685" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb121-686"><a href="simulační-studie.html#cb121-686" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb121-687"><a href="simulační-studie.html#cb121-687" tabindex="-1"></a>                              <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb121-688"><a href="simulační-studie.html#cb121-688" tabindex="-1"></a>      </span>
<span id="cb121-689"><a href="simulační-studie.html#cb121-689" tabindex="-1"></a>      clf.SVM.p.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb121-690"><a href="simulační-studie.html#cb121-690" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb121-691"><a href="simulační-studie.html#cb121-691" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb121-692"><a href="simulační-studie.html#cb121-692" tabindex="-1"></a>                              <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb121-693"><a href="simulační-studie.html#cb121-693" tabindex="-1"></a>      </span>
<span id="cb121-694"><a href="simulační-studie.html#cb121-694" tabindex="-1"></a>      clf.SVM.r.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb121-695"><a href="simulační-studie.html#cb121-695" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb121-696"><a href="simulační-studie.html#cb121-696" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb121-697"><a href="simulační-studie.html#cb121-697" tabindex="-1"></a>                              <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb121-698"><a href="simulační-studie.html#cb121-698" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb121-699"><a href="simulační-studie.html#cb121-699" tabindex="-1"></a>      <span class="do">## linear kernel</span></span>
<span id="cb121-700"><a href="simulační-studie.html#cb121-700" tabindex="-1"></a>      predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.projection,</span>
<span id="cb121-701"><a href="simulační-studie.html#cb121-701" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb121-702"><a href="simulační-studie.html#cb121-702" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb121-703"><a href="simulační-studie.html#cb121-703" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-704"><a href="simulační-studie.html#cb121-704" tabindex="-1"></a>      <span class="do">## polynomial kernel</span></span>
<span id="cb121-705"><a href="simulační-studie.html#cb121-705" tabindex="-1"></a>      predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.projection, </span>
<span id="cb121-706"><a href="simulační-studie.html#cb121-706" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb121-707"><a href="simulační-studie.html#cb121-707" tabindex="-1"></a>      presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb121-708"><a href="simulační-studie.html#cb121-708" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-709"><a href="simulační-studie.html#cb121-709" tabindex="-1"></a>      <span class="do">## radial kernel</span></span>
<span id="cb121-710"><a href="simulační-studie.html#cb121-710" tabindex="-1"></a>      predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.projection,</span>
<span id="cb121-711"><a href="simulační-studie.html#cb121-711" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb121-712"><a href="simulační-studie.html#cb121-712" tabindex="-1"></a>      presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb121-713"><a href="simulační-studie.html#cb121-713" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-714"><a href="simulační-studie.html#cb121-714" tabindex="-1"></a>      </span>
<span id="cb121-715"><a href="simulační-studie.html#cb121-715" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane d a fold</span></span>
<span id="cb121-716"><a href="simulační-studie.html#cb121-716" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb121-717"><a href="simulační-studie.html#cb121-717" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb121-718"><a href="simulační-studie.html#cb121-718" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb121-719"><a href="simulační-studie.html#cb121-719" tabindex="-1"></a>    }</span>
<span id="cb121-720"><a href="simulační-studie.html#cb121-720" tabindex="-1"></a>  }</span>
<span id="cb121-721"><a href="simulační-studie.html#cb121-721" tabindex="-1"></a>  </span>
<span id="cb121-722"><a href="simulační-studie.html#cb121-722" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb121-723"><a href="simulační-studie.html#cb121-723" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb121-724"><a href="simulační-studie.html#cb121-724" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb121-725"><a href="simulační-studie.html#cb121-725" tabindex="-1"></a>  }</span>
<span id="cb121-726"><a href="simulační-studie.html#cb121-726" tabindex="-1"></a>  </span>
<span id="cb121-727"><a href="simulační-studie.html#cb121-727" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb121-728"><a href="simulační-studie.html#cb121-728" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb121-729"><a href="simulační-studie.html#cb121-729" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb121-730"><a href="simulační-studie.html#cb121-730" tabindex="-1"></a>  </span>
<span id="cb121-731"><a href="simulační-studie.html#cb121-731" tabindex="-1"></a>  <span class="co"># ulozime optimalni d do datove tabulky</span></span>
<span id="cb121-732"><a href="simulační-studie.html#cb121-732" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb121-733"><a href="simulační-studie.html#cb121-733" tabindex="-1"></a>  </span>
<span id="cb121-734"><a href="simulační-studie.html#cb121-734" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb121-735"><a href="simulační-studie.html#cb121-735" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - projection&#39;</span>, </span>
<span id="cb121-736"><a href="simulační-studie.html#cb121-736" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb121-737"><a href="simulační-studie.html#cb121-737" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - projection&#39;</span>), </span>
<span id="cb121-738"><a href="simulační-studie.html#cb121-738" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb121-739"><a href="simulační-studie.html#cb121-739" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb121-740"><a href="simulační-studie.html#cb121-740" tabindex="-1"></a>  </span>
<span id="cb121-741"><a href="simulační-studie.html#cb121-741" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb121-742"><a href="simulační-studie.html#cb121-742" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb121-743"><a href="simulační-studie.html#cb121-743" tabindex="-1"></a>    bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb121-744"><a href="simulační-studie.html#cb121-744" tabindex="-1"></a>                                   <span class="at">nbasis =</span> d.opt[kernel_number])</span>
<span id="cb121-745"><a href="simulační-studie.html#cb121-745" tabindex="-1"></a>    Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="at">argvals =</span> t, <span class="at">basisobj =</span> bbasis) </span>
<span id="cb121-746"><a href="simulační-studie.html#cb121-746" tabindex="-1"></a>    </span>
<span id="cb121-747"><a href="simulační-studie.html#cb121-747" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb121-748"><a href="simulační-studie.html#cb121-748" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb121-749"><a href="simulační-studie.html#cb121-749" tabindex="-1"></a>    </span>
<span id="cb121-750"><a href="simulační-studie.html#cb121-750" tabindex="-1"></a>    data.projection.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train)</span>
<span id="cb121-751"><a href="simulační-studie.html#cb121-751" tabindex="-1"></a>    data.projection.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb121-752"><a href="simulační-studie.html#cb121-752" tabindex="-1"></a>    </span>
<span id="cb121-753"><a href="simulační-studie.html#cb121-753" tabindex="-1"></a>    data.projection.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.test)</span>
<span id="cb121-754"><a href="simulační-studie.html#cb121-754" tabindex="-1"></a>    data.projection.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb121-755"><a href="simulační-studie.html#cb121-755" tabindex="-1"></a>    </span>
<span id="cb121-756"><a href="simulační-studie.html#cb121-756" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb121-757"><a href="simulační-studie.html#cb121-757" tabindex="-1"></a>    clf.SVM.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train,</span>
<span id="cb121-758"><a href="simulační-studie.html#cb121-758" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb121-759"><a href="simulační-studie.html#cb121-759" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb121-760"><a href="simulační-studie.html#cb121-760" tabindex="-1"></a>                              <span class="at">kernel =</span> kernel_type)</span>
<span id="cb121-761"><a href="simulační-studie.html#cb121-761" tabindex="-1"></a>    </span>
<span id="cb121-762"><a href="simulační-studie.html#cb121-762" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb121-763"><a href="simulační-studie.html#cb121-763" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.train)</span>
<span id="cb121-764"><a href="simulační-studie.html#cb121-764" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb121-765"><a href="simulační-studie.html#cb121-765" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-766"><a href="simulační-studie.html#cb121-766" tabindex="-1"></a>      </span>
<span id="cb121-767"><a href="simulační-studie.html#cb121-767" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb121-768"><a href="simulační-studie.html#cb121-768" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.test)</span>
<span id="cb121-769"><a href="simulační-studie.html#cb121-769" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb121-770"><a href="simulační-studie.html#cb121-770" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-771"><a href="simulační-studie.html#cb121-771" tabindex="-1"></a>    </span>
<span id="cb121-772"><a href="simulační-studie.html#cb121-772" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb121-773"><a href="simulační-studie.html#cb121-773" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb121-774"><a href="simulační-studie.html#cb121-774" tabindex="-1"></a>  }</span>
<span id="cb121-775"><a href="simulační-studie.html#cb121-775" tabindex="-1"></a>  </span>
<span id="cb121-776"><a href="simulační-studie.html#cb121-776" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb121-777"><a href="simulační-studie.html#cb121-777" tabindex="-1"></a>  </span>
<span id="cb121-778"><a href="simulační-studie.html#cb121-778" tabindex="-1"></a>  <span class="do">## 7.5) SVM + RKHS</span></span>
<span id="cb121-779"><a href="simulační-studie.html#cb121-779" tabindex="-1"></a>  </span>
<span id="cb121-780"><a href="simulační-studie.html#cb121-780" tabindex="-1"></a>  <span class="do">### Gaussovo jadro</span></span>
<span id="cb121-781"><a href="simulační-studie.html#cb121-781" tabindex="-1"></a>  </span>
<span id="cb121-782"><a href="simulační-studie.html#cb121-782" tabindex="-1"></a>  <span class="co"># jadro a jadrova matice ... Gaussovske s parametrem gamma</span></span>
<span id="cb121-783"><a href="simulační-studie.html#cb121-783" tabindex="-1"></a>  Gauss.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, gamma) {</span>
<span id="cb121-784"><a href="simulační-studie.html#cb121-784" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>gamma <span class="sc">*</span> <span class="fu">norm</span>(<span class="fu">c</span>(x <span class="sc">-</span> y) <span class="sc">|&gt;</span> <span class="fu">t</span>(), <span class="at">type =</span> <span class="st">&#39;F&#39;</span>)))</span>
<span id="cb121-785"><a href="simulační-studie.html#cb121-785" tabindex="-1"></a>  }</span>
<span id="cb121-786"><a href="simulační-studie.html#cb121-786" tabindex="-1"></a>  </span>
<span id="cb121-787"><a href="simulační-studie.html#cb121-787" tabindex="-1"></a>  Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, gamma) {</span>
<span id="cb121-788"><a href="simulační-studie.html#cb121-788" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb121-789"><a href="simulační-studie.html#cb121-789" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb121-790"><a href="simulační-studie.html#cb121-790" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb121-791"><a href="simulační-studie.html#cb121-791" tabindex="-1"></a>        K[i, j] <span class="ot">&lt;-</span> <span class="fu">Gauss.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], <span class="at">gamma =</span> gamma)</span>
<span id="cb121-792"><a href="simulační-studie.html#cb121-792" tabindex="-1"></a>      }</span>
<span id="cb121-793"><a href="simulační-studie.html#cb121-793" tabindex="-1"></a>    }</span>
<span id="cb121-794"><a href="simulační-studie.html#cb121-794" tabindex="-1"></a>    <span class="fu">return</span>(K)</span>
<span id="cb121-795"><a href="simulační-studie.html#cb121-795" tabindex="-1"></a>  }</span>
<span id="cb121-796"><a href="simulační-studie.html#cb121-796" tabindex="-1"></a>  </span>
<span id="cb121-797"><a href="simulační-studie.html#cb121-797" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb121-798"><a href="simulační-studie.html#cb121-798" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb121-799"><a href="simulační-studie.html#cb121-799" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb121-800"><a href="simulační-studie.html#cb121-800" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb121-801"><a href="simulační-studie.html#cb121-801" tabindex="-1"></a>  </span>
<span id="cb121-802"><a href="simulační-studie.html#cb121-802" tabindex="-1"></a>  <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb121-803"><a href="simulační-studie.html#cb121-803" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">40</span>, <span class="at">by =</span><span class="dv">2</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb121-804"><a href="simulační-studie.html#cb121-804" tabindex="-1"></a>  gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">15</span>)</span>
<span id="cb121-805"><a href="simulační-studie.html#cb121-805" tabindex="-1"></a>  </span>
<span id="cb121-806"><a href="simulační-studie.html#cb121-806" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb121-807"><a href="simulační-studie.html#cb121-807" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb121-808"><a href="simulační-studie.html#cb121-808" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb121-809"><a href="simulační-studie.html#cb121-809" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb121-810"><a href="simulační-studie.html#cb121-810" tabindex="-1"></a>  dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">gamma =</span> <span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma.cv, <span class="dv">3</span>)),</span>
<span id="cb121-811"><a href="simulační-studie.html#cb121-811" tabindex="-1"></a>                    <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb121-812"><a href="simulační-studie.html#cb121-812" tabindex="-1"></a>                    <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb121-813"><a href="simulační-studie.html#cb121-813" tabindex="-1"></a>  </span>
<span id="cb121-814"><a href="simulační-studie.html#cb121-814" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb121-815"><a href="simulační-studie.html#cb121-815" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb121-816"><a href="simulační-studie.html#cb121-816" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb121-817"><a href="simulační-studie.html#cb121-817" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb121-818"><a href="simulační-studie.html#cb121-818" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb121-819"><a href="simulační-studie.html#cb121-819" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb121-820"><a href="simulační-studie.html#cb121-820" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names))</span>
<span id="cb121-821"><a href="simulační-studie.html#cb121-821" tabindex="-1"></a>  </span>
<span id="cb121-822"><a href="simulační-studie.html#cb121-822" tabindex="-1"></a>  <span class="co"># samotna CV</span></span>
<span id="cb121-823"><a href="simulační-studie.html#cb121-823" tabindex="-1"></a>  <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb121-824"><a href="simulační-studie.html#cb121-824" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb121-825"><a href="simulační-studie.html#cb121-825" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb121-826"><a href="simulační-studie.html#cb121-826" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb121-827"><a href="simulační-studie.html#cb121-827" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb121-828"><a href="simulační-studie.html#cb121-828" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb121-829"><a href="simulační-studie.html#cb121-829" tabindex="-1"></a>    </span>
<span id="cb121-830"><a href="simulační-studie.html#cb121-830" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb121-831"><a href="simulační-studie.html#cb121-831" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb121-832"><a href="simulační-studie.html#cb121-832" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb121-833"><a href="simulační-studie.html#cb121-833" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb121-834"><a href="simulační-studie.html#cb121-834" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb121-835"><a href="simulační-studie.html#cb121-835" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb121-836"><a href="simulační-studie.html#cb121-836" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb121-837"><a href="simulační-studie.html#cb121-837" tabindex="-1"></a>                      <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb121-838"><a href="simulační-studie.html#cb121-838" tabindex="-1"></a>                      <span class="at">gamma =</span> gamma)</span>
<span id="cb121-839"><a href="simulační-studie.html#cb121-839" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb121-840"><a href="simulační-studie.html#cb121-840" tabindex="-1"></a>    }</span>
<span id="cb121-841"><a href="simulační-studie.html#cb121-841" tabindex="-1"></a>    </span>
<span id="cb121-842"><a href="simulační-studie.html#cb121-842" tabindex="-1"></a>    <span class="co"># projdeme dimenze</span></span>
<span id="cb121-843"><a href="simulační-studie.html#cb121-843" tabindex="-1"></a>    <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb121-844"><a href="simulační-studie.html#cb121-844" tabindex="-1"></a>      Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb121-845"><a href="simulační-studie.html#cb121-845" tabindex="-1"></a>                            <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb121-846"><a href="simulační-studie.html#cb121-846" tabindex="-1"></a>                            <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb121-847"><a href="simulační-studie.html#cb121-847" tabindex="-1"></a>      <span class="co"># vypocet reprezentace</span></span>
<span id="cb121-848"><a href="simulační-studie.html#cb121-848" tabindex="-1"></a>      <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb121-849"><a href="simulační-studie.html#cb121-849" tabindex="-1"></a>        Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb121-850"><a href="simulační-studie.html#cb121-850" tabindex="-1"></a>                               alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb121-851"><a href="simulační-studie.html#cb121-851" tabindex="-1"></a>      }</span>
<span id="cb121-852"><a href="simulační-studie.html#cb121-852" tabindex="-1"></a>      <span class="co"># projdeme folds</span></span>
<span id="cb121-853"><a href="simulační-studie.html#cb121-853" tabindex="-1"></a>      <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb121-854"><a href="simulační-studie.html#cb121-854" tabindex="-1"></a>        <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb121-855"><a href="simulační-studie.html#cb121-855" tabindex="-1"></a>        fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb121-856"><a href="simulační-studie.html#cb121-856" tabindex="-1"></a>        <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb121-857"><a href="simulační-studie.html#cb121-857" tabindex="-1"></a>        XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb121-858"><a href="simulační-studie.html#cb121-858" tabindex="-1"></a>        XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb121-859"><a href="simulační-studie.html#cb121-859" tabindex="-1"></a>        <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb121-860"><a href="simulační-studie.html#cb121-860" tabindex="-1"></a>        Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb121-861"><a href="simulační-studie.html#cb121-861" tabindex="-1"></a>                                    <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb121-862"><a href="simulační-studie.html#cb121-862" tabindex="-1"></a>                                    <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb121-863"><a href="simulační-studie.html#cb121-863" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb121-864"><a href="simulační-studie.html#cb121-864" tabindex="-1"></a>        <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb121-865"><a href="simulační-studie.html#cb121-865" tabindex="-1"></a>        <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb121-866"><a href="simulační-studie.html#cb121-866" tabindex="-1"></a>          kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb121-867"><a href="simulační-studie.html#cb121-867" tabindex="-1"></a>        </span>
<span id="cb121-868"><a href="simulační-studie.html#cb121-868" tabindex="-1"></a>          data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb121-869"><a href="simulační-studie.html#cb121-869" tabindex="-1"></a>          data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb121-870"><a href="simulační-studie.html#cb121-870" tabindex="-1"></a>          </span>
<span id="cb121-871"><a href="simulační-studie.html#cb121-871" tabindex="-1"></a>          data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb121-872"><a href="simulační-studie.html#cb121-872" tabindex="-1"></a>          data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb121-873"><a href="simulační-studie.html#cb121-873" tabindex="-1"></a>          </span>
<span id="cb121-874"><a href="simulační-studie.html#cb121-874" tabindex="-1"></a>          <span class="co"># sestrojeni modelu</span></span>
<span id="cb121-875"><a href="simulační-studie.html#cb121-875" tabindex="-1"></a>          clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb121-876"><a href="simulační-studie.html#cb121-876" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb121-877"><a href="simulační-studie.html#cb121-877" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb121-878"><a href="simulační-studie.html#cb121-878" tabindex="-1"></a>                              <span class="at">kernel =</span> kernel_type)</span>
<span id="cb121-879"><a href="simulační-studie.html#cb121-879" tabindex="-1"></a>          </span>
<span id="cb121-880"><a href="simulační-studie.html#cb121-880" tabindex="-1"></a>          <span class="co"># presnost na validacnich datech</span></span>
<span id="cb121-881"><a href="simulační-studie.html#cb121-881" tabindex="-1"></a>          predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb121-882"><a href="simulační-studie.html#cb121-882" tabindex="-1"></a>          presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb121-883"><a href="simulační-studie.html#cb121-883" tabindex="-1"></a>            <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-884"><a href="simulační-studie.html#cb121-884" tabindex="-1"></a>          </span>
<span id="cb121-885"><a href="simulační-studie.html#cb121-885" tabindex="-1"></a>          <span class="co"># ulozeni vysledku</span></span>
<span id="cb121-886"><a href="simulační-studie.html#cb121-886" tabindex="-1"></a>          Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb121-887"><a href="simulační-studie.html#cb121-887" tabindex="-1"></a>        }</span>
<span id="cb121-888"><a href="simulační-studie.html#cb121-888" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb121-889"><a href="simulační-studie.html#cb121-889" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb121-890"><a href="simulační-studie.html#cb121-890" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb121-891"><a href="simulační-studie.html#cb121-891" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb121-892"><a href="simulační-studie.html#cb121-892" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb121-893"><a href="simulační-studie.html#cb121-893" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb121-894"><a href="simulační-studie.html#cb121-894" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb121-895"><a href="simulační-studie.html#cb121-895" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb121-896"><a href="simulační-studie.html#cb121-896" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb121-897"><a href="simulační-studie.html#cb121-897" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb121-898"><a href="simulační-studie.html#cb121-898" tabindex="-1"></a>      }</span>
<span id="cb121-899"><a href="simulační-studie.html#cb121-899" tabindex="-1"></a>    }</span>
<span id="cb121-900"><a href="simulační-studie.html#cb121-900" tabindex="-1"></a>  }</span>
<span id="cb121-901"><a href="simulační-studie.html#cb121-901" tabindex="-1"></a>  </span>
<span id="cb121-902"><a href="simulační-studie.html#cb121-902" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb121-903"><a href="simulační-studie.html#cb121-903" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb121-904"><a href="simulační-studie.html#cb121-904" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb121-905"><a href="simulační-studie.html#cb121-905" tabindex="-1"></a>  }</span>
<span id="cb121-906"><a href="simulační-studie.html#cb121-906" tabindex="-1"></a>  </span>
<span id="cb121-907"><a href="simulační-studie.html#cb121-907" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb121-908"><a href="simulační-studie.html#cb121-908" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb121-909"><a href="simulační-studie.html#cb121-909" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv))</span>
<span id="cb121-910"><a href="simulační-studie.html#cb121-910" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.opt)</span>
<span id="cb121-911"><a href="simulační-studie.html#cb121-911" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb121-912"><a href="simulační-studie.html#cb121-912" tabindex="-1"></a>  </span>
<span id="cb121-913"><a href="simulační-studie.html#cb121-913" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb121-914"><a href="simulační-studie.html#cb121-914" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb121-915"><a href="simulační-studie.html#cb121-915" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb121-916"><a href="simulační-studie.html#cb121-916" tabindex="-1"></a>  d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb121-917"><a href="simulační-studie.html#cb121-917" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb121-918"><a href="simulační-studie.html#cb121-918" tabindex="-1"></a>  </span>
<span id="cb121-919"><a href="simulační-studie.html#cb121-919" tabindex="-1"></a>  err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb121-920"><a href="simulační-studie.html#cb121-920" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb121-921"><a href="simulační-studie.html#cb121-921" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb121-922"><a href="simulační-studie.html#cb121-922" tabindex="-1"></a>  df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">gamma =</span> gamma.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb121-923"><a href="simulační-studie.html#cb121-923" tabindex="-1"></a>             <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb121-924"><a href="simulační-studie.html#cb121-924" tabindex="-1"></a>             <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb121-925"><a href="simulační-studie.html#cb121-925" tabindex="-1"></a>  </span>
<span id="cb121-926"><a href="simulační-studie.html#cb121-926" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb121-927"><a href="simulační-studie.html#cb121-927" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb121-928"><a href="simulační-studie.html#cb121-928" tabindex="-1"></a>  <span class="co"># pridame i testovaci data</span></span>
<span id="cb121-929"><a href="simulační-studie.html#cb121-929" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb121-930"><a href="simulační-studie.html#cb121-930" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb121-931"><a href="simulační-studie.html#cb121-931" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, </span>
<span id="cb121-932"><a href="simulační-studie.html#cb121-932" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, </span>
<span id="cb121-933"><a href="simulační-studie.html#cb121-933" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>), </span>
<span id="cb121-934"><a href="simulační-studie.html#cb121-934" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb121-935"><a href="simulační-studie.html#cb121-935" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb121-936"><a href="simulační-studie.html#cb121-936" tabindex="-1"></a>  </span>
<span id="cb121-937"><a href="simulační-studie.html#cb121-937" tabindex="-1"></a>  <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb121-938"><a href="simulační-studie.html#cb121-938" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb121-939"><a href="simulační-studie.html#cb121-939" tabindex="-1"></a>    <span class="co"># spocitame matici K</span></span>
<span id="cb121-940"><a href="simulační-studie.html#cb121-940" tabindex="-1"></a>    gamma <span class="ot">&lt;-</span> gamma.opt[kernel_number] <span class="co"># hodnota gamma pomoci CV</span></span>
<span id="cb121-941"><a href="simulační-studie.html#cb121-941" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb121-942"><a href="simulační-studie.html#cb121-942" tabindex="-1"></a>    </span>
<span id="cb121-943"><a href="simulační-studie.html#cb121-943" tabindex="-1"></a>    <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb121-944"><a href="simulační-studie.html#cb121-944" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb121-945"><a href="simulační-studie.html#cb121-945" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb121-946"><a href="simulační-studie.html#cb121-946" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb121-947"><a href="simulační-studie.html#cb121-947" tabindex="-1"></a>    <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb121-948"><a href="simulační-studie.html#cb121-948" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb121-949"><a href="simulační-studie.html#cb121-949" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb121-950"><a href="simulační-studie.html#cb121-950" tabindex="-1"></a>    </span>
<span id="cb121-951"><a href="simulační-studie.html#cb121-951" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb121-952"><a href="simulační-studie.html#cb121-952" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb121-953"><a href="simulační-studie.html#cb121-953" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb121-954"><a href="simulační-studie.html#cb121-954" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb121-955"><a href="simulační-studie.html#cb121-955" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb121-956"><a href="simulační-studie.html#cb121-956" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb121-957"><a href="simulační-studie.html#cb121-957" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb121-958"><a href="simulační-studie.html#cb121-958" tabindex="-1"></a>                      <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb121-959"><a href="simulační-studie.html#cb121-959" tabindex="-1"></a>                      <span class="at">gamma =</span> gamma)</span>
<span id="cb121-960"><a href="simulační-studie.html#cb121-960" tabindex="-1"></a>      <span class="co"># urceni alpha</span></span>
<span id="cb121-961"><a href="simulační-studie.html#cb121-961" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb121-962"><a href="simulační-studie.html#cb121-962" tabindex="-1"></a>    }</span>
<span id="cb121-963"><a href="simulační-studie.html#cb121-963" tabindex="-1"></a>    <span class="co"># d</span></span>
<span id="cb121-964"><a href="simulační-studie.html#cb121-964" tabindex="-1"></a>    d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb121-965"><a href="simulační-studie.html#cb121-965" tabindex="-1"></a>    </span>
<span id="cb121-966"><a href="simulační-studie.html#cb121-966" tabindex="-1"></a>    <span class="co"># urceni vektoru lambda</span></span>
<span id="cb121-967"><a href="simulační-studie.html#cb121-967" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb121-968"><a href="simulační-studie.html#cb121-968" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb121-969"><a href="simulační-studie.html#cb121-969" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb121-970"><a href="simulační-studie.html#cb121-970" tabindex="-1"></a>    </span>
<span id="cb121-971"><a href="simulační-studie.html#cb121-971" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb121-972"><a href="simulační-studie.html#cb121-972" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb121-973"><a href="simulační-studie.html#cb121-973" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb121-974"><a href="simulační-studie.html#cb121-974" tabindex="-1"></a>    }</span>
<span id="cb121-975"><a href="simulační-studie.html#cb121-975" tabindex="-1"></a>    </span>
<span id="cb121-976"><a href="simulační-studie.html#cb121-976" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb121-977"><a href="simulační-studie.html#cb121-977" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb121-978"><a href="simulační-studie.html#cb121-978" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb121-979"><a href="simulační-studie.html#cb121-979" tabindex="-1"></a>  </span>
<span id="cb121-980"><a href="simulační-studie.html#cb121-980" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb121-981"><a href="simulační-studie.html#cb121-981" tabindex="-1"></a>  </span>
<span id="cb121-982"><a href="simulační-studie.html#cb121-982" tabindex="-1"></a>    data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb121-983"><a href="simulační-studie.html#cb121-983" tabindex="-1"></a>    data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb121-984"><a href="simulační-studie.html#cb121-984" tabindex="-1"></a>    </span>
<span id="cb121-985"><a href="simulační-studie.html#cb121-985" tabindex="-1"></a>    data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb121-986"><a href="simulační-studie.html#cb121-986" tabindex="-1"></a>    data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb121-987"><a href="simulační-studie.html#cb121-987" tabindex="-1"></a>    </span>
<span id="cb121-988"><a href="simulační-studie.html#cb121-988" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb121-989"><a href="simulační-studie.html#cb121-989" tabindex="-1"></a>    clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb121-990"><a href="simulační-studie.html#cb121-990" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb121-991"><a href="simulační-studie.html#cb121-991" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb121-992"><a href="simulační-studie.html#cb121-992" tabindex="-1"></a>                        <span class="at">kernel =</span> kernel_type)</span>
<span id="cb121-993"><a href="simulační-studie.html#cb121-993" tabindex="-1"></a>    </span>
<span id="cb121-994"><a href="simulační-studie.html#cb121-994" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb121-995"><a href="simulační-studie.html#cb121-995" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb121-996"><a href="simulační-studie.html#cb121-996" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb121-997"><a href="simulační-studie.html#cb121-997" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-998"><a href="simulační-studie.html#cb121-998" tabindex="-1"></a>      </span>
<span id="cb121-999"><a href="simulační-studie.html#cb121-999" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb121-1000"><a href="simulační-studie.html#cb121-1000" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb121-1001"><a href="simulační-studie.html#cb121-1001" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb121-1002"><a href="simulační-studie.html#cb121-1002" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-1003"><a href="simulační-studie.html#cb121-1003" tabindex="-1"></a>    </span>
<span id="cb121-1004"><a href="simulační-studie.html#cb121-1004" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb121-1005"><a href="simulační-studie.html#cb121-1005" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb121-1006"><a href="simulační-studie.html#cb121-1006" tabindex="-1"></a>  }</span>
<span id="cb121-1007"><a href="simulační-studie.html#cb121-1007" tabindex="-1"></a>  </span>
<span id="cb121-1008"><a href="simulační-studie.html#cb121-1008" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb121-1009"><a href="simulační-studie.html#cb121-1009" tabindex="-1"></a></span>
<span id="cb121-1010"><a href="simulační-studie.html#cb121-1010" tabindex="-1"></a>  <span class="do">### Polynomialni jadro</span></span>
<span id="cb121-1011"><a href="simulační-studie.html#cb121-1011" tabindex="-1"></a>  </span>
<span id="cb121-1012"><a href="simulační-studie.html#cb121-1012" tabindex="-1"></a>  <span class="co"># jadro a jadrova matice ... polynomialni s parametrem p</span></span>
<span id="cb121-1013"><a href="simulační-studie.html#cb121-1013" tabindex="-1"></a>  Poly.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, p) {</span>
<span id="cb121-1014"><a href="simulační-studie.html#cb121-1014" tabindex="-1"></a>    <span class="fu">return</span>((<span class="dv">1</span> <span class="sc">+</span> x <span class="sc">*</span> y)<span class="sc">^</span>p)</span>
<span id="cb121-1015"><a href="simulační-studie.html#cb121-1015" tabindex="-1"></a>  }</span>
<span id="cb121-1016"><a href="simulační-studie.html#cb121-1016" tabindex="-1"></a>  </span>
<span id="cb121-1017"><a href="simulační-studie.html#cb121-1017" tabindex="-1"></a>  Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, p) {</span>
<span id="cb121-1018"><a href="simulační-studie.html#cb121-1018" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb121-1019"><a href="simulační-studie.html#cb121-1019" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb121-1020"><a href="simulační-studie.html#cb121-1020" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb121-1021"><a href="simulační-studie.html#cb121-1021" tabindex="-1"></a>        K[i, j] <span class="ot">&lt;-</span> <span class="fu">Poly.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], p)</span>
<span id="cb121-1022"><a href="simulační-studie.html#cb121-1022" tabindex="-1"></a>      }</span>
<span id="cb121-1023"><a href="simulační-studie.html#cb121-1023" tabindex="-1"></a>    }</span>
<span id="cb121-1024"><a href="simulační-studie.html#cb121-1024" tabindex="-1"></a>    <span class="fu">return</span>(K)</span>
<span id="cb121-1025"><a href="simulační-studie.html#cb121-1025" tabindex="-1"></a>  }</span>
<span id="cb121-1026"><a href="simulační-studie.html#cb121-1026" tabindex="-1"></a>  </span>
<span id="cb121-1027"><a href="simulační-studie.html#cb121-1027" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb121-1028"><a href="simulační-studie.html#cb121-1028" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb121-1029"><a href="simulační-studie.html#cb121-1029" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb121-1030"><a href="simulační-studie.html#cb121-1030" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb121-1031"><a href="simulační-studie.html#cb121-1031" tabindex="-1"></a>  </span>
<span id="cb121-1032"><a href="simulační-studie.html#cb121-1032" tabindex="-1"></a>  <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb121-1033"><a href="simulační-studie.html#cb121-1033" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">2</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb121-1034"><a href="simulační-studie.html#cb121-1034" tabindex="-1"></a>  poly.cv <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb121-1035"><a href="simulační-studie.html#cb121-1035" tabindex="-1"></a>  </span>
<span id="cb121-1036"><a href="simulační-studie.html#cb121-1036" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb121-1037"><a href="simulační-studie.html#cb121-1037" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb121-1038"><a href="simulační-studie.html#cb121-1038" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb121-1039"><a href="simulační-studie.html#cb121-1039" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro dane p a vrstvy odpovidaji folds</span></span>
<span id="cb121-1040"><a href="simulační-studie.html#cb121-1040" tabindex="-1"></a>  dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, poly.cv),</span>
<span id="cb121-1041"><a href="simulační-studie.html#cb121-1041" tabindex="-1"></a>                    <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb121-1042"><a href="simulační-studie.html#cb121-1042" tabindex="-1"></a>                    <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb121-1043"><a href="simulační-studie.html#cb121-1043" tabindex="-1"></a>  </span>
<span id="cb121-1044"><a href="simulační-studie.html#cb121-1044" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb121-1045"><a href="simulační-studie.html#cb121-1045" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb121-1046"><a href="simulační-studie.html#cb121-1046" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb121-1047"><a href="simulační-studie.html#cb121-1047" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb121-1048"><a href="simulační-studie.html#cb121-1048" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb121-1049"><a href="simulační-studie.html#cb121-1049" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb121-1050"><a href="simulační-studie.html#cb121-1050" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names))</span>
<span id="cb121-1051"><a href="simulační-studie.html#cb121-1051" tabindex="-1"></a>  </span>
<span id="cb121-1052"><a href="simulační-studie.html#cb121-1052" tabindex="-1"></a>  <span class="co"># samotna CV</span></span>
<span id="cb121-1053"><a href="simulační-studie.html#cb121-1053" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> poly.cv) {</span>
<span id="cb121-1054"><a href="simulační-studie.html#cb121-1054" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb121-1055"><a href="simulační-studie.html#cb121-1055" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb121-1056"><a href="simulační-studie.html#cb121-1056" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb121-1057"><a href="simulační-studie.html#cb121-1057" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb121-1058"><a href="simulační-studie.html#cb121-1058" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb121-1059"><a href="simulační-studie.html#cb121-1059" tabindex="-1"></a>    </span>
<span id="cb121-1060"><a href="simulační-studie.html#cb121-1060" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb121-1061"><a href="simulační-studie.html#cb121-1061" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb121-1062"><a href="simulační-studie.html#cb121-1062" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb121-1063"><a href="simulační-studie.html#cb121-1063" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb121-1064"><a href="simulační-studie.html#cb121-1064" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb121-1065"><a href="simulační-studie.html#cb121-1065" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb121-1066"><a href="simulační-studie.html#cb121-1066" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb121-1067"><a href="simulační-studie.html#cb121-1067" tabindex="-1"></a>                      <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb121-1068"><a href="simulační-studie.html#cb121-1068" tabindex="-1"></a>                      <span class="at">degree =</span> p)</span>
<span id="cb121-1069"><a href="simulační-studie.html#cb121-1069" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb121-1070"><a href="simulační-studie.html#cb121-1070" tabindex="-1"></a>    }</span>
<span id="cb121-1071"><a href="simulační-studie.html#cb121-1071" tabindex="-1"></a>    </span>
<span id="cb121-1072"><a href="simulační-studie.html#cb121-1072" tabindex="-1"></a>    <span class="co"># projdeme dimenze</span></span>
<span id="cb121-1073"><a href="simulační-studie.html#cb121-1073" tabindex="-1"></a>    <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb121-1074"><a href="simulační-studie.html#cb121-1074" tabindex="-1"></a>      Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb121-1075"><a href="simulační-studie.html#cb121-1075" tabindex="-1"></a>                            <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb121-1076"><a href="simulační-studie.html#cb121-1076" tabindex="-1"></a>                            <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb121-1077"><a href="simulační-studie.html#cb121-1077" tabindex="-1"></a>      <span class="co"># vypocet reprezentace</span></span>
<span id="cb121-1078"><a href="simulační-studie.html#cb121-1078" tabindex="-1"></a>      <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb121-1079"><a href="simulační-studie.html#cb121-1079" tabindex="-1"></a>        Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb121-1080"><a href="simulační-studie.html#cb121-1080" tabindex="-1"></a>                               alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb121-1081"><a href="simulační-studie.html#cb121-1081" tabindex="-1"></a>      }</span>
<span id="cb121-1082"><a href="simulační-studie.html#cb121-1082" tabindex="-1"></a>      <span class="co"># projdeme folds</span></span>
<span id="cb121-1083"><a href="simulační-studie.html#cb121-1083" tabindex="-1"></a>      <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb121-1084"><a href="simulační-studie.html#cb121-1084" tabindex="-1"></a>        <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb121-1085"><a href="simulační-studie.html#cb121-1085" tabindex="-1"></a>        fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb121-1086"><a href="simulační-studie.html#cb121-1086" tabindex="-1"></a>        <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb121-1087"><a href="simulační-studie.html#cb121-1087" tabindex="-1"></a>        XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb121-1088"><a href="simulační-studie.html#cb121-1088" tabindex="-1"></a>        XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb121-1089"><a href="simulační-studie.html#cb121-1089" tabindex="-1"></a>        <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb121-1090"><a href="simulační-studie.html#cb121-1090" tabindex="-1"></a>        Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb121-1091"><a href="simulační-studie.html#cb121-1091" tabindex="-1"></a>                                    <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb121-1092"><a href="simulační-studie.html#cb121-1092" tabindex="-1"></a>                                    <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb121-1093"><a href="simulační-studie.html#cb121-1093" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb121-1094"><a href="simulační-studie.html#cb121-1094" tabindex="-1"></a>        <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb121-1095"><a href="simulační-studie.html#cb121-1095" tabindex="-1"></a>        <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb121-1096"><a href="simulační-studie.html#cb121-1096" tabindex="-1"></a>          kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb121-1097"><a href="simulační-studie.html#cb121-1097" tabindex="-1"></a>        </span>
<span id="cb121-1098"><a href="simulační-studie.html#cb121-1098" tabindex="-1"></a>          data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb121-1099"><a href="simulační-studie.html#cb121-1099" tabindex="-1"></a>          data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb121-1100"><a href="simulační-studie.html#cb121-1100" tabindex="-1"></a>          </span>
<span id="cb121-1101"><a href="simulační-studie.html#cb121-1101" tabindex="-1"></a>          data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb121-1102"><a href="simulační-studie.html#cb121-1102" tabindex="-1"></a>          data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb121-1103"><a href="simulační-studie.html#cb121-1103" tabindex="-1"></a>          </span>
<span id="cb121-1104"><a href="simulační-studie.html#cb121-1104" tabindex="-1"></a>          <span class="co"># sestrojeni modelu</span></span>
<span id="cb121-1105"><a href="simulační-studie.html#cb121-1105" tabindex="-1"></a>          clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb121-1106"><a href="simulační-studie.html#cb121-1106" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb121-1107"><a href="simulační-studie.html#cb121-1107" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb121-1108"><a href="simulační-studie.html#cb121-1108" tabindex="-1"></a>                              <span class="at">kernel =</span> kernel_type)</span>
<span id="cb121-1109"><a href="simulační-studie.html#cb121-1109" tabindex="-1"></a>          </span>
<span id="cb121-1110"><a href="simulační-studie.html#cb121-1110" tabindex="-1"></a>          <span class="co"># presnost na validacnich datech</span></span>
<span id="cb121-1111"><a href="simulační-studie.html#cb121-1111" tabindex="-1"></a>          predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb121-1112"><a href="simulační-studie.html#cb121-1112" tabindex="-1"></a>          presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb121-1113"><a href="simulační-studie.html#cb121-1113" tabindex="-1"></a>            <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-1114"><a href="simulační-studie.html#cb121-1114" tabindex="-1"></a>          </span>
<span id="cb121-1115"><a href="simulační-studie.html#cb121-1115" tabindex="-1"></a>          <span class="co"># ulozeni vysledku</span></span>
<span id="cb121-1116"><a href="simulační-studie.html#cb121-1116" tabindex="-1"></a>          Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb121-1117"><a href="simulační-studie.html#cb121-1117" tabindex="-1"></a>        }</span>
<span id="cb121-1118"><a href="simulační-studie.html#cb121-1118" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb121-1119"><a href="simulační-studie.html#cb121-1119" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb121-1120"><a href="simulační-studie.html#cb121-1120" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb121-1121"><a href="simulační-studie.html#cb121-1121" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb121-1122"><a href="simulační-studie.html#cb121-1122" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb121-1123"><a href="simulační-studie.html#cb121-1123" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb121-1124"><a href="simulační-studie.html#cb121-1124" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb121-1125"><a href="simulační-studie.html#cb121-1125" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb121-1126"><a href="simulační-studie.html#cb121-1126" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb121-1127"><a href="simulační-studie.html#cb121-1127" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb121-1128"><a href="simulační-studie.html#cb121-1128" tabindex="-1"></a>      }</span>
<span id="cb121-1129"><a href="simulační-studie.html#cb121-1129" tabindex="-1"></a>    }</span>
<span id="cb121-1130"><a href="simulační-studie.html#cb121-1130" tabindex="-1"></a>  }</span>
<span id="cb121-1131"><a href="simulační-studie.html#cb121-1131" tabindex="-1"></a>  </span>
<span id="cb121-1132"><a href="simulační-studie.html#cb121-1132" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb121-1133"><a href="simulační-studie.html#cb121-1133" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb121-1134"><a href="simulační-studie.html#cb121-1134" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb121-1135"><a href="simulační-studie.html#cb121-1135" tabindex="-1"></a>  }</span>
<span id="cb121-1136"><a href="simulační-studie.html#cb121-1136" tabindex="-1"></a>  </span>
<span id="cb121-1137"><a href="simulační-studie.html#cb121-1137" tabindex="-1"></a>  poly.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb121-1138"><a href="simulační-studie.html#cb121-1138" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb121-1139"><a href="simulační-studie.html#cb121-1139" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv))</span>
<span id="cb121-1140"><a href="simulační-studie.html#cb121-1140" tabindex="-1"></a>  poly.opt[poly.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(poly.opt)</span>
<span id="cb121-1141"><a href="simulační-studie.html#cb121-1141" tabindex="-1"></a>  poly.opt <span class="ot">&lt;-</span> poly.cv[poly.opt]</span>
<span id="cb121-1142"><a href="simulační-studie.html#cb121-1142" tabindex="-1"></a>  </span>
<span id="cb121-1143"><a href="simulační-studie.html#cb121-1143" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb121-1144"><a href="simulační-studie.html#cb121-1144" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb121-1145"><a href="simulační-studie.html#cb121-1145" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb121-1146"><a href="simulační-studie.html#cb121-1146" tabindex="-1"></a>  d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb121-1147"><a href="simulační-studie.html#cb121-1147" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb121-1148"><a href="simulační-studie.html#cb121-1148" tabindex="-1"></a>  </span>
<span id="cb121-1149"><a href="simulační-studie.html#cb121-1149" tabindex="-1"></a>  err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb121-1150"><a href="simulační-studie.html#cb121-1150" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb121-1151"><a href="simulační-studie.html#cb121-1151" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb121-1152"><a href="simulační-studie.html#cb121-1152" tabindex="-1"></a>  df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">p =</span> poly.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb121-1153"><a href="simulační-studie.html#cb121-1153" tabindex="-1"></a>             <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb121-1154"><a href="simulační-studie.html#cb121-1154" tabindex="-1"></a>             <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb121-1155"><a href="simulační-studie.html#cb121-1155" tabindex="-1"></a>  </span>
<span id="cb121-1156"><a href="simulační-studie.html#cb121-1156" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb121-1157"><a href="simulační-studie.html#cb121-1157" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb121-1158"><a href="simulační-studie.html#cb121-1158" tabindex="-1"></a>  <span class="co"># pridame i testovaci data</span></span>
<span id="cb121-1159"><a href="simulační-studie.html#cb121-1159" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb121-1160"><a href="simulační-studie.html#cb121-1160" tabindex="-1"></a>  </span>
<span id="cb121-1161"><a href="simulační-studie.html#cb121-1161" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb121-1162"><a href="simulační-studie.html#cb121-1162" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - poly&#39;</span>, </span>
<span id="cb121-1163"><a href="simulační-studie.html#cb121-1163" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - RKHS - poly&#39;</span>, </span>
<span id="cb121-1164"><a href="simulační-studie.html#cb121-1164" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - RKHS - poly&#39;</span>), </span>
<span id="cb121-1165"><a href="simulační-studie.html#cb121-1165" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb121-1166"><a href="simulační-studie.html#cb121-1166" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb121-1167"><a href="simulační-studie.html#cb121-1167" tabindex="-1"></a>  </span>
<span id="cb121-1168"><a href="simulační-studie.html#cb121-1168" tabindex="-1"></a>  <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb121-1169"><a href="simulační-studie.html#cb121-1169" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb121-1170"><a href="simulační-studie.html#cb121-1170" tabindex="-1"></a>    <span class="co"># spocitame matici K</span></span>
<span id="cb121-1171"><a href="simulační-studie.html#cb121-1171" tabindex="-1"></a>    p <span class="ot">&lt;-</span> poly.opt[kernel_number] <span class="co"># hodnota gamma pomoci CV</span></span>
<span id="cb121-1172"><a href="simulační-studie.html#cb121-1172" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb121-1173"><a href="simulační-studie.html#cb121-1173" tabindex="-1"></a>    </span>
<span id="cb121-1174"><a href="simulační-studie.html#cb121-1174" tabindex="-1"></a>    <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb121-1175"><a href="simulační-studie.html#cb121-1175" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb121-1176"><a href="simulační-studie.html#cb121-1176" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb121-1177"><a href="simulační-studie.html#cb121-1177" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb121-1178"><a href="simulační-studie.html#cb121-1178" tabindex="-1"></a>    <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb121-1179"><a href="simulační-studie.html#cb121-1179" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb121-1180"><a href="simulační-studie.html#cb121-1180" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb121-1181"><a href="simulační-studie.html#cb121-1181" tabindex="-1"></a>    </span>
<span id="cb121-1182"><a href="simulační-studie.html#cb121-1182" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb121-1183"><a href="simulační-studie.html#cb121-1183" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb121-1184"><a href="simulační-studie.html#cb121-1184" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb121-1185"><a href="simulační-studie.html#cb121-1185" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb121-1186"><a href="simulační-studie.html#cb121-1186" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb121-1187"><a href="simulační-studie.html#cb121-1187" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb121-1188"><a href="simulační-studie.html#cb121-1188" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb121-1189"><a href="simulační-studie.html#cb121-1189" tabindex="-1"></a>                      <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb121-1190"><a href="simulační-studie.html#cb121-1190" tabindex="-1"></a>                      <span class="at">degree =</span> p)</span>
<span id="cb121-1191"><a href="simulační-studie.html#cb121-1191" tabindex="-1"></a>      <span class="co"># urceni alpha</span></span>
<span id="cb121-1192"><a href="simulační-studie.html#cb121-1192" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb121-1193"><a href="simulační-studie.html#cb121-1193" tabindex="-1"></a>    }</span>
<span id="cb121-1194"><a href="simulační-studie.html#cb121-1194" tabindex="-1"></a>    <span class="co"># d</span></span>
<span id="cb121-1195"><a href="simulační-studie.html#cb121-1195" tabindex="-1"></a>    d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb121-1196"><a href="simulační-studie.html#cb121-1196" tabindex="-1"></a>    </span>
<span id="cb121-1197"><a href="simulační-studie.html#cb121-1197" tabindex="-1"></a>    <span class="co"># urceni vektoru lambda</span></span>
<span id="cb121-1198"><a href="simulační-studie.html#cb121-1198" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb121-1199"><a href="simulační-studie.html#cb121-1199" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb121-1200"><a href="simulační-studie.html#cb121-1200" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb121-1201"><a href="simulační-studie.html#cb121-1201" tabindex="-1"></a>    </span>
<span id="cb121-1202"><a href="simulační-studie.html#cb121-1202" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb121-1203"><a href="simulační-studie.html#cb121-1203" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb121-1204"><a href="simulační-studie.html#cb121-1204" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb121-1205"><a href="simulační-studie.html#cb121-1205" tabindex="-1"></a>    }</span>
<span id="cb121-1206"><a href="simulační-studie.html#cb121-1206" tabindex="-1"></a>    </span>
<span id="cb121-1207"><a href="simulační-studie.html#cb121-1207" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb121-1208"><a href="simulační-studie.html#cb121-1208" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb121-1209"><a href="simulační-studie.html#cb121-1209" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb121-1210"><a href="simulační-studie.html#cb121-1210" tabindex="-1"></a>  </span>
<span id="cb121-1211"><a href="simulační-studie.html#cb121-1211" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb121-1212"><a href="simulační-studie.html#cb121-1212" tabindex="-1"></a>  </span>
<span id="cb121-1213"><a href="simulační-studie.html#cb121-1213" tabindex="-1"></a>    data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb121-1214"><a href="simulační-studie.html#cb121-1214" tabindex="-1"></a>    data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb121-1215"><a href="simulační-studie.html#cb121-1215" tabindex="-1"></a>    </span>
<span id="cb121-1216"><a href="simulační-studie.html#cb121-1216" tabindex="-1"></a>    data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb121-1217"><a href="simulační-studie.html#cb121-1217" tabindex="-1"></a>    data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb121-1218"><a href="simulační-studie.html#cb121-1218" tabindex="-1"></a>    </span>
<span id="cb121-1219"><a href="simulační-studie.html#cb121-1219" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb121-1220"><a href="simulační-studie.html#cb121-1220" tabindex="-1"></a>    clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb121-1221"><a href="simulační-studie.html#cb121-1221" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb121-1222"><a href="simulační-studie.html#cb121-1222" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb121-1223"><a href="simulační-studie.html#cb121-1223" tabindex="-1"></a>                        <span class="at">kernel =</span> kernel_type)</span>
<span id="cb121-1224"><a href="simulační-studie.html#cb121-1224" tabindex="-1"></a>    </span>
<span id="cb121-1225"><a href="simulační-studie.html#cb121-1225" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb121-1226"><a href="simulační-studie.html#cb121-1226" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb121-1227"><a href="simulační-studie.html#cb121-1227" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb121-1228"><a href="simulační-studie.html#cb121-1228" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-1229"><a href="simulační-studie.html#cb121-1229" tabindex="-1"></a>      </span>
<span id="cb121-1230"><a href="simulační-studie.html#cb121-1230" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb121-1231"><a href="simulační-studie.html#cb121-1231" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb121-1232"><a href="simulační-studie.html#cb121-1232" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb121-1233"><a href="simulační-studie.html#cb121-1233" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-1234"><a href="simulační-studie.html#cb121-1234" tabindex="-1"></a>    </span>
<span id="cb121-1235"><a href="simulační-studie.html#cb121-1235" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb121-1236"><a href="simulační-studie.html#cb121-1236" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb121-1237"><a href="simulační-studie.html#cb121-1237" tabindex="-1"></a>  }</span>
<span id="cb121-1238"><a href="simulační-studie.html#cb121-1238" tabindex="-1"></a>  </span>
<span id="cb121-1239"><a href="simulační-studie.html#cb121-1239" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb121-1240"><a href="simulační-studie.html#cb121-1240" tabindex="-1"></a>  </span>
<span id="cb121-1241"><a href="simulační-studie.html#cb121-1241" tabindex="-1"></a>  <span class="do">### Linearni jadro</span></span>
<span id="cb121-1242"><a href="simulační-studie.html#cb121-1242" tabindex="-1"></a>  </span>
<span id="cb121-1243"><a href="simulační-studie.html#cb121-1243" tabindex="-1"></a>  <span class="co"># jadro a jadrova matice ... polynomialni s parametrem p</span></span>
<span id="cb121-1244"><a href="simulační-studie.html#cb121-1244" tabindex="-1"></a>  Linear.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb121-1245"><a href="simulační-studie.html#cb121-1245" tabindex="-1"></a>    <span class="fu">return</span>(x <span class="sc">*</span> y)</span>
<span id="cb121-1246"><a href="simulační-studie.html#cb121-1246" tabindex="-1"></a>  }</span>
<span id="cb121-1247"><a href="simulační-studie.html#cb121-1247" tabindex="-1"></a>  </span>
<span id="cb121-1248"><a href="simulační-studie.html#cb121-1248" tabindex="-1"></a>  Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb121-1249"><a href="simulační-studie.html#cb121-1249" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb121-1250"><a href="simulační-studie.html#cb121-1250" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb121-1251"><a href="simulační-studie.html#cb121-1251" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb121-1252"><a href="simulační-studie.html#cb121-1252" tabindex="-1"></a>        K[i, j] <span class="ot">&lt;-</span> <span class="fu">Linear.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j])</span>
<span id="cb121-1253"><a href="simulační-studie.html#cb121-1253" tabindex="-1"></a>      }</span>
<span id="cb121-1254"><a href="simulační-studie.html#cb121-1254" tabindex="-1"></a>    }</span>
<span id="cb121-1255"><a href="simulační-studie.html#cb121-1255" tabindex="-1"></a>    <span class="fu">return</span>(K)</span>
<span id="cb121-1256"><a href="simulační-studie.html#cb121-1256" tabindex="-1"></a>  }</span>
<span id="cb121-1257"><a href="simulační-studie.html#cb121-1257" tabindex="-1"></a>  </span>
<span id="cb121-1258"><a href="simulační-studie.html#cb121-1258" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb121-1259"><a href="simulační-studie.html#cb121-1259" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb121-1260"><a href="simulační-studie.html#cb121-1260" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb121-1261"><a href="simulační-studie.html#cb121-1261" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb121-1262"><a href="simulační-studie.html#cb121-1262" tabindex="-1"></a>  </span>
<span id="cb121-1263"><a href="simulační-studie.html#cb121-1263" tabindex="-1"></a>  <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb121-1264"><a href="simulační-studie.html#cb121-1264" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">2</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb121-1265"><a href="simulační-studie.html#cb121-1265" tabindex="-1"></a>  </span>
<span id="cb121-1266"><a href="simulační-studie.html#cb121-1266" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb121-1267"><a href="simulační-studie.html#cb121-1267" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb121-1268"><a href="simulační-studie.html#cb121-1268" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane d</span></span>
<span id="cb121-1269"><a href="simulační-studie.html#cb121-1269" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro vrstvy odpovidaji folds</span></span>
<span id="cb121-1270"><a href="simulační-studie.html#cb121-1270" tabindex="-1"></a>  dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb121-1271"><a href="simulační-studie.html#cb121-1271" tabindex="-1"></a>                    <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb121-1272"><a href="simulační-studie.html#cb121-1272" tabindex="-1"></a>  </span>
<span id="cb121-1273"><a href="simulační-studie.html#cb121-1273" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb121-1274"><a href="simulační-studie.html#cb121-1274" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb121-1275"><a href="simulační-studie.html#cb121-1275" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb121-1276"><a href="simulační-studie.html#cb121-1276" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb121-1277"><a href="simulační-studie.html#cb121-1277" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb121-1278"><a href="simulační-studie.html#cb121-1278" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb121-1279"><a href="simulační-studie.html#cb121-1279" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names))</span>
<span id="cb121-1280"><a href="simulační-studie.html#cb121-1280" tabindex="-1"></a>  </span>
<span id="cb121-1281"><a href="simulační-studie.html#cb121-1281" tabindex="-1"></a>  <span class="co"># samotna CV</span></span>
<span id="cb121-1282"><a href="simulační-studie.html#cb121-1282" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb121-1283"><a href="simulační-studie.html#cb121-1283" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb121-1284"><a href="simulační-studie.html#cb121-1284" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb121-1285"><a href="simulační-studie.html#cb121-1285" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb121-1286"><a href="simulační-studie.html#cb121-1286" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb121-1287"><a href="simulační-studie.html#cb121-1287" tabindex="-1"></a>  </span>
<span id="cb121-1288"><a href="simulační-studie.html#cb121-1288" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb121-1289"><a href="simulační-studie.html#cb121-1289" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb121-1290"><a href="simulační-studie.html#cb121-1290" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb121-1291"><a href="simulační-studie.html#cb121-1291" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb121-1292"><a href="simulační-studie.html#cb121-1292" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb121-1293"><a href="simulační-studie.html#cb121-1293" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb121-1294"><a href="simulační-studie.html#cb121-1294" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb121-1295"><a href="simulační-studie.html#cb121-1295" tabindex="-1"></a>                    <span class="at">epsilon =</span> <span class="fl">0.1</span>)</span>
<span id="cb121-1296"><a href="simulační-studie.html#cb121-1296" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb121-1297"><a href="simulační-studie.html#cb121-1297" tabindex="-1"></a>  }</span>
<span id="cb121-1298"><a href="simulační-studie.html#cb121-1298" tabindex="-1"></a>  </span>
<span id="cb121-1299"><a href="simulační-studie.html#cb121-1299" tabindex="-1"></a>  <span class="co"># projdeme dimenze</span></span>
<span id="cb121-1300"><a href="simulační-studie.html#cb121-1300" tabindex="-1"></a>  <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb121-1301"><a href="simulační-studie.html#cb121-1301" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb121-1302"><a href="simulační-studie.html#cb121-1302" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb121-1303"><a href="simulační-studie.html#cb121-1303" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb121-1304"><a href="simulační-studie.html#cb121-1304" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb121-1305"><a href="simulační-studie.html#cb121-1305" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb121-1306"><a href="simulační-studie.html#cb121-1306" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb121-1307"><a href="simulační-studie.html#cb121-1307" tabindex="-1"></a>                             alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb121-1308"><a href="simulační-studie.html#cb121-1308" tabindex="-1"></a>    }</span>
<span id="cb121-1309"><a href="simulační-studie.html#cb121-1309" tabindex="-1"></a>    <span class="co"># projdeme folds</span></span>
<span id="cb121-1310"><a href="simulační-studie.html#cb121-1310" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb121-1311"><a href="simulační-studie.html#cb121-1311" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb121-1312"><a href="simulační-studie.html#cb121-1312" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb121-1313"><a href="simulační-studie.html#cb121-1313" tabindex="-1"></a>      <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb121-1314"><a href="simulační-studie.html#cb121-1314" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb121-1315"><a href="simulační-studie.html#cb121-1315" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb121-1316"><a href="simulační-studie.html#cb121-1316" tabindex="-1"></a>      <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb121-1317"><a href="simulační-studie.html#cb121-1317" tabindex="-1"></a>      Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb121-1318"><a href="simulační-studie.html#cb121-1318" tabindex="-1"></a>                                  <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb121-1319"><a href="simulační-studie.html#cb121-1319" tabindex="-1"></a>                                  <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb121-1320"><a href="simulační-studie.html#cb121-1320" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb121-1321"><a href="simulační-studie.html#cb121-1321" tabindex="-1"></a>      <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb121-1322"><a href="simulační-studie.html#cb121-1322" tabindex="-1"></a>      <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb121-1323"><a href="simulační-studie.html#cb121-1323" tabindex="-1"></a>        kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb121-1324"><a href="simulační-studie.html#cb121-1324" tabindex="-1"></a>      </span>
<span id="cb121-1325"><a href="simulační-studie.html#cb121-1325" tabindex="-1"></a>        data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb121-1326"><a href="simulační-studie.html#cb121-1326" tabindex="-1"></a>        data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb121-1327"><a href="simulační-studie.html#cb121-1327" tabindex="-1"></a>        </span>
<span id="cb121-1328"><a href="simulační-studie.html#cb121-1328" tabindex="-1"></a>        data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb121-1329"><a href="simulační-studie.html#cb121-1329" tabindex="-1"></a>        data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb121-1330"><a href="simulační-studie.html#cb121-1330" tabindex="-1"></a>        </span>
<span id="cb121-1331"><a href="simulační-studie.html#cb121-1331" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb121-1332"><a href="simulační-studie.html#cb121-1332" tabindex="-1"></a>        clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb121-1333"><a href="simulační-studie.html#cb121-1333" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb121-1334"><a href="simulační-studie.html#cb121-1334" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb121-1335"><a href="simulační-studie.html#cb121-1335" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb121-1336"><a href="simulační-studie.html#cb121-1336" tabindex="-1"></a>        </span>
<span id="cb121-1337"><a href="simulační-studie.html#cb121-1337" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb121-1338"><a href="simulační-studie.html#cb121-1338" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb121-1339"><a href="simulační-studie.html#cb121-1339" tabindex="-1"></a>        presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb121-1340"><a href="simulační-studie.html#cb121-1340" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-1341"><a href="simulační-studie.html#cb121-1341" tabindex="-1"></a>        </span>
<span id="cb121-1342"><a href="simulační-studie.html#cb121-1342" tabindex="-1"></a>        <span class="co"># ulozeni vysledku</span></span>
<span id="cb121-1343"><a href="simulační-studie.html#cb121-1343" tabindex="-1"></a>        Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb121-1344"><a href="simulační-studie.html#cb121-1344" tabindex="-1"></a>      }</span>
<span id="cb121-1345"><a href="simulační-studie.html#cb121-1345" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb121-1346"><a href="simulační-studie.html#cb121-1346" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb121-1347"><a href="simulační-studie.html#cb121-1347" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb121-1348"><a href="simulační-studie.html#cb121-1348" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb121-1349"><a href="simulační-studie.html#cb121-1349" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb121-1350"><a href="simulační-studie.html#cb121-1350" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb121-1351"><a href="simulační-studie.html#cb121-1351" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb121-1352"><a href="simulační-studie.html#cb121-1352" tabindex="-1"></a>    }</span>
<span id="cb121-1353"><a href="simulační-studie.html#cb121-1353" tabindex="-1"></a>  }</span>
<span id="cb121-1354"><a href="simulační-studie.html#cb121-1354" tabindex="-1"></a>  </span>
<span id="cb121-1355"><a href="simulační-studie.html#cb121-1355" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb121-1356"><a href="simulační-studie.html#cb121-1356" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb121-1357"><a href="simulační-studie.html#cb121-1357" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb121-1358"><a href="simulační-studie.html#cb121-1358" tabindex="-1"></a>  }</span>
<span id="cb121-1359"><a href="simulační-studie.html#cb121-1359" tabindex="-1"></a>  </span>
<span id="cb121-1360"><a href="simulační-studie.html#cb121-1360" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb121-1361"><a href="simulační-studie.html#cb121-1361" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb121-1362"><a href="simulační-studie.html#cb121-1362" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb121-1363"><a href="simulační-studie.html#cb121-1363" tabindex="-1"></a>  d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb121-1364"><a href="simulační-studie.html#cb121-1364" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb121-1365"><a href="simulační-studie.html#cb121-1365" tabindex="-1"></a>  </span>
<span id="cb121-1366"><a href="simulační-studie.html#cb121-1366" tabindex="-1"></a>  err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb121-1367"><a href="simulační-studie.html#cb121-1367" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb121-1368"><a href="simulační-studie.html#cb121-1368" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb121-1369"><a href="simulační-studie.html#cb121-1369" tabindex="-1"></a>  df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb121-1370"><a href="simulační-studie.html#cb121-1370" tabindex="-1"></a>             <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb121-1371"><a href="simulační-studie.html#cb121-1371" tabindex="-1"></a>             <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb121-1372"><a href="simulační-studie.html#cb121-1372" tabindex="-1"></a>  </span>
<span id="cb121-1373"><a href="simulační-studie.html#cb121-1373" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb121-1374"><a href="simulační-studie.html#cb121-1374" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb121-1375"><a href="simulační-studie.html#cb121-1375" tabindex="-1"></a>  <span class="co"># pridame i testovaci data</span></span>
<span id="cb121-1376"><a href="simulační-studie.html#cb121-1376" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb121-1377"><a href="simulační-studie.html#cb121-1377" tabindex="-1"></a>  </span>
<span id="cb121-1378"><a href="simulační-studie.html#cb121-1378" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb121-1379"><a href="simulační-studie.html#cb121-1379" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - linear&#39;</span>, </span>
<span id="cb121-1380"><a href="simulační-studie.html#cb121-1380" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - RKHS - linear&#39;</span>, </span>
<span id="cb121-1381"><a href="simulační-studie.html#cb121-1381" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - RKHS - linear&#39;</span>), </span>
<span id="cb121-1382"><a href="simulační-studie.html#cb121-1382" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb121-1383"><a href="simulační-studie.html#cb121-1383" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb121-1384"><a href="simulační-studie.html#cb121-1384" tabindex="-1"></a>  </span>
<span id="cb121-1385"><a href="simulační-studie.html#cb121-1385" tabindex="-1"></a>  <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb121-1386"><a href="simulační-studie.html#cb121-1386" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb121-1387"><a href="simulační-studie.html#cb121-1387" tabindex="-1"></a>    <span class="co"># spocitame matici K</span></span>
<span id="cb121-1388"><a href="simulační-studie.html#cb121-1388" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb121-1389"><a href="simulační-studie.html#cb121-1389" tabindex="-1"></a>    </span>
<span id="cb121-1390"><a href="simulační-studie.html#cb121-1390" tabindex="-1"></a>    <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb121-1391"><a href="simulační-studie.html#cb121-1391" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb121-1392"><a href="simulační-studie.html#cb121-1392" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb121-1393"><a href="simulační-studie.html#cb121-1393" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb121-1394"><a href="simulační-studie.html#cb121-1394" tabindex="-1"></a>    <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb121-1395"><a href="simulační-studie.html#cb121-1395" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb121-1396"><a href="simulační-studie.html#cb121-1396" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb121-1397"><a href="simulační-studie.html#cb121-1397" tabindex="-1"></a>    </span>
<span id="cb121-1398"><a href="simulační-studie.html#cb121-1398" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb121-1399"><a href="simulační-studie.html#cb121-1399" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb121-1400"><a href="simulační-studie.html#cb121-1400" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb121-1401"><a href="simulační-studie.html#cb121-1401" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb121-1402"><a href="simulační-studie.html#cb121-1402" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb121-1403"><a href="simulační-studie.html#cb121-1403" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb121-1404"><a href="simulační-studie.html#cb121-1404" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb121-1405"><a href="simulační-studie.html#cb121-1405" tabindex="-1"></a>                      <span class="at">epsilon =</span> <span class="fl">0.1</span>)</span>
<span id="cb121-1406"><a href="simulační-studie.html#cb121-1406" tabindex="-1"></a>      <span class="co"># urceni alpha</span></span>
<span id="cb121-1407"><a href="simulační-studie.html#cb121-1407" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb121-1408"><a href="simulační-studie.html#cb121-1408" tabindex="-1"></a>    }</span>
<span id="cb121-1409"><a href="simulační-studie.html#cb121-1409" tabindex="-1"></a>    <span class="co"># d</span></span>
<span id="cb121-1410"><a href="simulační-studie.html#cb121-1410" tabindex="-1"></a>    d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb121-1411"><a href="simulační-studie.html#cb121-1411" tabindex="-1"></a>    </span>
<span id="cb121-1412"><a href="simulační-studie.html#cb121-1412" tabindex="-1"></a>    <span class="co"># urceni vektoru lambda</span></span>
<span id="cb121-1413"><a href="simulační-studie.html#cb121-1413" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb121-1414"><a href="simulační-studie.html#cb121-1414" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb121-1415"><a href="simulační-studie.html#cb121-1415" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb121-1416"><a href="simulační-studie.html#cb121-1416" tabindex="-1"></a>    </span>
<span id="cb121-1417"><a href="simulační-studie.html#cb121-1417" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb121-1418"><a href="simulační-studie.html#cb121-1418" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb121-1419"><a href="simulační-studie.html#cb121-1419" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb121-1420"><a href="simulační-studie.html#cb121-1420" tabindex="-1"></a>    }</span>
<span id="cb121-1421"><a href="simulační-studie.html#cb121-1421" tabindex="-1"></a>    </span>
<span id="cb121-1422"><a href="simulační-studie.html#cb121-1422" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb121-1423"><a href="simulační-studie.html#cb121-1423" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb121-1424"><a href="simulační-studie.html#cb121-1424" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb121-1425"><a href="simulační-studie.html#cb121-1425" tabindex="-1"></a>  </span>
<span id="cb121-1426"><a href="simulační-studie.html#cb121-1426" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb121-1427"><a href="simulační-studie.html#cb121-1427" tabindex="-1"></a>  </span>
<span id="cb121-1428"><a href="simulační-studie.html#cb121-1428" tabindex="-1"></a>    data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb121-1429"><a href="simulační-studie.html#cb121-1429" tabindex="-1"></a>    data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb121-1430"><a href="simulační-studie.html#cb121-1430" tabindex="-1"></a>    </span>
<span id="cb121-1431"><a href="simulační-studie.html#cb121-1431" tabindex="-1"></a>    data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb121-1432"><a href="simulační-studie.html#cb121-1432" tabindex="-1"></a>    data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb121-1433"><a href="simulační-studie.html#cb121-1433" tabindex="-1"></a>    </span>
<span id="cb121-1434"><a href="simulační-studie.html#cb121-1434" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb121-1435"><a href="simulační-studie.html#cb121-1435" tabindex="-1"></a>    clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb121-1436"><a href="simulační-studie.html#cb121-1436" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb121-1437"><a href="simulační-studie.html#cb121-1437" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb121-1438"><a href="simulační-studie.html#cb121-1438" tabindex="-1"></a>                        <span class="at">kernel =</span> kernel_type)</span>
<span id="cb121-1439"><a href="simulační-studie.html#cb121-1439" tabindex="-1"></a>    </span>
<span id="cb121-1440"><a href="simulační-studie.html#cb121-1440" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb121-1441"><a href="simulační-studie.html#cb121-1441" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb121-1442"><a href="simulační-studie.html#cb121-1442" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb121-1443"><a href="simulační-studie.html#cb121-1443" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-1444"><a href="simulační-studie.html#cb121-1444" tabindex="-1"></a>      </span>
<span id="cb121-1445"><a href="simulační-studie.html#cb121-1445" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb121-1446"><a href="simulační-studie.html#cb121-1446" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb121-1447"><a href="simulační-studie.html#cb121-1447" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb121-1448"><a href="simulační-studie.html#cb121-1448" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb121-1449"><a href="simulační-studie.html#cb121-1449" tabindex="-1"></a>    </span>
<span id="cb121-1450"><a href="simulační-studie.html#cb121-1450" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb121-1451"><a href="simulační-studie.html#cb121-1451" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb121-1452"><a href="simulační-studie.html#cb121-1452" tabindex="-1"></a>  }</span>
<span id="cb121-1453"><a href="simulační-studie.html#cb121-1453" tabindex="-1"></a>  </span>
<span id="cb121-1454"><a href="simulační-studie.html#cb121-1454" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb121-1455"><a href="simulační-studie.html#cb121-1455" tabindex="-1"></a>  </span>
<span id="cb121-1456"><a href="simulační-studie.html#cb121-1456" tabindex="-1"></a>  <span class="do">## pridame vysledky do objektu SIMULACE</span></span>
<span id="cb121-1457"><a href="simulační-studie.html#cb121-1457" tabindex="-1"></a>  </span>
<span id="cb121-1458"><a href="simulační-studie.html#cb121-1458" tabindex="-1"></a>  SIMULACE<span class="sc">$</span>train[sim, ] <span class="ot">&lt;-</span> RESULTS<span class="sc">$</span>Err.train</span>
<span id="cb121-1459"><a href="simulační-studie.html#cb121-1459" tabindex="-1"></a>  SIMULACE<span class="sc">$</span>test[sim, ] <span class="ot">&lt;-</span> RESULTS<span class="sc">$</span>Err.test</span>
<span id="cb121-1460"><a href="simulační-studie.html#cb121-1460" tabindex="-1"></a>}</span></code></pre></div>
</details>
<pre><code>## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
<p>Nyní spočítáme průměrné testovací a trénovací chybovosti pro jednotlivé klasifikační metody.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="simulační-studie.html#cb123-1" tabindex="-1"></a><span class="co"># dame do vysledne tabulky</span></span>
<span id="cb123-2"><a href="simulační-studie.html#cb123-2" tabindex="-1"></a></span>
<span id="cb123-3"><a href="simulační-studie.html#cb123-3" tabindex="-1"></a>SIMULACE.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Err.train =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>train, <span class="dv">2</span>, mean),</span>
<span id="cb123-4"><a href="simulační-studie.html#cb123-4" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>test, <span class="dv">2</span>, mean),</span>
<span id="cb123-5"><a href="simulační-studie.html#cb123-5" tabindex="-1"></a>                          <span class="at">SD.train =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>train, <span class="dv">2</span>, sd),</span>
<span id="cb123-6"><a href="simulační-studie.html#cb123-6" tabindex="-1"></a>                          <span class="at">SD.test =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>test, <span class="dv">2</span>, sd))</span></code></pre></div>
</details>
<div id="výsledky" class="section level3 hasAnchor" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> Výsledky<a href="simulační-studie.html#výsledky" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<table>
<caption><span id="tab:unnamed-chunk-120">Tabulka 2.9: </span>Souhrnné výsledky použitých metod na simulovaných datech. <span class="math inline">\(\widehat{Err}_{train}\)</span> značí odhad trénovací chybovosti, <span class="math inline">\(\widehat{Err}_{test}\)</span> testovací chybovosti, <span class="math inline">\(\widehat{SD}_{train}\)</span> odhad směrodatné odchylky trénovacích chybovostí a <span class="math inline">\(\widehat{SD}_{test}\)</span> je odhad směrodatné odchylky testovacích chybovostí.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{train}\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{test}\)</span></th>
<th align="right"><span class="math inline">\(\widehat{SD}_{train}\)</span></th>
<th align="right"><span class="math inline">\(\widehat{SD}_{test}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>KNN</td>
<td align="right">0.2289</td>
<td align="right">0.2637</td>
<td align="right">0.0337</td>
<td align="right">0.0582</td>
</tr>
<tr class="even">
<td>LDA</td>
<td align="right">0.2124</td>
<td align="right">0.2357</td>
<td align="right">0.0329</td>
<td align="right">0.0637</td>
</tr>
<tr class="odd">
<td>QDA</td>
<td align="right">0.2077</td>
<td align="right">0.2410</td>
<td align="right">0.0309</td>
<td align="right">0.0657</td>
</tr>
<tr class="even">
<td>LR_functional</td>
<td align="right">0.1876</td>
<td align="right">0.2447</td>
<td align="right">0.0325</td>
<td align="right">0.0713</td>
</tr>
<tr class="odd">
<td>LR_score</td>
<td align="right">0.2100</td>
<td align="right">0.2360</td>
<td align="right">0.0334</td>
<td align="right">0.0669</td>
</tr>
<tr class="even">
<td>Tree_discr</td>
<td align="right">0.1930</td>
<td align="right">0.2780</td>
<td align="right">0.0330</td>
<td align="right">0.0645</td>
</tr>
<tr class="odd">
<td>Tree_score</td>
<td align="right">0.2114</td>
<td align="right">0.2890</td>
<td align="right">0.0410</td>
<td align="right">0.0640</td>
</tr>
<tr class="even">
<td>Tree_Bbasis</td>
<td align="right">0.1943</td>
<td align="right">0.2820</td>
<td align="right">0.0327</td>
<td align="right">0.0631</td>
</tr>
<tr class="odd">
<td>RF_discr</td>
<td align="right">0.0199</td>
<td align="right">0.2650</td>
<td align="right">0.0092</td>
<td align="right">0.0582</td>
</tr>
<tr class="even">
<td>RF_score</td>
<td align="right">0.0413</td>
<td align="right">0.2710</td>
<td align="right">0.0139</td>
<td align="right">0.0657</td>
</tr>
<tr class="odd">
<td>RF_Bbasis</td>
<td align="right">0.0204</td>
<td align="right">0.2610</td>
<td align="right">0.0109</td>
<td align="right">0.0592</td>
</tr>
<tr class="even">
<td>SVM linear - diskr</td>
<td align="right">0.2039</td>
<td align="right">0.2337</td>
<td align="right">0.0285</td>
<td align="right">0.0620</td>
</tr>
<tr class="odd">
<td>SVM poly - diskr</td>
<td align="right">0.2236</td>
<td align="right">0.2880</td>
<td align="right">0.0354</td>
<td align="right">0.0743</td>
</tr>
<tr class="even">
<td>SVM rbf - diskr</td>
<td align="right">0.1866</td>
<td align="right">0.2477</td>
<td align="right">0.0276</td>
<td align="right">0.0609</td>
</tr>
<tr class="odd">
<td>SVM linear - PCA</td>
<td align="right">0.2111</td>
<td align="right">0.2393</td>
<td align="right">0.0338</td>
<td align="right">0.0638</td>
</tr>
<tr class="even">
<td>SVM poly - PCA</td>
<td align="right">0.2220</td>
<td align="right">0.2813</td>
<td align="right">0.0343</td>
<td align="right">0.0720</td>
</tr>
<tr class="odd">
<td>SVM rbf - PCA</td>
<td align="right">0.1830</td>
<td align="right">0.2513</td>
<td align="right">0.0292</td>
<td align="right">0.0658</td>
</tr>
<tr class="even">
<td>SVM linear - Bbasis</td>
<td align="right">0.2037</td>
<td align="right">0.2353</td>
<td align="right">0.0266</td>
<td align="right">0.0641</td>
</tr>
<tr class="odd">
<td>SVM poly - Bbasis</td>
<td align="right">0.2239</td>
<td align="right">0.2880</td>
<td align="right">0.0344</td>
<td align="right">0.0719</td>
</tr>
<tr class="even">
<td>SVM rbf - Bbasis</td>
<td align="right">0.1844</td>
<td align="right">0.2457</td>
<td align="right">0.0279</td>
<td align="right">0.0615</td>
</tr>
<tr class="odd">
<td>SVM linear - projection</td>
<td align="right">0.1740</td>
<td align="right">0.2600</td>
<td align="right">0.0359</td>
<td align="right">0.0711</td>
</tr>
<tr class="even">
<td>SVM poly - projection</td>
<td align="right">0.1794</td>
<td align="right">0.2950</td>
<td align="right">0.0571</td>
<td align="right">0.0843</td>
</tr>
<tr class="odd">
<td>SVM rbf - projection</td>
<td align="right">0.1483</td>
<td align="right">0.2840</td>
<td align="right">0.0396</td>
<td align="right">0.0713</td>
</tr>
<tr class="even">
<td>SVM linear - RKHS - radial</td>
<td align="right">0.2519</td>
<td align="right">0.3597</td>
<td align="right">0.0351</td>
<td align="right">0.0587</td>
</tr>
<tr class="odd">
<td>SVM poly - RKHS - radial</td>
<td align="right">0.2426</td>
<td align="right">0.3740</td>
<td align="right">0.0455</td>
<td align="right">0.0674</td>
</tr>
<tr class="even">
<td>SVM rbf - RKHS - radial</td>
<td align="right">0.2331</td>
<td align="right">0.3520</td>
<td align="right">0.0402</td>
<td align="right">0.0502</td>
</tr>
<tr class="odd">
<td>SVM linear - RKHS - poly</td>
<td align="right">0.3799</td>
<td align="right">0.4540</td>
<td align="right">0.0943</td>
<td align="right">0.1231</td>
</tr>
<tr class="even">
<td>SVM poly - RKHS - poly</td>
<td align="right">0.3827</td>
<td align="right">0.4703</td>
<td align="right">0.0821</td>
<td align="right">0.1079</td>
</tr>
<tr class="odd">
<td>SVM rbf - RKHS - poly</td>
<td align="right">0.3693</td>
<td align="right">0.4393</td>
<td align="right">0.0869</td>
<td align="right">0.1162</td>
</tr>
<tr class="even">
<td>SVM linear - RKHS - linear</td>
<td align="right">0.3019</td>
<td align="right">0.3533</td>
<td align="right">0.0552</td>
<td align="right">0.0675</td>
</tr>
<tr class="odd">
<td>SVM poly - RKHS - linear</td>
<td align="right">0.2746</td>
<td align="right">0.3767</td>
<td align="right">0.0549</td>
<td align="right">0.0732</td>
</tr>
<tr class="even">
<td>SVM rbf - RKHS - linear</td>
<td align="right">0.2834</td>
<td align="right">0.3570</td>
<td align="right">0.0374</td>
<td align="right">0.0742</td>
</tr>
</tbody>
</table>
<p>V tabulce výše jsou uvedeny všechny vypočtené charakteristiky.
Jsou zde uvedeny také směrodatné odchylky, abychom mohli porovnat jakousi stálost či míru variability jednotlivých metod.</p>
<p>Nakonec ještě můžeme graficky zobrazit vypočtené hodnoty ze simulace pro jednotlivé klasifikační metody pomocí krabicových diagramů, zvlášť pro testovací a trénovací chybovosti.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="simulační-studie.html#cb124-1" tabindex="-1"></a><span class="co"># pro trenovaci data</span></span>
<span id="cb124-2"><a href="simulační-studie.html#cb124-2" tabindex="-1"></a>SIMULACE<span class="sc">$</span>train <span class="sc">|&gt;</span> </span>
<span id="cb124-3"><a href="simulační-studie.html#cb124-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> methods, <span class="at">names_to =</span> <span class="st">&#39;method&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb124-4"><a href="simulační-studie.html#cb124-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb124-5"><a href="simulační-studie.html#cb124-5" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb124-6"><a href="simulační-studie.html#cb124-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> Err, <span class="at">fill =</span> method, <span class="at">colour =</span> method, <span class="at">alpha =</span> <span class="fl">0.3</span>)) <span class="sc">+</span> </span>
<span id="cb124-7"><a href="simulační-studie.html#cb124-7" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">&quot;white&quot;</span>, <span class="at">outlier.shape =</span> <span class="dv">16</span>, <span class="at">outlier.size =</span> <span class="dv">0</span>, </span>
<span id="cb124-8"><a href="simulační-studie.html#cb124-8" tabindex="-1"></a>               <span class="at">notch =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb124-9"><a href="simulační-studie.html#cb124-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb124-10"><a href="simulační-studie.html#cb124-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Klasifikační metoda&#39;</span>,</span>
<span id="cb124-11"><a href="simulační-studie.html#cb124-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(Err)[train])) <span class="sc">+</span> </span>
<span id="cb124-12"><a href="simulační-studie.html#cb124-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb124-13"><a href="simulační-studie.html#cb124-13" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">40</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb124-14"><a href="simulační-studie.html#cb124-14" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.15</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb124-15"><a href="simulační-studie.html#cb124-15" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb124-16"><a href="simulační-studie.html#cb124-16" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">shape =</span> <span class="st">&#39;+&#39;</span>,</span>
<span id="cb124-17"><a href="simulační-studie.html#cb124-17" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>)<span class="sc">+</span> </span>
<span id="cb124-18"><a href="simulační-studie.html#cb124-18" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">min</span>(SIMULACE.df<span class="sc">$</span>Err.train), </span>
<span id="cb124-19"><a href="simulační-studie.html#cb124-19" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121"></span>
<img src="01-Simulace_1_files/figure-html/unnamed-chunk-121-1.png" alt="Krabicové diagramy trénovacích chybovostí pro 100 simulací zvlášť pro jednotlivé klasifikační metody. Černými symboly $+$ jsou vyznačeny průměry." width="672" />
<p class="caption">
Obrázek 2.24: Krabicové diagramy trénovacích chybovostí pro 100 simulací zvlášť pro jednotlivé klasifikační metody. Černými symboly <span class="math inline">\(+\)</span> jsou vyznačeny průměry.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="simulační-studie.html#cb125-1" tabindex="-1"></a><span class="co"># pro testovaci data</span></span>
<span id="cb125-2"><a href="simulační-studie.html#cb125-2" tabindex="-1"></a>SIMULACE<span class="sc">$</span>test <span class="sc">|&gt;</span> </span>
<span id="cb125-3"><a href="simulační-studie.html#cb125-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> methods, <span class="at">names_to =</span> <span class="st">&#39;method&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb125-4"><a href="simulační-studie.html#cb125-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb125-5"><a href="simulační-studie.html#cb125-5" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb125-6"><a href="simulační-studie.html#cb125-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> Err, <span class="at">fill =</span> method, <span class="at">colour =</span> method, <span class="at">alpha =</span> <span class="fl">0.3</span>)) <span class="sc">+</span> </span>
<span id="cb125-7"><a href="simulační-studie.html#cb125-7" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">&quot;white&quot;</span>, <span class="at">outlier.shape =</span> <span class="dv">16</span>, <span class="at">outlier.size =</span> <span class="dv">0</span>, </span>
<span id="cb125-8"><a href="simulační-studie.html#cb125-8" tabindex="-1"></a>               <span class="at">notch =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb125-9"><a href="simulační-studie.html#cb125-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb125-10"><a href="simulační-studie.html#cb125-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Klasifikační metoda&#39;</span>,</span>
<span id="cb125-11"><a href="simulační-studie.html#cb125-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(Err)[test])) <span class="sc">+</span> </span>
<span id="cb125-12"><a href="simulační-studie.html#cb125-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb125-13"><a href="simulační-studie.html#cb125-13" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">40</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb125-14"><a href="simulační-studie.html#cb125-14" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.15</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb125-15"><a href="simulační-studie.html#cb125-15" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb125-16"><a href="simulační-studie.html#cb125-16" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">shape =</span> <span class="st">&#39;+&#39;</span>,</span>
<span id="cb125-17"><a href="simulační-studie.html#cb125-17" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span> </span>
<span id="cb125-18"><a href="simulační-studie.html#cb125-18" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">min</span>(SIMULACE.df<span class="sc">$</span>Err.test), </span>
<span id="cb125-19"><a href="simulační-studie.html#cb125-19" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-123"></span>
<img src="01-Simulace_1_files/figure-html/unnamed-chunk-123-1.png" alt="Krabicové diagramy testovacích chybovostí pro 100 simulací zvlášť pro jednotlivé klasifikační metody. Černými symboly $+$ jsou vyznačeny průměry." width="672" />
<p class="caption">
Obrázek 2.25: Krabicové diagramy testovacích chybovostí pro 100 simulací zvlášť pro jednotlivé klasifikační metody. Černými symboly <span class="math inline">\(+\)</span> jsou vyznačeny průměry.
</p>
</div>
<p>Nakonec se podívejme, jaké hodnoty hyperparametrů byly nejčastější volbou.</p>
<table>
<caption><span id="tab:unnamed-chunk-125">Tabulka 2.10: </span>Mediány hodnot hyperparametrů pro vybrané metody, u nichž se určoval nějaký hyperparametr pomocí cross-validace.</caption>
<thead>
<tr class="header">
<th align="center"><span class="math inline">\(K\)</span> pro KNN</th>
<th align="right"><span class="math inline">\(d\)</span> pro SVM linear</th>
<th align="center"><span class="math inline">\(d\)</span> pro SVM poly</th>
<th align="right"><span class="math inline">\(d\)</span> pro SVM radial</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">13.5</td>
<td align="right">7</td>
<td align="center">5</td>
<td align="right">5</td>
</tr>
</tbody>
</table>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="simulační-studie.html#cb126-1" tabindex="-1"></a>CV_RESULTS <span class="sc">|&gt;</span> </span>
<span id="cb126-2"><a href="simulační-studie.html#cb126-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> CV_RESULTS <span class="sc">|&gt;</span> <span class="fu">colnames</span>(), <span class="at">names_to =</span> <span class="st">&#39;method&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;hyperparameter&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb126-3"><a href="simulační-studie.html#cb126-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, </span>
<span id="cb126-4"><a href="simulační-studie.html#cb126-4" tabindex="-1"></a>                         <span class="at">levels =</span> CV_RESULTS <span class="sc">|&gt;</span> <span class="fu">colnames</span>(), </span>
<span id="cb126-5"><a href="simulační-studie.html#cb126-5" tabindex="-1"></a>                         <span class="at">labels =</span> CV_RESULTS <span class="sc">|&gt;</span> <span class="fu">colnames</span>(), <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb126-6"><a href="simulační-studie.html#cb126-6" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb126-7"><a href="simulační-studie.html#cb126-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb126-8"><a href="simulační-studie.html#cb126-8" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb126-9"><a href="simulační-studie.html#cb126-9" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span> </span>
<span id="cb126-10"><a href="simulační-studie.html#cb126-10" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb126-11"><a href="simulační-studie.html#cb126-11" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>) <span class="sc">+</span></span>
<span id="cb126-12"><a href="simulační-studie.html#cb126-12" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hodnoty hyperparametru&#39;</span>,</span>
<span id="cb126-13"><a href="simulační-studie.html#cb126-13" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolutní počet&#39;</span>) <span class="sc">+</span> </span>
<span id="cb126-14"><a href="simulační-studie.html#cb126-14" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-126"></span>
<img src="01-Simulace_1_files/figure-html/unnamed-chunk-126-1.png" alt="Krabicové diagramy hodnot hyperparametrů." width="672" />
<p class="caption">
Obrázek 2.26: Krabicové diagramy hodnot hyperparametrů.
</p>
</div>

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="tabulka-výsledků.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="simulace-2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": null,
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/Tomas-Pompa/MastersThesis/blob/main/01-Simulace_1.Rmd",
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
